<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Corrado Caudek">
<title>46&nbsp; Lâ€™influenza della distribuzione a priori</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/bayesian_inference/09_gamma_poisson_model.html" rel="next">
<link href="../../chapters/bayesian_inference/07_summary_posterior.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-9fca8b603bedf2af16b4ac58a76b360a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/bayesian_inference/introduction_bayes_inference.html">Inferenza</a></li><li class="breadcrumb-item"><a href="../../chapters/bayesian_inference/08_balance_prior_post.html"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Lâ€™influenza della distribuzione a priori</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Eseguire il codice" class="quarto-navigation-tool px-1" aria-label="Eseguire il codice"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalitÃ  lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benvenuti</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefazione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Calendario</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../programmazione2024.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programma didattico e dettaglio del corso</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/key_notions/introduction_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fondamenti</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/01_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Abbracciare lâ€™incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/02_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Concetti chiave</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/03_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Campionamento, metodologia sperimentale e studi osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/04_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/05_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">La riforma metodologica in psicologia: dalla crisi alla rivoluzione bayesiana</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/R/introduction_r_lang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/01_r_syntax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Science e R: un approccio moderno allâ€™analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/02_utility_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Utility functions in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/03_r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Programmazione in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/04_r_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Pacchetti in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/05_dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduzione a <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/06_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/07_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Lâ€™ambiente di programmazione in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/08_ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Utilizzo di strumenti AI per la programmazione</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/eda/introduction_eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/01_project_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Le fasi del progetto di analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/02_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Flusso di lavoro per la pulizia dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/04_exploring_qualitative_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Esplorare i dati qualitativi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/05_exploring_numeric_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Esplorare i dati numerici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/06_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Principi della visualizzazione dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07_loc_scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Indicatori di tendenza centrale e variabilitÃ </span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/08_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Relazioni tra variabili</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/09_causality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">CausalitÃ  dai dati osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/10_estimand.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Estimandi teorici e estimandi empirici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/11_outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Outlier</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/probability/introduction_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ProbabilitÃ </span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/01_intro_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Interpretazione della probabilitÃ </span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/02_prob_spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Misura di ProbabilitÃ </span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/03_prob_on_general_spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fondamenti della probabilitÃ </span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/04_conditional_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">ProbabilitÃ  condizionata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/05_random_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/06_expval_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">ProprietÃ  delle variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/07_bayes_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/08_sampling_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/09_joint_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">ProbabilitÃ  congiunta</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/10_prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Distribuzioni di massa e di densitÃ </span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11_discr_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12_cont_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/13_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Assunzione di gaussianitÃ  e trasformazioni dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/14_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">La verosimiglianza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/15_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Simulazioni</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_intro_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">La quantificazione dellâ€™incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_bayesian_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Pensare ad una proporzione in termini soggettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_grid_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Calcolo della Distribuzione a Posteriori Gaussiana tramite Metodo a Griglia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_conjugate_families_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_conjugate_families_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (2)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_balance_prior_post.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Lâ€™influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_gamma_exponential_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Modello gamma-esponenziale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/11_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Lâ€™algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata: un approccio frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_synt_sugar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_one_mean_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media (Stan) ðŸ”¸</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_prediction_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Predizione e inferenza ðŸ”¸</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_two_means_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Confronto tra due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Disegno della ricerca e potere statistico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_anova_2vie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">ANOVA ad due vie</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Frequentismo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/introduction_frequentist_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01_intro_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Introduzione allâ€™inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/02_conf_interv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/03_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">La grandezza del campione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/04_test_ipotesi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">SignificativitÃ  statistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/05_two_ind_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Test t di Student per campioni indipendenti</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Limiti dellâ€™inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">La grandezza dellâ€™effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">La fragilitÃ  del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_piranha.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Il Problema del priming: sfide e paradossi nella psicologia sociale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">IntegritÃ  della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendice</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a10_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a44_montecarlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">Simulazione Monte Carlo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a46_stan_lang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">85</span>&nbsp; <span class="chapter-title">Linguaggio Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">86</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Indice</h2>
   
  <ul>
<li><a href="#introduzione" id="toc-introduzione" class="nav-link active" data-scroll-target="#introduzione"><span class="header-section-number">46.1</span> Introduzione</a></li>
  <li><a href="#la-distribuzione-a-priori" id="toc-la-distribuzione-a-priori" class="nav-link" data-scroll-target="#la-distribuzione-a-priori"><span class="header-section-number">46.2</span> La Distribuzione a Priori</a></li>
  <li><a href="#tipologie-di-distribuzioni-a-priori" id="toc-tipologie-di-distribuzioni-a-priori" class="nav-link" data-scroll-target="#tipologie-di-distribuzioni-a-priori"><span class="header-section-number">46.3</span> Tipologie di Distribuzioni a Priori</a></li>
  <li><a href="#limportanza-della-prior-in-base-ai-dati" id="toc-limportanza-della-prior-in-base-ai-dati" class="nav-link" data-scroll-target="#limportanza-della-prior-in-base-ai-dati"><span class="header-section-number">46.4</span> Lâ€™importanza della Prior in base ai Dati</a></li>
  <li>
<a href="#effetti-del-cambiamento-di-scala-dei-parametri" id="toc-effetti-del-cambiamento-di-scala-dei-parametri" class="nav-link" data-scroll-target="#effetti-del-cambiamento-di-scala-dei-parametri"><span class="header-section-number">46.5</span> Effetti del Cambiamento di Scala dei Parametri</a>
  <ul class="collapse">
<li><a href="#scala-e-invariabilit%C3%A0-della-scelta-delle-distribuzioni-a-priori" id="toc-scala-e-invariabilitÃ -della-scelta-delle-distribuzioni-a-priori" class="nav-link" data-scroll-target="#scala-e-invariabilit%C3%A0-della-scelta-delle-distribuzioni-a-priori"><span class="header-section-number">46.5.1</span> Scala e invariabilitÃ  della scelta delle distribuzioni a priori</a></li>
  <li><a href="#il-concetto-di-invariabilit%C3%A0-della-scala" id="toc-il-concetto-di-invariabilitÃ -della-scala" class="nav-link" data-scroll-target="#il-concetto-di-invariabilit%C3%A0-della-scala"><span class="header-section-number">46.5.2</span> Il concetto di invariabilitÃ  della scala</a></li>
  <li><a href="#attenzione-alle-trasformazioni-dei-parametri" id="toc-attenzione-alle-trasformazioni-dei-parametri" class="nav-link" data-scroll-target="#attenzione-alle-trasformazioni-dei-parametri"><span class="header-section-number">46.5.3</span> Attenzione alle trasformazioni dei parametri</a></li>
  </ul>
</li>
  <li>
<a href="#scelte-predefinite-per-le-distribuzioni-a-priori-non-informative" id="toc-scelte-predefinite-per-le-distribuzioni-a-priori-non-informative" class="nav-link" data-scroll-target="#scelte-predefinite-per-le-distribuzioni-a-priori-non-informative"><span class="header-section-number">46.6</span> Scelte predefinite per le distribuzioni a priori non informative</a>
  <ul class="collapse">
<li><a href="#scelte-predefinite-comuni-per-le-priors-non-informative" id="toc-scelte-predefinite-comuni-per-le-priors-non-informative" class="nav-link" data-scroll-target="#scelte-predefinite-comuni-per-le-priors-non-informative"><span class="header-section-number">46.6.1</span> Scelte predefinite comuni per le priors non informative</a></li>
  <li><a href="#attenzione-alle-trasformazioni-dei-parametri-1" id="toc-attenzione-alle-trasformazioni-dei-parametri-1" class="nav-link" data-scroll-target="#attenzione-alle-trasformazioni-dei-parametri-1"><span class="header-section-number">46.6.2</span> Attenzione alle trasformazioni dei parametri</a></li>
  <li><a href="#analisi-di-sensibilit%C3%A0" id="toc-analisi-di-sensibilitÃ " class="nav-link" data-scroll-target="#analisi-di-sensibilit%C3%A0"><span class="header-section-number">46.6.3</span> Analisi di sensibilitÃ </a></li>
  </ul>
</li>
  <li><a href="#priori-coniugate" id="toc-priori-coniugate" class="nav-link" data-scroll-target="#priori-coniugate"><span class="header-section-number">46.7</span> Priori coniugate</a></li>
  <li>
<a href="#simulazioni" id="toc-simulazioni" class="nav-link" data-scroll-target="#simulazioni"><span class="header-section-number">46.8</span> Simulazioni</a>
  <ul class="collapse">
<li><a href="#verosimiglianza-binomiale-con-distribuzioni-a-priori-arbitrari" id="toc-verosimiglianza-binomiale-con-distribuzioni-a-priori-arbitrari" class="nav-link" data-scroll-target="#verosimiglianza-binomiale-con-distribuzioni-a-priori-arbitrari"><span class="header-section-number">46.8.1</span> Verosimiglianza Binomiale con Distribuzioni a Priori Arbitrari</a></li>
  <li><a href="#esempio-1-priore-uniforme" id="toc-esempio-1-priore-uniforme" class="nav-link" data-scroll-target="#esempio-1-priore-uniforme"><span class="header-section-number">46.8.2</span> Esempio 1: Priore Uniforme</a></li>
  <li><a href="#esempio-2-priore-a-gradino" id="toc-esempio-2-priore-a-gradino" class="nav-link" data-scroll-target="#esempio-2-priore-a-gradino"><span class="header-section-number">46.8.3</span> Esempio 2: Priore a Gradino</a></li>
  <li><a href="#esempio-3-priore-esponenziale" id="toc-esempio-3-priore-esponenziale" class="nav-link" data-scroll-target="#esempio-3-priore-esponenziale"><span class="header-section-number">46.8.4</span> Esempio 3: Priore Esponenziale</a></li>
  <li><a href="#analisi-del-modello-beta-binomiale" id="toc-analisi-del-modello-beta-binomiale" class="nav-link" data-scroll-target="#analisi-del-modello-beta-binomiale"><span class="header-section-number">46.8.5</span> Analisi del Modello Beta-Binomiale</a></li>
  </ul>
</li>
  <li><a href="#connessione-tra-intuizioni-e-teoria" id="toc-connessione-tra-intuizioni-e-teoria" class="nav-link" data-scroll-target="#connessione-tra-intuizioni-e-teoria"><span class="header-section-number">46.9</span> Connessione tra Intuizioni e Teoria</a></li>
  <li><a href="#conflitto-tra-prior-e-verosimiglianza" id="toc-conflitto-tra-prior-e-verosimiglianza" class="nav-link" data-scroll-target="#conflitto-tra-prior-e-verosimiglianza"><span class="header-section-number">46.10</span> Conflitto tra Prior e Verosimiglianza</a></li>
  <li>
<a href="#riflessioni-conclusive" id="toc-riflessioni-conclusive" class="nav-link" data-scroll-target="#riflessioni-conclusive"><span class="header-section-number">46.11</span> Riflessioni Conclusive</a>
  <ul class="collapse">
<li><a href="#il-ruolo-della-prior-nella-regolarizzazione" id="toc-il-ruolo-della-prior-nella-regolarizzazione" class="nav-link" data-scroll-target="#il-ruolo-della-prior-nella-regolarizzazione"><span class="header-section-number">46.11.1</span> Il Ruolo della Prior nella Regolarizzazione</a></li>
  <li><a href="#limportanza-dei-prior-informativi" id="toc-limportanza-dei-prior-informativi" class="nav-link" data-scroll-target="#limportanza-dei-prior-informativi"><span class="header-section-number">46.11.2</span> Lâ€™Importanza dei Prior Informativi</a></li>
  <li><a href="#conclusioni-finali" id="toc-conclusioni-finali" class="nav-link" data-scroll-target="#conclusioni-finali"><span class="header-section-number">46.11.3</span> Conclusioni Finali</a></li>
  </ul>
</li>
  <li><a href="#informazioni-sullambiente-di-sviluppo" id="toc-informazioni-sullambiente-di-sviluppo" class="nav-link" data-scroll-target="#informazioni-sullambiente-di-sviluppo">Informazioni sullâ€™Ambiente di Sviluppo</a></li>
  <li><a href="#bibliografia" id="toc-bibliografia" class="nav-link" data-scroll-target="#bibliografia">Bibliografia</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/bayesian_inference/08_balance_prior_post.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/bayesian_inference/introduction_bayes_inference.html">Inferenza</a></li><li class="breadcrumb-item"><a href="../../chapters/bayesian_inference/08_balance_prior_post.html"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Lâ€™influenza della distribuzione a priori</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-bayes-inference-prior" class="quarto-section-identifier"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Lâ€™influenza della distribuzione a priori</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In questo capitolo imparerai a:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Comprendere il ruolo e lâ€™importanza dei prior nei modelli bayesiani:
<ul>
<li>
<strong>Prior non informativi</strong>, <strong>debolmente informativi</strong> e <strong>informativi</strong>.<br>
</li>
</ul>
</li>
<li>Approfondire il concetto di <strong>prior di Jeffreys</strong> e il loro utilizzo.<br>
</li>
<li>Analizzare come i prior si comportano in relazione ai <strong>cambiamenti di scala</strong> delle variabili.<br>
</li>
<li>Comprendere lâ€™uso dei <strong>prior coniugati</strong> e i vantaggi associati alla loro applicazione.<br>
</li>
<li>Eseguire unâ€™<strong>analisi di sensibilitÃ </strong> per valutare lâ€™impatto delle scelte sui prior nei risultati finali.<br>
</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Leggere il capitolo <em>Balance and Sequentiality in Bayesian Analyses</em> di <em>Bayes rules!</em> <span class="citation" data-cites="Johnson2022bayesrules">(<a href="#ref-Johnson2022bayesrules" role="doc-biblioref">Johnson et al., 2022</a>)</span>.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">mice</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="introduzione" class="level2" data-number="46.1"><h2 data-number="46.1" class="anchored" data-anchor-id="introduzione">
<span class="header-section-number">46.1</span> Introduzione</h2>
<p>Consideriamo un semplice scenario medico: un paziente si presenta dal dottore con un mal di testa. Il medico, per formulare una diagnosi accurata, dovrÃ  considerare diversi fattori. Possiamo immaginare due medici con approcci leggermente differenti:</p>
<ul>
<li>
<strong>Medico 1:</strong> Si basa principalmente sui risultati di test specifici, senza considerare una storia clinica pregressa del paziente.</li>
<li>
<strong>Medico 2:</strong> Oltre ai test, tiene conto della storia clinica del paziente, cercando di individuare eventuali fattori di rischio o condizioni preesistenti che potrebbero essere correlate al mal di testa.</li>
</ul>
<p>Quale dei due medici Ã¨ in grado di fornire una diagnosi piÃ¹ precisa? La risposta risiede nel concetto di <em>probabilitÃ  a priori</em> (o semplicemente <em>prior</em>), ovvero le credenze che un individuo ha su un evento prima di osservare nuovi dati.</p>
<p>Nel contesto medico, la storia clinica del paziente rappresenta una preziosa fonte di informazioni a priori. Conoscere gli antecedenti sanitari di un individuo permette al medico di formulare ipotesi piÃ¹ plausibili sulla causa del mal di testa. In termini bayesiani, i priori agiscono come una sorta di â€œlenteâ€ attraverso cui vengono interpretati i nuovi dati (in questo caso, i risultati dei test).</p>
<p>Quando prendiamo decisioni nella vita quotidiana, utilizziamo costantemente le nostre conoscenze pregresse per interpretare nuove informazioni. Ad esempio, se vediamo una persona che indossa un camice bianco in un ospedale, inferiamo che si tratti di un medico, basandoci sulla nostra esperienza e sulle associazioni mentali che abbiamo costruito nel tempo. Questo processo di inferenza Ã¨ molto simile a quello che avviene nellâ€™aggiornamento bayesiano.</p>
<p>La scelta dei priori ha un impatto fondamentale sulla qualitÃ  delle inferenze che possiamo trarre dai dati. Questo capitolo si focalizza sullâ€™importanza e sulle implicazioni che derivano dalla scelta dei priori sul processo di aggiornamento bayesiano. Per illustrare questi concetti, esamineremo alcuni esempi discussi da <span class="citation" data-cites="Johnson2022bayesrules">Johnson et al. (<a href="#ref-Johnson2022bayesrules" role="doc-biblioref">2022</a>)</span>.</p>
</section><section id="la-distribuzione-a-priori" class="level2" data-number="46.2"><h2 data-number="46.2" class="anchored" data-anchor-id="la-distribuzione-a-priori">
<span class="header-section-number">46.2</span> La Distribuzione a Priori</h2>
<p>La distribuzione a priori gioca un ruolo centrale nellâ€™approccio bayesiano, poichÃ© rappresenta le nostre conoscenze pregresse o le ipotesi sui parametri del modello prima di osservare i dati. Questo concetto Ã¨ fondamentale perchÃ© permette di integrare le informazioni disponibili in precedenza con i dati osservati, fornendo cosÃ¬ una stima piÃ¹ precisa e robusta dei parametri. Le distribuzioni a priori possono variare a seconda del grado di certezza che si attribuisce ai valori dei parametri.</p>
</section><section id="tipologie-di-distribuzioni-a-priori" class="level2" data-number="46.3"><h2 data-number="46.3" class="anchored" data-anchor-id="tipologie-di-distribuzioni-a-priori">
<span class="header-section-number">46.3</span> Tipologie di Distribuzioni a Priori</h2>
<p>La scelta della distribuzione a priori (nota come <em>elicitazione della prior</em>) Ã¨ uno dei passaggi cruciali nellâ€™analisi bayesiana ed Ã¨ spesso vista come la fase piÃ¹ controversa, poichÃ© Ã¨ considerata â€œsoggettivaâ€. Tuttavia, Ã¨ importante sottolineare che la scelta della prior non Ã¨ necessariamente soggettiva. A differenza dellâ€™approccio frequentista, lâ€™approccio bayesiano incoraggia la raccolta e lâ€™integrazione di tutte le informazioni conosciute sul parametro in anticipo. Questo puÃ² essere fatto in modo <em>oggettivo</em>, basandosi su evidenze pregresse o raccomandazioni consolidate.</p>
<p>Esistono tre principali categorie di distribuzioni a priori.</p>
<ol type="1">
<li><p><strong>Distribuzioni a Priori Non Informative.</strong> Le distribuzioni a priori non informative sono caratterizzate da una totale mancanza di conoscenza pregressa e assegnano la stessa credibilitÃ  a tutti i valori dei parametri. Un esempio comune di distribuzione a priori non informativa Ã¨ la distribuzione uniforme, basata sul â€œPrincipio della Ragione Insufficienteâ€ formulato da Laplace. Secondo questo principio, in assenza di evidenze rilevanti pregresse, tutte le possibili configurazioni dei parametri sono considerate equiprobabili.</p></li>
<li>
<p><strong>Distribuzioni a Priori Debolmente Informative.</strong> Le distribuzioni a priori debolmente informative consentendo di integrare una quantitÃ  limitata di informazioni pregresse nei modelli statistici. Queste distribuzioni sono progettate per riflettere le nostre assunzioni su quali possono essere i valori â€œragionevoliâ€ dei parametri del modello, tenendo conto delle incertezze presenti nellâ€™analisi. Lâ€™uso di informazioni a priori debolmente informative puÃ² contribuire a migliorare la stabilitÃ  dellâ€™analisi senza influenzare in modo significativo le conclusioni derivate da essa.</p>
<p>Le distribuzioni a priori debolmente informative hanno la caratteristica di non â€œspostareâ€ in modo significativo la distribuzione a posteriori in una direzione specifica. In altre parole, sono centrate su valori â€œneutriâ€ dei parametri. Ad esempio, quando si trattano parametri che possono assumere valori positivi o negativi, la distribuzione a priori debolmente informativa potrebbe essere centrata sullo zero. Nel caso di parametri che rappresentano proporzioni, essa potrebbe essere centrata su 0.5.</p>
<p>Tuttavia, ciÃ² che rende queste distribuzioni debolmente informative Ã¨ la specifica definizione di un intervallo â€œplausibileâ€ di valori dei parametri. Questo intervallo indica quali valori dei parametri sono considerati plausibili e quali sono invece considerati implausibili. Ad esempio, una distribuzione a priori debolmente informativa potrebbe suggerire che valori estremamente grandi o estremamente bassi dei parametri sono poco plausibili, concentrandosi su un intervallo piÃ¹ stretto di valori considerati ragionevoli.</p>
<p>In sintesi, le distribuzioni a priori debolmente informative sono utilizzate per incorporare informazioni pregresse limitate nei modelli bayesiani, contribuendo a stabilizzare le stime dei parametri senza influenzare in modo significativo le conclusioni derivate dai dati. Queste distribuzioni definiscono un intervallo plausibile di valori dei parametri, aiutando a guidare lâ€™analisi verso soluzioni piÃ¹ verosimili senza imporre vincoli eccessivi sui risultati.</p>
</li>
<li>
<p><strong>Distribuzioni a Priori Informativa.</strong> Le conoscenze pregresse, acquisite attraverso ricerche precedenti, pareri esperti o una combinazione di entrambi, possono essere meticolosamente integrate nel processo di analisi mediante lâ€™incorporazione nelle distribuzioni a priori. Queste distribuzioni sono comunemente conosciute come distribuzioni a priori informative. Esse rappresentano un mezzo per codificare in modo sistematico informazioni concrete e rilevanti che possono avere un notevole impatto sullâ€™analisi statistica, fornendo una solida base di conoscenza su cui fondare lâ€™inferenza bayesiana.</p>
<p>Le distribuzioni a priori informative possono derivare da una vasta gamma di fonti, comprese ricerche pregresse, pareri di esperti nel campo e altre fonti affidabili. Questo approccio offre un metodo strutturato per integrare in modo coerente le conoscenze pregresse nel processo di analisi statistica. Lâ€™incorporazione di queste informazioni aggiuntive contribuisce notevolmente a migliorare la robustezza e lâ€™accuratezza delle conclusioni derivate dai dati, fornendo una solida base empirica su cui basare le stime dei parametri del modello e le decisioni basate sullâ€™analisi bayesiana.</p>
<p>Nellâ€™ambito della ricerca psicologica, lâ€™utilizzo di distribuzioni a priori informative Ã¨ attualmente poco diffuso, tuttavia emergono segnali che allâ€™interno della comunitÃ  statistica sta crescendo lâ€™interesse per questa pratica, considerandola come un avanzamento promettente nel campo della data science.</p>
</li>
</ol></section><section id="limportanza-della-prior-in-base-ai-dati" class="level2" data-number="46.4"><h2 data-number="46.4" class="anchored" data-anchor-id="limportanza-della-prior-in-base-ai-dati">
<span class="header-section-number">46.4</span> Lâ€™importanza della Prior in base ai Dati</h2>
<p>Un aspetto cruciale da considerare Ã¨ che lâ€™influenza della prior diminuisce allâ€™aumentare del numero di dati osservati. In altre parole, <em>con un numero infinito di dati</em>, la verosimiglianza diventa estremamente precisa (o â€œaffilataâ€), rendendo la scelta della prior irrilevante, a patto che la prior non assegni probabilitÃ  zero a regioni dello spazio parametri dove la verosimiglianza Ã¨ positiva.</p>
<p>Tuttavia, la prior assume unâ€™importanza fondamentale quando si lavora con <em>dataset di piccole dimensioni</em>. In questi casi, la distribuzione a priori puÃ² avere unâ€™influenza significativa sulle stime, poichÃ© i dati da soli non sono sufficienti per ottenere stime precise.</p>
</section><section id="effetti-del-cambiamento-di-scala-dei-parametri" class="level2" data-number="46.5"><h2 data-number="46.5" class="anchored" data-anchor-id="effetti-del-cambiamento-di-scala-dei-parametri">
<span class="header-section-number">46.5</span> Effetti del Cambiamento di Scala dei Parametri</h2>
<p>Un altro aspetto da tenere a mente Ã¨ che le priors possono cambiare quando si modificano le scale dei parametri. Se un parametro viene riscalato, ad esempio passando da metri a chilometri, anche la prior deve essere riscalata di conseguenza per mantenere la coerenza dellâ€™inferenza.</p>
<section id="scala-e-invariabilitÃ -della-scelta-delle-distribuzioni-a-priori" class="level3" data-number="46.5.1"><h3 data-number="46.5.1" class="anchored" data-anchor-id="scala-e-invariabilitÃ -della-scelta-delle-distribuzioni-a-priori">
<span class="header-section-number">46.5.1</span> Scala e invariabilitÃ  della scelta delle distribuzioni a priori</h3>
<p>La scelta delle distribuzioni a priori non informative non Ã¨ sempre banale e non puÃ² sempre essere rappresentata da una prior piatta. Per capire questo concetto, Ã¨ fondamentale comprendere il ruolo della <em>scala</em>. Vediamo un esempio per chiarire meglio questo aspetto.</p>
<p>Immaginiamo di avere un dataset che contiene la media dei diametri di alcuni alberi, e vogliamo stimare la media di questi diametri utilizzando un metodo bayesiano. Prima di osservare i dati, dobbiamo specificare la nostra distribuzione a priori, poichÃ© non vogliamo che i dati influenzino la nostra scelta. Supponiamo di scegliere una distribuzione a priori piatta tra 1 cm e 10 cm, per evitare di introdurre bias:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Creazione di un vettore da 1 a 5</span></span>
<span><span class="va">valori</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span><span class="co"># Creazione di un vettore di 5 elementi, tutti uguali a 1/5</span></span>
<span><span class="va">pesoPrior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># Mostra i risultati</span></span>
<span><span class="va">pesoPrior</span></span>
<span><span class="co">#&gt; [1] 0.2 0.2 0.2 0.2 0.2</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In questo caso, stiamo assegnando la stessa probabilitÃ  a ciascun diametro compreso tra 1 e 10 cm, senza dare piÃ¹ peso a un valore rispetto a un altro. Questa sembra una scelta ragionevole e â€œnon informativaâ€, poichÃ© non stiamo preferendo nessun diametro in particolare.</p>
<p>Ora, supponiamo di voler modificare leggermente la nostra analisi e di misurare la grandezza degli alberi in termini di <em>area basale</em> (cioÃ¨ la sezione trasversale dellâ€™albero alla base), che Ã¨ proporzionale al quadrato del diametro (cioÃ¨ <span class="math inline">\(x^2\)</span>). PoichÃ© abbiamo giÃ  specificato la nostra distribuzione a priori in termini di diametro, dovremmo trasformare questa distribuzione in modo coerente con la nuova scala (area basale).</p>
<p>Il problema che emerge Ã¨ il seguente: quando riscaliamo lâ€™asse <span class="math inline">\(x\)</span> per riflettere lâ€™area basale (cioÃ¨, passiamo da cm a cm<span class="math inline">\(^2\)</span>), i valori piÃ¹ grandi diventano piÃ¹ ampi (poichÃ© lâ€™area cresce con il quadrato del diametro), mentre i valori piÃ¹ piccoli diventano piÃ¹ stretti. Se vogliamo mantenere la stessa distribuzione a priori in termini di probabilitÃ , dobbiamo modificare il peso di ciascun valore.</p>
<p>Di conseguenza, una distribuzione a priori che inizialmente era piatta (uguale per tutti i valori di diametro) non rimane piatta dopo la trasformazione in area basale. I valori piÃ¹ grandi ora hanno un peso minore, mentre i valori piÃ¹ piccoli hanno un peso maggiore. Questo dimostra che <em>una distribuzione a priori non puÃ² essere piatta per tutte le possibili trasformazioni dei parametri</em>.</p>
</section><section id="il-concetto-di-invariabilitÃ -della-scala" class="level3" data-number="46.5.2"><h3 data-number="46.5.2" class="anchored" data-anchor-id="il-concetto-di-invariabilitÃ -della-scala">
<span class="header-section-number">46.5.2</span> Il concetto di invariabilitÃ  della scala</h3>
<p>Una delle chiavi per definire correttamente le distribuzioni a priori non informative Ã¨ lâ€™invariabilitÃ  rispetto alle trasformazioni dei parametri. Se possiamo scegliere liberamente come rappresentare i parametri (ad esempio, in termini di diametro o area basale), la nostra distribuzione a priori dovrebbe essere definita in modo che sia coerente indipendentemente dalla scala scelta.</p>
</section><section id="attenzione-alle-trasformazioni-dei-parametri" class="level3" data-number="46.5.3"><h3 data-number="46.5.3" class="anchored" data-anchor-id="attenzione-alle-trasformazioni-dei-parametri">
<span class="header-section-number">46.5.3</span> Attenzione alle trasformazioni dei parametri</h3>
<p>Un secondo messaggio importante riguarda la <em>cautela nelle trasformazioni dei parametri</em> nellâ€™analisi bayesiana. Quando cambiamo i parametri del nostro modello, non stiamo semplicemente osservando un singolo valore, ma una distribuzione intera. La forma di questa distribuzione puÃ² cambiare notevolmente con la trasformazione dei parametri.</p>
<p>Ad esempio, se si sta conducendo uno studio psicologico e si vuole misurare un parametro legato alla gravitÃ  di un disturbo (ad esempio, la gravitÃ  della depressione su una scala numerica), e poi si decide di trasformare la scala in unâ€™unitÃ  diversa (ad esempio, un punteggio quadratico per evidenziare differenze estreme), la distribuzione a priori che sembrava ragionevole prima della trasformazione potrebbe non esserlo piÃ¹ dopo. Questo significa che bisogna prestare attenzione a come si scelgono le priors e come queste si comportano sotto diverse rappresentazioni del problema.</p>
<p>In conclusione, la scelta delle distribuzioni a priori non puÃ² essere fatta superficialmente. Deve essere considerata con attenzione, tenendo conto delle possibili trasformazioni dei parametri e assicurandosi che le priors siano coerenti rispetto alla scala scelta. Questo rende evidente che le priors non informative non sono sempre piatte, e la loro scelta deve tenere conto della struttura del problema e delle variabili coinvolte.</p>
</section></section><section id="scelte-predefinite-per-le-distribuzioni-a-priori-non-informative" class="level2" data-number="46.6"><h2 data-number="46.6" class="anchored" data-anchor-id="scelte-predefinite-per-le-distribuzioni-a-priori-non-informative">
<span class="header-section-number">46.6</span> Scelte predefinite per le distribuzioni a priori non informative</h2>
<p>Una delle domande piÃ¹ ricorrenti nellâ€™inferenza bayesiana riguarda la scelta delle <em>distribuzioni a priori non informative</em>. La risposta, perÃ², Ã¨ piuttosto complessa: non esiste una soluzione generalmente accettata. Questo Ã¨ particolarmente importante perchÃ©, mentre le priors informative possono essere basate su conoscenze pregresse, una prior non informativa deve essere scelta con cura per evitare di influenzare eccessivamente i risultati.</p>
<p>Una delle proposte piÃ¹ famose, che soddisfa molte delle proprietÃ  desiderabili, Ã¨ la <em>prior di Jeffreys</em>, definita come:</p>
<p><span class="math display">\[
p(\phi) \propto \sqrt{ \det (F(\phi)) },
\]</span></p>
<p>dove <span class="math inline">\(F(\phi)\)</span> Ã¨ la <em>matrice di informazione di Fisher</em>, che misura quanto la verosimiglianza cambia quando variano i parametri. La prior di Jeffreys ha due caratteristiche fondamentali:</p>
<ol type="1">
<li>
<strong>Invarianza rispetto alla riscalatura dei parametri</strong>: CiÃ² significa che se trasformiamo la scala del parametro, la prior si adatta automaticamente, rimanendo coerente con il problema.</li>
<li>
<strong>ProporzionalitÃ  allâ€™influenza dei parametri sulla verosimiglianza</strong>: Parametri che influenzano maggiormente la verosimiglianza hanno una prior piÃ¹ informativa.</li>
</ol>
<p>Questi aspetti sembrano coprire molti dei criteri comunemente accettati per la scelta delle distribuzioni a priori non informative. Tuttavia, la prior di Jeffreys presenta alcuni problemi nei modelli multivariati e gerarchici, il che limita la sua applicabilitÃ  come soluzione universale.</p>
<section id="scelte-predefinite-comuni-per-le-priors-non-informative" class="level3" data-number="46.6.1"><h3 data-number="46.6.1" class="anchored" data-anchor-id="scelte-predefinite-comuni-per-le-priors-non-informative">
<span class="header-section-number">46.6.1</span> Scelte predefinite comuni per le priors non informative</h3>
<p>Nonostante le difficoltÃ  legate alla prior di Jeffreys, sono emerse alcune scelte predefinite comuni per le priors non informative, basate su intuizioni derivanti proprio da questa distribuzione. Di seguito sono elencate alcune di queste scelte:</p>
<ol type="1">
<li>
<strong>Parametri di scala (es. coefficiente angolare o intercetta in una regressione)</strong>:
<ul>
<li>Per i parametri di scala, che influenzano lâ€™output in modo lineare, si utilizzano comunemente priors piatte o quasi piatte. Queste possono essere distribuzioni uniformi con limiti fissati o, piÃ¹ comunemente, una <em>distribuzione normale ampia</em>.</li>
<li>Un esempio di prior modificata Ã¨ lâ€™uso di una normalitÃ  centrata su un valore neutro, come 0, per ottenere lâ€™analogo bayesiano della regressione Lasso o Ridge, che introduce una penalizzazione sui parametri (Park &amp; Casella, 2008; Kyung et al., 2010).
<ul>
<li>Se questa penalizzazione Ã¨ lieve, si parla di <em>priors debolmente regolarizzanti</em>.</li>
<li>Se Ã¨ forte, si parla di <em>priors di riduzione (shrinkage)</em>, che possono essere fisse o adattative:
<ul>
<li>
<strong>Shrinkage fisso</strong>: la forza della riduzione (ad es. controllata dalla deviazione standard nella prior normale) rimane costante.</li>
<li>
<strong>Shrinkage adattativo</strong>: la prior di riduzione si adatta tramite un iperparametro (hyperprior), il che consente al modello di decidere autonomamente la forza della riduzione.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<strong>Parametri di varianza (es. la deviazione standard in una regressione lineare)</strong>:
<ul>
<li>Per i parametri di varianza, si utilizzano spesso priors che <em>decrescono allâ€™aumentare del valore</em>. Un esempio classico Ã¨ la prior di Jeffreyâ€™s, che per la varianza assume la forma <span class="math inline">\(1/x\)</span>, oppure la <em>distribuzione inversa-gamma</em>, molto comune per via della sua proprietÃ  di coniugazione, che semplifica il calcolo bayesiano.</li>
</ul>
</li>
<li>
<strong>Iperparametri di varianza nei modelli gerarchici</strong>:
<ul>
<li>Nei modelli gerarchici, gli iperparametri di varianza vengono trattati con priors decrescenti come lâ€™<em>inversa-gamma</em> o la <em>distribuzione half-t</em> <span class="citation" data-cites="gelman2006prior">(<a href="#ref-gelman2006prior" role="doc-biblioref">Gelman, 2006</a>)</span>. Queste priors sono progettate per gestire la varianza tra gruppi in modo efficace.</li>
</ul>
</li>
<li>
<strong>Distribuzioni binomiali</strong>:
<ul>
<li>Per una distribuzione binomiale, la prior di Jeffreys corrisponde a una distribuzione <em>Beta(1/2, 1/2)</em>, che Ã¨ considerata una buona scelta predefinita non informativa. Questo tipo di prior assegna un peso equo alle possibili probabilitÃ  di successo, riflettendo una distribuzione equilibrata senza favorire un particolare risultato.</li>
</ul>
</li>
</ol></section><section id="attenzione-alle-trasformazioni-dei-parametri-1" class="level3" data-number="46.6.2"><h3 data-number="46.6.2" class="anchored" data-anchor-id="attenzione-alle-trasformazioni-dei-parametri-1">
<span class="header-section-number">46.6.2</span> Attenzione alle trasformazioni dei parametri</h3>
<p>Un aspetto importante da considerare nellâ€™uso delle priors non informative Ã¨ che la loro forma puÃ² cambiare significativamente in seguito a trasformazioni dei parametri. Per esempio, passando dalla scala lineare alla scala quadratica di un parametro, la prior puÃ² assumere una forma diversa e introdurre involontariamente un bias. Pertanto, Ã¨ essenziale prestare attenzione a come i parametri sono scalati e trasformati nel modello.</p>
</section><section id="analisi-di-sensibilitÃ " class="level3" data-number="46.6.3"><h3 data-number="46.6.3" class="anchored" data-anchor-id="analisi-di-sensibilitÃ ">
<span class="header-section-number">46.6.3</span> Analisi di sensibilitÃ </h3>
<p>Infine, quando si Ã¨ incerti sulla scelta della prior, un buon approccio consiste nel condurre unâ€™<em>analisi di sensibilitÃ </em>. Questa tecnica prevede di variare la prior e osservare come ciÃ² influenzi i risultati. Se i risultati sono robusti rispetto a diverse scelte di prior, ciÃ² suggerisce che la prior scelta non sta influenzando in modo eccessivo lâ€™inferenza finale. Questo Ã¨ particolarmente utile nei casi in cui si dispone di pochi dati, situazione in cui la prior puÃ² avere un impatto maggiore.</p>
</section></section><section id="priori-coniugate" class="level2" data-number="46.7"><h2 data-number="46.7" class="anchored" data-anchor-id="priori-coniugate">
<span class="header-section-number">46.7</span> Priori coniugate</h2>
<p>Una distribuzione a priori Ã¨ detta <em>coniugata</em> rispetto a una funzione di verosimiglianza se la distribuzione a posteriori risultante ha la stessa forma funzionale della distribuzione a priori. In altre parole, la distribuzione a priori e quella a posteriori appartengono alla stessa famiglia di distribuzioni. Questo Ã¨ particolarmente utile perchÃ©, quando si usano <em>priori coniugate</em>, si ottiene una distribuzione a posteriori che puÃ² essere espressa in forma chiusa, rendendo possibile risolverla analiticamente.</p>
<p>Un esempio tipico Ã¨ quello delle funzioni di verosimiglianza appartenenti alla <em>famiglia esponenziale</em>, per le quali esiste sempre una distribuzione a priori coniugata. Questo Ã¨ uno dei motivi per cui le distribuzioni della famiglia esponenziale sono cosÃ¬ rilevanti: in modelli semplici, lâ€™uso di una prior coniugata consente di ottenere una soluzione analitica per la distribuzione a posteriori, noto come <em>modello coniugato-esponenziale</em>.</p>
<p>Tradizionalmente, si preferiva specificare priori coniugate quando possibile, proprio per la semplicitÃ  analitica che garantivano. Tuttavia, lâ€™importanza delle priors coniugate Ã¨ diminuita con lâ€™evoluzione dei metodi di campionamento. Oggi, la maggior parte dei campionatori moderni (come i metodi MCMC) non richiede piÃ¹ la coniugazione per funzionare in modo efficiente, e lâ€™uso di priors non coniugate Ã¨ diventato comune senza compromettere la qualitÃ  delle stime.</p>
</section><section id="simulazioni" class="level2" data-number="46.8"><h2 data-number="46.8" class="anchored" data-anchor-id="simulazioni">
<span class="header-section-number">46.8</span> Simulazioni</h2>
<p>In questa sezione, esploriamo come le distribuzioni a priori influenzano la distribuzione a posteriori attraverso una serie di simulazioni. La formula di Bayes, <span class="math inline">\(p(\theta \mid y) \propto p(\theta) \times p(y \mid \theta)\)</span>, evidenzia come la distribuzione a posteriori sia il risultato della combinazione tra la distribuzione a priori e la funzione di verosimiglianza basata sui dati osservati. Se abbiamo le valutazioni puntuali della verosimiglianza e della distribuzione a priori, possiamo moltiplicarle punto per punto per ottenere la distribuzione a posteriori.</p>
<section id="verosimiglianza-binomiale-con-distribuzioni-a-priori-arbitrari" class="level3" data-number="46.8.1"><h3 data-number="46.8.1" class="anchored" data-anchor-id="verosimiglianza-binomiale-con-distribuzioni-a-priori-arbitrari">
<span class="header-section-number">46.8.1</span> Verosimiglianza Binomiale con Distribuzioni a Priori Arbitrari</h3>
<p>Consideriamo un caso in cui la verosimiglianza Ã¨ binomiale, ma utilizziamo distribuzioni a priori non coniugate. Supponiamo che i dati consistano in 6 successi su 9 prove di tipo bernoulliano. Confronteremo lâ€™effetto di tre distribuzioni a priori diverse sulla distribuzione a posteriori e analizzeremo come ciascuna influisce sullâ€™inferenza finale.</p>
<section id="creazione-della-griglia-e-calcolo-della-verosimiglianza" class="level4" data-number="46.8.1.1"><h4 data-number="46.8.1.1" class="anchored" data-anchor-id="creazione-della-griglia-e-calcolo-della-verosimiglianza">
<span class="header-section-number">46.8.1.1</span> Creazione della Griglia e Calcolo della Verosimiglianza</h4>
<p>Iniziamo definendo una griglia di valori per <span class="math inline">\(\theta\)</span> e calcolando la verosimiglianza a ciascun punto della griglia.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Dati</span></span>
<span><span class="va">success</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">tosses</span> <span class="op">&lt;-</span> <span class="fl">9</span></span>
<span></span>
<span><span class="co"># Griglia di valori per theta</span></span>
<span><span class="va">grid_points</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">p_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">grid_points</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verosimiglianza binomiale</span></span>
<span><span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">success</span>, <span class="va">tosses</span>, <span class="va">p_grid</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="funzione-per-calcolare-e-visualizzare-la-posteriori" class="level4" data-number="46.8.1.2"><h4 data-number="46.8.1.2" class="anchored" data-anchor-id="funzione-per-calcolare-e-visualizzare-la-posteriori">
<span class="header-section-number">46.8.1.2</span> Funzione per Calcolare e Visualizzare la Posteriori</h4>
<p>Definiamo una funzione che calcola la distribuzione a posteriori in base alla verosimiglianza e al priore fornito. La funzione visualizza anche il priore, la verosimiglianza e la distribuzione a posteriori.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">computePosterior</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">likelihood</span>, <span class="va">prior</span>, <span class="va">p_grid</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Calcolo della distribuzione a posteriori non normalizzata</span></span>
<span>  <span class="va">unstd_posterior</span> <span class="op">&lt;-</span> <span class="va">likelihood</span> <span class="op">*</span> <span class="va">prior</span></span>
<span>  </span>
<span>  <span class="co"># Normalizzazione</span></span>
<span>  <span class="va">posterior</span> <span class="op">&lt;-</span> <span class="va">unstd_posterior</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">unstd_posterior</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Creazione del dataframe per il plotting</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>    theta <span class="op">=</span> <span class="va">p_grid</span>,</span>
<span>    Prior <span class="op">=</span> <span class="va">prior</span>,</span>
<span>    Likelihood <span class="op">=</span> <span class="va">likelihood</span>,</span>
<span>    Posterior <span class="op">=</span> <span class="va">posterior</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Prior</span>, <span class="va">Likelihood</span>, <span class="va">Posterior</span><span class="op">)</span>, </span>
<span>                 names_to <span class="op">=</span> <span class="st">"distribution"</span>, </span>
<span>                 values_to <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Grafico con ggplot2</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta</span>, y <span class="op">=</span> <span class="va">density</span>, color <span class="op">=</span> <span class="va">distribution</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_manual</span><span class="op">(</span></span>
<span>      values <span class="op">=</span> <span class="fu">MetBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MetBrewer/man/met.brewer.html">met.brewer</a></span><span class="op">(</span><span class="st">"Hiroshige"</span>, <span class="fl">10</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, </span>
<span>      <span class="co"># Usa i primi 3 colori della palette</span></span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Prior"</span>, <span class="st">"Likelihood"</span>, <span class="st">"Posterior"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">distribution</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="st">"Distribuzioni: Prior, Likelihood, e Posterior"</span>,</span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"DensitÃ "</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>      plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>      legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>      strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Restituzione della distribuzione a posteriori</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="esempio-1-priore-uniforme" class="level3" data-number="46.8.2"><h3 data-number="46.8.2" class="anchored" data-anchor-id="esempio-1-priore-uniforme">
<span class="header-section-number">46.8.2</span> Esempio 1: Priore Uniforme</h3>
<p>Il nostro primo priore Ã¨ una distribuzione uniforme: <span class="math inline">\(p(\theta) = 1\)</span>. Questo riflette una completa mancanza di informazioni a priori sulla probabilitÃ  di successo <span class="math inline">\(\theta\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Priore uniforme</span></span>
<span><span class="va">prior1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">grid_points</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo e visualizzazione della distribuzione a posteriori</span></span>
<span><span class="va">posterior1</span> <span class="op">&lt;-</span> <span class="fu">computePosterior</span><span class="op">(</span><span class="va">likelihood</span>, <span class="va">prior1</span>, <span class="va">p_grid</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="08_balance_prior_post_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Come previsto, la distribuzione a posteriori coincide con la verosimiglianza (a parte un fattore di scala), poichÃ© non abbiamo aggiunto informazioni.</p>
</section><section id="esempio-2-priore-a-gradino" class="level3" data-number="46.8.3"><h3 data-number="46.8.3" class="anchored" data-anchor-id="esempio-2-priore-a-gradino">
<span class="header-section-number">46.8.3</span> Esempio 2: Priore a Gradino</h3>
<p>Il secondo priore Ã¨ una funzione a gradino che riflette la convinzione che <span class="math inline">\(\theta\)</span> sia almeno <span class="math inline">\(0.5\)</span>. Questo priore esprime la credenza che il successo (â€œtestaâ€) sia piÃ¹ probabile, ma non specifica di quanto.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Priore a gradino</span></span>
<span><span class="va">prior2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p_grid</span> <span class="op">&gt;=</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo e visualizzazione della distribuzione a posteriori</span></span>
<span><span class="va">posterior2</span> <span class="op">&lt;-</span> <span class="fu">computePosterior</span><span class="op">(</span><span class="va">likelihood</span>, <span class="va">prior2</span>, <span class="va">p_grid</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="08_balance_prior_post_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>La distribuzione a posteriori risultante esclude completamente i valori di <span class="math inline">\(\theta\)</span> inferiori a 0.5, coerentemente con le ipotesi del priore.</p>
</section><section id="esempio-3-priore-esponenziale" class="level3" data-number="46.8.4"><h3 data-number="46.8.4" class="anchored" data-anchor-id="esempio-3-priore-esponenziale">
<span class="header-section-number">46.8.4</span> Esempio 3: Priore Esponenziale</h3>
<p>Il terzo priore Ã¨ una distribuzione centrata su 0.5, con un rapido decadimento esponenziale su entrambi i lati. Questo priore riflette la convinzione che <span class="math inline">\(\theta\)</span> sia vicina a 0.5.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Priore esponenziale</span></span>
<span><span class="va">prior3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">p_grid</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo e visualizzazione della distribuzione a posteriori</span></span>
<span><span class="va">posterior3</span> <span class="op">&lt;-</span> <span class="fu">computePosterior</span><span class="op">(</span><span class="va">likelihood</span>, <span class="va">prior3</span>, <span class="va">p_grid</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="08_balance_prior_post_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Questo priore â€œattrareâ€ la distribuzione a posteriori verso 0.5, a meno che i dati non forniscano evidenze contrarie molto forti.</p>
</section><section id="analisi-del-modello-beta-binomiale" class="level3" data-number="46.8.5"><h3 data-number="46.8.5" class="anchored" data-anchor-id="analisi-del-modello-beta-binomiale">
<span class="header-section-number">46.8.5</span> Analisi del Modello Beta-Binomiale</h3>
<p>Consideriamo ora il caso coniugato, in cui il priore Ã¨ una distribuzione Beta e i dati seguono una distribuzione Binomiale.</p>
<p>Definiamo una funzione per visualizzare le distribuzioni del modello Beta-Binomiale: priore, verosimiglianza e posteriore.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_beta_binomial</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">y</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">n</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Griglia di valori per theta</span></span>
<span>  <span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Priore</span></span>
<span>  <span class="va">prior_density</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Verosimiglianza e posterior</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">n</span>, <span class="va">theta</span><span class="op">)</span></span>
<span>    <span class="va">scaled_likelihood</span> <span class="op">&lt;-</span> <span class="va">likelihood</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">likelihood</span><span class="op">)</span></span>
<span>    <span class="va">posterior_alpha</span> <span class="op">&lt;-</span> <span class="va">alpha</span> <span class="op">+</span> <span class="va">y</span></span>
<span>    <span class="va">posterior_beta</span> <span class="op">&lt;-</span> <span class="va">beta</span> <span class="op">+</span> <span class="va">n</span> <span class="op">-</span> <span class="va">y</span></span>
<span>    <span class="va">posterior_density</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">posterior_alpha</span>, <span class="va">posterior_beta</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Creazione del dataframe</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>    theta <span class="op">=</span> <span class="va">theta</span>,</span>
<span>    prior <span class="op">=</span> <span class="va">prior_density</span>,</span>
<span>    likelihood <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="va">scaled_likelihood</span> <span class="kw">else</span> <span class="cn">NA</span>,</span>
<span>    posterior <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="va">posterior_density</span> <span class="kw">else</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prior</span>, <span class="va">likelihood</span>, <span class="va">posterior</span><span class="op">)</span>, </span>
<span>                 names_to <span class="op">=</span> <span class="st">"distribution"</span>, </span>
<span>                 values_to <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Filtra i valori validi</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Grafico con ggplot2</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta</span>, y <span class="op">=</span> <span class="va">density</span>, color <span class="op">=</span> <span class="va">distribution</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_manual</span><span class="op">(</span></span>
<span>      values <span class="op">=</span> <span class="fu">MetBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MetBrewer/man/met.brewer.html">met.brewer</a></span><span class="op">(</span><span class="st">"Hiroshige"</span>, <span class="fl">10</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span>, </span>
<span>      <span class="co"># Usa la palette di MetBrewer</span></span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Prior"</span>, <span class="st">"Likelihood (scaled)"</span>, <span class="st">"Posterior"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="st">"Beta-Binomial Model"</span>,</span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"Distribution"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>      plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, <span class="co"># Centra il titolo</span></span>
<span>      legend.position <span class="op">=</span> <span class="st">"bottom"</span>,            <span class="co"># Posiziona la legenda in basso</span></span>
<span>      legend.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="priore-uniforme" class="level4" data-number="46.8.5.1"><h4 data-number="46.8.5.1" class="anchored" data-anchor-id="priore-uniforme">
<span class="header-section-number">46.8.5.1</span> Priore Uniforme</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_beta_binomial</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span>, beta <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">15</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="08_balance_prior_post_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="priore-informativo-beta2-2" class="level4" data-number="46.8.5.2"><h4 data-number="46.8.5.2" class="anchored" data-anchor-id="priore-informativo-beta2-2">
<span class="header-section-number">46.8.5.2</span> Priore Informativo (Beta(2, 2))</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_beta_binomial</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">15</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="08_balance_prior_post_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="priore-fortemente-informativo-beta2-5" class="level4" data-number="46.8.5.3"><h4 data-number="46.8.5.3" class="anchored" data-anchor-id="priore-fortemente-informativo-beta2-5">
<span class="header-section-number">46.8.5.3</span> Priore Fortemente Informativo (Beta(2, 5))</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_beta_binomial</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="fl">15</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="08_balance_prior_post_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>In conclusione, abbiamo esplorato come i priori influenzano la distribuzione a posteriori in contesti binomiali, dimostrando che lâ€™influenza del priore Ã¨ maggiore nei campioni piccoli e diminuisce con campioni di grandi dimensioni. Lâ€™analisi bayesiana consente unâ€™integrazione flessibile delle conoscenze pregresse con i dati osservati.</p>
</section></section></section><section id="connessione-tra-intuizioni-e-teoria" class="level2" data-number="46.9"><h2 data-number="46.9" class="anchored" data-anchor-id="connessione-tra-intuizioni-e-teoria">
<span class="header-section-number">46.9</span> Connessione tra Intuizioni e Teoria</h2>
<p>Lâ€™equilibrio tra la distribuzione a priori e le evidenze provenienti dai dati, come dimostrato negli esempi precedenti, non solo rispecchia le nostre intuizioni, ma rappresenta anche una necessitÃ  matematica. Questo concetto diventa chiaro esaminando la formula del valore atteso della distribuzione a posteriori nel contesto del caso beta-binomiale, che puÃ² essere riscritta come segue:</p>
<p><span class="math display">\[
\begin{align}
\mathbb{E}_{\text{post}} &amp;[\text{Beta}(\alpha + y, \beta + n - y)] = \frac{\alpha + y}{\alpha + \beta + n} \\
&amp;= \frac{a+b}{a+b+n} \cdot \frac{a}{a+b} + \frac{n}{a+b+n} \cdot \frac{y}{n}.
\end{align}
\]</span></p>
<p>Lâ€™equazione precedente rivela che il valore atteso a posteriori si ottiene come una media ponderata tra il valore atteso a priori <span class="math inline">\(\left( \frac{\alpha}{\alpha+\beta}\right)\)</span> e la proporzione osservata dei successi <span class="math inline">\(\left(\frac{y}{n}\right)\)</span>. I pesi sono dati da <span class="math inline">\(\left( \frac{\alpha+\beta}{\alpha+\beta+n}\right)\)</span> e <span class="math inline">\(\left( \frac{n}{\alpha+\beta+n}\right)\)</span>. Pertanto, quando il numero di osservazioni <span class="math inline">\(n\)</span> Ã¨ significativo rispetto alla somma dei parametri <span class="math inline">\(\alpha + \beta\)</span>, la distribuzione a posteriori sarÃ  principalmente influenzata dai dati osservati e in minor misura dalle credenze a priori. Al contrario, se <span class="math inline">\(n\)</span> Ã¨ piccolo rispetto a <span class="math inline">\(\alpha + \beta\)</span>, i dati avranno un peso inferiore rispetto alle credenze a priori.</p>
<p>Queste considerazioni indicano come scegliere i parametri <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span>: se desideriamo rappresentare una totale ignoranza sul fenomeno, una scelta coerente Ã¨ <span class="math inline">\(\alpha = \beta = 1\)</span> (attribuiamo uguale credibilitÃ  a ogni valore di <span class="math inline">\(\theta\)</span>). Se, invece, possediamo forti credenze a priori, possiamo selezionare <span class="math inline">\(\alpha\)</span> in modo da eguagliare il valore atteso a priori, mentre <span class="math inline">\(\alpha + \beta\)</span> rifletterÃ  lâ€™importanza attribuita allâ€™informazione a priori: maggiore Ã¨ il valore di <span class="math inline">\(\alpha + \beta\)</span>, maggiore sarÃ  il numero di dati necessari per influenzare significativamente la distribuzione a posteriori rispetto a quella a priori. In situazioni in cui <span class="math inline">\(n\)</span> Ã¨ considerevolmente grande, la distribuzione a posteriori avrÃ  un impatto ridotto sulla distribuzione a priori, a meno che non si facciano scelte estreme per i parametri a priori.</p>
</section><section id="conflitto-tra-prior-e-verosimiglianza" class="level2" data-number="46.10"><h2 data-number="46.10" class="anchored" data-anchor-id="conflitto-tra-prior-e-verosimiglianza">
<span class="header-section-number">46.10</span> Conflitto tra Prior e Verosimiglianza</h2>
<p>Esaminiamo ora un altro esempio proposto da McElreath:</p>
<blockquote class="blockquote">
<p>Lesson: Donâ€™t trust intuition, for even simple prior+likelihood scenarios defy it. Four examples below, each producing radically different posteriors. Can you guess what each does?</p>
</blockquote>
<p><img src="../../figures/mcelreath_post_1.png" class="img-fluid" style="width:80.0%"></p>
<p>Nella figura successiva vediamo la risposta alla domanda precedente.</p>
<p><img src="../../figures/mcelreath_post_2.png" class="img-fluid" style="width:80.0%"></p>
<p>McElreath descrive le caratteristiche di quattro diversi modelli in cui si combinano distribuzioni normali (Gaussiane) e Student-t (con 2 gradi di libertÃ ) per il prior e la likelihood. La distribuzione gaussiana ha code molto sottili, mentre quella di Student-t ha code piÃ¹ spesse.</p>
<ol type="1">
<li>
<p><strong>In Alto a Sinistra: Prior Normale, Likelihood Normale</strong></p>
<ul>
<li><code>y ~ Normal(mu,1)</code></li>
<li><code>mu ~ Normal(10,1)</code></li>
</ul>
<p>In questo scenario classico di aggiornamento bayesiano, il posterior risulta essere un compromesso tra il prior e la likelihood. La distribuzione normale, con le sue code sottili, contribuisce a un aggiornamento piÃ¹ â€œprevedibileâ€ e concentrato attorno al valore medio.</p>
</li>
<li>
<p><strong>In Alto a Destra: Prior Student, Likelihood Student (df=2)</strong></p>
<ul>
<li><code>y ~ Student(2,mu,1)</code></li>
<li><code>mu ~ Student(2,10,1)</code></li>
</ul>
<p>In questo caso, entrambe le distribuzioni hanno code piÃ¹ spesse. La presenza di â€œextra massaâ€ nelle code significa che ciascuna distribuzione trova il modo dellâ€™altra piÃ¹ plausibile, portando a una media che non rappresenta il miglior â€œcompromessoâ€. Questo scenario risulta in una maggiore incertezza e un posterior meno definito.</p>
</li>
<li>
<p><strong>In Basso a Sinistra: Prior Student, Likelihood Normale</strong></p>
<ul>
<li><code>y ~ Normal(mu,1)</code></li>
<li><code>mu ~ Student(2,10,1)</code></li>
</ul>
<p>Qui, la likelihood normale, con le sue code sottili, tende a dominare. Essa Ã¨ molto scettica nei confronti del prior con code spesse, ma il prior di Student-t non Ã¨ sorpreso dalla likelihood. Questo porta a un posterior che Ã¨ piÃ¹ influenzato dalla likelihood normale.</p>
</li>
<li>
<p><strong>In Basso a Destra: Prior Normale, Likelihood Student</strong></p>
<ul>
<li><code>y ~ Student(2,mu,1)</code></li>
<li><code>mu ~ Normal(10,1)</code></li>
</ul>
<p>In questo ultimo scenario, Ã¨ il prior normale a dominare. Il ragionamento Ã¨ simile a quello del caso precedente, ma in senso inverso. Il prior normale, con le sue code sottili, impone una maggiore influenza sul posterior, rendendolo meno influenzato dalle code piÃ¹ spesse della likelihood di Student-t.</p>
</li>
</ol>
<p>In sintesi, la combinazione di queste due distribuzioni in diversi modi porta a risultati di aggiornamento bayesiano molto differenti, a seconda di quale tra prior e likelihood abbia le code piÃ¹ spesse e quindi eserciti una maggiore influenza sul posterior.</p>
<p>In conclusione, questo esercizio mostra come, ad eccezione del caso gaussiano, i risultati non sono affatto intuitivi. Pertanto, in contesti come questi, affidarsi esclusivamente alle proprie intuizioni non Ã¨ una scelta consigliabile. Ãˆ invece fondamentale procedere con lâ€™esecuzione dei calcoli.</p>
</section><section id="riflessioni-conclusive" class="level2" data-number="46.11"><h2 data-number="46.11" class="anchored" data-anchor-id="riflessioni-conclusive">
<span class="header-section-number">46.11</span> Riflessioni Conclusive</h2>
<p>La scelta della distribuzione a priori Ã¨ uno degli aspetti piÃ¹ cruciali nellâ€™inferenza bayesiana. Da un lato, le priors non informative possono essere utilizzate per minimizzare lâ€™influenza delle conoscenze pregresse, permettendo ai dati osservati di guidare lâ€™inferenza. Dallâ€™altro, le priors informative sono estremamente utili quando si dispone di informazioni affidabili sui parametri, consentendo una stima piÃ¹ precisa. Ãˆ importante ricordare che, con un gran numero di dati, lâ€™influenza della prior tende a ridursi, mentre nei contesti con pochi dati la scelta della prior puÃ² avere un impatto significativo.</p>
<p>Un aspetto essenziale dellâ€™approccio bayesiano, come evidenziato nellâ€™esempio di Johnson (2022), Ã¨ che il processo di aggiornamento bayesiano riflette il modo in cui le persone ragionano intuitivamente: di fronte a evidenze deboli, le credenze rimangono stabili, mentre nuove informazioni robuste portano a un aggiornamento significativo delle credenze. Questo meccanismo formalizza in modo quantitativo e rigoroso le intuizioni che utilizziamo quotidianamente. Al contrario, lâ€™approccio frequentista ignora le conoscenze pregresse, il che puÃ² portare a cambiamenti nelle inferenze senza tener conto delle credenze giÃ  esistenti.</p>
<p>Tuttavia, come evidenziato dagli esempi di McElreath, la situazione puÃ² essere piÃ¹ complessa nei modelli non coniugati, dove lâ€™intuizione puÃ² fallire nel prevedere correttamente la distribuzione a posteriori. Questo ci ricorda che il contesto e la struttura del modello giocano un ruolo determinante nellâ€™inferenza bayesiana.</p>
<section id="il-ruolo-della-prior-nella-regolarizzazione" class="level3" data-number="46.11.1"><h3 data-number="46.11.1" class="anchored" data-anchor-id="il-ruolo-della-prior-nella-regolarizzazione">
<span class="header-section-number">46.11.1</span> Il Ruolo della Prior nella Regolarizzazione</h3>
<p>Nel contesto bayesiano, le distribuzioni a priori debolmente informative fungono da meccanismo di regolarizzazione, limitando lâ€™influenza delle osservazioni estreme e garantendo inferenze piÃ¹ stabili. Questo approccio Ã¨ ormai ampiamente accettato nella comunitÃ  statistica, poichÃ© permette di ottenere risultati piÃ¹ prudenti senza introdurre un forte bias.</p>
</section><section id="limportanza-dei-prior-informativi" class="level3" data-number="46.11.2"><h3 data-number="46.11.2" class="anchored" data-anchor-id="limportanza-dei-prior-informativi">
<span class="header-section-number">46.11.2</span> Lâ€™Importanza dei Prior Informativi</h3>
<p>Negli ultimi anni, lâ€™uso di priori informativi ha guadagnato maggiore attenzione, soprattutto grazie allâ€™integrazione delle <em>conoscenze esperte</em> nel processo inferenziale. Questa pratica, nota come <font color="orange">elicitazione della conoscenza esperta</font>, richiede un rigoroso approccio metodologico per evitare bias cognitivi e assicurare che le informazioni pregresse siano incorporate in modo accurato. Questo Ã¨ particolarmente rilevante in campi come la psicologia, dove spesso la base teorica Ã¨ incerta, e lâ€™elicitazione esperta puÃ² contribuire a migliorare la soliditÃ  delle analisi bayesiane <span class="citation" data-cites="o2019expert">(<a href="#ref-o2019expert" role="doc-biblioref">Oâ€™Hagan, 2019</a>)</span>.</p>
</section><section id="conclusioni-finali" class="level3" data-number="46.11.3"><h3 data-number="46.11.3" class="anchored" data-anchor-id="conclusioni-finali">
<span class="header-section-number">46.11.3</span> Conclusioni Finali</h3>
<p>In conclusione, <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">la scelta delle prior</a> deve essere ponderata attentamente in base alla disponibilitÃ  di dati e al contesto dellâ€™analisi. Sebbene lâ€™uso di priors non informative possa sembrare una scelta â€œneutraâ€, Ã¨ spesso sub-ottimale. Le priors debolmente informative rappresentano lo standard attuale, poichÃ© favoriscono unâ€™inferenza piÃ¹ robusta grazie alla loro capacitÃ  di regolarizzare lâ€™influenza dei dati. Infine, lâ€™uso di priori informativi, sviluppati attraverso protocolli rigorosi di elicitazione esperta, Ã¨ una frontiera in crescita nellâ€™analisi bayesiana, poichÃ© consente di sfruttare al meglio le conoscenze pregresse per migliorare la qualitÃ  delle inferenze e ridurre lâ€™incertezza.</p>
<p>Questo approccio, che bilancia conoscenza pregressa e nuovi dati, permette di sviluppare modelli bayesiani piÃ¹ solidi e informati, riflettendo accuratamente sia lâ€™incertezza sia la competenza specifica del dominio di studio.</p>
</section></section><section id="informazioni-sullambiente-di-sviluppo" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="informazioni-sullambiente-di-sviluppo">Informazioni sullâ€™Ambiente di Sviluppo</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.2 (2024-10-31)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] mice_3.17.0      MetBrewer_0.2.0  ggokabeito_0.1.0 see_0.9.0       </span></span>
<span><span class="co">#&gt;  [5] gridExtra_2.3    patchwork_1.3.0  bayesplot_1.11.1 psych_2.4.12    </span></span>
<span><span class="co">#&gt;  [9] scales_1.3.0     markdown_1.13    knitr_1.49       lubridate_1.9.4 </span></span>
<span><span class="co">#&gt; [13] forcats_1.0.0    stringr_1.5.1    dplyr_1.1.4      purrr_1.0.2     </span></span>
<span><span class="co">#&gt; [17] readr_2.1.5      tidyr_1.3.1      tibble_3.2.1     ggplot2_3.5.1   </span></span>
<span><span class="co">#&gt; [21] tidyverse_2.0.0  rio_1.2.3        here_1.0.1      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.6      shape_1.4.6.1     xfun_0.50         htmlwidgets_1.6.4</span></span>
<span><span class="co">#&gt;  [5] lattice_0.22-6    tzdb_0.4.0        Rdpack_2.6.2      vctrs_0.6.5      </span></span>
<span><span class="co">#&gt;  [9] tools_4.4.2       generics_0.1.3    parallel_4.4.2    pan_1.9          </span></span>
<span><span class="co">#&gt; [13] pacman_0.5.1      jomo_2.7-6        pkgconfig_2.0.3   Matrix_1.7-1     </span></span>
<span><span class="co">#&gt; [17] lifecycle_1.0.4   compiler_4.4.2    farver_2.1.2      munsell_0.5.1    </span></span>
<span><span class="co">#&gt; [21] mnormt_2.1.1      codetools_0.2-20  htmltools_0.5.8.1 yaml_2.3.10      </span></span>
<span><span class="co">#&gt; [25] glmnet_4.1-8      nloptr_2.1.1      pillar_1.10.1     MASS_7.3-64      </span></span>
<span><span class="co">#&gt; [29] reformulas_0.4.0  iterators_1.0.14  rpart_4.1.24      boot_1.3-31      </span></span>
<span><span class="co">#&gt; [33] mitml_0.4-5       foreach_1.5.2     nlme_3.1-166      tidyselect_1.2.1 </span></span>
<span><span class="co">#&gt; [37] digest_0.6.37     stringi_1.8.4     labeling_0.4.3    splines_4.4.2    </span></span>
<span><span class="co">#&gt; [41] rprojroot_2.0.4   fastmap_1.2.0     grid_4.4.2        colorspace_2.1-1 </span></span>
<span><span class="co">#&gt; [45] cli_3.6.3         magrittr_2.0.3    survival_3.8-3    broom_1.0.7      </span></span>
<span><span class="co">#&gt; [49] withr_3.0.2       backports_1.5.0   timechange_0.3.0  rmarkdown_2.29   </span></span>
<span><span class="co">#&gt; [53] nnet_7.3-20       lme4_1.1-36       hms_1.1.3         evaluate_1.0.3   </span></span>
<span><span class="co">#&gt; [57] rbibutils_2.3     rlang_1.1.4       Rcpp_1.0.14       glue_1.8.0       </span></span>
<span><span class="co">#&gt; [61] minqa_1.2.8       jsonlite_1.8.9    R6_2.5.1</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bibliografia" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-gelman2006prior" class="csl-entry" role="listitem">
Gelman, A. (2006). Prior distributions for variance parameters in hierarchical models (comment on article by Browne and Draper). <em>Bayesian Analysis</em>, <em>1</em>(3), 515â€“534. <a href="https://doi.org/10.1214/06-BA117A">https://doi.org/10.1214/06-BA117A</a>
</div>
<div id="ref-Johnson2022bayesrules" class="csl-entry" role="listitem">
Johnson, A. A., Ott, M., &amp; Dogucu, M. (2022). <em><span>Bayes Rules! An Introduction to Bayesian Modeling with R</span></em>. CRC Press.
</div>
<div id="ref-o2019expert" class="csl-entry" role="listitem">
Oâ€™Hagan, A. (2019). Expert knowledge elicitation: subjective but scientific. <em>The American Statistician</em>, <em>73</em>(sup1), 69â€“81.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiato!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiato!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/bayesian_inference/07_summary_posterior.html" class="pagination-link" aria-label="Sintesi a posteriori">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/bayesian_inference/09_gamma_poisson_model.html" class="pagination-link" aria-label="Modello coniugato Gamma-Poisson">
        <span class="nav-page-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> Ã¨ una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dellâ€™UniversitÃ  degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/bayesian_inference/08_balance_prior_post.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>