<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Corrado Caudek">

<title>21&nbsp; Causalità dai dati osservazionali</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/eda/10_estimand.html" rel="next">
<link href="../../chapters/eda/08_correlation.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-564ca48ed2ee3c036ea5530783e2cb20.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/eda/introduction_eda.html">EDA</a></li><li class="breadcrumb-item"><a href="../../chapters/eda/09_causality.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Eseguire il codice" class="quarto-navigation-tool px-1" aria-label="Eseguire il codice"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benvenuti</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefazione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Calendario</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../programmazione2024.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programma didattico e dettaglio del corso</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/key_notions/introduction_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fondamenti</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/02_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Concetti chiave</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/03_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Campionamento, metodologia sperimentale e studi osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/04_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/05_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La riforma metodologica in psicologia: dalla crisi alla rivoluzione bayesiana</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/R/introduction_r_lang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/01_r_syntax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Science e R: un approccio moderno all’analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/02_utility_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Utility functions in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/03_r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Programmazione in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/04_r_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pacchetti in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/05_dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduzione a <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/06_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/07_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">L’ambiente di programmazione in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/08_ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Utilizzo di strumenti AI per la programmazione</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/eda/introduction_eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/01_project_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Le fasi del progetto di analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/02_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Flusso di lavoro per la pulizia dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/04_exploring_qualitative_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Esplorare i dati qualitativi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/05_exploring_numeric_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Esplorare i dati numerici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/06_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Principi della visualizzazione dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07_loc_scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Indicatori di tendenza centrale e variabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07a_introduction_normal_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introduzione alla distribuzione normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/08_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Relazioni tra variabili</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/09_causality.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/10_estimand.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Estimandi teorici e estimandi empirici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/11_outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Outlier</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/probability/introduction_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilità</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/01_intro_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Interpretazione della probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/02_probability_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Modelli probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/03_prob_spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Misura di Probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/04_sigma-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Dal Discreto al Continuo: Misurabilità e Assiomi di Kolmogorov</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/05_conditional_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Probabilità condizionata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/06_bayes_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/07_random_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/08_prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Distribuzioni di massa e di densità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/09_expval_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Proprietà delle variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/10_sampling_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11_joint_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Probabilità congiunta</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12_discr_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/13_cont_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/14_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Assunzione di gaussianità e trasformazioni dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/15_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">La verosimiglianza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/16_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Simulazioni</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_intro_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_bayesian_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Pensare ad una proporzione in termini soggettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_grid_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Calcolo della distribuzione a posteriori gaussiana tramite metodo a griglia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_conjugate_families_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_conjugate_families_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (2)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/11_gamma_exponential_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Modello gamma-esponenziale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/12_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata: un approccio frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_prediction_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Predizione e inferenza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Disegno della ricerca e potere statistico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_anova_2vie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">ANOVA ad due vie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/12_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni indipendenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/13_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Frequentismo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/introduction_frequentist_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01_intro_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01a_stime_parametri.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/02_conf_interv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/03_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">La grandezza del campione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/04_test_ipotesi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Significatività statistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/05_two_ind_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Test t di Student per campioni indipendenti</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_piranha.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Il Problema del priming: sfide e paradossi nella psicologia sociale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendici</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Indice</h2>
   
  <ul>
  <li><a href="#introduzione" id="toc-introduzione" class="nav-link active" data-scroll-target="#introduzione"><span class="header-section-number">21.1</span> Introduzione</a></li>
  <li><a href="#cosè-la-causalità" id="toc-cosè-la-causalità" class="nav-link" data-scroll-target="#cosè-la-causalità"><span class="header-section-number">21.2</span> Cos’è la causalità?</a></li>
  <li><a href="#effetto-causale" id="toc-effetto-causale" class="nav-link" data-scroll-target="#effetto-causale"><span class="header-section-number">21.3</span> Effetto Causale</a>
  <ul class="collapse">
  <li><a href="#i-limiti-dellosservazione" id="toc-i-limiti-dellosservazione" class="nav-link" data-scroll-target="#i-limiti-dellosservazione"><span class="header-section-number">21.3.1</span> I Limiti dell’Osservazione</a></li>
  </ul></li>
  <li><a href="#variabili-confondenti" id="toc-variabili-confondenti" class="nav-link" data-scroll-target="#variabili-confondenti"><span class="header-section-number">21.4</span> Variabili Confondenti</a>
  <ul class="collapse">
  <li><a href="#approcci-per-il-controllo-delle-variabili-confondenti" id="toc-approcci-per-il-controllo-delle-variabili-confondenti" class="nav-link" data-scroll-target="#approcci-per-il-controllo-delle-variabili-confondenti"><span class="header-section-number">21.4.1</span> Approcci per il Controllo delle Variabili Confondenti</a></li>
  <li><a href="#inferenza-causale-nei-dati-osservazionali" id="toc-inferenza-causale-nei-dati-osservazionali" class="nav-link" data-scroll-target="#inferenza-causale-nei-dati-osservazionali"><span class="header-section-number">21.4.2</span> Inferenza Causale nei Dati Osservazionali</a></li>
  <li><a href="#strumenti-moderni-per-lanalisi-causale" id="toc-strumenti-moderni-per-lanalisi-causale" class="nav-link" data-scroll-target="#strumenti-moderni-per-lanalisi-causale"><span class="header-section-number">21.4.3</span> Strumenti Moderni per l’Analisi Causale</a></li>
  </ul></li>
  <li><a href="#modelli-causali-strutturali" id="toc-modelli-causali-strutturali" class="nav-link" data-scroll-target="#modelli-causali-strutturali"><span class="header-section-number">21.5</span> Modelli Causali Strutturali</a></li>
  <li><a href="#bias-da-variabile-omessa" id="toc-bias-da-variabile-omessa" class="nav-link" data-scroll-target="#bias-da-variabile-omessa"><span class="header-section-number">21.6</span> Bias da Variabile Omessa</a></li>
  <li><a href="#grafi-aciclici-diretti" id="toc-grafi-aciclici-diretti" class="nav-link" data-scroll-target="#grafi-aciclici-diretti"><span class="header-section-number">21.7</span> Grafi Aciclici Diretti</a>
  <ul class="collapse">
  <li><a href="#la-d-separazione" id="toc-la-d-separazione" class="nav-link" data-scroll-target="#la-d-separazione"><span class="header-section-number">21.7.1</span> La d-separazione</a></li>
  <li><a href="#il-criterio-del-back-door" id="toc-il-criterio-del-back-door" class="nav-link" data-scroll-target="#il-criterio-del-back-door"><span class="header-section-number">21.7.2</span> Il criterio del back-door</a></li>
  <li><a href="#applicazioni" id="toc-applicazioni" class="nav-link" data-scroll-target="#applicazioni"><span class="header-section-number">21.7.3</span> Applicazioni</a></li>
  </ul></li>
  <li><a href="#le-pratiche-scientifiche-per-inferire-la-causalità" id="toc-le-pratiche-scientifiche-per-inferire-la-causalità" class="nav-link" data-scroll-target="#le-pratiche-scientifiche-per-inferire-la-causalità"><span class="header-section-number">21.8</span> Le Pratiche Scientifiche per Inferire la Causalità</a>
  <ul class="collapse">
  <li><a href="#il-framework-interventista-di-judea-pearl" id="toc-il-framework-interventista-di-judea-pearl" class="nav-link" data-scroll-target="#il-framework-interventista-di-judea-pearl"><span class="header-section-number">21.8.1</span> Il Framework Interventista di Judea Pearl</a></li>
  <li><a href="#tre-fonti-di-conoscenza-causale-pragmatica" id="toc-tre-fonti-di-conoscenza-causale-pragmatica" class="nav-link" data-scroll-target="#tre-fonti-di-conoscenza-causale-pragmatica"><span class="header-section-number">21.8.2</span> Tre Fonti di Conoscenza Causale Pragmatica</a></li>
  <li><a href="#conciliare-pragmatismo-con-scetticismo-filosofico" id="toc-conciliare-pragmatismo-con-scetticismo-filosofico" class="nav-link" data-scroll-target="#conciliare-pragmatismo-con-scetticismo-filosofico"><span class="header-section-number">21.8.3</span> Conciliare Pragmatismo con Scetticismo Filosofico</a></li>
  </ul></li>
  <li><a href="#riflessioni-conclusive" id="toc-riflessioni-conclusive" class="nav-link" data-scroll-target="#riflessioni-conclusive"><span class="header-section-number">21.9</span> Riflessioni Conclusive</a></li>
  <li><a href="#esercizi" id="toc-esercizi" class="nav-link" data-scroll-target="#esercizi"><span class="header-section-number">21.10</span> Esercizi</a></li>
  <li><a href="#bibliografia" id="toc-bibliografia" class="nav-link" data-scroll-target="#bibliografia">Bibliografia</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/eda/09_causality.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/eda/introduction_eda.html">EDA</a></li><li class="breadcrumb-item"><a href="../../chapters/eda/09_causality.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-eda-causality" class="quarto-section-identifier"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In questo capitolo imparerai a
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>affrontare il problema della causalità anche in assenza di esperimenti;</li>
<li>riconoscere i quattro confondenti fondamentali (catena, biforcazione, collider, discendente);</li>
<li>valutare con cautela le inferenze dai dati osservazionali, tenendo conto di debolezze e assunzioni.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Leggere <a href="https://xcelab.net/rm/statistical-rethinking/">Statistical Rethinking</a>. Focalizzati sul capitolo 1 <em>The Golem of Prague</em>.</li>
<li>Leggere <em>Causal inference with observational data and unobserved confounding variables</em> di <span class="citation" data-cites="byrnes2024causal">Byrnes &amp; Dee (<a href="#ref-byrnes2024causal" role="doc-biblioref">2024</a>)</span>.</li>
<li>Leggere <em>Causal design patterns for data analysts</em> <span class="citation" data-cites="riedererdesignpatterns">(<a href="#ref-riedererdesignpatterns" role="doc-biblioref">Riederer, 2021</a>)</span>. Questo post sul blog fornisce una panoramica di diversi approcci per fare affermazioni causali dai dati osservazionali.</li>
<li>Leggere <a href="https://theeffectbook.net">The Effect: An Introduction to Research Design and Causality</a>. Focalizzati sul capitolo 10 <em>Treatment Effects</em>.</li>
<li>Leggere <a href="https://mixtape.scunning.com/03-directed_acyclical_graphs">Causal Inference</a> di Scott Cunningham. Focalizzati sul capitolo 3 <em>Directed Acyclic Graphs</em>.</li>
<li>Leggere <em>Telling Stories with Data</em> <span class="citation" data-cites="alexander2023telling">(<a href="#ref-alexander2023telling" role="doc-biblioref">Alexander, 2023</a>)</span>. Concentrati sul capitolo 15 <em>Causality from observational data</em>.</li>
</ul>
</div>
</div>
<section id="introduzione" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="introduzione"><span class="header-section-number">21.1</span> Introduzione</h2>
<p>La pura osservazione dei dati può rivelare correlazioni e pattern nei dati, ma senza un’indagine sulle cause che stanno alla base di tali correlazioni, le conclusioni tratte possono essere fuorvianti o incomplete.</p>
<p>Richard McElreath, nel suo libro “Statistical Rethinking” <span class="citation" data-cites="McElreath_rethinking">(<a href="#ref-McElreath_rethinking" role="doc-biblioref">McElreath, 2020</a>)</span>, utilizza l’analogia dei Golem - creature potenti ma prive di saggezza - per descrivere un approccio metodologico che è stato a lungo predominante in psicologia. Questo approccio si basa esclusivamente sull’analisi delle associazioni statistiche tra variabili, trascurando considerazioni più profonde sulla causalità.</p>
<p>Il metodo in questione si concentra principalmente sul test delle ipotesi nulle, senza stabilire una chiara connessione tra le domande di ricerca riguardanti relazioni causali e i test statistici impiegati. Questa disconnessione è evidente nella figura successiva, tratta da un manuale di analisi dati di impostazione frequentista, che illustra la procedura raccomandata dai sostenitori di questo approccio per descrivere le associazioni tra variabili.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../figures/mcelreath_golem.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption>Esempio di albero decisionale per la selezione di una procedura statistica appropriata. Iniziando dall’alto, l’utente risponde a una serie di domande riguardanti la misurazione e l’intento, arrivando infine al nome di una procedura. Sono possibili molti alberi decisionali simili. (Figura tratta da <span class="citation" data-cites="McElreath_rethinking">McElreath (<a href="#ref-McElreath_rethinking" role="doc-biblioref">2020</a>)</span>).</figcaption>
</figure>
</div>
<p>È importante notare come tale procedura non fornisca strumenti utili per identificare le effettive cause sottostanti ai fenomeni osservati. Questa limitazione metodologica è stata identificata come uno dei fattori principali che hanno contribuito alla crisi di replicabilità nella ricerca psicologica, come approfondito nel <span class="quarto-unresolved-ref">?sec-crisis</span>. L’approccio descritto, pur essendo potente nell’individuare correlazioni, manca della “saggezza” necessaria per distinguere tra semplici associazioni e vere relazioni causali, analogamente ai Golem della metafora di McElreath.</p>
<p>Un problema evidenziato da <span class="citation" data-cites="McElreath_rethinking">McElreath (<a href="#ref-McElreath_rethinking" role="doc-biblioref">2020</a>)</span> è che processi causali completamente distinti possono generare la stessa distribuzione di risultati osservati. Pertanto, un approccio focalizzato esclusivamente sull’analisi delle associazioni mediante il test dell’ipotesi nulla non è in grado di distinguere tra questi diversi scenari, come spiegato nel <span class="quarto-unresolved-ref">?sec-causal-inference-regr</span>.</p>
<p>L’approccio frequentista, che si limita a descrivere le associazioni tra le variabili, ha una scarsa capacità di rilevare le caratteristiche cruciali dei fenomeni studiati e tende a produrre un alto tasso di falsi positivi <span class="citation" data-cites="van2023new">(<a href="#ref-van2023new" role="doc-biblioref">Zwet et al., 2023</a>)</span>. È invece necessario utilizzare una metodologia che non si limiti a confutare ipotesi nulle, ma sia in grado di sviluppare modelli causali che rispondano direttamente alle domande di ricerca. In questo capitolo, ci concentreremo sull’introduzione dei concetti fondamentali dell’analisi causale.</p>
</section>
<section id="cosè-la-causalità" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="cosè-la-causalità"><span class="header-section-number">21.2</span> Cos’è la causalità?</h2>
<p><span class="citation" data-cites="hardt2022patterns">Hardt &amp; Recht (<a href="#ref-hardt2022patterns" role="doc-biblioref">2022</a>)</span> introducono il concetto di causalità distinguendo tra osservazione e azione. Ciò che vediamo nell’osservazione passiva è il modo in cui le persone seguono i loro comportamenti abituali, le loro inclinazioni naturali, proiettando lo stato del mondo su un insieme di caratteristiche che abbiamo scelto di evidenziare. Tuttavia, le domande più importanti spesso non riguardano semplici osservazioni.</p>
<ul>
<li>Non ci basta sapere che le persone che praticano regolarmente attività fisica soffrono meno d’ansia; vogliamo capire se l’attività fisica riduce effettivamente i livelli d’ansia.</li>
<li>Non ci accontentiamo di osservare che chi segue una terapia cognitivo-comportamentale (CBT) presenta meno sintomi depressivi; desideriamo verificare se la CBT riduce realmente questi sintomi.</li>
<li>Non ci limitiamo a constatare che l’uso frequente dei social media è associato a un calo del benessere mentale; vogliamo determinare se l’uso intensivo dei social media causa effettivamente una diminuzione del benessere mentale.</li>
</ul>
<p>Alla base, il ragionamento causale è un quadro concettuale per affrontare domande sugli effetti di azioni o interventi ipotetici. Una volta compreso quale sia l’effetto di un’azione, possiamo invertire la domanda e chiederci quale azione plausibile abbia causato un determinato evento.</p>
</section>
<section id="effetto-causale" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="effetto-causale"><span class="header-section-number">21.3</span> Effetto Causale</h2>
<p>Sebbene non esista una definizione univoca di causalità, possiamo concettualizzarla in modo pratico: diciamo che X causa Y se, intervenendo e modificando il valore di X (il trattamento), la distribuzione di Y cambia di conseguenza. Questa definizione sottolinea l’importanza cruciale dell’azione o dell’intervento nel determinare una relazione causale.</p>
<p>Quando X è una variabile binaria, rappresentante la presenza o l’assenza del trattamento, la conseguenza dell’intervento su X è denominata effetto medio del trattamento. Questo ci indica quanto il trattamento (azione X = 1) aumenta l’aspettativa di Y rispetto all’assenza di trattamento (azione X = 0).</p>
<p>È importante notare che gli effetti causali sono quantità relative alla popolazione. Si riferiscono a effetti mediati sull’intera popolazione in esame. Tuttavia, spesso l’effetto del trattamento può variare notevolmente da un individuo all’altro o tra gruppi di individui. In questi casi, parliamo di effetti di trattamento eterogenei.</p>
<p>Per chiarire questo concetto, consideriamo un esempio concreto: supponiamo che la terapia cognitivo-comportamentale (CBT) riduca l’ansia. Se un gruppo di persone ansiose non riceve alcun trattamento, i loro livelli d’ansia rimarranno presumibilmente invariati. Se invece interveniamo introducendo la CBT (modificando così il valore di X), i livelli d’ansia nel gruppo tenderanno a diminuire (cambiando quindi il valore di Y). Questo esempio illustra la distinzione tra semplice correlazione, basata sull’osservazione passiva, e causalità, che implica un’azione o un intervento.</p>
<p>La definizione di causalità può essere applicata anche per collegare variabili apparentemente distanti. Ad esempio, l’autoefficacia potrebbe non avere un effetto causale diretto sulle prestazioni accademiche. Tuttavia, se aumentiamo l’autoefficacia attraverso interventi mirati, è probabile che osserviamo un miglioramento nell’impegno allo studio. Questo aumento dell’impegno, a sua volta, tende a migliorare le prestazioni accademiche. Di conseguenza, possiamo affermare che l’autoefficacia influisce indirettamente sulle prestazioni accademiche attraverso una catena causale.</p>
<p>È importante precisare che esiste una relazione causale tra X e Y anche quando modificare X non porta necessariamente a un cambiamento immediato o deterministico in Y, ma altera la probabilità che Y si verifichi in un certo modo, modificando quindi la distribuzione di Y. Questa prospettiva probabilistica della causalità è particolarmente rilevante in campi come la psicologia, dove le relazioni tra variabili sono spesso complesse e influenzate da molteplici fattori.</p>
<section id="i-limiti-dellosservazione" class="level3" data-number="21.3.1">
<h3 data-number="21.3.1" class="anchored" data-anchor-id="i-limiti-dellosservazione"><span class="header-section-number">21.3.1</span> I Limiti dell’Osservazione</h3>
<p>Per comprendere i limiti dell’osservazione passiva, e quindi la necessità di comprendere le relazioni causali sottostanti, <span class="citation" data-cites="hardt2022patterns">Hardt &amp; Recht (<a href="#ref-hardt2022patterns" role="doc-biblioref">2022</a>)</span> si riferiscono all’esempio storico delle ammissioni ai corsi di laurea dell’Università della California, Berkeley, nel 1973. In quell’anno, 12,763 candidati furono considerati per l’ammissione in uno dei 101 dipartimenti o major interdipartimentali. Di questi, 4,321 erano donne e 8,442 erano uomini. I dati mostrano che circa il 35% delle donne fu ammesso, rispetto al 44% degli uomini. Test di significatività statistica indicano che questa differenza non è attribuibile al caso, suggerendo una disparità nei tassi di ammissione tra i generi.</p>
<p>Una tendenza simile si osserva quando si analizzano le decisioni aggregate di ammissione nei sei maggiori dipartimenti. Il tasso di ammissione complessivo per gli uomini era di circa il 44%, mentre per le donne era solo il 30%, un’altra differenza statisticamente significativa. Tuttavia, poiché i dipartimenti hanno autonomia nelle loro decisioni di ammissione, è utile esaminare il possibile bias di genere a livello di singolo dipartimento.</p>
<p><strong>Uomini</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Dipartimento</th>
<th>Candidati</th>
<th>Ammessi (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>825</td>
<td>62</td>
</tr>
<tr class="even">
<td>B</td>
<td>520</td>
<td>60</td>
</tr>
<tr class="odd">
<td>C</td>
<td>325</td>
<td>37</td>
</tr>
<tr class="even">
<td>D</td>
<td>417</td>
<td>33</td>
</tr>
<tr class="odd">
<td>E</td>
<td>191</td>
<td>28</td>
</tr>
<tr class="even">
<td>F</td>
<td>373</td>
<td>6</td>
</tr>
</tbody>
</table>
<p><strong>Donne</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Dipartimento</th>
<th>Candidati</th>
<th>Ammessi (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>108</td>
<td>82</td>
</tr>
<tr class="even">
<td>B</td>
<td>25</td>
<td>68</td>
</tr>
<tr class="odd">
<td>C</td>
<td>593</td>
<td>34</td>
</tr>
<tr class="even">
<td>D</td>
<td>375</td>
<td>35</td>
</tr>
<tr class="odd">
<td>E</td>
<td>393</td>
<td>24</td>
</tr>
<tr class="even">
<td>F</td>
<td>341</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Dall’osservazione di questi dati, emerge che quattro dei sei maggiori dipartimenti mostrano un tasso di ammissione più elevato per le donne, mentre due mostrano un tasso più elevato per gli uomini. Tuttavia, questi due dipartimenti non possono giustificare la sostanziale differenza nei tassi di ammissione osservata nei dati aggregati. Questo suggerisce che la tendenza generale di un tasso di ammissione più alto per gli uomini sembra invertita quando i dati sono disaggregati per dipartimento.</p>
<p>Questo fenomeno è noto come <em>paradosso di Simpson</em>, un paradosso statistico in cui una tendenza che appare in sottopopolazioni si inverte o scompare quando i dati vengono aggregati. Nel contesto attuale, il paradosso di Simpson si manifesta nel fatto che, mentre i dati aggregati sembrano indicare una discriminazione di genere contro le donne, l’analisi dei dati disaggregati per dipartimento rivela che in alcuni casi le donne sono favorite in termini di ammissioni.</p>
<p>La domanda fondamentale è se questi dati indicano effettivamente un problema di discriminazione di genere o se, come suggerito dallo studio originale, il bias di genere nelle ammissioni fosse principalmente dovuto al fatto che “le donne sono indirizzate dalla loro socializzazione e istruzione verso campi di studio generalmente più affollati, meno produttivi in termini di completamento dei diplomi, meno finanziati e che spesso offrono prospettive professionali peggiori.” In altre parole, il problema risiederebbe in differenze sistemiche e strutturali tra i campi di studio scelti dalle donne e quelli scelti dagli uomini.</p>
<p>Il paradosso di Simpson crea disagio proprio perché l’intuizione suggerisce che una tendenza valida per tutte le sottopopolazioni dovrebbe esserlo anche a livello aggregato. Tuttavia, questo paradosso evidenzia un errore comune nell’interpretazione delle probabilità condizionate: confondere l’osservazione passiva con l’analisi causale. I dati che abbiamo rappresentano solo un’istantanea del comportamento normale di uomini e donne che si candidavano per l’ammissione a UC Berkeley nel 1973.</p>
<p>Non possiamo trarre conclusioni definitive da questi dati. Possiamo solo riconoscere che l’analisi iniziale solleva ulteriori domande, come ad esempio la necessità di progettare nuovi studi per raccogliere dati più completi, che potrebbero portare a conclusioni più definitive. In alternativa, potremmo discutere su quale scenario sia più verosimile in base alle nostre convinzioni e alle notre ipotesi sul mondo.</p>
<p>L’inferenza causale può essere utile in entrambi i casi. Da un lato, può guidare la progettazione di nuovi studi, aiutandoci a scegliere quali variabili includere, quali escludere e quali mantenere costanti. Dall’altro, i modelli causali possono fungere da meccanismo per incorporare le conoscenze scientifiche del dominio e passare da ipotesi plausibili a conclusioni plausibili.</p>
</section>
</section>
<section id="variabili-confondenti" class="level2" data-number="21.4">
<h2 data-number="21.4" class="anchored" data-anchor-id="variabili-confondenti"><span class="header-section-number">21.4</span> Variabili Confondenti</h2>
<p>Sebbene gli esperimenti controllati siano considerati il metodo più affidabile per identificare relazioni causali, molte domande di ricerca non possono essere affrontate sperimentalmente a causa di vincoli etici o pratici. In tali situazioni, i ricercatori si rivolgono a disegni osservazionali, che garantiscono maggiore flessibilità e adattabilità ai contesti reali. Tuttavia, l’utilizzo di dati osservazionali introduce una sfida cruciale: la difficoltà di stabilire conclusioni causali solide e affidabili.</p>
<p>Al centro di questa complessità si trovano le <strong>variabili confondenti</strong>. Una variabile confondente è presente quando l’associazione osservata tra due variabili, X e Y, non riflette accuratamente la vera relazione causale tra di esse. In altre parole, la variabile confondente influenza sia X che Y, creando l’apparenza di una relazione diretta tra le due che potrebbe essere fuorviante o inesatta.</p>
<p>Negli studi osservazionali, se le variabili confondenti non vengono misurate e controllate adeguatamente, possono distorcere le stime degli effetti causali, introducendo bias nei risultati e impedendo di riflettere il vero valore dell’effetto. In pratica, la presenza di variabili confondenti può portare a conclusioni errate quando si confrontano semplicemente i risultati osservati in diversi gruppi. Ciò che si osserva nei dati potrebbe non corrispondere a ciò che accadrebbe se si potesse manipolare direttamente la variabile di interesse in un esperimento controllato.</p>
<section id="approcci-per-il-controllo-delle-variabili-confondenti" class="level3" data-number="21.4.1">
<h3 data-number="21.4.1" class="anchored" data-anchor-id="approcci-per-il-controllo-delle-variabili-confondenti"><span class="header-section-number">21.4.1</span> Approcci per il Controllo delle Variabili Confondenti</h3>
<p>Un approccio apparentemente semplice per affrontare questo problema potrebbe essere quello di controllare statisticamente tutte le variabili confondenti. Questo metodo prevede di stimare l’effetto di X su Y separatamente in ogni segmento della popolazione definito da una condizione Z = z per ogni possibile valore di z. Successivamente, si calcola la media di questi effetti stimati nelle sottopopolazioni, ponderandoli per la probabilità di Z = z nella popolazione. Tuttavia, questo metodo presenta due difficoltà fondamentali:</p>
<ol type="1">
<li><strong>Conoscenza di tutte le variabili confondenti</strong>: Richiede la conoscenza di tutte le possibili variabili confondenti.</li>
<li><strong>Misurazione delle variabili confondenti</strong>: Richiede la capacità di misurare ciascuna di esse, cosa che spesso non è praticabile.</li>
</ol>
<p>Il controllo delle variabili confondenti è cruciale per stabilire relazioni causali, poiché permette di isolare gli effetti delle variabili indipendenti da quelli delle variabili confondenti che potrebbero influenzare le variabili dipendenti. Esistono due principali metodologie di controllo:</p>
<ol type="1">
<li><strong>Controllo Sperimentale</strong>: Implementato attraverso il disegno sperimentale e basato principalmente sulla randomizzazione.</li>
<li><strong>Controllo Statistico</strong>: Applicato durante l’analisi dei dati, con l’obiettivo di neutralizzare o quantificare l’influenza delle variabili estranee.</li>
</ol>
</section>
<section id="inferenza-causale-nei-dati-osservazionali" class="level3" data-number="21.4.2">
<h3 data-number="21.4.2" class="anchored" data-anchor-id="inferenza-causale-nei-dati-osservazionali"><span class="header-section-number">21.4.2</span> Inferenza Causale nei Dati Osservazionali</h3>
<p>A causa di queste difficoltà, l’inferenza causale basata su dati osservazionali è spesso considerata problematica, dando origine al famoso detto “la correlazione non implica causalità”.</p>
<p>Anche se il metodo preferito per l’inferenza causale in molte scienze è l’esperimento controllato e randomizzato, tali esperimenti non sono, e non sono mai stati, lo stile dominante di inferenza causale nelle scienze umane. Una ragione è che molte delle domande più importanti sul comportamento umano non possono essere studiate sperimentalmente. Alla fine, il comportamento deve essere studiato negli ambienti naturali che le persone costruiscono, poiché questi ambienti sono sia cause che conseguenze del comportamento. Senza studiare le persone nelle loro comunità, non sapremmo nemmeno cosa stiamo cercando di spiegare.</p>
<p>L’inferenza causale è possibile anche in contesti osservazionali, e gli statistici hanno sviluppato metodi specializzati per progettare analisi che affrontano specifici obiettivi di inferenza causale <span class="citation" data-cites="pearl_2016">(<a href="#ref-pearl_2016" role="doc-biblioref">Pearl et al., 2016</a>)</span>.</p>
</section>
<section id="strumenti-moderni-per-lanalisi-causale" class="level3" data-number="21.4.3">
<h3 data-number="21.4.3" class="anchored" data-anchor-id="strumenti-moderni-per-lanalisi-causale"><span class="header-section-number">21.4.3</span> Strumenti Moderni per l’Analisi Causale</h3>
<p>L’obiettivo dell’analisi causale moderna è proprio quello di fornire gli strumenti concettuali e metodologici per affrontare queste sfide. Attraverso l’uso di tecniche avanzate come i modelli causali strutturali, i grafi aciclici diretti (DAG) e i metodi di identificazione degli effetti causali, i ricercatori possono spesso superare le limitazioni dei dati osservazionali e trarre conclusioni causali più robuste.</p>
<p>In sintesi, mentre le variabili confondenti rappresentano una sfida significativa nell’analisi dei dati osservazionali, i progressi metodologici nell’analisi causale offrono strumenti potenti per mitigare questi problemi e migliorare l’affidabilità delle inferenze causali.</p>
</section>
</section>
<section id="modelli-causali-strutturali" class="level2" data-number="21.5">
<h2 data-number="21.5" class="anchored" data-anchor-id="modelli-causali-strutturali"><span class="header-section-number">21.5</span> Modelli Causali Strutturali</h2>
<p>I modelli causali sono strumenti essenziali per l’analisi dei dati osservazionali, poiché consentono di rappresentare il processo sottostante a un fenomeno e di prevedere gli effetti di un intervento. Questi modelli non solo permettono di anticipare le conseguenze di una causa, ma offrono anche la possibilità di esplorare scenari controfattuali, immaginando esiti alternativi che si sarebbero potuti verificare in presenza di decisioni diverse.</p>
<p>Un modello causale strutturale (<em>Structural Causal Model</em>, SCM) è un approccio che rappresenta le relazioni causali tra variabili. Esso si basa su una serie di assegnazioni che, partendo da variabili di rumore indipendenti (note anche come variabili esogene), generano una distribuzione di probabilità congiunta.</p>
<p>Le variabili di rumore indipendenti svolgono un ruolo cruciale negli SCM. Esse rappresentano fonti di incertezza o variabilità all’interno del sistema e non sono influenzate da altre variabili del modello. Queste variabili sono mutuamente indipendenti, il che significa che il loro valore non fornisce informazioni sul valore delle altre.</p>
<p>La costruzione di un SCM segue una sequenza specifica: si parte dalle variabili di rumore indipendenti, si applicano una serie di assegnazioni che descrivono gli effetti causali delle variabili esogene su altre variabili, e si genera progressivamente un insieme di variabili casuali che dà origine a una distribuzione congiunta.</p>
<p>Il principale vantaggio di un SCM risiede nella sua duplice natura: da un lato, fornisce una distribuzione di probabilità congiunta delle variabili, e dall’altro, descrive il processo generativo che porta alla formazione di tale distribuzione, partendo dalle variabili di rumore elementari.</p>
<p>Questa struttura consente non solo di modellare le relazioni probabilistiche tra le variabili, ma anche di rappresentare in modo esplicito i meccanismi causali che le governano.</p>
<p>I SCM possono essere rappresentati graficamente attraverso Grafi Aciclici Direzionati (<em>Directed Acyclic Graphs</em>, DAG). Questi DAG visualizzano le relazioni causali tra le variabili all’interno di un SCM, facilitando l’identificazione delle variabili confondenti e il loro impatto sull’analisi.</p>
</section>
<section id="bias-da-variabile-omessa" class="level2" data-number="21.6">
<h2 data-number="21.6" class="anchored" data-anchor-id="bias-da-variabile-omessa"><span class="header-section-number">21.6</span> Bias da Variabile Omessa</h2>
<p>Possiamo introdurre i DAG facendo riferiento al <em>bias da variabile omessa</em> (<em>Omitted Variable Bias</em>, o OVB; <span class="citation" data-cites="wilms2021omitted">Wilms et al. (<a href="#ref-wilms2021omitted" role="doc-biblioref">2021</a>)</span>). Come discusso da <span class="citation" data-cites="byrnes2024causal">Byrnes &amp; Dee (<a href="#ref-byrnes2024causal" role="doc-biblioref">2024</a>)</span>, l’omissione dall’analisi statistica di variabili confondenti note ma non misurate, o sconosciute e non misurate, può portare a stime errate della magnitudine degli effetti, errori nel segno delle stime (stimatori distorti), correlazioni spurie, e al mascheramento delle vere relazioni causali.</p>
<p>Un illustrazione di questa situazione è fornita nella <a href="#fig-byrnes-dee-1" class="quarto-xref">Figura&nbsp;<span>21.1</span></a>. La figura mostra tre DAG che illustrano diversi scenari in cui le variabili non osservate non influenzano i risultati del modello o potrebbero creare problemi a causa della confusione. Una variabile di risposta di interesse (Y) è causata sia da una variabile misurata (X) che da una variabile non misurata (U). Nel pannello di sinistra, la variabile non osservata (U) non è una variabile confondente. Nel pannello centrale, la variabile non osservata (U) è una variabile confondente e causa il bias da variabile omessa. Nel pannello di destra la variabile non osservata (U) causa il bias da variabile omessa in maniera indiretta.</p>
<div id="fig-byrnes-dee-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-byrnes-dee-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../figures/byrnes_dee_fig1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-byrnes-dee-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;21.1: Nel pannello di sinistra, X e U sono non correlate, quindi la mancata inclusione di U in un modello statistico aumenterebbe l’errore standard della stima (riducendo la precisione del modello) ma non porterebbe a bias nella stima dell’effetto di X su Y. Tuttavia, se U influenza anche X come nel pannello centrale, o se U e X sono influenzati da un fattore comune Z come nel pannello di destra, allora omettere U da un modello statistico causa il bias da variabile omessa nella stima dell’effetto di X su Y. I casi illustrati dal pannello centrale e dal pannello di destra sono esempi di sistemi in cui le cause comuni di confusione (U e Z rispettivamente) devono essere controllate per effettuare inferenze causali non distorte (la figura è ispirata da <span class="citation" data-cites="byrnes2024causal">Byrnes &amp; Dee (<a href="#ref-byrnes2024causal" role="doc-biblioref">2024</a>)</span>).
</figcaption>
</figure>
</div>
<p>Affrontare i problemi creati dalle variabili confondenti non misurate rappresenta una sfida primaria nell’inferenza causale dai dati osservazionali. A differenza dell’errore di misurazione nelle variabili predittive, che produce un bias costante verso lo zero e può essere corretto o modellato <span class="citation" data-cites="McElreath_rethinking schennach2016recent">(<a href="#ref-McElreath_rethinking" role="doc-biblioref">McElreath, 2020</a>; <a href="#ref-schennach2016recent" role="doc-biblioref">Schennach, 2016</a>)</span>, con l’OVB non possiamo conoscere la grandezza o la direzione del bias senza conoscere tutte le possibili variabili confondenti e le loro relazioni nel sistema.</p>
<p>Nonostante queste sfide, non è necessario abbandonare l’uso dei dati osservazionali per l’inferenza causale in psicologia. È invece necessario ricorrere all’adozione delle tecniche dei SCM per potere comunque svolgere l’inferenza causale.</p>
<p>È evidente che questo approccio porterà a conclusioni inevitabilmente parziali, destinate ad essere perfezionate da studi successivi. Tuttavia, tale metodologia offre il vantaggio di esplicitare il “modello generativo dei dati”, ovvero la struttura causale sottostante ai fenomeni psicologici oggetto di studio.</p>
<p>I progressi nella ricerca empirica conducono a una maggiore comprensione e, di conseguenza, a modifiche nelle ipotesi sui meccanismi causali. Questo processo rappresenta un’evoluzione della conoscenza scientifica. Tale sviluppo è reso possibile proprio perché le ipotesi causali sono formulate in termini di modelli formali, che descrivono in modo preciso i meccanismi ipotizzati.</p>
<p>Al contrario, limitarsi alla mera descrizione delle associazioni tra variabili non consente questo tipo di avanzamento conoscitivo. La formulazione di modelli causali espliciti permette infatti di testare, raffinare e, se necessario, rivedere le ipotesi sui meccanismi sottostanti ai fenomeni osservati, portando a una comprensione più profonda e dinamica dei processi psicologici.</p>
</section>
<section id="grafi-aciclici-diretti" class="level2" data-number="21.7">
<h2 data-number="21.7" class="anchored" data-anchor-id="grafi-aciclici-diretti"><span class="header-section-number">21.7</span> Grafi Aciclici Diretti</h2>
<p>I DAG sono uno strumento fondamentale per l’inferenza causale, offrendo una rappresentazione visiva delle relazioni causali ipotizzate tra variabili. Questi grafi sono definiti “diretti” perché le variabili, rappresentate da nodi, sono collegate da frecce orientate anziché da semplici linee. Sono inoltre chiamati “aciclici” poiché non è possibile tornare a un nodo di partenza seguendo il percorso delle frecce.</p>
<p>In un DAG, una freccia che va da X a Y indica un’influenza probabilistica di X su Y. La terminologia delle relazioni all’interno del grafo è importante: il nodo di origine di una freccia è chiamato “genitore”, mentre il nodo di destinazione è detto “figlio”. Quando è possibile raggiungere un nodo B partendo da un nodo A seguendo una successione di frecce, A è definito “antenato” di B, e B è considerato “discendente” di A.</p>
<p>I DAG consentono di distinguere chiaramente tra cause dirette e indirette. Una causa diretta è rappresentata da un nodo genitore, mentre una causa indiretta può essere qualsiasi antenato di un nodo nel grafo causale. Questa struttura permette di differenziare efficacemente causa ed effetto basandosi sulla posizione relativa dei nodi all’interno del grafo, ovvero se un nodo è antenato o discendente di un altro.</p>
<p>Questi grafi sono particolarmente utili per identificare variabili confondenti, basandosi sulla teoria sviluppata da Judea Pearl <span class="citation" data-cites="pearl2009causality">(<a href="#ref-pearl2009causality" role="doc-biblioref">Pearl, 2009</a>)</span>. È cruciale rappresentare in un DAG tutte le possibili relazioni causali, poiché l’assenza di una freccia tra due nodi implica la certezza dell’assenza di una relazione causale diretta tra le variabili corrispondenti.</p>
<p>Nella teoria dei DAG, due concetti fondamentali sono la d-separazione e il criterio del back-door.</p>
<section id="la-d-separazione" class="level3" data-number="21.7.1">
<h3 data-number="21.7.1" class="anchored" data-anchor-id="la-d-separazione"><span class="header-section-number">21.7.1</span> La d-separazione</h3>
<p>La <em>d-separazione</em> ci aiuta a determinare quando due variabili in un grafo causale sono indipendenti condizionatamente a un insieme di altre variabili. Questo concetto è cruciale per comprendere come l’informazione o l’influenza si propaga tra le variabili in un modello causale.</p>
<p>In termini più semplici, la d-separazione ci permette di identificare se esiste un “blocco” nel flusso di informazioni tra due variabili, dato un certo insieme di altre variabili (che chiameremo Λ). Quando due variabili sono d-separate da Λ, significa che non c’è flusso di informazioni tra di loro, condizionatamente a Λ.</p>
<p>Per comprendere meglio la d-separazione, consideriamo tre situazioni principali che possono verificarsi in un DAG:</p>
<ol type="1">
<li><p>Catena (X → Z → Y): In questo caso, Z è un mediatore tra X e Y. Se Z appartiene all’insieme Λ (cioè, se controlliamo o condizioniamo su Z), blocchiamo il flusso di informazioni da X a Y attraverso questo percorso. Per esempio, se X è “esercizio fisico”, Z è “pressione sanguigna” e Y è “rischio di malattie cardiache”, controllando per la pressione sanguigna (Z) blocchiamo il percorso attraverso il quale l’esercizio fisico influenza il rischio di malattie cardiache.</p></li>
<li><p>Fork (X ← Z → Y): Qui, Z è una causa comune sia di X che di Y. Se Z appartiene a Λ, blocchiamo la correlazione spuria tra X e Y che deriva dalla loro causa comune. Per esempio, se Z è “status socioeconomico”, X è “livello di istruzione” e Y è “stato di salute”, controllando per lo status socioeconomico (Z) eliminiamo la correlazione apparente tra istruzione e salute che potrebbe derivare dal fatto che entrambe sono influenzate dallo status socioeconomico.</p></li>
<li><p>Collider (X → Z ← Y): In questa situazione, Z è un effetto comune di X e Y. Sorprendentemente, se né Z né i suoi discendenti appartengono a Λ, il percorso è già bloccato. Controllare per Z (o i suoi discendenti) in realtà aprirebbe un percorso tra X e Y, creando una correlazione spuria. Per esempio, se X è “intelligenza”, Y è “bellezza” e Z è “successo in una carriera di attore”, controllare per il successo nella carriera di attore (Z) creerebbe una correlazione apparente tra intelligenza e bellezza, anche se queste potrebbero essere indipendenti nella popolazione generale.</p></li>
</ol>
<p>In sintesi, la d-separazione ci permette di determinare, dato un certo insieme di variabili Λ, se due variabili X e Y sono indipendenti condizionatamente a Λ. Questo ci aiuta a identificare quali variabili dobbiamo controllare (e quali non dobbiamo controllare) per ottenere stime causali non distorte, facilitando così l’inferenza causale corretta. La d-separazione è quindi uno strumento potente che ci permette di leggere le indipendenze condizionali direttamente dal grafo, senza dover fare calcoli probabilistici complessi.</p>
</section>
<section id="il-criterio-del-back-door" class="level3" data-number="21.7.2">
<h3 data-number="21.7.2" class="anchored" data-anchor-id="il-criterio-del-back-door"><span class="header-section-number">21.7.2</span> Il criterio del back-door</h3>
<p>Il criterio del back-door consente di identificare un insieme di variabili che, se controllate adeguatamente, permettono di stimare gli effetti causali in modo non distorto. L’obiettivo principale di questo criterio è eliminare l’influenza di percorsi non causali tra la variabile di esposizione (causa potenziale) e l’outcome (effetto), mantenendo aperto solo il percorso causale diretto di interesse.</p>
<p>In questo contesto, due variabili sono considerate “confuse” se esiste tra di esse un percorso di tipo back-door. Un back-door path da X a Y è definito come qualsiasi percorso che inizia da X con una freccia entrante in X. Per esempio, consideriamo il seguente percorso:</p>
<p>X ← A → B ← C → Y</p>
<p>In questo caso, il percorso rappresenta un flusso di informazioni da X a Y che non è causale, ma potrebbe creare l’apparenza di una relazione causale.</p>
<p>Per “deconfondere” una coppia di variabili, è necessario selezionare un insieme di variabili (chiamato back-door set) che “blocchi” tutti i back-door paths tra i due nodi di interesse. Il blocco di questi percorsi avviene in modi diversi a seconda della struttura del percorso:</p>
<ol type="1">
<li><p>Un back-door path che coinvolge una catena di variabili (ad esempio, A → B → C) può essere bloccato controllando per la variabile intermedia (in questo caso, B).</p></li>
<li><p>Un percorso che coinvolge un “collider” (una variabile che riceve frecce da entrambe le direzioni, come in A → B ← C) è naturalmente bloccato e non permette il flusso di informazioni.</p></li>
</ol>
<p>È importante notare che bisogna prestare attenzione a non aprire involontariamente un flusso di informazioni attraverso un collider. Questo può accadere se si condiziona l’analisi sul collider stesso o su un suo discendente, il che potrebbe erroneamente aprire il percorso e introdurre bias nell’analisi.</p>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Punti chiave
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Il criterio del back-door aiuta a identificare il set minimale di variabili da controllare.</li>
<li>Non tutte le variabili associate sia all’esposizione che all’outcome devono essere controllate; solo quelle che creano percorsi back-door.</li>
<li>In alcuni casi, potrebbe non essere necessario controllare alcuna variabile (se non ci sono percorsi back-door aperti).</li>
<li>In altri casi, potrebbe essere impossibile bloccare tutti i percorsi back-door con le variabili disponibili, indicando che l’effetto causale non può essere identificato con i dati a disposizione.</li>
</ul>
<p>Utilizzando il criterio del back-door in combinazione con i DAG, i ricercatori possono fare scelte più informate su quali variabili includere nelle loro analisi, migliorando così la validità delle loro inferenze causali.</p>
</div>
</div>
</section>
<section id="applicazioni" class="level3" data-number="21.7.3">
<h3 data-number="21.7.3" class="anchored" data-anchor-id="applicazioni"><span class="header-section-number">21.7.3</span> Applicazioni</h3>
<p>Consideriamo nuovamente la struttura causale illustrata nella <a href="#fig-byrnes-dee-1" class="quarto-xref">Figura&nbsp;<span>21.1</span></a>, pannello centrale. Dopo aver costruito un DAG come descritto nella sezione precedente, è possibile identificare le potenziali fonti di bias da variabili omesse, inclusi i confondenti non misurati (ad esempio, U). Non controllare per le variabili confondenti apre una “back-door” permettendo alla variazione confondente di influenzare la relazione tra la variabile causale e la variabile di risposta di interesse attraverso un percorso non valutato <span class="citation" data-cites="pearl2009causality">(<a href="#ref-pearl2009causality" role="doc-biblioref">Pearl, 2009</a>)</span>. In altre parole, omettere una variabile confondente come U nella <a href="#fig-byrnes-dee-1" class="quarto-xref">Figura&nbsp;<span>21.1</span></a> (pannello centrale) in un’analisi statistica significa che questa viene incorporata nel termine di errore del modello statistico, insieme alle fonti di errore casuali. La <a href="#fig-byrnes-dee-2" class="quarto-xref">Figura&nbsp;<span>21.2</span></a> illustra le conseguenze di un confondente U che ha un effetto positivo su X ma un effetto negativo su Y. Se adattiamo un modello come mostrato nella <a href="#fig-byrnes-dee-2" class="quarto-xref">Figura&nbsp;<span>21.2</span></a> bi, l’effetto stimato di X su Y è positivo quando si controlla per U. Tuttavia, se non si controlla per U, come mostrato nella <a href="#fig-byrnes-dee-2" class="quarto-xref">Figura&nbsp;<span>21.2</span></a> bii, U viene incorporato nel termine di errore, inducendo una correlazione tra l’errore e X, come illustrato nella <a href="#fig-byrnes-dee-2" class="quarto-xref">Figura&nbsp;<span>21.2</span></a> biii, portando a una stima errata. Pertanto, il termine di errore del modello e X risultano correlati, il che viola un’assunzione fondamentale dei modelli lineari (ovvero, il teorema di Gauss-Markov; Abdallah et al., 2015; Antonakis et al., 2010). Questo produce una stima errata, evidenziata in blu.</p>
<div id="fig-byrnes-dee-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-byrnes-dee-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../figures/byrnes_dee_fig2.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-byrnes-dee-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;21.2: <strong>Una visualizzazione del bias da variabile omessa e delle conseguenze per l’inferenza causale.</strong> (A) mostra un DAG di un sistema in cui X ha un effetto positivo su Y, e una variabile confondente U ha un effetto positivo su Y ma un effetto negativo su X. Le variabili non osservate (cioè non misurate) sono rappresentate in ellissi, come la variabile U e il termine di errore e nel pannello B. (B) illustra diverse stime del DAG in (A) utilizzando un’analisi del percorso. Vedi Box 1 per una breve spiegazione delle principali differenze tra DAG e diagrammi dei percorsi. Presumiamo che U non sia misurata. In (Bi), presumiamo di poter misurare e controllare U, rappresentata dalla freccia a doppia testa tra U e X, che rappresenta la correlazione tra le due variabili considerata dal modello. La variabile non misurata e è la fonte residua di variazione che si presume non sia correlata con nessun predittore. La freccia rossa rappresenta il percorso stimato. Al contrario, (Bii) e (Biii) rappresentano la realtà, dove non abbiamo una misurazione di U e non la controlliamo nel modello dei percorsi. Il ricercatore pensa di adattare il modello in (Bii) ma in realtà sta adattando il modello in (Biii), dove il termine di errore non è solo e, ma la somma di e e la variazione dovuta alla variabile omessa U. A causa di ciò, c’è un percorso diretto dal termine di errore del modello a X (e quindi X è endogeno). (C) mostra le relazioni stimate risultanti dai modelli in (Bi) rispetto a (Bii). Le linee rappresentano la relazione stimata tra X e Y dai rispettivi modelli. La linea rossa è la vera relazione causale, stimata da (Bi), mentre la linea blu contiene il bias da variabile omessa, poiché non si tiene conto della variabile confondente U, come stimato dal modello in Bii/Biii (Figura tratta da <span class="citation" data-cites="byrnes2024causal">Byrnes &amp; Dee (<a href="#ref-byrnes2024causal" role="doc-biblioref">2024</a>)</span>).
</figcaption>
</figure>
</div>
</section>
</section>
<section id="le-pratiche-scientifiche-per-inferire-la-causalità" class="level2" data-number="21.8">
<h2 data-number="21.8" class="anchored" data-anchor-id="le-pratiche-scientifiche-per-inferire-la-causalità"><span class="header-section-number">21.8</span> Le Pratiche Scientifiche per Inferire la Causalità</h2>
<p>Come visto in precedenza, in qualsiasi sistema complesso, consideriamo due variabili, <em>X</em> e <em>Y</em>. Sebbene possiamo osservare la loro distribuzione di probabilità congiunta <span class="math inline">\(p(x, y)\)</span>, stabilire se <em>X</em> causa <em>Y</em>, <em>Y</em> causa <em>X</em>, o se una terza variabile <em>Z</em> influenzi entrambe, rimane un problema complesso (Salmon, 1984). Questa difficoltà è al centro del dibattito filosofico sulla causalità, ma è anche il motore che spinge lo sviluppo di metodi scientifici per decifrare il funzionamento del mondo. Ad esempio, per capire se una terapia cognitivo-comportamentale (TCC) riduce effettivamente i sintomi di ansia, se la lettura di un articolo scientifico influenza le opinioni dei lettori riguardo a un tema controverso, o se l’attivazione di un neurone in una specifica area cerebrale influenza il comportamento o l’attività di un altro neurone, dobbiamo affrontare queste questioni con rigore scientifico.</p>
<section id="il-framework-interventista-di-judea-pearl" class="level3" data-number="21.8.1">
<h3 data-number="21.8.1" class="anchored" data-anchor-id="il-framework-interventista-di-judea-pearl"><span class="header-section-number">21.8.1</span> Il Framework Interventista di Judea Pearl</h3>
<p>Come discusso sopra, il lavoro di Judea Pearl ha rivoluzionato la formalizzazione dell’inferenza causale. Mettiamo qui in evidenza il ruolo che l’intervento attivo ha nella comprensione della causalità <span class="citation" data-cites="hardt2022patterns">(ricordiamo il punto di vista di <a href="#ref-hardt2022patterns" role="doc-biblioref">Hardt &amp; Recht, 2022</a> descritto in precedenza)</span>. Nella tradizionale probabilità bayesiana, consideriamo <span class="math inline">\(p(y \mid x)\)</span> — la probabilità di <em>Y</em> dato <em>X</em>. Tuttavia, Pearl ha introdotto l’operatore <em>“do”</em>, che permette di esprimere il risultato di un intervento attivo, scritto come <span class="math inline">\(p(y \mid do(x))\)</span>. Questo rappresenta la probabilità di <em>Y</em> quando <em>X</em> viene impostato artificialmente a un certo valore (Pearl, 2009). Questo approccio si concentra sugli interventi piuttosto che sulle sole osservazioni, permettendo di isolare l’effetto causale di <em>X</em> su <em>Y</em> senza necessariamente conoscere i meccanismi sottostanti.</p>
<p>Per esempio, supponiamo di voler studiare se la terapia cognitivo-comportamentale (TCC) riduce i sintomi di ansia. Osservare una correlazione tra la partecipazione alla TCC e il miglioramento dei sintomi non è sufficiente per stabilire una relazione causale. Utilizzando l’operatore <em>“do”</em>, possiamo simulare un intervento ipotetico: “Cosa accadrebbe se forzassimo tutti i pazienti a seguire la TCC?” Questo approccio ci permette di isolare l’effetto della TCC sui sintomi di ansia, eliminando l’influenza di fattori confondenti come lo stato socioeconomico o la predisposizione genetica.</p>
</section>
<section id="tre-fonti-di-conoscenza-causale-pragmatica" class="level3" data-number="21.8.2">
<h3 data-number="21.8.2" class="anchored" data-anchor-id="tre-fonti-di-conoscenza-causale-pragmatica"><span class="header-section-number">21.8.2</span> Tre Fonti di Conoscenza Causale Pragmatica</h3>
<p>Alla luce delle considerazioni precedenti, possiamo individuare tre fonti di conoscenza che ci informano sui meccanismi causali.</p>
<section id="esperimenti-randomizzati-controllati-rct" class="level4" data-number="21.8.2.1">
<h4 data-number="21.8.2.1" class="anchored" data-anchor-id="esperimenti-randomizzati-controllati-rct"><span class="header-section-number">21.8.2.1</span> Esperimenti Randomizzati Controllati (RCT)</h4>
<p>Gli RCT sono considerati lo standard aureo per stimare gli effetti causali. Assegnando casualmente i partecipanti a gruppi di trattamento e controllo, gli RCT minimizzano l’influenza di variabili confondenti, fornendo stime non distorte dell’effetto di un intervento. Ad esempio, numerosi esperimenti dimostrano che attivare un interruttore causa l’accensione di una luce:</p>
<p><span class="math display">\[
p(\text{luce accesa}|do(\text{interruttore acceso})) \approx 1, \quad p(\text{luce spenta}|do(\text{interruttore spento})) \approx 1
\]</span></p>
<p>Questo approccio è particolarmente utile in psicologia, dove fattori confondenti possono facilmente distorcere i risultati.</p>
<p>Per esempio, immaginiamo uno studio in cui alcuni volontari vengono assegnati casualmente a dormire 8 ore o a restare svegli tutta la notte prima di un test di memoria. Gli RCT permettono di stabilire se il sonno causa un miglioramento delle prestazioni cognitive, eliminando l’influenza di fattori come l’età o lo stress.</p>
</section>
<section id="comprensione-specifica-del-dominio" class="level4" data-number="21.8.2.2">
<h4 data-number="21.8.2.2" class="anchored" data-anchor-id="comprensione-specifica-del-dominio"><span class="header-section-number">21.8.2.2</span> Comprensione Specifica del Dominio</h4>
<p>In discipline come la psicologia, le neuroscienze o l’elettronica, la conoscenza specialistica consente agli esperti di basarsi su principi consolidati per formulare ipotesi causali e progettare esperimenti significativi. Ad esempio, anche se un semplice movimento della mano non causa direttamente l’accensione di una luce, la nostra comprensione dei circuiti elettrici ci informa che chiudere un interruttore completa un circuito, producendo luce. Queste intuizioni, basate su conoscenze approfondite del dominio, raffinano i nostri modelli causali e migliorano la progettazione sperimentale. Tale comprensione deriva spesso da esperimenti randomizzati precedenti e permette l’uso di quasi-esperimenti per produrre risultati causali convincenti.</p>
<p>Un esempio rilevante in psicologia e neuroscienze è il ruolo dell’amigdala nella risposta alla paura. Grazie a studi clinici e sperimentali, sappiamo che l’amigdala è una struttura cerebrale chiave nel processamento delle emozioni, in particolare della paura. Pazienti con danni all’amigdala, ad esempio, mostrano una ridotta capacità di riconoscere espressioni facciali di paura e di rispondere a stimoli minacciosi. Questa conoscenza specifica del dominio ci permette di formulare ipotesi causali precise, come “L’attività nell’amigdala influenza la risposta emotiva alla paura.”</p>
<p>Un altro esempio è il legame tra l’area di Broca e la produzione del linguaggio. Studi clinici su pazienti con lesioni in questa area hanno dimostrato che danni specifici portano a deficit nella produzione del linguaggio, un disturbo noto come <em>afasia di Broca</em>. Questa conoscenza deriva da decenni di ricerca neuroscientifica e ci permette di affermare con sicurezza che “L’attività nell’area di Broca è necessaria per la produzione fluente del linguaggio.”</p>
<p>La comprensione specifica del dominio non solo aiuta a formulare ipotesi causali, ma guida anche la progettazione degli esperimenti. Ad esempio, se vogliamo studiare l’effetto di un farmaco sulla riduzione dell’ansia, la conoscenza dei meccanismi neurobiologici alla base dell’ansia (come il ruolo del sistema limbico e dei neurotrasmettitori come la serotonina) ci permette di identificare i parametri rilevanti da misurare e di controllare per possibili fattori confondenti. Questo approccio è particolarmente utile quando non è possibile condurre esperimenti randomizzati, come nel caso di studi su pazienti con condizioni cliniche specifiche.</p>
<p>In sintesi, la comprensione specifica del dominio è un pilastro fondamentale per l’inferenza causale in psicologia e neuroscienze. Essa non solo fornisce le basi per formulare ipotesi precise, ma migliora anche la qualità e l’affidabilità della ricerca, permettendo di trarre conclusioni causali anche in contesti complessi e non sperimentali.</p>
</section>
<section id="testimonianze-scientifiche-e-prove-cumulative" class="level4" data-number="21.8.2.3">
<h4 data-number="21.8.2.3" class="anchored" data-anchor-id="testimonianze-scientifiche-e-prove-cumulative"><span class="header-section-number">21.8.2.3</span> Testimonianze Scientifiche e Prove Cumulative</h4>
<p>L’avanzamento della conoscenza scientifica dipende dalla validazione collettiva dei risultati. Quando numerosi studi indipendenti e randomizzati giungono a conclusioni causali simili, la comunità scientifica acquisisce una comprensione pragmatica, se non definitiva, dei meccanismi causali sottostanti. Questo approccio si giustifica grazie ai successi passati nella descrizione della causalità.</p>
<p>Per esempio, numerosi studi indicano che le relazioni sociali positive aumentano il benessere psicologico. Benché nessuno studio singolo possa offrire una prova definitiva, l’accumulo di prove da diverse fonti conferma l’esistenza di un legame causale tra socializzazione e benessere.</p>
</section>
</section>
<section id="conciliare-pragmatismo-con-scetticismo-filosofico" class="level3" data-number="21.8.3">
<h3 data-number="21.8.3" class="anchored" data-anchor-id="conciliare-pragmatismo-con-scetticismo-filosofico"><span class="header-section-number">21.8.3</span> Conciliare Pragmatismo con Scetticismo Filosofico</h3>
<p>Nonostante i metodi sperimentali, come gli esperimenti randomizzati controllati (RCT), e gli strumenti teorici, come l’operatore “do” introdotto da Judea Pearl, abbiano dimostrato una grande efficacia nella pratica scientifica, essi non risolvono completamente le sfide epistemologiche sollevate da filosofi come David Hume. Hume ha argomentato che la causalità non è qualcosa che possiamo osservare direttamente; piuttosto, è un concetto inferito attraverso l’esperienza. Questo scetticismo radicale ci ricorda che la nostra comprensione causale del mondo è sempre mediata da assunzioni e interpretazioni.</p>
<p>Tuttavia, ciò non significa che dobbiamo abbandonare il concetto di causalità. Al contrario, i metodi scientifici moderni forniscono uno strumento pragmatico estremamente potente per navigare nei sistemi complessi e fare previsioni affidabili. Secondo Woodward (2003), la causalità in scienza non deve essere vista come una finestra diretta ipotetiche verità metafisiche, ma piuttosto come uno strumento pratico per manipolare il mondo e prevedere i risultati delle nostre azioni. Questa prospettiva pragmatica ci permette di superare le limitazioni teoriche e concentrarci sui risultati concreti.</p>
<p>Consideriamo due esempi concreti.</p>
<ol type="1">
<li><p>Ogni volta che saliamo su un aereo, ci affidiamo implicitamente alle leggi della fisica e all’ingegneria aeronautica. Sappiamo, grazie a studi rigorosi e prove empiriche, che le forze aerodinamiche e i principi di propulsione consentono agli aerei di volare. Questa fiducia non deriva da una certezza assoluta, ma dalla robustezza delle evidenze accumulate nel tempo. La causalità tra il disegno dell’aereo e il suo funzionamento è stata testata e confermata milioni di volte, rendendo questo mezzo di trasporto sicuro e affidabile.</p></li>
<li><p>Analogamente, quando scegliamo di seguire un trattamento psicologico, come la terapia cognitivo-comportamentale (TCC), lo facciamo basandoci su una vasta quantità di ricerche scientifiche che dimostrano l’efficacia di tali interventi. Gli studi randomizzati hanno mostrato che la TCC modifica i processi mentali e comportamentali, riducendo in maniera rilevante i sintomi di ansia e depressione. Anche qui, la nostra fiducia non deriva da una prova definitiva della causalità, ma da un corpus consistente di evidenze empiriche.</p></li>
</ol>
<p>La chiave del successo del pragmatismo scientifico sta nella sua capacità di fornire risultati <strong>misurabili</strong> e <strong>replicabili</strong>. Non dobbiamo risolvere il problema filosofico della causalità per utilizzarla efficacemente. Ciò che conta è la sua applicabilità pratica: se un’intervento produce risultati coerenti e prevedibili, allora possiamo considerarlo causa di quei risultati, almeno per tutti gli scopi pratici. Questo approccio ci permette di progredire senza rimanere bloccati dalle domande metafisiche irrisolte.</p>
</section>
</section>
<section id="riflessioni-conclusive" class="level2" data-number="21.9">
<h2 data-number="21.9" class="anchored" data-anchor-id="riflessioni-conclusive"><span class="header-section-number">21.9</span> Riflessioni Conclusive</h2>
<p>Il dibattito filosofico sulla natura della causalità rimane un campo ricco e dinamico, ma i progressi metodologici degli ultimi decenni hanno fornito strumenti pratici e robusti per affrontare le complessità dell’inferenza causale. Esperimenti randomizzati controllati (RCT), diagrammi causali (DAG) e l’operatore “do” introdotto da Judea Pearl rappresentano esempi concreti di come, pur senza pretendere di risolvere le questioni metafisiche sulla natura ultima della causalità, la ricerca empirica sia in grado di offrire modelli affidabili per comprendere e intervenire su fenomeni complessi.</p>
<p>I DAG si distinguono come uno degli strumenti più potenti per rappresentare e analizzare le relazioni causali. Essi mettono in luce le influenze dirette e indirette tra variabili, rendendo esplicite le assunzioni alla base di ogni ricerca. Tuttavia, la loro efficacia dipende in modo cruciale dalla qualità delle conoscenze del dominio: senza una comprensione approfondita del contesto, anche il DAG più raffinato rischia di omettere variabili rilevanti o di rappresentare in modo fuorviante i rapporti causali. Nonostante ciò, i DAG promuovono la <strong>trasparenza scientifica</strong>, poiché rendono visibile il processo decisionale e aiutano a identificare potenziali fonti di bias, contribuendo a una maggiore chiarezza metodologica.</p>
<p>L’approccio pragmatico, che accetta di lavorare con concetti causali anche in assenza di risposte definitive ai grandi interrogativi metafisici, è al cuore del progresso scientifico. La nostra fiducia nel viaggiare in aereo o nel ricorrere a terapie come quella cognitivo-comportamentale si basa sull’evidenza empirica accumulata e confermata innumerevoli volte, non su una certezza assoluta. Questo pragmatismo non è solo utile, ma indispensabile per la ricerca scientifica e per la vita quotidiana.</p>
<p>Tuttavia, strumenti come i DAG non sono infallibili. Se le loro premesse sono scorrette o incomplete, le inferenze causali che ne derivano possono risultare distorte. Per mantenere la credibilità di queste tecniche, è essenziale un <em>rigoroso controllo metodologico</em>, accompagnato da una <em>riflessione critica</em> costante sulle assunzioni sottostanti. Solo questa vigilanza epistemologica permette di evitare semplificazioni eccessive e di confrontarsi in modo costruttivo con i limiti intrinseci dell’inferenza causale.</p>
<p>In definitiva, l’indagine causale contemporanea richiede un bilanciamento tra <em>pragmatismo</em> — che valorizza e applica i risultati empirici in modo concreto — e <em>scetticismo filosofico</em>, che stimola un’analisi continua delle nostre ipotesi e premesse. Questa prospettiva equilibrata è essenziale per l’avanzamento delle conoscenze. Pur rimanendo consapevoli che la “vera natura” della causalità possa restare, almeno in parte, un mistero irrisolvibile, possiamo comunque costruire strumenti sufficientemente robusti per prevedere con accuratezza i fenomeni di interesse e prendere decisioni informate. È questa combinazione di umiltà epistemologica e fiducia pragmatica a permetterci di avanzare nella comprensione del mondo, pur senza pretendere di esaurirne tutta la complessità.</p>
<p>Un sommario ironico di questi concetti è fornito nella vignetta di <a href="https://www.explainxkcd.com/wiki/index.php/2560:_Confounding_Variables">xkcd</a>.</p>
</section>
<section id="esercizi" class="level2" data-number="21.10">
<h2 data-number="21.10" class="anchored" data-anchor-id="esercizi"><span class="header-section-number">21.10</span> Esercizi</h2>
<div class="callout callout-style-simple callout-tip callout-titled" title="Esercizio">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Esercizio
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Esercizi teorici</strong></p>
<p><strong>Esercizio 1: Concetti chiave della causalità</strong></p>
<p>Per ciascuna delle seguenti affermazioni, indica se è vera o falsa e spiega il motivo della tua risposta.</p>
<ol type="1">
<li>Se X e Y sono correlate, allora X causa Y.<br>
</li>
<li>Se condizioniamo su una variabile collider, la correlazione tra X e Y aumenta.<br>
</li>
<li>Il paradosso di Simpson dimostra che i risultati osservati in gruppi disaggregati devono sempre essere preferiti a quelli aggregati.<br>
</li>
<li>Gli esperimenti randomizzati controllati eliminano completamente il problema della confusione.<br>
</li>
<li>Un DAG può rappresentare relazioni causali solo se tutte le variabili sono misurate.</li>
</ol>
<p><strong>Esercizio 2: Interpretazione di un DAG</strong></p>
<p>Considera il seguente DAG che rappresenta l’effetto dell’esercizio fisico (X) sulla salute cardiaca (Y):</p>
<pre><code>    X → Y
    Z → X
    Z → Y</code></pre>
<p>dove:</p>
<ul>
<li><strong>X</strong> = Esercizio fisico<br>
</li>
<li><strong>Y</strong> = Salute cardiaca<br>
</li>
<li><strong>Z</strong> = Predisposizione genetica</li>
</ul>
<ol type="1">
<li>Quale ruolo svolge <strong>Z</strong> in questo DAG? È una variabile confondente, collider o mediatore?</li>
<li>Per stimare correttamente l’effetto causale di <strong>X</strong> su <strong>Y</strong>, è necessario controllare per <strong>Z</strong>? Spiega il perché.<br>
</li>
<li>Se aggiungiamo un’altra variabile <strong>W</strong> che influenza sia <strong>Z</strong> che <strong>X</strong>, ma non direttamente <strong>Y</strong>, come cambierebbe il DAG?</li>
</ol>
<p><strong>Esercizio 3: Causalità nei dati osservazionali</strong></p>
<p>Leggi le seguenti situazioni e identifica quale problema potrebbe invalidare l’inferenza causale:</p>
<ol type="1">
<li>Uno studio osservazionale mostra che le persone che bevono caffè vivono più a lungo. Tuttavia, chi beve caffè tende ad avere un reddito più alto e accesso a migliori cure mediche.</li>
<li>Un’azienda scopre che i dipendenti che frequentano corsi di formazione hanno salari più alti. Ma i corsi sono aperti solo a coloro che già hanno più esperienza lavorativa.<br>
</li>
<li>Una ricerca mostra che gli studenti che usano di più il tablet per studiare hanno punteggi più bassi nei test. Tuttavia, gli studenti con difficoltà di apprendimento tendono a usare di più il tablet.</li>
</ol>
<p>Per ogni caso, identifica una possibile variabile confondente e suggerisci un metodo per controllare il bias.</p>
<p><strong>Esercizi pratici in R</strong></p>
<p><strong>Esercizio 4: Paradosso di Simpson con dati reali</strong></p>
<p>Utilizziamo i dati delle ammissioni di UC Berkeley per verificare il paradosso di Simpson.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dati di UC Berkeley</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(UCBAdmissions)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(UCBAdmissions)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertiamo i dati in formato long</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Admit"</span>, <span class="at">values_from =</span> <span class="st">"Freq"</span>) </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcoliamo il tasso di ammissione per uomini e donne aggregati</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>total_admitted_m <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>Freq[df<span class="sc">$</span>Admit <span class="sc">==</span> <span class="st">"Admitted"</span> <span class="sc">&amp;</span> df<span class="sc">$</span>Gender <span class="sc">==</span> <span class="st">"Male"</span>])</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>total_applicants_m <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>Freq[df<span class="sc">$</span>Gender <span class="sc">==</span> <span class="st">"Male"</span>])</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>total_admitted_f <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>Freq[df<span class="sc">$</span>Admit <span class="sc">==</span> <span class="st">"Admitted"</span> <span class="sc">&amp;</span> df<span class="sc">$</span>Gender <span class="sc">==</span> <span class="st">"Female"</span>])</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>total_applicants_f <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>Freq[df<span class="sc">$</span>Gender <span class="sc">==</span> <span class="st">"Female"</span>])</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>admit_rate_m <span class="ot">&lt;-</span> total_admitted_m <span class="sc">/</span> total_applicants_m</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>admit_rate_f <span class="ot">&lt;-</span> total_admitted_f <span class="sc">/</span> total_applicants_f</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(admit_rate_m, admit_rate_f)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcoliamo il tasso di ammissione per ogni dipartimento</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>df_long<span class="sc">$</span>rate_m <span class="ot">&lt;-</span> df_long<span class="sc">$</span>Admitted <span class="sc">/</span> (df_long<span class="sc">$</span>Admitted <span class="sc">+</span> df_long<span class="sc">$</span>Rejected)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>df_long <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(Dept) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean_rate_m =</span> <span class="fu">mean</span>(rate_m))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizziamo il tasso di ammissione per genere e dipartimento</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> Dept, <span class="at">y =</span> rate_m, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tasso di Ammissione per Genere nei Dipartimenti UC Berkeley"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Dipartimento"</span>, <span class="at">y =</span> <span class="st">"Tasso di Ammissione"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Domande:</strong></p>
<ol type="1">
<li>Dai dati aggregati, sembra che le donne siano discriminate. Questo è confermato dall’analisi per dipartimento?<br>
</li>
<li>Quale variabile confondente è responsabile del paradosso di Simpson in questo caso?<br>
</li>
<li>Come potrebbe essere interpretato male un modello che considera solo i dati aggregati?</li>
</ol>
<p><strong>Esercizio 5: Analisi causale con DAG</strong></p>
<p>Usiamo il pacchetto <code>dagitty</code> per costruire e analizzare un DAG.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">"dag {</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">    E -&gt; H</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">    G -&gt; E</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">    G -&gt; H</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">}"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">graphLayout</span>(dag))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Domande:</strong></p>
<ol type="1">
<li>Quali sono le variabili confondenti nel DAG?<br>
</li>
<li>Quali percorsi sono back-door paths?<br>
</li>
<li>Quale set di variabili dovremmo controllare per ottenere una stima non distorta dell’effetto di <strong>E</strong> su <strong>H</strong>?<br>
</li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled" title="Soluzione">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Soluzione
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Esercizio 1: Concetti chiave della causalità</strong></p>
<ol type="1">
<li><strong>Falso</strong> – La correlazione non implica causalità. Potrebbero esserci variabili confondenti o una relazione di causalità inversa tra X e Y.<br>
</li>
<li><strong>Vero</strong> – Condizionare su un collider introduce un’associazione spuriosa tra X e Y, aumentando la correlazione.<br>
</li>
<li><strong>Falso</strong> – Il paradosso di Simpson mostra che i dati aggregati possono essere fuorvianti, ma non significa che i dati disaggregati siano sempre più affidabili. È necessario analizzare il contesto e le possibili variabili confondenti.<br>
</li>
<li><strong>Falso</strong> – Gli RCT minimizzano i problemi di confondimento grazie alla randomizzazione, ma possono comunque avere limitazioni dovute a bias di selezione, mancate assegnazioni casuali, e problemi etici.<br>
</li>
<li><strong>Falso</strong> – Un DAG può rappresentare le relazioni causali anche se alcune variabili non sono misurate. Tuttavia, la validità dell’inferenza dipende dalla correttezza del DAG.</li>
</ol>
<p><strong>Esercizio 2: Interpretazione di un DAG</strong></p>
<ol type="1">
<li><p><strong>Z è una variabile confondente</strong>, poiché influenza sia X che Y, creando un percorso di back-door.<br>
</p></li>
<li><p><strong>Sì</strong>, per stimare correttamente l’effetto di X su Y dobbiamo controllare per Z. Se non lo facciamo, la relazione osservata tra X e Y includerà l’influenza di Z.<br>
</p></li>
<li><p>Se aggiungiamo una variabile W che influenza Z e X, il DAG diventa:</p>
<pre><code>    W → Z → X → Y
    W → X
    Z → Y</code></pre>
<p>Ora W è una variabile a monte di X e Z, ma non confonde direttamente la relazione tra X e Y.</p></li>
</ol>
<p><strong>Esercizio 3: Causalità nei dati osservazionali</strong></p>
<ol type="1">
<li><strong>Confondente: reddito</strong> – Le persone con un reddito più alto possono avere accesso a cure migliori, che a loro volta migliorano la salute. Soluzione: <strong>Propensity Score Matching (PSM)</strong> o regressione con controllo per il reddito.<br>
</li>
<li><strong>Confondente: esperienza lavorativa</strong> – Chi ha più esperienza può già avere salari più alti. Soluzione: <strong>Matching o modello di regressione con controllo per esperienza lavorativa</strong>.<br>
</li>
<li><strong>Confondente: difficoltà di apprendimento</strong> – Studenti con difficoltà possono usare più il tablet e avere punteggi più bassi. Soluzione: <strong>Includere il livello di abilità di partenza nei modelli statistici</strong>.</li>
</ol>
<p><strong>Soluzioni esercizi pratici in R</strong></p>
<p><strong>Esercizio 4: Paradosso di Simpson con dati reali</strong></p>
<ol type="1">
<li><p><strong>Differenza nei tassi di ammissione aggregati:</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>admit_rate_m <span class="ot">&lt;-</span> total_admitted_m <span class="sc">/</span> total_applicants_m</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>admit_rate_f <span class="ot">&lt;-</span> total_admitted_f <span class="sc">/</span> total_applicants_f</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Risultato:</strong></p>
<ul>
<li>Tasso di ammissione uomini: ~44%<br>
</li>
<li>Tasso di ammissione donne: ~35%<br>
→ <strong>Sembra che le donne siano discriminate.</strong></li>
</ul></li>
<li><p><strong>Analisi per dipartimento:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_long <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(Dept) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean_rate_m =</span> <span class="fu">mean</span>(rate_m))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Nei singoli dipartimenti, le donne hanno tassi di ammissione <strong>uguali o superiori</strong> rispetto agli uomini.<br>
→ <strong>Il problema non è discriminazione diretta, ma la distribuzione delle domande nei dipartimenti.</strong></li>
</ul></li>
<li><p><strong>Conclusione:</strong> Il paradosso di Simpson mostra che le donne tendono a candidarsi più spesso a dipartimenti molto competitivi con bassi tassi di ammissione, mentre gli uomini si candidano di più in dipartimenti con tassi di ammissione più alti.</p></li>
</ol>
<p><strong>Moralità</strong>: Non sempre una differenza aggregata indica un bias. Bisogna analizzare i sottogruppi.</p>
<p><strong>Esercizio 5: Analisi causale con DAG</strong></p>
<ol type="1">
<li><p><strong>Variabili confondenti</strong></p>
<ul>
<li>G è una variabile confondente perché influenza sia E (esposizione) che H (esito).</li>
</ul></li>
<li><p><strong>Back-door paths</strong></p>
<ul>
<li>Il percorso <code>E ← G → H</code> è un back-door path che deve essere bloccato.</li>
</ul></li>
<li><p><strong>Soluzione: controllare per G</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output: <code>{G}</code><br>
→ <strong>Controllare per G permette di ottenere una stima causale non distorta di E su H.</strong></p></li>
</ol>
<p><strong>Conclusioni</strong></p>
<ol type="1">
<li><strong>La correlazione non implica causalità</strong>. Abbiamo visto come variabili confondenti possano generare relazioni spurie.<br>
</li>
<li><strong>Il paradosso di Simpson dimostra che i dati aggregati possono essere fuorvianti</strong>. Bisogna sempre analizzare i sottogruppi.<br>
</li>
<li><strong>I DAG aiutano a identificare le variabili da controllare per ottenere stime causali corrette</strong>.<br>
</li>
<li><strong>L’analisi causale è fondamentale per evitare inferenze errate e migliorare la qualità della ricerca</strong>.<br>
</li>
</ol>
</div>
</div>
</div>
</section>
<section id="bibliografia" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-alexander2023telling" class="csl-entry" role="listitem">
Alexander, R. (2023). <em>Telling Stories with Data: With Applications in R</em>. Chapman; Hall/CRC.
</div>
<div id="ref-byrnes2024causal" class="csl-entry" role="listitem">
Byrnes, J. E., &amp; Dee, L. E. (2024). Causal inference with observational data and unobserved confounding variables. <em>bioRxiv</em>, 2024–2002.
</div>
<div id="ref-hardt2022patterns" class="csl-entry" role="listitem">
Hardt, M., &amp; Recht, B. (2022). <em>Patterns, Predictions, and Actions: Foundations of Machine Learning</em>. Princeton University Press.
</div>
<div id="ref-McElreath_rethinking" class="csl-entry" role="listitem">
McElreath, R. (2020). <em>Statistical rethinking: <span>A</span> <span>Bayesian</span> course with examples in <span>R</span> and <span>Stan</span></em> (2nd Edition). CRC Press.
</div>
<div id="ref-pearl2009causality" class="csl-entry" role="listitem">
Pearl, J. (2009). <em>Causality</em>. Cambridge University Press.
</div>
<div id="ref-pearl_2016" class="csl-entry" role="listitem">
Pearl, J., Glymour, M., &amp; Jewell, N. P. (2016). <em>Causal inference in statistics: <span>A</span> primer</em>. John Wiley &amp; Sons.
</div>
<div id="ref-riedererdesignpatterns" class="csl-entry" role="listitem">
Riederer, E. (2021). <em>Causal design patterns for data analysts</em>. <a href="https://emilyriederer.netlify.app/post/causal-design-patterns/">https://emilyriederer.netlify.app/post/causal-design-patterns/</a>
</div>
<div id="ref-schennach2016recent" class="csl-entry" role="listitem">
Schennach, S. M. (2016). Recent advances in the measurement error literature. <em>Annual Review of Economics</em>, <em>8</em>(1), 341–377.
</div>
<div id="ref-wilms2021omitted" class="csl-entry" role="listitem">
Wilms, R., Mäthner, E., Winnen, L., &amp; Lanwehr, R. (2021). Omitted variable bias: A threat to estimating causal relationships. <em>Methods in Psychology</em>, <em>5</em>, 100075.
</div>
<div id="ref-van2023new" class="csl-entry" role="listitem">
Zwet, E. van, Gelman, A., Greenland, S., Imbens, G., Schwab, S., &amp; Goodman, S. N. (2023). A New Look at P Values for Randomized Clinical Trials. <em>NEJM Evidence</em>, <em>3</em>(1), EVIDoa2300003.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiato!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiato!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/eda/08_correlation.html" class="pagination-link" aria-label="Relazioni tra variabili">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Relazioni tra variabili</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/eda/10_estimand.html" class="pagination-link" aria-label="Estimandi teorici e estimandi empirici">
        <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Estimandi teorici e estimandi empirici</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> è una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/eda/09_causality.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>