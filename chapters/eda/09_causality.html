<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Corrado Caudek">

<title>22&nbsp; Causalità dai dati osservazionali – Psicometria</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/eda/10_estimand.html" rel="next">
<link href="../../chapters/eda/08_correlation.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-5ce6d56fc2a85cf1942de8a9da5c14ea.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c3f49431341e11ca6c1a861f909675d0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/eda/introduction_eda.html">EDA</a></li><li class="breadcrumb-item"><a href="../../chapters/eda/09_causality.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Eseguire il codice" class="quarto-navigation-tool px-1" aria-label="Eseguire il codice"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informazioni Generali</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefazione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/key_notions/introduction_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fondamenti</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/01_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">La crisi di replicazione e la riforma metodologica in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/02_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Concetti chiave</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/03_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Campionamento, metodologia sperimentale e studi osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/04_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/05_cognitive_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dalla descrizione alla spiegazione: modelli meccanicistici e computazionali in psicologia</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/R/introduction_r_lang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/01_r_syntax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Un approccio moderno all’analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/02_utility_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Utility functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/03_r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Programmazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/04_r_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Pacchetti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/05_dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduzione a <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/06_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/07_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">L’ambiente di programmazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/08_ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Utilizzo di strumenti AI</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/eda/introduction_eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/01_project_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Le fasi del progetto di analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/02_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Flusso di lavoro per la pulizia dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/04_exploring_qualitative_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Esplorare i dati qualitativi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/05_exploring_numeric_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Esplorare i dati numerici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/06_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Principi della visualizzazione dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07_loc_scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Indicatori di tendenza centrale e variabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07a_introduction_normal_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Introduzione alla distribuzione normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/08_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Relazioni tra variabili</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/09_causality.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/10_estimand.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Estimandi teorici e estimandi empirici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/11_outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Outlier</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/probability/introduction_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilità</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/01_intro_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Interpretazione della probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/02_probability_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Modelli probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/03_prob_spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">La Probabilità come misura della certezza razionale: un’interpretazione Bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/04_sigma-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Dal Discreto al Continuo: la <span class="math inline">\(\sigma\)</span>-algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/05_conditional_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Probabilità condizionata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/06_bayes_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/07_random_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/08_prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Distribuzioni di massa e di densità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/09_expval_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Proprietà delle variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/10_sampling_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11a_joint_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Probabilità congiunta</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11b_cov_cor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Covarianza e correlazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11c_joint_prob_cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Caso continuo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12a_intro_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Introduzione alle distribuzioni di probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12_discr_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/13_cont_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/14_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Assunzione di gaussianità e trasformazioni dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/15_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">La verosimiglianza</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_intro_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_bayesian_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Aggiornare le credenze su un parametro: dal prior alla posterior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_conjugate_families_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_conjugate_families_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (2)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/11_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/12_gamma_exponential_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Modello gamma-esponenziale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/13_prior_pred_check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Controllo predittivo a priori (Prior Predictive Check)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/14_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04a_stan_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Regressione lineare in Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07a_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto: valutare la rilevanza pratica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Pianificazione della dimensione campionaria</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_anova_2vie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">ANOVA ad due vie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/12_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni indipendenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/13_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Entropia</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/01_entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Entropia e informazione di Shannon</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/02_kl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/03_model_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Valutare i modelli bayesiani: Log-Score, LPPD, ELPD e LOO-CV</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Modelli</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/01_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Il modello di revisione degli obiettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/02_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Estensioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/03_rescorla_wagner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Decisioni</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/decision_analysis/01_study_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Analisi delle decisioni</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Missing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/missing/01_mnar_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Dati mancanti in psicologia: identificare e modellare i casi MNAR con un approccio Bayesiano in Stan</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Frequentismo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/introduction_frequentist_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01_intro_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01a_stime_parametri.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/02_conf_interv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/03_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">La grandezza del campione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/04_test_ipotesi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">85</span>&nbsp; <span class="chapter-title">Significatività statistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/05_two_ind_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">86</span>&nbsp; <span class="chapter-title">Test t di Student per campioni indipendenti</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">87</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">88</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">89</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">90</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">91</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">92</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_piranha.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">93</span>&nbsp; <span class="chapter-title">Il Problema del priming: sfide e paradossi nella psicologia sociale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">94</span>&nbsp; <span class="chapter-title">I gradi di libertà del ricercatore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/09_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">95</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendici</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01a_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Cartelle e documenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a47_first_order_markov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Catene di Markov</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Indice</h2>
   
  <ul class="collapse">
  <li><a href="#cosè-la-causalità" id="toc-cosè-la-causalità" class="nav-link active" data-scroll-target="#cosè-la-causalità"><span class="header-section-number">22.1</span> Cos’è la causalità?</a></li>
  <li><a href="#effetto-causale" id="toc-effetto-causale" class="nav-link" data-scroll-target="#effetto-causale"><span class="header-section-number">22.2</span> Effetto Causale</a></li>
  <li><a href="#i-limiti-dellosservazione" id="toc-i-limiti-dellosservazione" class="nav-link" data-scroll-target="#i-limiti-dellosservazione"><span class="header-section-number">22.3</span> I Limiti dell’Osservazione</a></li>
  <li><a href="#come-scoprire-le-relazioni-causali" id="toc-come-scoprire-le-relazioni-causali" class="nav-link" data-scroll-target="#come-scoprire-le-relazioni-causali"><span class="header-section-number">22.4</span> Come Scoprire le Relazioni Causali?</a></li>
  <li><a href="#modelli-causali-strutturali" id="toc-modelli-causali-strutturali" class="nav-link" data-scroll-target="#modelli-causali-strutturali"><span class="header-section-number">22.5</span> Modelli Causali Strutturali</a></li>
  <li><a href="#bias-da-variabile-omessa" id="toc-bias-da-variabile-omessa" class="nav-link" data-scroll-target="#bias-da-variabile-omessa"><span class="header-section-number">22.6</span> Bias da Variabile Omessa</a></li>
  <li><a href="#grafi-aciclici-diretti" id="toc-grafi-aciclici-diretti" class="nav-link" data-scroll-target="#grafi-aciclici-diretti"><span class="header-section-number">22.7</span> Grafi Aciclici Diretti</a></li>
  <li><a href="#le-pratiche-scientifiche-per-inferire-la-causalità" id="toc-le-pratiche-scientifiche-per-inferire-la-causalità" class="nav-link" data-scroll-target="#le-pratiche-scientifiche-per-inferire-la-causalità"><span class="header-section-number">22.8</span> Le Pratiche Scientifiche per Inferire la Causalità</a></li>
  <li><a href="#conciliare-pragmatismo-con-scetticismo-filosofico" id="toc-conciliare-pragmatismo-con-scetticismo-filosofico" class="nav-link" data-scroll-target="#conciliare-pragmatismo-con-scetticismo-filosofico"><span class="header-section-number">22.9</span> Conciliare Pragmatismo con Scetticismo Filosofico</a></li>
  </ul>
<div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/eda/09_causality.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/eda/introduction_eda.html">EDA</a></li><li class="breadcrumb-item"><a href="../../chapters/eda/09_causality.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-eda-causality" class="quarto-section-identifier"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In questo capitolo imparerai a
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>affrontare il problema della causalità anche in assenza di esperimenti;</li>
<li>riconoscere i quattro confondenti fondamentali (catena, biforcazione, collider, discendente);</li>
<li>valutare con cautela le inferenze dai dati osservazionali, tenendo conto di debolezze e assunzioni.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Leggere <a href="https://xcelab.net/rm/statistical-rethinking/">Statistical Rethinking</a>. Focalizzati sul capitolo 1 <em>The Golem of Prague</em>.</li>
<li>Leggere <em>Causal inference with observational data and unobserved confounding variables</em> di <span class="citation" data-cites="byrnes2024causal">Byrnes &amp; Dee (<a href="#ref-byrnes2024causal" role="doc-biblioref">2024</a>)</span>.</li>
<li>Leggere <em>Causal design patterns for data anal<span class="math inline">\(Y\)</span>sts</em> <span class="citation" data-cites="riedererdesignpatterns">(<a href="#ref-riedererdesignpatterns" role="doc-biblioref">Riederer, 2021</a>)</span>. Questo post sul blog fornisce una panoramica di diversi approcci per fare affermazioni causali dai dati osservazionali.</li>
<li>Leggere <a href="https://theeffectbook.net">The Effect: An Introduction to Research Design and Causality</a>. Focalizzati sul capitolo 10 <em>Treatment Effects</em>.</li>
<li>Leggere <a href="https://mixtape.scunning.com/03-directed_acyclical_graphs">Causal Inference</a> di Scott Cunningham. Focalizzati sul capitolo 3 <em>Directed Acyclic Graphs</em>.</li>
<li>Leggere <em>Telling Stories with Data</em> <span class="citation" data-cites="alexander2023telling">(<a href="#ref-alexander2023telling" role="doc-biblioref">Alexander, 2023</a>)</span>. Concentrati sul capitolo 15 <em>Causalit<span class="math inline">\(Y\)</span> from observational data</em>.</li>
</ul>
</div>
</div>
<section id="introduzione" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="introduzione">Introduzione</h2>
<p>La pura osservazione dei dati può rivelare correlazioni e pattern nei dati, ma senza un’indagine sulle cause che stanno alla base di tali correlazioni, le conclusioni tratte possono essere fuorvianti o incomplete.</p>
<p>Richard McElreath, nel suo libro “Statistical Rethinking” <span class="citation" data-cites="McElreath_rethinking">(<a href="#ref-McElreath_rethinking" role="doc-biblioref">McElreath, 2020</a>)</span>, utilizza l’analogia dei Golem - creature potenti ma prive di saggezza - per descrivere un approccio metodologico che è stato a lungo predominante in psicologia. Questo approccio si basa esclusivamente sull’analisi delle <strong>associazioni statistiche</strong> tra variabili, trascurando considerazioni più profonde sulla causalità.</p>
<p>Il metodo in questione si concentra principalmente sul test delle ipotesi nulle, senza stabilire una chiara <strong>connessione tra le domande di ricerca riguardanti le relazioni causali e i test statistici</strong> impiegati. Questa disconnessione è evidente nella figura successiva, tratta da un manuale di analisi dati di impostazione frequentista, che illustra la procedura raccomandata dai sostenitori di questo approccio per descrivere le associazioni tra variabili.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../../figures/mcelreath_golem.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Esempio di albero decisionale per la selezione di una procedura statistica appropriata. Iniziando dall’alto, l’utente risponde a una serie di domande riguardanti la misurazione e l’intento, arrivando infine al nome di una procedura. Sono possibili molti alberi decisionali simili. (Figura tratta da @McElreath_rethinking)."><img src="../../figures/mcelreath_golem.png" class="img-fluid figure-img" style="width:95.0%" alt="Esempio di albero decisionale per la selezione di una procedura statistica appropriata. Iniziando dall’alto, l’utente risponde a una serie di domande riguardanti la misurazione e l’intento, arrivando infine al nome di una procedura. Sono possibili molti alberi decisionali simili. (Figura tratta da McElreath (2020))."></a></p>
<figcaption><strong>Esempio di albero decisionale per la selezione di una procedura statistica appropriata.</strong> Iniziando dall’alto, l’utente risponde a una serie di domande riguardanti la misurazione e l’intento, arrivando infine al nome di una procedura. Sono possibili molti alberi decisionali simili. (Figura tratta da <span class="citation" data-cites="McElreath_rethinking">McElreath (<a href="#ref-McElreath_rethinking" role="doc-biblioref">2020</a>)</span>).</figcaption>
</figure>
</div>
<p>È importante notare come tale procedura non fornisca strumenti utili per identificare le effettive cause sottostanti ai fenomeni osservati. Questa limitazione metodologica è stata identificata come uno dei fattori principali che hanno contribuito alla <strong>crisi di replicabilità</strong> nella ricerca psicologica, come approfondito nel <a href="../replication_crisis/01_crisis.html" class="quarto-xref"><span>Capitolo 87</span></a>. L’approccio descritto sopra, pur essendo potente nell’individuare correlazioni, manca della “saggezza” necessaria per distinguere tra semplici associazioni e vere relazioni causali, analogamente ai Golem della metafora di McElreath.</p>
<p>Un problema evidenziato da <span class="citation" data-cites="McElreath_rethinking">McElreath (<a href="#ref-McElreath_rethinking" role="doc-biblioref">2020</a>)</span> è che processi causali completamente distinti possono generare la stessa distribuzione di risultati osservati. Pertanto, un approccio focalizzato esclusivamente sull’analisi delle associazioni mediante il test dell’ipotesi nulla non è in grado di distinguere tra questi diversi scenari.</p>
<p>L’approccio frequentista, che si limita a descrivere le associazioni tra le variabili, ha una scarsa capacità di rilevare le caratteristiche cruciali dei fenomeni studiati e tende a produrre un <strong>alto tasso di falsi positivi</strong> <span class="citation" data-cites="van2023new">(<a href="#ref-van2023new" role="doc-biblioref">Zwet et al., 2023</a>)</span>. È invece necessario utilizzare una metodologia che non si limiti a confutare ipotesi nulle, ma sia in grado di sviluppare modelli causali che rispondano direttamente alle domande di ricerca. In questo capitolo, ci concentreremo sull’introduzione dei concetti fondamentali dell’analisi causale.</p>
</section>
<section id="cosè-la-causalità" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="cosè-la-causalità"><span class="header-section-number">22.1</span> Cos’è la causalità?</h2>
<p><span class="citation" data-cites="hardt2022patterns">Hardt &amp; Recht (<a href="#ref-hardt2022patterns" role="doc-biblioref">2022</a>)</span> introducono il concetto di causalità distinguendo tra osservazione e azione. Ciò che vediamo nell’osservazione passiva è il modo in cui le persone seguono i loro comportamenti abituali, le loro inclinazioni naturali, proiettando lo stato del mondo su un insieme di caratteristiche che abbiamo scelto di evidenziare. Tuttavia, le domande più importanti spesso non riguardano semplici osservazioni.</p>
<ul>
<li>Non ci basta sapere che le persone che praticano regolarmente attività fisica soffrono meno d’ansia; vogliamo capire se l’attività fisica riduce effettivamente i livelli d’ansia.</li>
<li>Non ci accontentiamo di osservare che chi segue una terapia cognitivo-comportamentale (CBT) presenta meno sintomi depressivi; desideriamo verificare se la CBT riduce realmente questi sintomi.</li>
<li>Non ci limitiamo a constatare che l’uso frequente dei social media è associato a un calo del benessere mentale; vogliamo determinare se l’uso intensivo dei social media causa effettivamente una diminuzione del benessere mentale.</li>
</ul>
<p>Alla base, il ragionamento causale è un quadro concettuale per affrontare domande sugli <strong>effetti di azioni</strong> o interventi ipotetici. Una volta compreso quale sia l’effetto di un’azione, possiamo invertire la domanda e chiederci quale azione plausibile abbia causato un determinato evento.</p>
</section>
<section id="effetto-causale" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="effetto-causale"><span class="header-section-number">22.2</span> Effetto Causale</h2>
<p>La causalità è un concetto fondamentale in molte discipline, ma non esiste una definizione univoca universalmente accettata. Tuttavia, possiamo adottare una definizione operativa utile per l’analisi empirica.</p>
<div id="def-causalita" class="theorem definition">
<p><span class="theorem-title"><strong>Definizione 22.1</strong></span> Diciamo che <strong><span class="math inline">\(X\)</span> causa <span class="math inline">\(Y\)</span></strong> se, intervenendo e modificando il valore di <span class="math inline">\(X\)</span> (il trattamento), la distribuzione di <span class="math inline">\(Y\)</span> cambia di conseguenza.</p>
</div>
<p>Questa definizione enfatizza il ruolo centrale dell’<strong>intervento</strong> nel determinare una relazione causale. A differenza della correlazione, che si basa sull’osservazione passiva, la causalità implica un’azione attiva che modifica il sistema in esame.</p>
<section id="effetto-medio-del-trattamento" class="level3" data-number="22.2.1">
<h3 data-number="22.2.1" class="anchored" data-anchor-id="effetto-medio-del-trattamento"><span class="header-section-number">22.2.1</span> Effetto Medio del Trattamento</h3>
<p>Se <span class="math inline">\(X\)</span> è una variabile binaria, rappresentante la presenza (<span class="math inline">\(X=1\)</span>) o l’assenza (<span class="math inline">\(X=0\)</span>) del trattamento, l’effetto dell’intervento è misurato tramite l’<strong>effetto medio del trattamento</strong> (Average Treatment Effect, ATE):</p>
<p><span class="math display">\[ ATE = \mathbb{E}[Y \mid X=1] - \mathbb{E}[Y \mid X=0] .\]</span></p>
<p>Questo valore rappresenta quanto, in media, il trattamento modifica l’attesa di <span class="math inline">\(Y\)</span>. È essenziale notare che gli effetti causali sono definiti a livello di <strong>popolazione</strong> e possono variare tra individui o gruppi, dando origine a <strong>effetti di trattamento eterogenei</strong>.</p>
</section>
<section id="esempio-terapia-cognitivo-comportamentale-e-ansia" class="level3" data-number="22.2.2">
<h3 data-number="22.2.2" class="anchored" data-anchor-id="esempio-terapia-cognitivo-comportamentale-e-ansia"><span class="header-section-number">22.2.2</span> Esempio: Terapia Cognitivo-Comportamentale e Ansia</h3>
<p>Consideriamo un esempio concreto: supponiamo di voler studiare l’efficacia della terapia cognitivo-comportamentale (CBT) nella riduzione dell’ansia. Se un gruppo di persone ansiose non riceve alcun trattamento, il loro livello d’ansia rimarrà invariato in media. Se invece <strong>interveniamo</strong> introducendo la CBT (modificando <span class="math inline">\(X\)</span> da 0 a 1), il livello medio d’ansia nel gruppo tenderà a diminuire (modificando così la distribuzione di <span class="math inline">\(Y\)</span>).</p>
<p>Questo esempio chiarisce la distinzione tra <strong>correlazione</strong> e <strong>causalità</strong>:</p>
<ul>
<li>Se osserviamo che le persone che fanno CBT hanno meno ansia, potremmo erroneamente concludere che la CBT è efficace. Tuttavia, la riduzione dell’ansia potrebbe essere dovuta a fattori confondenti, come la maggiore motivazione delle persone che scelgono la terapia.</li>
<li>Solo un intervento controllato (ad esempio, un esperimento randomizzato in cui è presente un <strong>gruppo di controllo</strong>) permette di stabilire con certezza l’effetto causale della CBT.</li>
</ul>
</section>
<section id="causalità-diretta-e-indiretta" class="level3" data-number="22.2.3">
<h3 data-number="22.2.3" class="anchored" data-anchor-id="causalità-diretta-e-indiretta"><span class="header-section-number">22.2.3</span> Causalità Diretta e Indiretta</h3>
<p>In alcuni casi, un effetto causale può non essere <strong>diretto</strong>, ma manifestarsi attraverso un meccanismo intermedio. Ad esempio, l’<strong>autoefficacia</strong> potrebbe non influenzare direttamente le <strong>prestazioni accademiche</strong>, ma se un intervento aumenta l’autoefficacia, potremmo osservare un miglioramento nell’<strong>impegno allo studio</strong>, che a sua volta porta a migliori prestazioni. In questo caso, possiamo dire che l’autoefficacia ha un <strong>effetto causale indiretto</strong> sulle prestazioni accademiche.</p>
</section>
<section id="causalità-probabilistica" class="level3" data-number="22.2.4">
<h3 data-number="22.2.4" class="anchored" data-anchor-id="causalità-probabilistica"><span class="header-section-number">22.2.4</span> Causalità Probabilistica</h3>
<p>È importante sottolineare che una relazione causale tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> non implica necessariamente che ogni cambiamento in <span class="math inline">\(X\)</span> porti a un cambiamento immediato o deterministico in <span class="math inline">\(Y\)</span>. In molti contesti, specialmente in psicologia, le relazioni causali sono <strong>probabilistiche</strong>: l’intervento su <span class="math inline">\(X\)</span> altera la distribuzione di probabilità di <span class="math inline">\(Y\)</span>, senza garantire un esito certo per ogni individuo. Questo approccio probabilistico è cruciale per comprendere le dinamiche causali in sistemi complessi e multifattoriali.</p>
<p><strong>In sintesi</strong>, l’analisi causale è uno strumento essenziale per la ricerca empirica, permettendo di andare oltre la semplice correlazione e comprendere i meccanismi che regolano i fenomeni osservati. La chiave per stabilire una relazione causale solida risiede nella progettazione di esperimenti o nell’uso di metodi statistici avanzati per identificare e correggere i possibili bias derivanti da fattori confondenti.</p>
</section>
</section>
<section id="i-limiti-dellosservazione" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="i-limiti-dellosservazione"><span class="header-section-number">22.3</span> I Limiti dell’Osservazione</h2>
<p>Per comprendere i limiti dell’osservazione passiva e la necessità di indagare le relazioni causali sottostanti, <span class="citation" data-cites="hardt2022patterns">Hardt &amp; Recht (<a href="#ref-hardt2022patterns" role="doc-biblioref">2022</a>)</span> citano il celebre esempio delle ammissioni ai corsi di laurea dell’Università della California, Berkeley, nel 1973. In quell’anno, 12,763 candidati furono considerati per l’ammissione in uno dei 101 dipartimenti o major interdipartimentali. Di questi, 4,321 erano donne e 8,442 erano uomini. I dati aggregati mostrano che circa il 35% delle donne fu ammesso, rispetto al 44% degli uomini. Test statistici indicano che questa differenza non è attribuibile al caso, <strong>suggerendo una disparità nei tassi di ammissione tra i generi</strong>.</p>
<p>Un’analisi simile si osserva considerando le decisioni <strong>aggregate</strong> di ammissione nei sei principali dipartimenti di UC Berkeley. Il tasso di ammissione complessivo per gli uomini era del 44%, mentre per le donne solo del 30%, una differenza statisticamente credibile.</p>
<p>Tuttavia, poiché ogni dipartimento ha autonomia nelle decisioni di ammissione, è utile esaminare il possibile bias di genere <strong>a livello di singolo dipartimento</strong> (dati disaggregati).</p>
<section id="analisi-dei-dati-disaggregati" class="level3" data-number="22.3.1">
<h3 data-number="22.3.1" class="anchored" data-anchor-id="analisi-dei-dati-disaggregati"><span class="header-section-number">22.3.1</span> Analisi dei Dati Disaggregati</h3>
<p><strong>Uomini</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Dipartimento</th>
<th>Candidati</th>
<th>Ammessi (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>825</td>
<td>62</td>
</tr>
<tr class="even">
<td>B</td>
<td>520</td>
<td>60</td>
</tr>
<tr class="odd">
<td>C</td>
<td>325</td>
<td>37</td>
</tr>
<tr class="even">
<td>D</td>
<td>417</td>
<td>33</td>
</tr>
<tr class="odd">
<td>E</td>
<td>191</td>
<td>28</td>
</tr>
<tr class="even">
<td>F</td>
<td>373</td>
<td>6</td>
</tr>
</tbody>
</table>
<p><strong>Donne</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Dipartimento</th>
<th>Candidati</th>
<th>Ammessi (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>108</td>
<td>82</td>
</tr>
<tr class="even">
<td>B</td>
<td>25</td>
<td>68</td>
</tr>
<tr class="odd">
<td>C</td>
<td>593</td>
<td>34</td>
</tr>
<tr class="even">
<td>D</td>
<td>375</td>
<td>35</td>
</tr>
<tr class="odd">
<td>E</td>
<td>393</td>
<td>24</td>
</tr>
<tr class="even">
<td>F</td>
<td>341</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Dall’analisi dei dati disaggregati emerge che, tra i sei dipartimenti più grandi, <strong>quattro</strong> presentano un tasso di ammissione più alto per le <strong>donne</strong>, mentre <strong>due</strong> favoriscono gli <strong>uomini</strong>. Tuttavia, questi due dipartimenti da soli non possono spiegare la grande differenza nei tassi di ammissione osservata nei dati aggregati. Questo suggerisce che la tendenza generale di un <strong>tasso di ammissione più alto per gli uomini</strong> si <strong>inverte</strong> quando si analizzano i dati suddivisi per dipartimento.</p>
</section>
<section id="la-vera-ragione-della-differenza-nei-tassi-di-ammissione" class="level3" data-number="22.3.2">
<h3 data-number="22.3.2" class="anchored" data-anchor-id="la-vera-ragione-della-differenza-nei-tassi-di-ammissione"><span class="header-section-number">22.3.2</span> La Vera Ragione della Differenza nei Tassi di Ammissione</h3>
<p>L’analisi di questi dati suggerisce che l’apparente svantaggio per le donne <strong>non derivava da una discriminazione diretta nei criteri di selezione</strong>, ma piuttosto da una <strong>scelta differente dei corsi di studio</strong>. In generale, le donne tendevano a candidarsi per dipartimenti con un numero elevato di concorrenti e tassi di ammissione più bassi (come lettere o psicologia), mentre gli uomini erano più propensi a fare domanda per dipartimenti con tassi di accettazione più alti (come ingegneria o fisica).</p>
<p>Questa dinamica riflette <strong>differenze sistemiche e strutturali</strong> nei percorsi educativi e professionali, più che una discriminazione esplicita nei criteri di ammissione. Lo studio originale evidenzia che <strong>le donne erano spesso indirizzate, fin dalla scuola, verso campi di studio con meno finanziamenti, prospettive di carriera più limitate e tassi di completamento inferiori</strong>.</p>
<p>La vera forma di discriminazione, dunque, non risiedeva nelle politiche di ammissione di UC Berkeley, ma in una <strong>cultura che alimentava aspettative diverse in base al genere</strong>, influenzando le scelte accademiche e professionali delle donne sin dall’infanzia.</p>
</section>
<section id="perché-il-paradosso-di-simpson-inganna" class="level3" data-number="22.3.3">
<h3 data-number="22.3.3" class="anchored" data-anchor-id="perché-il-paradosso-di-simpson-inganna"><span class="header-section-number">22.3.3</span> Perché il Paradosso di Simpson Inganna?</h3>
<p>Il <strong>paradosso di Simpson</strong> (che si manifesta nei dati sulle ammissioni ai corsi di laurea dell’Università della California, Berkeley, nel 1973) mette in luce un errore comune: <strong>assumere che una tendenza osservata nei dati aggregati sia necessariamente valida a livello di sottogruppi</strong>. L’intuizione ci porta a credere che, se nel complesso le donne hanno un tasso di ammissione più basso, questo debba essere vero anche per ciascun dipartimento. In realtà, il paradosso dimostra che <strong>le statistiche aggregate possono essere fuorvianti</strong> se non si tiene conto della distribuzione interna dei dati.</p>
<p>Questo caso ci ricorda anche l’importanza di distinguere tra <strong>correlazione e causalità</strong>. Osservare un dato (meno donne ammesse) non implica automaticamente una causa (discriminazione diretta). Solo un’analisi più approfondita, che consideri le scelte individuali e le strutture socio-culturali di riferimento, può portare a conclusioni più accurate.</p>
<p><strong>In sintesi</strong>, i dati delle ammissioni a UC Berkeley <strong>non dimostrano necessariamente una discriminazione di genere diretta</strong>, ma sollevano questioni più ampie sulle differenze nei percorsi accademici di uomini e donne. Per comprendere realmente il fenomeno, servirebbero studi più approfonditi, capaci di analizzare le cause profonde di queste scelte educative. L’<strong>inferenza causale</strong> è uno strumento fondamentale in questo processo, poiché permette non solo di selezionare le variabili chiave da analizzare, ma anche di formulare spiegazioni più solide e plausibili.</p>
</section>
</section>
<section id="come-scoprire-le-relazioni-causali" class="level2" data-number="22.4">
<h2 data-number="22.4" class="anchored" data-anchor-id="come-scoprire-le-relazioni-causali"><span class="header-section-number">22.4</span> Come Scoprire le Relazioni Causali?</h2>
<p>Il metodo più rigoroso per identificare relazioni causali è rappresentato dagli <strong>studi randomizzati controllati</strong> (RCT, Randomized Controlled Trials). La randomizzazione, ovvero l’assegnazione casuale dei partecipanti ai gruppi di trattamento e controllo, assicura che l’influenza di eventuali <strong>variabili confondenti</strong> sia equamente distribuita tra i gruppi. Di conseguenza, se dopo l’intervento si osserva una differenza sistematica tra i gruppi, questa può essere attribuita con elevata probabilità all’effetto del <strong>trattamento</strong>, poiché tutte le altre fonti di variazione sono state bilanciate grazie alla randomizzazione.</p>
<p>Gli RCT sono considerati il <strong>gold standard</strong> per l’inferenza causale, ma presentano alcuni limiti. In molti casi, l’implementazione di un esperimento controllato è impossibile per <strong>vincoli etici o pratici</strong>. Ad esempio, non si può randomizzare l’esposizione a fattori di rischio nocivi o imporre determinate condizioni di vita ai partecipanti. Inoltre, le condizioni sperimentali sono spesso <strong>artificiali</strong>, il che pone un problema di <strong>validità esterna</strong>: i risultati ottenuti in un contesto controllato potrebbero non generalizzarsi a contesti reali.</p>
<p>Quando gli RCT non sono praticabili, i ricercatori ricorrono a <strong>disegni osservazionali</strong>, che offrono maggiore flessibilità e adattabilità ai contesti naturali. Tuttavia, il principale limite di questi studi è la difficoltà nell’<strong>identificazione causale</strong>, poiché l’assenza di randomizzazione espone i risultati al rischio di <strong>bias da confondimento</strong>. Per affrontare questa sfida, vengono adottate tecniche statistiche avanzate che permettono di avvicinarsi a stime causali più affidabili.</p>
<section id="variabili-confondenti" class="level3" data-number="22.4.1">
<h3 data-number="22.4.1" class="anchored" data-anchor-id="variabili-confondenti"><span class="header-section-number">22.4.1</span> Variabili Confondenti</h3>
<p>Le <strong>variabili confondenti</strong> rappresentano uno degli ostacoli principali nell’analisi causale. Una variabile confondente è un fattore che influenza sia la variabile indipendente (<span class="math inline">\(X\)</span>) sia la variabile dipendente (<span class="math inline">\(Y\)</span>), generando un’associazione spuria tra le due. In altre parole, la relazione osservata tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> potrebbe non riflettere un nesso causale diretto, ma essere il risultato dell’influenza esercitata da una terza variabile.</p>
<p>Negli studi osservazionali, se le variabili confondenti non vengono adeguatamente identificate e controllate, possono introdurre <strong>bias</strong> nelle stime degli effetti, portando a conclusioni errate. In assenza di un disegno sperimentale controllato, <strong>ciò che si osserva nei dati potrebbe non corrispondere a ciò che accadrebbe se si potesse manipolare direttamente <span class="math inline">\(X\)</span> in un esperimento randomizzato</strong>.</p>
</section>
<section id="approcci-per-il-controllo-delle-variabili-confondenti" class="level3" data-number="22.4.2">
<h3 data-number="22.4.2" class="anchored" data-anchor-id="approcci-per-il-controllo-delle-variabili-confondenti"><span class="header-section-number">22.4.2</span> Approcci per il Controllo delle Variabili Confondenti</h3>
<p>Per stabilire relazioni causali affidabili, è fondamentale distinguere gli effetti della variabile indipendente (<span class="math inline">\(X\)</span>) da quelli delle <strong>variabili confondenti</strong> (<span class="math inline">\(Z\)</span>), che potrebbero generare associazioni spurie. Se le variabili confondenti non vengono adeguatamente controllate, possono introdurre bias nelle stime degli effetti e compromettere la validità delle conclusioni tratte dai dati osservazionali. Esistono due approcci principali per affrontare questo problema:</p>
<ol type="1">
<li><strong>Controllo sperimentale</strong>: Questo metodo viene implementato attraverso il disegno dello studio e si basa sulla <strong>randomizzazione</strong>, che assicura una distribuzione casuale delle variabili confondenti tra il gruppo di trattamento e il gruppo di controllo. In questo modo, ogni differenza osservata tra i gruppi dopo il trattamento può essere attribuita con maggiore certezza all’intervento, poiché tutte le altre fonti di variazione sono bilanciate in media.</li>
<li><strong>Controllo statistico</strong>: Quando la randomizzazione non è possibile, è necessario applicare tecniche statistiche per correggere il bias da confondimento. Questo approccio mira a stimare l’effetto causale di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span> eliminando l’influenza di eventuali variabili confondenti attraverso modelli appropriati.</li>
</ol>
<section id="controllo-statistico-e-le-sue-sfide" class="level4" data-number="22.4.2.1">
<h4 data-number="22.4.2.1" class="anchored" data-anchor-id="controllo-statistico-e-le-sue-sfide"><span class="header-section-number">22.4.2.1</span> Controllo Statistico e le sue Sfide</h4>
<p>Uno dei metodi più comuni per il controllo statistico delle variabili confondenti è il <strong>condizionamento</strong> su <span class="math inline">\(Z\)</span>. Questo implica stimare l’effetto di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span> all’interno di ciascun livello della variabile confondente <span class="math inline">\(Z\)</span>, per poi calcolare una media ponderata dell’effetto su tutta la popolazione. Tuttavia, questo approccio presenta due sfide fondamentali:</p>
<ol type="1">
<li><strong>Identificazione delle variabili confondenti</strong>: È necessario conoscere e includere tutte le possibili variabili confondenti nel modello. Tuttavia, alcune potrebbero essere sconosciute o latenti, rendendo incompleto il controllo del confondimento.</li>
<li><strong>Accuratezza della misurazione</strong>: Anche quando le variabili confondenti sono note, la loro misurazione potrebbe essere imprecisa o soggetta a errori, compromettendo la validità dell’analisi e introducendo ulteriore bias.</li>
</ol>
<p>Per ovviare a questi problemi, vengono impiegate tecniche avanzate di controllo statistico, come:</p>
<ul>
<li><strong>Regressione multipla</strong>: Include le variabili confondenti come covariate in un modello di regressione per stimare l’effetto netto di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>.</li>
<li><strong>Propensity Score Matching (PSM)</strong>: Confronta individui con caratteristiche simili nei gruppi di trattamento e controllo, riducendo il bias da confondimento.</li>
<li><strong>Stratificazione</strong>: Suddivide il campione in sottogruppi omogenei rispetto alle variabili confondenti e stima l’effetto del trattamento all’interno di ciascun sottogruppo.</li>
</ul>
</section>
<section id="inferenza-causale-nei-dati-osservazionali" class="level4" data-number="22.4.2.2">
<h4 data-number="22.4.2.2" class="anchored" data-anchor-id="inferenza-causale-nei-dati-osservazionali"><span class="header-section-number">22.4.2.2</span> Inferenza Causale nei Dati Osservazionali</h4>
<p>L’assenza di randomizzazione negli studi osservazionali ha portato alla famosa affermazione <strong>“la correlazione non implica causalità”</strong>. Tuttavia, questo non significa che l’inferenza causale sia impossibile senza esperimenti controllati. Esistono metodi statistici che permettono di affrontare il problema del confondimento e avvicinarsi a stime causali più affidabili. Tra questi:</p>
<ul>
<li><strong>Grafi Aciclici Diretti (DAG)</strong>: Strumenti grafici che rappresentano le relazioni causali tra variabili e aiutano a identificare le variabili confondenti che devono essere controllate.</li>
<li><strong>Modelli Causali Strutturali (SCM)</strong>: Formalismi matematici che descrivono le relazioni causali e stabiliscono le condizioni necessarie per l’identificazione degli effetti.</li>
<li><strong>Differenze-differenze (DiD)</strong>: Metodo che confronta l’evoluzione di <span class="math inline">\(Y\)</span> prima e dopo il trattamento in gruppi esposti e non esposti, controllando per le tendenze temporali comuni.</li>
<li><strong>Variabili strumentali (IV)</strong>: Tecnica che utilizza una variabile esogena correlata con <span class="math inline">\(X\)</span> ma non direttamente con <span class="math inline">\(Y\)</span>, per isolare la parte di variazione di <span class="math inline">\(X\)</span> non influenzata da confondenti.</li>
<li><strong>Regressione discontinua (RD)</strong>: Metodo che sfrutta soglie arbitrarie per identificare effetti causali in situazioni quasi-sperimentali.</li>
</ul>
<p><strong>In sintesi</strong>, le variabili confondenti rappresentano una delle principali sfide nell’inferenza causale da dati osservazionali. Tuttavia, lo sviluppo di tecniche avanzate di analisi causale consente di ridurre il rischio di bias e migliorare l’affidabilità delle stime. Sebbene nessun metodo osservazionale possa replicare perfettamente i benefici della randomizzazione, l’utilizzo di strumenti come DAG, SCM e tecniche di identificazione causale permette di ottenere risultati più solidi e interpretabili. L’adozione di questi approcci è fondamentale per garantire che le conclusioni tratte dai dati osservazionali siano quanto più possibile accurate e prive di distorsioni.</p>
</section>
</section>
</section>
<section id="modelli-causali-strutturali" class="level2" data-number="22.5">
<h2 data-number="22.5" class="anchored" data-anchor-id="modelli-causali-strutturali"><span class="header-section-number">22.5</span> Modelli Causali Strutturali</h2>
<p>I <strong>modelli causali strutturali</strong> (<em>Structural Causal Models</em>, SCM) sono strumenti fondamentali per l’inferenza causale nei dati osservazionali. Essi permettono di rappresentare il processo generativo sottostante a un fenomeno e di prevedere gli effetti di un intervento. Oltre a descrivere le relazioni causali tra variabili, gli SCM consentono di esplorare scenari <strong>controfattuali</strong>, ovvero ipotetiche alternative a ciò che è stato osservato, offrendo un quadro formale per rispondere a domande del tipo <em>cosa sarebbe successo se…?</em></p>
<section id="struttura-di-un-modello-causale-strutturale" class="level3" data-number="22.5.1">
<h3 data-number="22.5.1" class="anchored" data-anchor-id="struttura-di-un-modello-causale-strutturale"><span class="header-section-number">22.5.1</span> Struttura di un Modello Causale Strutturale</h3>
<p>Un SCM è definito da un insieme di equazioni strutturali che descrivono come ciascuna variabile dipende causalmente dalle altre. Il modello è composto da:</p>
<ul>
<li><strong>Variabili esogene</strong>: Fonti di variazione esterne al sistema modellato, che non dipendono da nessuna altra variabile del modello.</li>
<li><strong>Variabili endogene</strong>: Determinate dalle equazioni del modello e influenzate da altre variabili all’interno dello stesso.</li>
<li><strong>Relazioni causali esplicite</strong>: Specificate attraverso funzioni matematiche che descrivono i meccanismi di generazione dei dati.</li>
</ul>
<p>Il processo di costruzione di un SCM segue una logica ben definita: si parte dalle variabili esogene e, attraverso una serie di assegnazioni, si generano le variabili endogene, costruendo progressivamente una distribuzione congiunta delle variabili osservate.</p>
</section>
<section id="vantaggi-degli-scm" class="level3" data-number="22.5.2">
<h3 data-number="22.5.2" class="anchored" data-anchor-id="vantaggi-degli-scm"><span class="header-section-number">22.5.2</span> Vantaggi degli SCM</h3>
<p>Uno degli aspetti distintivi degli SCM è la loro duplice funzione:</p>
<ol type="1">
<li><strong>Descrivono il processo generativo</strong> dei dati, rendendo esplicite le ipotesi sui meccanismi causali.</li>
<li><strong>Inducono una distribuzione probabilistica congiunta</strong>, consentendo l’analisi sia delle relazioni statistiche tra le variabili sia delle connessioni causali sottostanti.</li>
</ol>
<p>Questa struttura consente di superare i limiti dei modelli puramente correlazionali, offrendo un framework solido per distinguere tra causalità e semplice associazione.</p>
</section>
<section id="rappresentazione-grafica-dag" class="level3" data-number="22.5.3">
<h3 data-number="22.5.3" class="anchored" data-anchor-id="rappresentazione-grafica-dag"><span class="header-section-number">22.5.3</span> Rappresentazione Grafica: DAG</h3>
<p>Gli SCM sono spesso rappresentati graficamente tramite <strong>Grafi Aciclici Diretti</strong> (<em>Directed Acyclic Graphs</em>, DAG). Un DAG è una rete di nodi (variabili) e archi direzionati che indicano relazioni causali. Questa rappresentazione:</p>
<ul>
<li>facilita l’individuazione delle variabili confondenti e dei percorsi di causalità indiretti;</li>
<li>aiuta a identificare strategie per il controllo del confondimento, come il criterio di separazione (<em>d-separation</em>);</li>
<li>permette di determinare se un effetto causale è identificabile o se è necessario raccogliere dati aggiuntivi.</li>
</ul>
<p><strong>In sintesi</strong>, gli SCM rappresentano un’evoluzione rispetto ai modelli statistici tradizionali, poiché incorporano esplicitamente informazioni sulle relazioni causali. L’uso combinato di equazioni strutturali e rappresentazioni grafiche tramite DAG consente di affrontare problemi di confondimento, identificare effetti causali e analizzare scenari controfattuali con maggiore rigore rispetto a modelli puramente correlazionali.</p>
<p>L’adozione di SCM è particolarmente utile nei dati osservazionali, dove la mancanza di randomizzazione rende necessaria una modellazione esplicita delle relazioni causali per ottenere inferenze affidabili.</p>
</section>
</section>
<section id="bias-da-variabile-omessa" class="level2" data-number="22.6">
<h2 data-number="22.6" class="anchored" data-anchor-id="bias-da-variabile-omessa"><span class="header-section-number">22.6</span> Bias da Variabile Omessa</h2>
<p>L’<strong>omissione di variabili confondenti</strong> rappresenta una delle principali fonti di distorsione nelle stime statistiche. Il <em>bias da variabile omessa</em> [<em>Omitted Variable Bias</em>, OVB; <span class="citation" data-cites="wilms2021omitted">Wilms et al. (<a href="#ref-wilms2021omitted" role="doc-biblioref">2021</a>)</span>] si verifica quando una variabile confondente, nota ma non misurata, o sconosciuta, viene esclusa dall’analisi, alterando la stima dell’effetto causale. Come evidenziato da <span class="citation" data-cites="byrnes2024causal">Byrnes &amp; Dee (<a href="#ref-byrnes2024causal" role="doc-biblioref">2024</a>)</span>, l’OVB può portare a stime distorte della magnitudine degli effetti, inversioni del segno delle stime, correlazioni spurie e al mascheramento di reali relazioni causali.</p>
<p>Un’illustrazione di questa problematica è mostrata nella <a href="#fig-byrnes-dee-1" class="quarto-xref">Figura&nbsp;<span>22.1</span></a>, che rappresenta tre scenari diversi in cui una variabile non osservata (<span class="math inline">\(U\)</span>) può influenzare un modello causale:</p>
<ul>
<li><strong>Pannello di sinistra</strong>: La variabile non osservata <span class="math inline">\(U\)</span> non è correlata con la variabile indipendente <span class="math inline">\(X\)</span>, quindi la sua omissione non introduce bias nella stima dell’effetto di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>, ma può ridurre la precisione del modello aumentando l’errore standard della stima.</li>
<li><strong>Pannello centrale</strong>: La variabile non osservata <span class="math inline">\(U\)</span> è una variabile confondente, poiché influenza sia <span class="math inline">\(X\)</span> che <span class="math inline">\(Y\)</span>. La sua omissione causa bias nella stima dell’effetto di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>, alterando le conclusioni causali.</li>
<li><strong>Pannello di destra</strong>: <span class="math inline">\(U\)</span> e <span class="math inline">\(X\)</span> sono entrambi influenzati da un fattore comune <span class="math inline">\(Z\)</span>, generando un <strong>confondimento indiretto</strong>. In questo caso, omettere <span class="math inline">\(U\)</span> introduce distorsione nella stima dell’effetto di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>.</li>
</ul>
<div id="fig-byrnes-dee-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-byrnes-dee-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../../figures/byrnes_dee_fig1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figura&nbsp;22.1: La figura mostra come l’omissione di una variabile confondente possa o meno introdurre bias nella stima dell’effetto di X su Y. Nel pannello di sinistra, X e U sono indipendenti, quindi la mancata inclusione di U non altera la stima dell’effetto di X su Y, ma riduce la precisione del modello. Nel pannello centrale, U influenza sia X che Y, generando un bias da variabile omessa. Nel pannello di destra, X e U sono correlati tramite un fattore comune Z, creando un confondimento indiretto. In entrambi questi ultimi casi, il controllo delle variabili confondenti è essenziale per effettuare inferenze causali affidabili. La figura è ispirata da @byrnes2024causal."><img src="../../figures/byrnes_dee_fig1.png" class="img-fluid figure-img" style="width:80.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-byrnes-dee-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;22.1: La figura mostra come l’omissione di una variabile confondente possa o meno introdurre bias nella stima dell’effetto di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>. Nel <strong>pannello di sinistra</strong>, <span class="math inline">\(X\)</span> e <span class="math inline">\(U\)</span> sono indipendenti, quindi la mancata inclusione di <span class="math inline">\(U\)</span> non altera la stima dell’effetto di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>, ma riduce la precisione del modello. Nel <strong>pannello centrale</strong>, <span class="math inline">\(U\)</span> influenza sia <span class="math inline">\(X\)</span> che <span class="math inline">\(Y\)</span>, generando un bias da variabile omessa. Nel <strong>pannello di destra</strong>, <span class="math inline">\(X\)</span> e <span class="math inline">\(U\)</span> sono correlati tramite un fattore comune <span class="math inline">\(Z\)</span>, creando un confondimento indiretto. In entrambi questi ultimi casi, il controllo delle variabili confondenti è essenziale per effettuare inferenze causali affidabili. La figura è ispirata da <span class="citation" data-cites="byrnes2024causal">Byrnes &amp; Dee (<a href="#ref-byrnes2024causal" role="doc-biblioref">2024</a>)</span>.
</figcaption>
</figure>
</div>
<section id="superare-il-bias-da-variabile-omessa-con-gli-scm" class="level3" data-number="22.6.1">
<h3 data-number="22.6.1" class="anchored" data-anchor-id="superare-il-bias-da-variabile-omessa-con-gli-scm"><span class="header-section-number">22.6.1</span> Superare il Bias da Variabile Omessa con gli SCM</h3>
<p>Affrontare il bias da variabile omessa è una delle sfide principali nell’inferenza causale dai dati osservazionali. A differenza dell’errore di misurazione nelle variabili predittive, che tende a ridurre l’ampiezza delle stime senza necessariamente invertirne il segno <span class="citation" data-cites="McElreath_rethinking schennach2016recent">(<a href="#ref-McElreath_rethinking" role="doc-biblioref">McElreath, 2020</a>; <a href="#ref-schennach2016recent" role="doc-biblioref">Schennach, 2016</a>)</span>, il bias da variabile omessa può alterare in modo imprevedibile le stime, rendendole fuorvianti.</p>
<p>Nonostante queste difficoltà, i dati osservazionali possono comunque essere utilizzati per l’inferenza causale, a condizione che vengano applicate strategie adeguate. L’adozione dei <strong>modelli causali strutturali (SCM)</strong> consente di esplicitare il meccanismo generativo sottostante ai dati, permettendo di modellare le relazioni tra variabili e di controllare il confondimento in modo più rigoroso.</p>
</section>
<section id="il-ruolo-della-modellazione-esplicita" class="level3" data-number="22.6.2">
<h3 data-number="22.6.2" class="anchored" data-anchor-id="il-ruolo-della-modellazione-esplicita"><span class="header-section-number">22.6.2</span> Il Ruolo della Modellazione Esplicita</h3>
<p>L’uso degli SCM non elimina del tutto il problema delle variabili omesse, ma offre un quadro concettuale per affrontarlo. Questo approccio ha due vantaggi principali:</p>
<ol type="1">
<li><strong>Esplicitazione del modello generativo</strong>: Un SCM rende trasparente la struttura causale ipotizzata e permette di individuare le variabili mancanti che potrebbero influenzare le stime.</li>
<li><strong>Possibilità di affinamento progressivo</strong>: Ogni nuova evidenza empirica può essere utilizzata per migliorare il modello, testando ipotesi alternative e perfezionando la comprensione dei meccanismi causali sottostanti.</li>
</ol>
<p><strong>In sintesi</strong>, l’inferenza causale non può basarsi esclusivamente su correlazioni osservate tra variabili, poiché il confondimento dovuto a variabili omesse può distorcere le stime. L’utilizzo di modelli causali strutturali, supportati dall’analisi tramite DAG, consente di ridurre questi problemi e di formulare inferenze più affidabili. Sebbene nessun modello possa garantire conclusioni definitive, la costruzione di un quadro causale esplicito favorisce il progresso scientifico, permettendo di testare, correggere e affinare le ipotesi sui meccanismi che regolano i fenomeni psicologici.</p>
</section>
</section>
<section id="grafi-aciclici-diretti" class="level2" data-number="22.7">
<h2 data-number="22.7" class="anchored" data-anchor-id="grafi-aciclici-diretti"><span class="header-section-number">22.7</span> Grafi Aciclici Diretti</h2>
<p>I <strong>Grafi Aciclici Diretti</strong> (<em>Directed Acyclic Graphs</em>, DAG) sono strumenti fondamentali per rappresentare e analizzare relazioni causali. Offrono una rappresentazione visiva chiara delle ipotesi sui meccanismi causali e aiutano a identificare le variabili confondenti da controllare per ottenere stime causali affidabili.</p>
<p>Un <strong>DAG</strong> è un grafo in cui:</p>
<ul>
<li>i <strong>nodi</strong> rappresentano le variabili coinvolte nel fenomeno studiato;</li>
<li>le <strong>frecce direzionate</strong> tra i nodi indicano relazioni causali;</li>
<li>il grafo è <strong>aciclico</strong>, il che significa che non si possono formare cicli: non esiste un percorso chiuso che permetta di tornare a un nodo di partenza seguendo le frecce.</li>
</ul>
<section id="terminologia-nei-dag" class="level3" data-number="22.7.1">
<h3 data-number="22.7.1" class="anchored" data-anchor-id="terminologia-nei-dag"><span class="header-section-number">22.7.1</span> Terminologia nei DAG</h3>
<ul>
<li>Un nodo <span class="math inline">\(X\)</span> con una freccia diretta verso un altro nodo <span class="math inline">\(Y\)</span> indica che <strong><span class="math inline">\(X\)</span> causa <span class="math inline">\(Y\)</span></strong>.</li>
<li>Il nodo che origina una freccia è detto <strong>genitore</strong>, mentre quello di destinazione è detto <strong>figlio</strong>.</li>
<li>Se esiste un percorso tra un nodo <span class="math inline">\(A\)</span> e un nodo <span class="math inline">\(B\)</span>, <span class="math inline">\(A\)</span> è detto <strong>antenato</strong> di <span class="math inline">\(B\)</span>, e <span class="math inline">\(B\)</span> è un <strong>discendente</strong> di <span class="math inline">\(A\)</span>.</li>
</ul>
<p>Questa struttura permette di distinguere tra <strong>cause dirette e indirette</strong>: una causa diretta è un nodo genitore, mentre una causa indiretta è un qualsiasi antenato lungo un percorso nel grafo.</p>
<p>I DAG sono particolarmente utili per l’<strong>identificazione delle variabili confondenti</strong> e per stabilire quali variabili devono essere controllate per ottenere inferenze causali non distorte.</p>
</section>
<section id="la-d-separazione" class="level3" data-number="22.7.2">
<h3 data-number="22.7.2" class="anchored" data-anchor-id="la-d-separazione"><span class="header-section-number">22.7.2</span> La d-separazione</h3>
<p>La <strong>d-separazione</strong> è una regola che ci permette di capire se due variabili in un DAG sono <strong>indipendenti</strong> una volta che si è controllato per un insieme di altre variabili. In termini semplici, ci aiuta a rispondere alla domanda: <em>possiamo dire che due variabili non sono collegate dopo aver considerato certe informazioni?</em></p>
<p>Immaginiamo un DAG come un sistema di <strong>percorsi attraverso cui scorre l’informazione</strong>. Se due variabili sono collegate da un percorso aperto, significa che possono influenzarsi a vicenda, direttamente o indirettamente. Se invece il percorso è bloccato, l’informazione non può passare e possiamo considerarle indipendenti. La d-separazione ci indica quando un percorso è aperto e quando è bloccato.</p>
<p>Per determinare se due variabili sono indipendenti, si deve controllare il percorso che le collega nel DAG e verificare se ci sono <strong>ostacoli</strong> che ne impediscono il flusso informativo. Un percorso può essere bloccato in tre modi principali:</p>
<ol type="1">
<li><strong>Catena (<span class="math inline">\(X\)</span> → <span class="math inline">\(Z\)</span> → <span class="math inline">\(Y\)</span>)</strong>: Il nodo intermedio (<span class="math inline">\(Z\)</span>) è un <strong>mediatore</strong>. Se si controlla per <span class="math inline">\(Z\)</span>, il flusso di informazioni tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> viene interrotto, rendendole indipendenti.</li>
<li><strong>Fork (<span class="math inline">\(X\)</span> ← <span class="math inline">\(Z\)</span> → <span class="math inline">\(Y\)</span>)</strong>: <span class="math inline">\(Z\)</span> è una <strong>causa comune</strong> di <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>. Se si controlla per <span class="math inline">\(Z\)</span>, si elimina la correlazione spuria tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, bloccando il percorso.</li>
<li><strong>Collider (<span class="math inline">\(X\)</span> → <span class="math inline">\(Z\)</span> ← <span class="math inline">\(Y\)</span>)</strong>: <span class="math inline">\(Z\)</span> è un <strong>effetto comune</strong> di <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>. Se non si controlla per <span class="math inline">\(Z\)</span>, il percorso è già bloccato e <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> sono indipendenti. <strong>Attenzione!</strong> Controllare per <span class="math inline">\(Z\)</span> (o per una sua conseguenza) apre il percorso e introduce una correlazione spuria tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>.</li>
</ol>
<p>La d-separazione è cruciale perché ci permette di <strong>leggere direttamente dal DAG quali variabili dobbiamo controllare per ottenere inferenze causali affidabili</strong>, senza dover fare complessi calcoli probabilistici.</p>
</section>
<section id="il-criterio-del-back-door-e-la-d-separazione" class="level3" data-number="22.7.3">
<h3 data-number="22.7.3" class="anchored" data-anchor-id="il-criterio-del-back-door-e-la-d-separazione"><span class="header-section-number">22.7.3</span> Il Criterio del Back-Door e la d-separazione</h3>
<p>Il <strong>criterio del back-door</strong> è strettamente legato alla d-separazione e serve a identificare un insieme di variabili da controllare per ottenere una stima non distorta dell’effetto causale di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>.</p>
<p>Un <strong>back-door path</strong> è un percorso tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> che inizia con una freccia entrante in <span class="math inline">\(X\)</span>. Questo tipo di percorso rappresenta una <strong>fonte di confondimento</strong> che deve essere bloccata per stimare correttamente l’effetto causale di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>.</p>
<section id="come-bloccare-i-percorsi-back-door" class="level4" data-number="22.7.3.1">
<h4 data-number="22.7.3.1" class="anchored" data-anchor-id="come-bloccare-i-percorsi-back-door"><span class="header-section-number">22.7.3.1</span> Come bloccare i percorsi back-door</h4>
<ol type="1">
<li><strong>Se il percorso contiene una catena (<span class="math inline">\(X\)</span> ← <span class="math inline">\(A\)</span> → <span class="math inline">\(B\)</span> → <span class="math inline">\(Y\)</span>), si blocca condizionando su una delle variabili intermedie (<span class="math inline">\(A\)</span> o <span class="math inline">\(B\)</span>).</strong></li>
<li><strong>Se il percorso contiene un collider (<span class="math inline">\(X\)</span> → <span class="math inline">\(Z\)</span> ← <span class="math inline">\(Y\)</span>), il percorso è già bloccato e non bisogna condizionare su <span class="math inline">\(Z\)</span>.</strong></li>
<li><strong>Se il percorso contiene un fork (<span class="math inline">\(X\)</span> ← <span class="math inline">\(Z\)</span> → <span class="math inline">\(Y\)</span>), il percorso si blocca condizionando su <span class="math inline">\(Z\)</span>.</strong></li>
</ol>
</section>
</section>
<section id="relazione-tra-d-separazione-e-il-criterio-del-back-door" class="level3" data-number="22.7.4">
<h3 data-number="22.7.4" class="anchored" data-anchor-id="relazione-tra-d-separazione-e-il-criterio-del-back-door"><span class="header-section-number">22.7.4</span> Relazione tra d-separazione e il criterio del back-door</h3>
<p>La d-separazione ci permette di determinare se esiste un <strong>percorso aperto</strong> tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>. Se vogliamo stimare un effetto causale, dobbiamo assicurarci che tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> <strong>esista solo il percorso causale diretto</strong> e che tutti gli altri percorsi (in particolare i back-door paths) siano bloccati.</p>
<p>Quindi:</p>
<ul>
<li>se due variabili risultano <strong>d-separate dopo aver condizionato su un insieme di variabili di controllo</strong>, significa che ogni percorso non causale tra di esse è stato bloccato, permettendo un’interpretazione causale dell’effetto stimato;</li>
<li>se invece esistono percorsi back-door non bloccati, la stima dell’effetto causale sarà distorta a causa della presenza di confondimento.</li>
</ul>
<p><strong>In sintesi</strong>, l’uso dei <strong>DAG</strong> consente di visualizzare in modo chiaro le relazioni causali tra le variabili e di determinare quali percorsi devono essere chiusi per ottenere inferenze non distorte. Strumenti come la <strong>d-separazione</strong> e il <strong>criterio del back-door</strong> permettono di evitare errori comuni nell’analisi causale e di migliorare la validità delle stime statistiche. L’adozione di questi metodi è essenziale per garantire che le conclusioni tratte dai dati osservazionali siano affidabili e prive di bias.</p>
</section>
<section id="applicazioni" class="level3" data-number="22.7.5">
<h3 data-number="22.7.5" class="anchored" data-anchor-id="applicazioni"><span class="header-section-number">22.7.5</span> Applicazioni</h3>
<p>Consideriamo la struttura causale illustrata nella <a href="#fig-byrnes-dee-1" class="quarto-xref">Figura&nbsp;<span>22.1</span></a>, pannello centrale. Dopo aver costruito un <strong>DAG</strong> come descritto nella sezione precedente, possiamo identificare le possibili fonti di bias da variabili omesse, incluse quelle <strong>non misurate</strong> (ad esempio, <span class="math inline">\(U\)</span>). Se una variabile confondente non viene inclusa nell’analisi, si apre un <strong>back-door path</strong>, permettendo alla variazione confondente di influenzare la relazione tra la variabile causale e la variabile di risposta attraverso un percorso non controllato <span class="citation" data-cites="pearl2009causality">(<a href="#ref-pearl2009causality" role="doc-biblioref">Pearl, 2009</a>)</span>.</p>
<p>In altre parole, omettere una variabile confondente come <span class="math inline">\(U\)</span> nella <a href="#fig-byrnes-dee-1" class="quarto-xref">Figura&nbsp;<span>22.1</span></a> (pannello centrale) implica che la sua influenza venga incorporata nel termine di errore del modello statistico, insieme ad altre fonti di errore casuali. Questo può distorcere la stima dell’effetto causale di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>.</p>
<p>La <a href="#fig-byrnes-dee-2" class="quarto-xref">Figura&nbsp;<span>22.2</span></a> illustra le conseguenze di un confondente <span class="math inline">\(U\)</span> che ha un effetto positivo su <span class="math inline">\(X\)</span> ma un effetto negativo su <span class="math inline">\(Y\)</span>:</p>
<ul>
<li><strong>Se controlliamo per <span class="math inline">\(U\)</span></strong>, come mostrato nella <a href="#fig-byrnes-dee-2" class="quarto-xref">Figura&nbsp;<span>22.2</span></a> (Bi), l’effetto stimato di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span> riflette la relazione causale effettiva.</li>
<li><strong>Se non controlliamo per <span class="math inline">\(U\)</span></strong>, come mostrato nella <a href="#fig-byrnes-dee-2" class="quarto-xref">Figura&nbsp;<span>22.2</span></a> (Bii), <span class="math inline">\(U\)</span> viene inglobato nel termine di errore, creando una correlazione spuriosa tra l’errore e <span class="math inline">\(X\)</span> (<a href="#fig-byrnes-dee-2" class="quarto-xref">Figura&nbsp;<span>22.2</span></a>, Biii). Questo induce una stima distorta dell’effetto di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>, evidenziata in blu.</li>
</ul>
<p>L’omissione di una variabile indipendente che è correlata con altre variabili indipendenti nel modello e che ha un effetto diretto su <span class="math inline">\(Y\)</span> costituisce un <strong>errore di specificazione</strong>. Nei modelli lineari, questa omissione <strong>viola un’ipotesi fondamentale del teorema di Gauss-Markov</strong>, secondo cui il termine di errore deve essere incorrelato con le variabili esplicative. Di conseguenza, la stima dell’effetto causale di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span> risulta distorta, compromettendo l’affidabilità dell’analisi.</p>
<div id="fig-byrnes-dee-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-byrnes-dee-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="../../figures/fig-byrnes-dee-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figura&nbsp;22.2: Una visualizzazione del bias da variabile omessa e delle conseguenze per l’inferenza causale. (A) mostra un DAG di un sistema in cui X ha un effetto positivo su Y, e una variabile confondente U ha un effetto positivo su Y ma un effetto negativo su X. Le variabili non osservate (cioè non misurate) sono rappresentate in ellissi, come la variabile U e il termine di errore e nel pannello B. (B) illustra diverse stime del DAG in (A) utilizzando un’analisi del percorso. Vedi BoX 1 per una breve spiegazione delle principali differenze tra DAG e diagrammi dei percorsi. Presumiamo che U non sia misurata. In (Bi), presumiamo di poter misurare e controllare U, rappresentata dalla freccia a doppia testa tra U e X, che rappresenta la correlazione tra le due variabili considerata dal modello. La variabile non misurata e è la fonte residua di variazione che si presume non sia correlata con nessun predittore. La freccia rossa rappresenta il percorso stimato. Al contrario, (Bii) e (Biii) rappresentano la realtà, dove non abbiamo una misurazione di U e non la controlliamo nel modello dei percorsi. Il ricercatore pensa di adattare il modello in (Bii) ma in realtà sta adattando il modello in (Biii), dove il termine di errore non è solo e, ma la somma di e e la variazione dovuta alla variabile omessa U. A causa di ciò, c’è un percorso diretto dal termine di errore del modello a X (e quindi X è endogeno). (C) mostra le relazioni stimate risultanti dai modelli in (Bi) rispetto a (Bii). Le linee rappresentano la relazione stimata tra X e Y dai rispettivi modelli. La linea rossa è la vera relazione causale, stimata da (Bi), mentre la linea blu contiene il bias da variabile omessa, poiché non si tiene conto della variabile confondente U, come stimato dal modello in Bii/Biii (Figura tratta da @byrnes2024causal)."><img src="../../figures/fig-byrnes-dee-2.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-byrnes-dee-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;22.2: <strong>Una visualizzazione del bias da variabile omessa e delle conseguenze per l’inferenza causale.</strong> (A) mostra un DAG di un sistema in cui <span class="math inline">\(X\)</span> ha un effetto positivo su <span class="math inline">\(Y\)</span>, e una variabile confondente U ha un effetto positivo su <span class="math inline">\(Y\)</span> ma un effetto negativo su <span class="math inline">\(X\)</span>. Le variabili non osservate (cioè non misurate) sono rappresentate in ellissi, come la variabile U e il termine di errore e nel pannello B. (B) illustra diverse stime del DAG in (A) utilizzando un’analisi del percorso. Vedi Bo<span class="math inline">\(X\)</span> 1 per una breve spiegazione delle principali differenze tra DAG e diagrammi dei percorsi. Presumiamo che U non sia misurata. In (Bi), presumiamo di poter misurare e controllare U, rappresentata dalla freccia a doppia testa tra U e <span class="math inline">\(X\)</span>, che rappresenta la correlazione tra le due variabili considerata dal modello. La variabile non misurata e è la fonte residua di variazione che si presume non sia correlata con nessun predittore. La freccia rossa rappresenta il percorso stimato. Al contrario, (Bii) e (Biii) rappresentano la realtà, dove non abbiamo una misurazione di U e non la controlliamo nel modello dei percorsi. Il ricercatore pensa di adattare il modello in (Bii) ma in realtà sta adattando il modello in (Biii), dove il termine di errore non è solo e, ma la somma di e e la variazione dovuta alla variabile omessa U. A causa di ciò, c’è un percorso diretto dal termine di errore del modello a <span class="math inline">\(X\)</span> (e quindi <span class="math inline">\(X\)</span> è endogeno). (C) mostra le relazioni stimate risultanti dai modelli in (Bi) rispetto a (Bii). Le linee rappresentano la relazione stimata tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> dai rispettivi modelli. La linea rossa è la vera relazione causale, stimata da (Bi), mentre la linea blu contiene il bias da variabile omessa, poiché non si tiene conto della variabile confondente U, come stimato dal modello in Bii/Biii (Figura tratta da <span class="citation" data-cites="byrnes2024causal">Byrnes &amp; Dee (<a href="#ref-byrnes2024causal" role="doc-biblioref">2024</a>)</span>).
</figcaption>
</figure>
</div>
</section>
</section>
<section id="le-pratiche-scientifiche-per-inferire-la-causalità" class="level2" data-number="22.8">
<h2 data-number="22.8" class="anchored" data-anchor-id="le-pratiche-scientifiche-per-inferire-la-causalità"><span class="header-section-number">22.8</span> Le Pratiche Scientifiche per Inferire la Causalità</h2>
<p>In qualsiasi sistema complesso, possiamo osservare la distribuzione congiunta di due variabili, <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, ma determinare se <span class="math inline">\(X\)</span> causa <span class="math inline">\(Y\)</span>, se <span class="math inline">\(Y\)</span> causa <span class="math inline">\(X\)</span>, o se una terza variabile <span class="math inline">\(Z\)</span> influenza entrambe, è un problema complesso (Salmon, 1984). Questa difficoltà è alla base del dibattito filosofico sulla causalità e ha stimolato lo sviluppo di metodi scientifici rigorosi per decifrare i meccanismi causali. Ad esempio, per stabilire se la terapia cognitivo-comportamentale (CBT) riduce i sintomi di ansia o se l’attivazione di un neurone influenza il comportamento, è necessario adottare pratiche scientifiche che distinguano la correlazione dalla causalità.</p>
<section id="il-framework-interventista-di-judea-pearl" class="level3" data-number="22.8.1">
<h3 data-number="22.8.1" class="anchored" data-anchor-id="il-framework-interventista-di-judea-pearl"><span class="header-section-number">22.8.1</span> Il Framework Interventista di Judea Pearl</h3>
<p>Il lavoro di Judea Pearl ha rivoluzionato la formalizzazione dell’inferenza causale introducendo l’operatore <em>“do”</em>, che distingue tra correlazione osservata e causalità determinata da un <strong>intervento attivo</strong> <span class="citation" data-cites="hardt2022patterns">(ricordiamo il punto di vista di <a href="#ref-hardt2022patterns" role="doc-biblioref">Hardt &amp; Recht, 2022</a> descritto in precedenza)</span>. La probabilità condizionale tradizionale, <span class="math inline">\(p(Y \mid X)\)</span>, descrive l’associazione tra due variabili, ma non implica necessariamente causalità. L’operatore <em>do</em>, invece, introduce il concetto di intervento forzato: <span class="math inline">\(p(Y \mid do(X))\)</span> rappresenta la probabilità di <span class="math inline">\(Y\)</span> quando <span class="math inline">\(X\)</span> viene manipolato direttamente <span class="citation" data-cites="pearl2009causality">(<a href="#ref-pearl2009causality" role="doc-biblioref">Pearl, 2009</a>)</span>.</p>
<p>Ad esempio, osservare che i pazienti che partecipano alla CBT tendono a mostrare una riduzione dell’ansia non è sufficiente per concludere che la CBT ne sia la causa. Il problema è che la decisione di seguire la CBT potrebbe dipendere da fattori come il livello di gravità dell’ansia, lo stato socioeconomico o la predisposizione genetica, che possono influenzare sia la scelta di intraprendere la terapia sia la variazione nei sintomi.</p>
<p>Utilizzando un modello causale strutturale (SCM) completo, possiamo esprimere formalmente le relazioni tra le variabili e determinare se l’effetto di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span> può essere identificato, ovvero stimato correttamente dai dati. L’operatore <em>do</em> ci consente di rispondere alla domanda: “Cosa accadrebbe se tutti i pazienti seguissero la CBT indipendentemente da altri fattori?”. In pratica, uno SCM ben specificato permette di controllare statisticamente le variabili di disturbo e di rimuovere i percorsi di confondimento, simulando una condizione sperimentale in cui l’assegnazione al trattamento è indipendente da fattori che influenzano sia la terapia sia l’outcome.</p>
<p>Questa capacità di simulare interventi e stimare effetti causali è ciò che distingue i modelli causali strutturali dagli approcci puramente correlazionali e permette di ottenere inferenze più affidabili <strong>anche in assenza di esperimenti randomizzati</strong>.</p>
</section>
<section id="tre-fonti-di-conoscenza-causale" class="level3" data-number="22.8.2">
<h3 data-number="22.8.2" class="anchored" data-anchor-id="tre-fonti-di-conoscenza-causale"><span class="header-section-number">22.8.2</span> Tre Fonti di Conoscenza Causale</h3>
<p>Alla luce delle considerazioni precedenti, possiamo individuare tre fonti fondamentali per inferire la causalità.</p>
<ol type="1">
<li><p><strong>Esperimenti Randomizzati Controllati (RCT).</strong> Gli RCT rappresentano il metodo più affidabile per stabilire relazioni causali, assegnando casualmente i partecipanti a gruppi di trattamento e controllo. Questo processo minimizza l’influenza di confondenti e garantisce stime non distorte dell’effetto di un intervento. Ad esempio, per verificare se il sonno migliora la memoria, possiamo assegnare casualmente alcuni volontari a dormire 8 ore e altri a restare svegli prima di un test cognitivo. Questo approccio elimina l’influenza di fattori come l’età o il livello di stress, consentendo di attribuire le differenze di performance esclusivamente alla quantità di sonno.</p></li>
<li><p><strong>Conoscenza Specifica del Dominio.</strong> In discipline come la psicologia e le neuroscienze, la conoscenza specialistica permette di formulare ipotesi causali informate. Ad esempio, sebbene un semplice movimento della mano non causi direttamente l’accensione di una luce, sappiamo che chiudere un interruttore completa un circuito elettrico. Questa comprensione ci guida nella progettazione di esperimenti e nell’interpretazione dei risultati. Un esempio in neuroscienze è il ruolo dell’amigdala nella risposta alla paura. Studi su pazienti con danni all’amigdala mostrano una ridotta capacità di riconoscere espressioni di paura, suggerendo un legame causale tra l’attività dell’amigdala e la regolazione della paura. Allo stesso modo, la scoperta dell’afasia di Broca ha dimostrato il ruolo causale dell’area di Broca nella produzione del linguaggio. Questa conoscenza permette di formulare ipotesi precise anche in assenza di RCT, come nel caso di studi clinici su pazienti con condizioni neurologiche rare.</p></li>
<li><p><strong>Prove Cumulative e Consenso Scientifico.</strong> La conoscenza scientifica avanza attraverso la validazione collettiva dei risultati. Quando numerosi studi indipendenti convergono su una relazione causale, la comunità scientifica acquisisce una comprensione più solida del fenomeno. Ad esempio, molteplici studi indicano che relazioni sociali positive aumentano il benessere psicologico. Anche se nessuno studio singolo può offrire una prova definitiva, la convergenza di evidenze rafforza l’ipotesi causale.</p></li>
</ol>
<p>Si noti che, mentre nel primo caso l’inferenza causale deriva direttamente da esperimenti randomizzati controllati (RCT), nei secondi due la conoscenza causale si basa su studi osservazionali e sulla convergenza di evidenze empiriche. La validità di queste inferenze dipende dall’uso di modelli adeguati, dal controllo delle variabili confondenti e dalla replicabilità dei risultati.</p>
</section>
</section>
<section id="conciliare-pragmatismo-con-scetticismo-filosofico" class="level2" data-number="22.9">
<h2 data-number="22.9" class="anchored" data-anchor-id="conciliare-pragmatismo-con-scetticismo-filosofico"><span class="header-section-number">22.9</span> Conciliare Pragmatismo con Scetticismo Filosofico</h2>
<p>Nonostante l’efficacia degli RCT e degli strumenti teorici come l’operatore <em>do</em>, il problema epistemologico della causalità, sollevato da filosofi come Hume, rimane aperto. Hume sosteneva che la causalità non è direttamente osservabile, ma è inferita dall’esperienza e dalla regolarità delle osservazioni. Questo scetticismo ci ricorda che la nostra comprensione causale è sempre mediata da modelli, assunzioni e interpretazioni.</p>
<p>Tuttavia, l’approccio pragmatico alla causalità non richiede una dimostrazione metafisica assoluta, ma si concentra sulla sua utilità pratica: se un intervento produce risultati coerenti e prevedibili, allora possiamo considerarlo una causa per tutti gli scopi pratici.</p>
<p>Ad esempio, la nostra fiducia nel volo aereo non deriva da una prova definitiva della causalità tra il design di un aereo e la sua capacità di volare, ma dall’affidabilità e replicabilità delle leggi dell’aerodinamica. Analogamente, la CBT è riconosciuta come trattamento efficace per l’ansia non perché possiamo dimostrare una causalità assoluta, ma perché numerosi studi, tra cui RCT e analisi basate su modelli causali, ne confermano ripetutamente l’efficacia in diversi contesti.</p>
<p><strong>In sintesi</strong>, l’inferenza causale è una delle sfide centrali della scienza, ma strumenti come gli RCT, i modelli causali strutturali, la conoscenza del dominio e le prove cumulative forniscono metodi robusti per affrontarla. L’approccio pragmatico ci consente di superare il problema filosofico della causalità, concentrandoci sulla replicabilità, sull’affidabilità e sull’applicabilità pratica dei risultati. Sebbene il dibattito sulla natura ultima della causalità rimanga aperto, le pratiche scientifiche ci permettono di prendere decisioni informate e mettere in atti interventi efficaci.</p>
</section>
<section id="riflessioni-conclusive" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="riflessioni-conclusive">Riflessioni conclusive</h2>
<p>Il dibattito filosofico sulla causalità resta aperto, ma i progressi metodologici degli ultimi decenni hanno trasformato l’inferenza causale in una disciplina rigorosa e applicabile. L’uso di esperimenti randomizzati controllati (RCT), diagrammi causali (DAG) e l’operatore <em>do</em> di Judea Pearl ha reso possibile analizzare le relazioni causali in modo più trasparente e sistematico, senza dover risolvere le questioni metafisiche sulla natura ultima della causalità. La scienza, dunque, procede non con certezze assolute, ma con modelli sempre più raffinati e verificabili.</p>
<p>I DAG si sono affermati come strumenti essenziali per visualizzare e analizzare i rapporti causali, permettendo di esplicitare le assunzioni e di individuare le fonti di bias. Tuttavia, la loro validità dipende strettamente dalla qualità delle conoscenze del dominio: un DAG ben costruito può guidare verso inferenze affidabili, ma un DAG con specificazioni errate o incomplete rischia di produrre conclusioni distorte. Per questa ragione, la loro applicazione richiede non solo competenza metodologica, ma anche un solido ancoraggio alla realtà empirica.</p>
<p>L’approccio pragmatico alla causalità si fonda su un equilibrio tra fiducia nei modelli empirici e consapevolezza dei loro limiti. La nostra capacità di fare previsioni e intervenire sui fenomeni — dall’ingegneria aeronautica all’efficacia delle terapie psicologiche — non si basa su una conoscenza definitiva della causalità, ma sulla robustezza delle evidenze accumulate. Questo pragmatismo non è una debolezza, ma una strategia vincente per affrontare l’incertezza in modo efficace e produttivo.</p>
<p>Tuttavia, la solidità degli strumenti causali non è garantita a priori: la qualità delle inferenze dipende dalla cura con cui vengono costruiti e validati. Un uso acritico dei DAG, degli RCT o dei modelli causali strutturali può portare a interpretazioni fuorvianti, specialmente se si ignorano le limitazioni insite in ogni approccio. La ricerca causale, dunque, non è solo una questione di strumenti, ma di metodo: richiede una costante <em>riflessione critica</em> sulle ipotesi sottostanti e un <em>rigoroso controllo empirico</em> per evitare semplificazioni eccessive.</p>
<p>In definitiva, il progresso nella comprensione della causalità dipende dalla capacità di bilanciare <em>pragmatismo</em> e <em>scetticismo epistemologico</em>. Da un lato, dobbiamo costruire modelli che ci permettano di fare previsioni affidabili e di prendere decisioni informate; dall’altro, dobbiamo riconoscere che ogni modello è una rappresentazione semplificata della realtà e che le nostre inferenze devono essere costantemente riviste alla luce di nuove evidenze. Accettare questa tensione tra conoscenza e incertezza non è una limitazione, ma una condizione essenziale per il progresso scientifico. In questo equilibrio tra umiltà teorica e fiducia operativa risiede la vera forza dell’indagine causale.</p>
<p>Un riassunto ironico di questi concetti è offerto dalla vignetta di <a href="https://www.e$X$plain$X$kcd.com/wiki/inde$X$.php/2560:_Confounding_Variables">xkcd</a>.</p>
</section>
<section id="esercizi" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="esercizi">Esercizi</h2>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Esercizio">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Esercizio
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Esercizi teorici</strong></p>
<p><strong>Esercizio 1: Concetti chiave della causalità</strong></p>
<p>Per ciascuna delle seguenti affermazioni, indica se è vera o falsa e spiega il motivo della tua risposta.</p>
<ol type="1">
<li>Se <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> sono correlate, allora <span class="math inline">\(X\)</span> causa <span class="math inline">\(Y\)</span>.<br>
</li>
<li>Se condizioniamo su una variabile collider, la correlazione tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> aumenta.<br>
</li>
<li>Il paradosso di Simpson dimostra che i risultati osservati in gruppi disaggregati devono sempre essere preferiti a quelli aggregati.<br>
</li>
<li>Gli esperimenti randomizzati controllati eliminano completamente il problema della confusione.<br>
</li>
<li>Un DAG può rappresentare relazioni causali solo se tutte le variabili sono misurate.</li>
</ol>
<p><strong>Esercizio 2: Interpretazione di un DAG</strong></p>
<p>Considera il seguente DAG che rappresenta l’effetto dell’esercizio fisico (<span class="math inline">\(X\)</span>) sulla salute cardiaca (<span class="math inline">\(Y\)</span>):</p>
<pre><code>    $X$ → $Y$
    Z → $X$
    Z → $Y$</code></pre>
<p>dove:</p>
<ul>
<li><span class="math inline">\(X\)</span> = Esercizio fisico<br>
</li>
<li><span class="math inline">\(Y\)</span> = Salute cardiaca<br>
</li>
<li><em><span class="math inline">\(Z\)</span></em> = Predisposizione genetica</li>
</ul>
<ol type="1">
<li>Quale ruolo svolge <em><span class="math inline">\(Z\)</span></em> in questo DAG? È una variabile confondente, collider o mediatore?</li>
<li>Per stimare correttamente l’effetto causale di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>, è necessario controllare per <em><span class="math inline">\(Z\)</span></em>? Spiega il perché.<br>
</li>
<li>Se aggiungiamo un’altra variabile <strong>W</strong> che influenza sia <em><span class="math inline">\(Z\)</span></em> che <span class="math inline">\(X\)</span>, ma non direttamente <span class="math inline">\(Y\)</span>, come cambierebbe il DAG?</li>
</ol>
<p><strong>Esercizio 3: Causalità nei dati osservazionali</strong></p>
<p>Leggi le seguenti situazioni e identifica quale problema potrebbe invalidare l’inferenza causale:</p>
<ol type="1">
<li>Uno studio osservazionale mostra che le persone che bevono caffè vivono più a lungo. Tuttavia, chi beve caffè tende ad avere un reddito più alto e accesso a migliori cure mediche.</li>
<li>Un’azienda scopre che i dipendenti che frequentano corsi di formazione hanno salari più alti. Ma i corsi sono aperti solo a coloro che già hanno più esperienza lavorativa.<br>
</li>
<li>Una ricerca mostra che gli studenti che usano di più il tablet per studiare hanno punteggi più bassi nei test. Tuttavia, gli studenti con difficoltà di apprendimento tendono a usare di più il tablet.</li>
</ol>
<p>Per ogni caso, identifica una possibile variabile confondente e suggerisci un metodo per controllare il bias.</p>
<p><strong>Esercizi pratici in R</strong></p>
<p><strong>Esercizio 4: Paradosso di Simpson con dati reali</strong></p>
<p>Utilizziamo i dati delle ammissioni di UC Berkele<span class="math inline">\(Y\)</span> per verificare il paradosso di Simpson.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dati di UC Berkele$Y$</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(UCBAdmissions)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(UCBAdmissions)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertiamo i dati in formato long</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> tid<span class="sc">$</span>Y<span class="sc">$</span>r<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Admit"</span>, <span class="at">values_from =</span> <span class="st">"Freq"</span>) </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcoliamo il tasso di ammissione per uomini e donne aggregati</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>total_admitted_m <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>Freq[df<span class="sc">$</span>Admit <span class="sc">==</span> <span class="st">"Admitted"</span> <span class="sc">&amp;</span> df<span class="sc">$</span>Gender <span class="sc">==</span> <span class="st">"Male"</span>])</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>total_applicants_m <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>Freq[df<span class="sc">$</span>Gender <span class="sc">==</span> <span class="st">"Male"</span>])</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>total_admitted_f <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>Freq[df<span class="sc">$</span>Admit <span class="sc">==</span> <span class="st">"Admitted"</span> <span class="sc">&amp;</span> df<span class="sc">$</span>Gender <span class="sc">==</span> <span class="st">"Female"</span>])</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>total_applicants_f <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>Freq[df<span class="sc">$</span>Gender <span class="sc">==</span> <span class="st">"Female"</span>])</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>admit_rate_m <span class="ot">&lt;-</span> total_admitted_m <span class="sc">/</span> total_applicants_m</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>admit_rate_f <span class="ot">&lt;-</span> total_admitted_f <span class="sc">/</span> total_applicants_f</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(admit_rate_m, admit_rate_f)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcoliamo il tasso di ammissione per ogni dipartimento</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>df_long<span class="sc">$</span>rate_m <span class="ot">&lt;-</span> df_long<span class="sc">$</span>Admitted <span class="sc">/</span> (df_long<span class="sc">$</span>Admitted <span class="sc">+</span> df_long<span class="sc">$</span>Rejected)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>df_long <span class="sc">|&gt;</span> dpl<span class="sc">$</span>Y<span class="sc">$</span>r<span class="sc">::</span>group_b<span class="sc">$</span>Y<span class="sc">$</span>(Dept) <span class="sc">|&gt;</span> dpl<span class="sc">$</span>Y<span class="sc">$</span>r<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean_rate_m =</span> <span class="fu">mean</span>(rate_m))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizziamo il tasso di ammissione per genere e dipartimento</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="sc">$</span>X<span class="sc">$</span> <span class="er">=</span> Dept, <span class="sc">$</span>Y<span class="sc">$</span> <span class="er">=</span> rate_m, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identit$Y$"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tasso di Ammissione per Genere nei Dipartimenti UC Berkele$Y$"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>       <span class="sc">$</span>X<span class="sc">$</span> <span class="er">=</span> <span class="st">"Dipartimento"</span>, <span class="sc">$</span>Y<span class="sc">$</span> <span class="er">=</span> <span class="st">"Tasso di Ammissione"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Domande:</strong></p>
<ol type="1">
<li>Dai dati aggregati, sembra che le donne siano discriminate. Questo è confermato dall’analisi per dipartimento?<br>
</li>
<li>Quale variabile confondente è responsabile del paradosso di Simpson in questo caso?<br>
</li>
<li>Come potrebbe essere interpretato male un modello che considera solo i dati aggregati?</li>
</ol>
<p><strong>Esercizio 5: Analisi causale con DAG</strong></p>
<p>Usiamo il pacchetto <code>dagitt$Y$</code> per costruire e analizzare un DAG.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>librar<span class="sc">$</span>Y<span class="sc">$</span>(dagitt<span class="sc">$</span>Y<span class="sc">$</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> dagitt<span class="sc">$</span>Y<span class="sc">$</span>(<span class="st">"dag {</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">    E -&gt; H</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">    G -&gt; E</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">    G -&gt; H</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">}"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(graphLa<span class="sc">$</span>Y<span class="sc">$</span><span class="fu">out</span>(dag))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Domande:</strong></p>
<ol type="1">
<li>Quali sono le variabili confondenti nel DAG?<br>
</li>
<li>Quali percorsi sono back-door paths?<br>
</li>
<li>Quale set di variabili dovremmo controllare per ottenere una stima non distorta dell’effetto di <strong>E</strong> su <strong>H</strong>?<br>
</li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Soluzione">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Soluzione
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Esercizio 1: Concetti chiave della causalità</strong></p>
<ol type="1">
<li><strong>Falso</strong> – La correlazione non implica causalità. Potrebbero esserci variabili confondenti o una relazione di causalità inversa tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>.<br>
</li>
<li><strong>Vero</strong> – Condizionare su un collider introduce un’associazione spuriosa tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, aumentando la correlazione.<br>
</li>
<li><strong>Falso</strong> – Il paradosso di Simpson mostra che i dati aggregati possono essere fuorvianti, ma non significa che i dati disaggregati siano sempre più affidabili. È necessario analizzare il contesto e le possibili variabili confondenti.<br>
</li>
<li><strong>Falso</strong> – Gli RCT minimizzano i problemi di confondimento grazie alla randomizzazione, ma possono comunque avere limitazioni dovute a bias di selezione, mancate assegnazioni casuali, e problemi etici.<br>
</li>
<li><strong>Falso</strong> – Un DAG può rappresentare le relazioni causali anche se alcune variabili non sono misurate. Tuttavia, la validità dell’inferenza dipende dalla correttezza del DAG.</li>
</ol>
<p><strong>Esercizio 2: Interpretazione di un DAG</strong></p>
<ol type="1">
<li><p><strong>Z è una variabile confondente</strong>, poiché influenza sia <span class="math inline">\(X\)</span> che <span class="math inline">\(Y\)</span>, creando un percorso di back-door.<br>
</p></li>
<li><p><strong>Sì</strong>, per stimare correttamente l’effetto di <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span> dobbiamo controllare per Z. Se non lo facciamo, la relazione osservata tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> includerà l’influenza di Z.<br>
</p></li>
<li><p>Se aggiungiamo una variabile W che influenza Z e <span class="math inline">\(X\)</span>, il DAG diventa:</p>
<pre><code>    W → Z → $X$ → $Y$
    W → $X$
    Z → $Y$</code></pre>
<p>Ora W è una variabile a monte di <span class="math inline">\(X\)</span> e Z, ma non confonde direttamente la relazione tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>.</p></li>
</ol>
<p><strong>Esercizio 3: Causalità nei dati osservazionali</strong></p>
<ol type="1">
<li><strong>Confondente: reddito</strong> – Le persone con un reddito più alto possono avere accesso a cure migliori, che a loro volta migliorano la salute. Soluzione: <strong>Propensit<span class="math inline">\(Y\)</span> Score Matching (PSM)</strong> o regressione con controllo per il reddito.<br>
</li>
<li><strong>Confondente: esperienza lavorativa</strong> – Chi ha più esperienza può già avere salari più alti. Soluzione: <strong>Matching o modello di regressione con controllo per esperienza lavorativa</strong>.<br>
</li>
<li><strong>Confondente: difficoltà di apprendimento</strong> – Studenti con difficoltà possono usare più il tablet e avere punteggi più bassi. Soluzione: <strong>Includere il livello di abilità di partenza nei modelli statistici</strong>.</li>
</ol>
<p><strong>Soluzioni esercizi pratici in R</strong></p>
<p><strong>Esercizio 4: Paradosso di Simpson con dati reali</strong></p>
<ol type="1">
<li><p><strong>Differenza nei tassi di ammissione aggregati:</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>admit_rate_m <span class="ot">&lt;-</span> total_admitted_m <span class="sc">/</span> total_applicants_m</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>admit_rate_f <span class="ot">&lt;-</span> total_admitted_f <span class="sc">/</span> total_applicants_f</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Risultato:</strong></p>
<ul>
<li>Tasso di ammissione uomini: ~44%<br>
</li>
<li>Tasso di ammissione donne: ~35%<br>
→ <strong>Sembra che le donne siano discriminate.</strong></li>
</ul></li>
<li><p><strong>Analisi per dipartimento:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_long <span class="sc">|&gt;</span> dpl<span class="sc">$</span>Y<span class="sc">$</span>r<span class="sc">::</span>group_b<span class="sc">$</span>Y<span class="sc">$</span>(Dept) <span class="sc">|&gt;</span> dpl<span class="sc">$</span>Y<span class="sc">$</span>r<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean_rate_m =</span> <span class="fu">mean</span>(rate_m))</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Nei singoli dipartimenti, le donne hanno tassi di ammissione <strong>uguali o superiori</strong> rispetto agli uomini.<br>
→ <strong>Il problema non è discriminazione diretta, ma la distribuzione delle domande nei dipartimenti.</strong></li>
</ul></li>
<li><p><strong>Conclusione:</strong> Il paradosso di Simpson mostra che le donne tendono a candidarsi più spesso a dipartimenti molto competitivi con bassi tassi di ammissione, mentre gli uomini si candidano di più in dipartimenti con tassi di ammissione più alti.</p></li>
</ol>
<p><strong>Moralità</strong>: Non sempre una differenza aggregata indica un bias. Bisogna analizzare i sottogruppi.</p>
<p><strong>Esercizio 5: Analisi causale con DAG</strong></p>
<ol type="1">
<li><p><strong>Variabili confondenti</strong></p>
<ul>
<li>G è una variabile confondente perché influenza sia E (esposizione) che H (esito).</li>
</ul></li>
<li><p><strong>Back-door paths</strong></p>
<ul>
<li>Il percorso <code>E ← G → H</code> è un back-door path che deve essere bloccato.</li>
</ul></li>
<li><p><strong>Soluzione: controllare per G</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output: <code>{G}</code><br>
→ <strong>Controllare per G permette di ottenere una stima causale non distorta di E su H.</strong></p></li>
</ol>
<p><strong>Conclusioni</strong></p>
<ol type="1">
<li><strong>La correlazione non implica causalità</strong>. Abbiamo visto come variabili confondenti possano generare relazioni spurie.<br>
</li>
<li><strong>Il paradosso di Simpson dimostra che i dati aggregati possono essere fuorvianti</strong>. Bisogna sempre analizzare i sottogruppi.<br>
</li>
<li><strong>I DAG aiutano a identificare le variabili da controllare per ottenere stime causali corrette</strong>.<br>
</li>
<li><strong>L’analisi causale è fondamentale per evitare inferenze errate e migliorare la qualità della ricerca</strong>.<br>
</li>
</ol>
</div>
</div>
</div>
</section>
<section id="bibliografia" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-alexander2023telling" class="csl-entry" role="listitem">
Alexander, R. (2023). <em>Telling Stories with Data: With Applications in R</em>. Chapman; Hall/CRC.
</div>
<div id="ref-byrnes2024causal" class="csl-entry" role="listitem">
Byrnes, J. E., &amp; Dee, L. E. (2024). Causal inference with observational data and unobserved confounding variables. <em>bioRxiv</em>, 2024–2002.
</div>
<div id="ref-hardt2022patterns" class="csl-entry" role="listitem">
Hardt, M., &amp; Recht, B. (2022). <em>Patterns, Predictions, and Actions: Foundations of Machine Learning</em>. Princeton University Press.
</div>
<div id="ref-McElreath_rethinking" class="csl-entry" role="listitem">
McElreath, R. (2020). <em>Statistical rethinking: <span>A</span> <span>Bayesian</span> course with examples in <span>R</span> and <span>Stan</span></em> (2nd Edition). CRC Press.
</div>
<div id="ref-pearl2009causality" class="csl-entry" role="listitem">
Pearl, J. (2009). <em>Causality</em>. Cambridge University Press.
</div>
<div id="ref-riedererdesignpatterns" class="csl-entry" role="listitem">
Riederer, E. (2021). <em>Causal design patterns for data analysts</em>. <a href="https://emilyriederer.netlify.app/post/causal-design-patterns/">https://emilyriederer.netlify.app/post/causal-design-patterns/</a>
</div>
<div id="ref-schennach2016recent" class="csl-entry" role="listitem">
Schennach, S. M. (2016). Recent advances in the measurement error literature. <em>Annual Review of Economics</em>, <em>8</em>(1), 341–377.
</div>
<div id="ref-wilms2021omitted" class="csl-entry" role="listitem">
Wilms, R., Mäthner, E., Winnen, L., &amp; Lanwehr, R. (2021). Omitted variable bias: A threat to estimating causal relationships. <em>Methods in Psychology</em>, <em>5</em>, 100075.
</div>
<div id="ref-van2023new" class="csl-entry" role="listitem">
Zwet, E. van, Gelman, A., Greenland, S., Imbens, G., Schwab, S., &amp; Goodman, S. N. (2023). A New Look at P Values for Randomized Clinical Trials. <em>NEJM Evidence</em>, <em>3</em>(1), EVIDoa2300003.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/eda/08_correlation.html" class="pagination-link" aria-label="Relazioni tra variabili">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Relazioni tra variabili</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/eda/10_estimand.html" class="pagination-link" aria-label="Estimandi teorici e estimandi empirici">
        <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Estimandi teorici e estimandi empirici</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> è una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/eda/09_causality.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>