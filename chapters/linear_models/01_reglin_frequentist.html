<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Corrado Caudek">
<title>61&nbsp; La regressione lineare bivariata: un approccio frequentista – Psicometria</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/linear_models/02_regr_toward_mean.html" rel="next">
<link href="../../chapters/linear_models/introduction_linear_models.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-51e9ba6732aa6bc0134376f05742e55b.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-be4ac3c225b26f991c14b13db7ee7aa0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/linear_models/introduction_linear_models.html">Regressione</a></li><li class="breadcrumb-item"><a href="../../chapters/linear_models/01_reglin_frequentist.html"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata: un approccio frequentista</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Eseguire il codice" class="quarto-navigation-tool px-1" aria-label="Eseguire il codice"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informazioni Generali</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefazione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/key_notions/introduction_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fondamenti</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/01_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Concetti chiave</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/02_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Campionamento, metodologia sperimentale e studi osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/03_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/04_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La riforma metodologica in psicologia: dalla crisi alla rivoluzione bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/05_cognitive_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelli cognitivi</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/R/introduction_r_lang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/01_r_syntax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Un approccio moderno all’analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/02_utility_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Utility functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/03_r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Programmazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/04_r_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Pacchetti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/05_dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduzione a <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/06_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/07_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">L’ambiente di programmazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/08_ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Utilizzo di strumenti AI</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/eda/introduction_eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/01_project_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Le fasi del progetto di analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/02_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Flusso di lavoro per la pulizia dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/04_exploring_qualitative_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Esplorare i dati qualitativi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/05_exploring_numeric_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Esplorare i dati numerici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/06_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Principi della visualizzazione dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07_loc_scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Indicatori di tendenza centrale e variabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07a_introduction_normal_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Introduzione alla distribuzione normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/08_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Relazioni tra variabili</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/09_causality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/10_estimand.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Estimandi teorici e estimandi empirici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/11_outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Outlier</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/probability/introduction_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilità</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/01_intro_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Interpretazione della probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/02_probability_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Modelli probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/03_prob_spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">La Probabilità come misura della certezza razionale: un’interpretazione Bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/04_sigma-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Dal Discreto al Continuo: la <span class="math inline">\(\sigma\)</span>-algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/05_conditional_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Probabilità condizionata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/06_bayes_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/07_random_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/08_prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Distribuzioni di massa e di densità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/09_expval_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Proprietà delle variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/10_sampling_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11a_joint_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Probabilità congiunta</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11b_cov_cor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Covarianza e correlazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11c_joint_prob_cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Caso continuo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12a_intro_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Introduzione alle distribuzioni di probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12_discr_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/13_cont_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/14_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Assunzione di gaussianità e trasformazioni dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/15_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">La verosimiglianza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/16_likelihood_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">La verosimiglianza gaussiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/17_likelihood_ratio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Il rapporto di verosimiglianze</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_intro_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_bayesian_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Pensare ad una proporzione in termini soggettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_grid_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Calcolo della distribuzione a posteriori gaussiana tramite metodo a griglia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_conjugate_families_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_conjugate_families_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (2)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/11_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/12_gamma_exponential_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Modello gamma-esponenziale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/13_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata: un approccio frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_prediction_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Predizione e inferenza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07a_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Stima bayesiana della grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07b_posterior_draws.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Manipolazione dei campioni a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Disegno della ricerca e potere statistico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_anova_2vie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">ANOVA ad due vie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/12_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni indipendenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/13_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Frequentismo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/introduction_frequentist_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01_intro_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01a_stime_parametri.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/02_conf_interv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/03_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">La grandezza del campione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/04_test_ipotesi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Significatività statistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/05_two_ind_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Test t di Student per campioni indipendenti</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">85</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">86</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">87</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_piranha.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">88</span>&nbsp; <span class="chapter-title">Il Problema del priming: sfide e paradossi nella psicologia sociale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">89</span>&nbsp; <span class="chapter-title">I gradi di libertà del ricercatore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/09_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">90</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendici</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01a_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Cartelle e documenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a47_first_order_markov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Catene di Markov</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Indice</h2>
   
  <ul class="collapse">
<li><a href="#introduzione" id="toc-introduzione" class="nav-link active" data-scroll-target="#introduzione"><span class="header-section-number">61.1</span> Introduzione</a></li>
  <li><a href="#il-modello-lineare-bivariato" id="toc-il-modello-lineare-bivariato" class="nav-link" data-scroll-target="#il-modello-lineare-bivariato"><span class="header-section-number">61.2</span> Il modello lineare bivariato</a></li>
  <li><a href="#la-predizione-dellintelligenza" id="toc-la-predizione-dellintelligenza" class="nav-link" data-scroll-target="#la-predizione-dellintelligenza"><span class="header-section-number">61.3</span> La Predizione dell’Intelligenza</a></li>
  <li><a href="#stima-del-modello-di-regressione-lineare" id="toc-stima-del-modello-di-regressione-lineare" class="nav-link" data-scroll-target="#stima-del-modello-di-regressione-lineare"><span class="header-section-number">61.4</span> Stima del modello di regressione lineare</a></li>
  <li><a href="#stima-dei-coefficienti-di-regressione" id="toc-stima-dei-coefficienti-di-regressione" class="nav-link" data-scroll-target="#stima-dei-coefficienti-di-regressione"><span class="header-section-number">61.5</span> Stima dei coefficienti di regressione</a></li>
  <li><a href="#residui" id="toc-residui" class="nav-link" data-scroll-target="#residui"><span class="header-section-number">61.6</span> Residui</a></li>
  <li><a href="#trasformazione-dei-dati" id="toc-trasformazione-dei-dati" class="nav-link" data-scroll-target="#trasformazione-dei-dati"><span class="header-section-number">61.7</span> Trasformazione dei dati</a></li>
  <li><a href="#il-metodo-dei-minimi-quadrati" id="toc-il-metodo-dei-minimi-quadrati" class="nav-link" data-scroll-target="#il-metodo-dei-minimi-quadrati"><span class="header-section-number">61.8</span> Il metodo dei minimi quadrati</a></li>
  <li><a href="#lerrore-standard-della-regressione" id="toc-lerrore-standard-della-regressione" class="nav-link" data-scroll-target="#lerrore-standard-della-regressione"><span class="header-section-number">61.9</span> L’errore standard della regressione</a></li>
  <li><a href="#indice-di-determinazione" id="toc-indice-di-determinazione" class="nav-link" data-scroll-target="#indice-di-determinazione"><span class="header-section-number">61.10</span> Indice di determinazione</a></li>
  <li><a href="#inferenza-sul-modello-di-regressione" id="toc-inferenza-sul-modello-di-regressione" class="nav-link" data-scroll-target="#inferenza-sul-modello-di-regressione"><span class="header-section-number">61.11</span> Inferenza sul modello di regressione</a></li>
  <li><a href="#cos%C3%A8-la-distribuzione-campionaria-di-b_1" id="toc-cosè-la-distribuzione-campionaria-di-b_1" class="nav-link" data-scroll-target="#cos%C3%A8-la-distribuzione-campionaria-di-b_1"><span class="header-section-number">61.12</span> Cos’è la Distribuzione Campionaria di <span class="math inline">\(b_1\)</span> ?</a></li>
  <li><a href="#propriet%C3%A0-della-distribuzione-campionaria-di-b_1" id="toc-proprietà-della-distribuzione-campionaria-di-b_1" class="nav-link" data-scroll-target="#propriet%C3%A0-della-distribuzione-campionaria-di-b_1"><span class="header-section-number">61.13</span> Proprietà della Distribuzione Campionaria di <span class="math inline">\(b_1\)</span></a></li>
  <li><a href="#simulazione-in-r" id="toc-simulazione-in-r" class="nav-link" data-scroll-target="#simulazione-in-r"><span class="header-section-number">61.14</span> Simulazione in R</a></li>
  <li><a href="#riflessioni-conclusive" id="toc-riflessioni-conclusive" class="nav-link" data-scroll-target="#riflessioni-conclusive"><span class="header-section-number">61.15</span> Riflessioni conclusive&nbsp;</a></li>
  <li><a href="#informazioni-sullambiente-di-sviluppo" id="toc-informazioni-sullambiente-di-sviluppo" class="nav-link" data-scroll-target="#informazioni-sullambiente-di-sviluppo">Informazioni sull’Ambiente di Sviluppo</a></li>
  <li><a href="#bibliografia" id="toc-bibliografia" class="nav-link" data-scroll-target="#bibliografia">Bibliografia</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/linear_models/01_reglin_frequentist.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/linear_models/introduction_linear_models.html">Regressione</a></li><li class="breadcrumb-item"><a href="../../chapters/linear_models/01_reglin_frequentist.html"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata: un approccio frequentista</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-linear-models-biv-model-frequentist" class="quarto-section-identifier"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata: un approccio frequentista</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In questo capitolo imparerai a:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>comprendere il funzionamento del modello lineare secondo l’approccio frequentista;</li>
<li>stimare i coefficienti del modello utilizzando il metodo dei minimi quadrati e interpretarli correttamente;</li>
<li>valutare la qualità del modello attraverso l’indice di determinazione (<span class="math inline">\(R^2\)</span>).</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Leggere il capitolo <em>Basic Regression</em> di <a href="https://moderndive.com/v2/">Statistical Inference via Data Science: A ModernDive into R and the Tidyverse (Second Edition)</a>.</li>
<li>Consulta l’appendice <a href="../appendix/a50_lin_fun.html" class="quarto-xref"><span>Appendice K</span></a> per un’introduzione alle funzioni lineari.</li>
<li>Leggere <em>Navigating the Bayes maze: The psychologist’s guide to Bayesian statistics, a hands-on tutorial with R code</em> <span class="citation" data-cites="alter2025navigating">(<a href="#ref-alter2025navigating" role="doc-biblioref">Alter et al., 2025</a>)</span>.</li>
<li>Leggere il capitolo <em>Linear Statistical Models</em> <span class="citation" data-cites="schervish2014probability">(<a href="#ref-schervish2014probability" role="doc-biblioref">Schervish &amp; DeGroot, 2014</a>)</span>.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">broom</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="introduzione" class="level2" data-number="61.1"><h2 data-number="61.1" class="anchored" data-anchor-id="introduzione">
<span class="header-section-number">61.1</span> Introduzione</h2>
<p>La <strong>regressione</strong> è una tecnica statistica che permette ai ricercatori di analizzare come i valori medi di una variabile risultato (o variabile dipendente) cambiano in relazione a un insieme di predittori (variabili indipendenti).</p>
<p>Secondo <span class="citation" data-cites="gelman2021regression">Gelman et al. (<a href="#ref-gelman2021regression" role="doc-biblioref">2021</a>)</span>, i principali utilizzi della regressione includono:</p>
<ol type="1">
<li>
<strong>Previsione</strong> – Modellare dati esistenti o prevedere nuove osservazioni, sia continue che categoriche.
<ul>
<li>
<em>Esempi</em>: Prevedere punteggi futuri in un test, monitorare il benessere psicologico in uno studio longitudinale o classificare individui in base alla probabilità di successo in un compito cognitivo.</li>
</ul>
</li>
<li>
<strong>Esplorazione delle associazioni</strong> – Identificare e quantificare le relazioni tra una o più variabili indipendenti e un risultato.
<ul>
<li>
<em>Esempi</em>: Analizzare i tratti di personalità legati alla resilienza allo stress, indagare la correlazione tra stili di attaccamento infantile e capacità relazionali in età adulta, o valutare l’influenza di fattori socio-economici sullo sviluppo cognitivo nei bambini.</li>
</ul>
</li>
<li>
<strong>Estrapolazione</strong> – Estendere i risultati osservati in un campione a una popolazione più ampia.
<ul>
<li>
<em>Esempi</em>: Stimare l’efficacia di una terapia testata su studenti universitari alla popolazione generale, oppure prevedere l’impatto di un intervento scolastico su un intero distretto partendo dai dati di alcune scuole pilota.</li>
</ul>
</li>
<li>
<strong>Inferenza causale</strong> – Analizzare gli effetti di un trattamento o intervento, purché supportata da un disegno sperimentale adeguato.
<ul>
<li>
<em>Esempi</em>: Valutare l’efficacia di un programma di mindfulness sui livelli di ansia, stimare l’impatto di una psicoterapia per il disturbo post-traumatico da stress o determinare l’effetto di un intervento educativo su una popolazione diversificata.</li>
</ul>
</li>
</ol>
<p>In tutti questi contesti, è <strong>essenziale</strong> che il modello includa tutte le variabili rilevanti per la variabile di interesse. Ad esempio, in uno studio sull’efficacia di una psicoterapia per la depressione, fattori come età, condizioni di salute preesistenti e supporto sociale possono influenzare significativamente i risultati e devono essere integrati nell’analisi. La trascuratezza di tali variabili può distorto le relazioni stimate tra predittori e risultato. L’accuratezza dei modelli di regressione dipende quindi sia dalla completezza del modello che dalla selezione mirata delle informazioni incluse.</p>
<p>Un problema critico legato a questa scelta è il cosiddetto <strong>“errore di specificazione”</strong>, che si verifica quando uno o più predittori rilevanti vengono omessi dal modello. Questo porta a stime sistematicamente errate, compromettendo la validità delle conclusioni tratte. Approfondiremo questo concetto in seguito, esaminando le implicazioni pratiche e strategie per evitarlo.</p>
<section id="la-storia-dei-modelli-lineari" class="level3" data-number="61.1.1"><h3 data-number="61.1.1" class="anchored" data-anchor-id="la-storia-dei-modelli-lineari">
<span class="header-section-number">61.1.1</span> La storia dei modelli lineari</h3>
<p>I <strong>modelli lineari</strong> hanno una lunga storia nella statistica. Come riportato da <span class="citation" data-cites="stigler1986">Stigler (<a href="#ref-stigler1986" role="doc-biblioref">1986</a>)</span>, il metodo dei <strong>minimi quadrati</strong> per adattare un modello di regressione lineare bivariata fu introdotto nel XVIII secolo per l’analisi dei dati astronomici. Gli astronomi lo utilizzavano, ad esempio, per determinare il moto della Luna o per modellare i movimenti non periodici di Giove e Saturno.</p>
<p>L’adozione di questi metodi fu favorita dalla qualità e dall’omogeneità delle misurazioni astronomiche, raccolte con strumenti standardizzati e sotto condizioni controllate. Al contrario, nelle scienze sociali, l’elevata variabilità dei dati—derivante da differenze individuali, contesti mutevoli e strumenti di misura meno precisi—rese più complessa l’applicazione della regressione e ne ritardò la diffusione. Solo con lo sviluppo di tecniche statistiche più avanzate, capaci di gestire questa complessità, la regressione divenne uno strumento essenziale anche nelle scienze umane e sociali.</p>
</section><section id="tipologie-di-regressione" class="level3" data-number="61.1.2"><h3 data-number="61.1.2" class="anchored" data-anchor-id="tipologie-di-regressione">
<span class="header-section-number">61.1.2</span> Tipologie di regressione</h3>
<p>È utile distinguere tra tre principali categorie di regressione:</p>
<ol type="1">
<li>
<strong>Regressione bivariata</strong> – Un solo predittore e una sola variabile dipendente.<br>
</li>
<li>
<strong>Regressione multipla</strong> – Un solo risultato ma molteplici predittori.<br>
</li>
<li>
<strong>Regressione multivariata</strong> – Molteplici risultati, con uno o più predittori.</li>
</ol>
<p>Il caso bivariato, pur essendo il più semplice, è raramente sufficiente per descrivere fenomeni complessi, soprattutto in psicologia, dove molteplici fattori influenzano le variabili di interesse. Tuttavia, lo analizzeremo in dettaglio perché permette di comprendere la logica dell’analisi di regressione in un contesto semplificato, privo di complicazioni matematiche. I concetti appresi saranno poi estesi ai modelli più complessi, in cui la regressione multipla e la regressione multivariata richiederanno calcoli più articolati e un’interpretazione più sofisticata dei parametri.</p>
</section></section><section id="il-modello-lineare-bivariato" class="level2" data-number="61.2"><h2 data-number="61.2" class="anchored" data-anchor-id="il-modello-lineare-bivariato">
<span class="header-section-number">61.2</span> Il modello lineare bivariato</h2>
<p>Nel contesto frequentista, il modello di regressione lineare bivariata consente di predire una variabile continua <span class="math inline">\(y\)</span> sulla base di un singolo predittore continuo <span class="math inline">\(x\)</span>. La relazione tra le due variabili è espressa dall’equazione della retta di regressione:</p>
<p><span class="math display">\[
y_i = a + b x_i + e_i, \quad i = 1, \dots, n
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(a\)</span> è l’intercetta (il valore atteso di <span class="math inline">\(y\)</span> quando <span class="math inline">\(x = 0\)</span>),</li>
<li>
<span class="math inline">\(b\)</span> è la pendenza della retta (coefficiente di regressione, che misura il cambiamento atteso in <span class="math inline">\(y\)</span> per ogni unità di incremento in <span class="math inline">\(x\)</span>),</li>
<li>
<span class="math inline">\(e_i\)</span> è l’errore residuo (la differenza tra il valore osservato di <span class="math inline">\(y_i\)</span> e il valore predetto dal modello).</li>
</ul>
<section id="aspetti-principali" class="level3" data-number="61.2.1"><h3 data-number="61.2.1" class="anchored" data-anchor-id="aspetti-principali">
<span class="header-section-number">61.2.1</span> Aspetti principali</h3>
<ol type="1">
<li><p><strong>Stima dei coefficienti</strong><br>
I coefficienti <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span> vengono stimati mediante il metodo dei <strong>minimi quadrati</strong>, che minimizza la somma dei quadrati degli errori residui (<span class="math inline">\(\sum e_i^2\)</span>).</p></li>
<li>
<p><strong>Interpretazione dei coefficienti</strong></p>
<ul>
<li>
<span class="math inline">\(a\)</span>: rappresenta il valore medio previsto di <span class="math inline">\(y\)</span> quando <span class="math inline">\(x = 0\)</span>.<br>
</li>
<li>
<span class="math inline">\(b\)</span>: indica la variazione media prevista in <span class="math inline">\(y\)</span> per ogni unità di variazione in <span class="math inline">\(x\)</span>.</li>
</ul>
</li>
<li>
<p><strong>Valutazione del modello</strong><br>
La bontà di adattamento del modello viene valutata attraverso:</p>
<ul>
<li>L’<strong>indice di determinazione</strong> (<span class="math inline">\(R^2\)</span>), che misura la proporzione della varianza di <span class="math inline">\(y\)</span> spiegata dal modello.</li>
<li>L’<strong>analisi dei residui</strong>, utile per individuare pattern non catturati dal modello e diagnosticare eventuali problemi.</li>
</ul>
</li>
</ol></section><section id="verso-modelli-più-complessi" class="level3" data-number="61.2.2"><h3 data-number="61.2.2" class="anchored" data-anchor-id="verso-modelli-più-complessi">
<span class="header-section-number">61.2.2</span> Verso modelli più complessi</h3>
<p>Questo capitolo illustrerà come applicare e interpretare il modello di regressione bivariata, fornendo una base per comprendere il modello lineare multiplo e, più in generale, gli approcci avanzati per l’inferenza causale. La logica della regressione bivariata sarà estesa ai modelli con più predittori, dove sarà fondamentale distinguere tra relazioni spurie e reali effetti predittivi.</p>
</section></section><section id="la-predizione-dellintelligenza" class="level2" data-number="61.3"><h2 data-number="61.3" class="anchored" data-anchor-id="la-predizione-dellintelligenza">
<span class="header-section-number">61.3</span> La Predizione dell’Intelligenza</h2>
<p>Nella presente discussione, esamineremo i dati <code>kidiq</code> che consistono in una raccolta di dati provenienti da un sondaggio su donne adulte americane e i loro figli, selezionati da un sotto-campione del <em>National Longitudinal Survey of Youth</em> <span class="citation" data-cites="gelman2021regression">(<a href="#ref-gelman2021regression" role="doc-biblioref">Gelman et al., 2021</a>)</span>.</p>
<p>Nello specifico, ci concentreremo sulla relazione tra il punteggio di intelligenza del bambino (<code>kid_score</code>) e quello della madre (<code>mom_iq</code>). Ci proponiamo di valutare se e in quale misura l’intelligenza della madre possa prevedere l’intelligenza del bambino. Per fare ciò, inizieremo ad importare i dati nell’ambiente R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Caricamento dei dati</span></span>
<span><span class="va">kidiq</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"kidiq.dta"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Anteprima dei dati</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">)</span></span>
<span><span class="co">#&gt;   kid_score mom_hs mom_iq mom_work mom_age</span></span>
<span><span class="co">#&gt; 1        65      1 121.12        4      27</span></span>
<span><span class="co">#&gt; 2        98      1  89.36        4      25</span></span>
<span><span class="co">#&gt; 3        85      1 115.44        4      27</span></span>
<span><span class="co">#&gt; 4        83      1  99.45        3      25</span></span>
<span><span class="co">#&gt; 5       115      1  92.75        4      27</span></span>
<span><span class="co">#&gt; 6        98      0 107.90        1      18</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Un diagramma a dispersione per i dati di questo campione suggerisce la presenza di un’associazione positiva tra l’intelligenza del bambino (<code>kid_score</code>) e l’intelligenza della madre (<code>mom_iq</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">kidiq</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mom_iq</span>, y <span class="op">=</span> <span class="va">kid_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"QI della madre"</span>, y <span class="op">=</span> <span class="st">"QI del bambino"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Diagramma a dispersione"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="01_reglin_frequentist_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="01_reglin_frequentist_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="stima-del-modello-di-regressione-lineare" class="level2" data-number="61.4"><h2 data-number="61.4" class="anchored" data-anchor-id="stima-del-modello-di-regressione-lineare">
<span class="header-section-number">61.4</span> Stima del modello di regressione lineare</h2>
<p>Calcoliamo i coefficienti della retta di regressione utilizzando la funzione <code>lm</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Modello di regressione lineare</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_iq</span>, data <span class="op">=</span> <span class="va">kidiq</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Coefficienti stimati</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Intercept)      mom_iq </span></span>
<span><span class="co">#&gt;       25.80        0.61</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ci sono però infinite rette che, in linea di principio, possono essere usate per “approssimare” la nube di punti nel diagramma a dispersione. È dunque necessario introdurre dei vincoli per selezionare una di queste possibili rette. Il vincolo che viene introdotto dal modello di regressione è quello di costringere la retta a passare per il punto <span class="math inline">\((\bar{x}, \bar{y})\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcola le medie per mom_iq e kid_score</span></span>
<span><span class="va">mean_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mean_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Aggiungi il punto medio al grafico</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">kidiq</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mom_iq</span>, y <span class="op">=</span> <span class="va">kid_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    <span class="st">"point"</span>, x <span class="op">=</span> <span class="va">mean_x</span>, y <span class="op">=</span> <span class="va">mean_y</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">5</span>, </span>
<span>    shape <span class="op">=</span> <span class="fl">4</span>, stroke <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"QI della madre"</span>, y <span class="op">=</span> <span class="st">"QI del bambino"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Retta di regressione"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="01_reglin_frequentist_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="01_reglin_frequentist_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Una retta di regressione che passa per il punto medio <span class="math inline">\((\bar{x}, \bar{y})\)</span> (che rappresenta il centro di massa dei dati) è preferibile dal punto di vista statistico poiché minimizza la somma dei quadrati degli errori residui.</p>
<p>Il campione è costituito da <span class="math inline">\(n\)</span> coppie di osservazioni (<span class="math inline">\(x, y\)</span>).</p>
<p><span class="math display">\[
\begin{array}{cc}
\hline
x_1 &amp; y_1 \\
x_2 &amp; y_2 \\
x_3 &amp; y_3 \\
\vdots &amp; \vdots \\
x_n &amp; y_n \\
\hline
\end{array}
\]</span></p>
<p>Per ciascuna coppia di valori <span class="math inline">\(x_i, y_i\)</span>, il modello di regressione si aspetta che il valore <span class="math inline">\(y_i\)</span> sia associato al corrispondente valore <span class="math inline">\(x_i\)</span> come indicato dalla seguente equazione</p>
<p><span id="eq-reglin-exp-val"><span class="math display">\[
\begin{equation}
\mathbb{E}(y_i) = a + b x_i ,
\end{equation}
\tag{61.1}\]</span></span></p>
<p>ovvero:</p>
<p><span class="math display">\[
\begin{array}{ccc}
\hline
x_i &amp; y_i &amp; \mathbb{E}(y_i) = a + b x_i \\
\hline
x_1 &amp; y_1 &amp; a + b x_1 \\
x_2 &amp; y_2 &amp; a + b x_2 \\
x_3 &amp; y_3 &amp; a + b x_3 \\
\vdots &amp; \vdots &amp; \vdots \\
x_n &amp; y_n &amp; a + b x_n \\
\hline
\end{array}
\]</span></p>
<p>I valori <span class="math inline">\(y_i\)</span> corrispondono, nell’esempio che stiamo discutendo, alla variabile <code>kid_score</code>. I primi 10 valori della variabile <span class="math inline">\(y\)</span> sono i seguenti:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">[</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1]  65  98  85  83 115  98  69 106 102  95</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Per fare riferimento a ciascuna osservazione usiamo l’indice <span class="math inline">\(i\)</span>. Quindi, ad esempio, <span class="math inline">\(y_2\)</span> è uguale a</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 98</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il modello di regressione lineare bivariata, rappresentato dall’equazione <span class="math inline">\(y_i = a + b x_i + e_i\)</span>, descrive la relazione tra le variabili <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span>, dove <span class="math inline">\(y\)</span> è la variabile dipendente (nel nostro esempio, la variabile <code>kid_score</code>) e <span class="math inline">\(x\)</span> è la variabile indipendente (nel nostro esempio, la variabile <code>mom_iq</code>).</p>
<p>Il valore di <span class="math inline">\(y\)</span> è la somma di due componenti:</p>
<ul>
<li>la <strong>componente deterministica</strong>, <span class="math inline">\(\hat{y}_i = a + b x_i\)</span>, rappresenta la porzione della <span class="math inline">\(y\)</span> che è prevedibile conoscendo il valore di <span class="math inline">\(x\)</span>;</li>
<li>la <strong>componente aleatoria</strong>, <span class="math inline">\(e_i\)</span>, rappresenta la porzione della <span class="math inline">\(y\)</span> che non è prevedibile dal modello.</li>
</ul>
<p>Il modello lineare cerca di trovare i coefficienti <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span> che permettono di prevedere la componente deterministica di <span class="math inline">\(y\)</span> conoscendo il valore di <span class="math inline">\(x\)</span>. Tuttavia, poiché la retta è solo un’approssimazione della relazione tra <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span>, la componente deterministica rappresenta solo una stima approssimata della vera relazione tra le due variabili.</p>
<p>Per valutare l’accuratezza del modello di regressione lineare, è necessario calcolare il residuo</p>
<p><span id="eq-reglin-res"><span class="math display">\[
e_i = y_i - (a + b x_i) ,
\tag{61.2}\]</span></span></p>
<p>ovvero la differenza tra il valore osservato di <span class="math inline">\(y\)</span> e il valore previsto dal modello, <span class="math inline">\(\hat{y}\)</span>. La dimensione del residuo indica quanto la componente aleatoria contribuisce al valore osservato di <span class="math inline">\(y\)</span>.</p>
<p>Il modello di regressione lineare ha tre obiettivi <span class="citation" data-cites="fox2015applied">(<a href="#ref-fox2015applied" role="doc-biblioref">Fox, 2015</a>)</span>:</p>
<ol type="1">
<li>il primo è quello di trovare i coefficienti <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span> che permettono di prevedere la componente deterministica di <span class="math inline">\(y\)</span> conoscendo il valore di <span class="math inline">\(x\)</span>;</li>
<li>il secondo obiettivo è quello di valutare l’accuratezza della predizione fornita dal modello di regressione lineare;</li>
<li>infine, il terzo obiettivo è quello dell’inferenza, ovvero quello di capire quali relazioni esistono tra la relazione tra <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> osservata nel campione e la relazione tra le due variabili nella popolazione.</li>
</ol></section><section id="stima-dei-coefficienti-di-regressione" class="level2" data-number="61.5"><h2 data-number="61.5" class="anchored" data-anchor-id="stima-dei-coefficienti-di-regressione">
<span class="header-section-number">61.5</span> Stima dei coefficienti di regressione</h2>
<p>In breve, stiamo cercando di descrivere una relazione tra due variabili, il QI della madre e il QI del bambino, utilizzando un modello di regressione lineare. L’equazione lineare che descrive la relazione tra le due variabili è della forma <span class="math inline">\(\hat{y}_i = a_i + bx_i\)</span>, dove <span class="math inline">\(\hat{y}_i\)</span> rappresenta la previsione per il QI del bambino <span class="math inline">\(i\)</span>-esimo, <span class="math inline">\(a_i\)</span> e <span class="math inline">\(b\)</span> sono i coefficienti di regressione che vogliamo trovare e <span class="math inline">\(x_i\)</span> è il QI della madre del bambino <span class="math inline">\(i\)</span>-esimo.</p>
<p>Per trovare i coefficienti di regressione, dobbiamo introdurre dei vincoli per limitare lo spazio delle possibili soluzioni. Il primo vincolo è che la retta di regressione deve passare per il baricentro del grafico a dispersione. Il secondo vincolo è che vogliamo minimizzare la somma dei quadrati dei residui, ovvero la differenza tra il valore osservato e il valore previsto dal modello. I coefficienti di regressione che soddisfano questi vincoli si chiamano <strong>coefficienti dei minimi quadrati</strong>.</p>
<p>Il problema di trovare i coefficienti di regressione <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span> che minimizzano la somma dei quadrati dei residui ha una soluzione analitica. Questa soluzione si ottiene trovando il punto di minimo di una superficie tridimensionale che rappresenta la somma dei quadrati dei residui. Il punto di minimo è quello per cui il piano tangente alla superficie nelle due direzioni <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span> è piatto, cioè le derivate parziali rispetto ad <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span> sono uguali a zero. In pratica, ciò significa risolvere un sistema di equazioni lineari con due incognite <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span>, noto come equazioni normali.</p>
<p>La soluzione delle equazioni normali ci fornisce i coefficienti di regressione stimati, che minimizzano la somma dei quadrati dei residui. La formula per il coefficiente <span class="math inline">\(a\)</span> è</p>
<p><span id="eq-reglin-coef-a"><span class="math display">\[
a = \bar{y} - b \bar{x} ,
\tag{61.3}\]</span></span></p>
<p>la formula per il coefficiente <span class="math inline">\(b\)</span> è</p>
<p><span id="eq-reglin-coef-b"><span class="math display">\[
b = \frac{Cov(x, y)}{Var(x)},
\tag{61.4}\]</span></span></p>
<p>dove <span class="math inline">\(\bar{x}\)</span> e <span class="math inline">\(\bar{y}\)</span> sono le medie delle variabili <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span>, <span class="math inline">\(Cov(x,y)\)</span> è la covarianza tra <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> e <span class="math inline">\(Var(x)\)</span> è la varianza di <span class="math inline">\(x\)</span>.</p>
<p>Queste equazioni rappresentano la stima dei minimi quadrati dei coefficienti di regressione che ci permettono di trovare la retta che minimizza la somma dei quadrati dei residui.</p>
<section id="calcolo-manuale-dei-coefficienti-di-regressione" class="level3" data-number="61.5.1"><h3 data-number="61.5.1" class="anchored" data-anchor-id="calcolo-manuale-dei-coefficienti-di-regressione">
<span class="header-section-number">61.5.1</span> Calcolo manuale dei coefficienti di regressione</h3>
<p>Calcoliamo i coefficientii dei minimi quadrati con l’<a href="#eq-reglin-coef-a" class="quarto-xref">Equazione&nbsp;<span>61.3</span></a> e l’<a href="#eq-reglin-coef-b" class="quarto-xref">Equazione&nbsp;<span>61.4</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcolo manuale dei coefficienti</span></span>
<span><span class="va">cov_xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span>, <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span>  <span class="co"># Covarianza tra le due variabili</span></span>
<span><span class="va">var_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span>  <span class="co"># Varianza della variabile indipendente</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">cov_xy</span> <span class="op">/</span> <span class="va">var_x</span>  <span class="co"># Pendenza (coefficiente b)</span></span>
<span><span class="va">b</span></span>
<span><span class="co">#&gt; [1] 0.61</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Intercetta (coefficiente a)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">)</span> <span class="op">-</span> <span class="va">b</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span></span>
<span><span class="va">a</span></span>
<span><span class="co">#&gt; [1] 25.8</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I risultati replicano quelli ottenuti in precedenza con <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p>
</section><section id="interpretazione" class="level3" data-number="61.5.2"><h3 data-number="61.5.2" class="anchored" data-anchor-id="interpretazione">
<span class="header-section-number">61.5.2</span> Interpretazione</h3>
<p>Il coefficiente <span class="math inline">\(a\)</span> indica l’intercetta della retta di regressione nel diagramma a dispersione. Questo valore rappresenta il punto in cui la retta di regressione interseca l’asse <span class="math inline">\(y\)</span> del sistema di assi cartesiani. Tuttavia, in questo caso specifico, il valore di <span class="math inline">\(a\)</span> non è di particolare interesse poiché corrisponde al valore della retta di regressione quando l’intelligenza della madre è pari a 0, il che non ha senso nella situazione reale. Successivamente, vedremo come è possibile trasformare i dati per fornire un’interpretazione utile del coefficiente <span class="math inline">\(a\)</span>.</p>
<p>Invece, il coefficiente <span class="math inline">\(b\)</span> indica la pendenza della retta di regressione, ovvero di quanto aumenta (se <span class="math inline">\(b\)</span> è positivo) o diminuisce (se <span class="math inline">\(b\)</span> è negativo) la retta di regressione in corrispondenza di un aumento di 1 punto della variabile <span class="math inline">\(x\)</span>. Nel caso specifico del QI delle madri e dei loro figli, il coefficiente <span class="math inline">\(b\)</span> ci indica che un aumento di 1 punto del QI delle madri è associato, in media, a un aumento di 0.61 punti del QI dei loro figli.</p>
<p>In pratica, il modello di regressione lineare cerca di prevedere le medie dei punteggi del QI dei figli in base al QI delle madri. Ciò significa che non è in grado di prevedere esattamente il punteggio di ciascun bambino in funzione del QI della madre, ma solo una stima della media dei punteggi dei figli quando il QI delle madri aumenta o diminuisce di un punto.</p>
<p>Il coefficiente <span class="math inline">\(b\)</span> ci dice di quanto aumenta (o diminuisce) in media il QI dei figli per ogni unità di aumento (o diminuzione) del QI della madre. Nel nostro caso, se il QI della madre aumenta di un punto, il QI dei figli aumenta in media di 0.61 punti.</p>
<p>È importante comprendere che il modello statistico di regressione lineare non è in grado di prevedere il valore preciso di ogni singolo bambino, ma solo una stima della media dei punteggi del QI dei figli quando il QI delle madri aumenta o diminuisce. Questa stima è basata su una distribuzione di valori possibili che si chiama distribuzione condizionata <span class="math inline">\(p(y \mid x_i)\)</span>.</p>
<p>Una rappresentazione grafica del valore predetto dal modello di regressione, <span class="math inline">\(\hat{y}_i = a + bx_i\)</span> è stato fornito in precedenza. Il diagramma presenta ciascun valore <span class="math inline">\(\hat{y}_i = a + b x_i\)</span> in funzione di <span class="math inline">\(x_i\)</span>. I valori predetti dal modello di regressione sono i punti che stanno sulla retta di regressione.</p>
</section></section><section id="residui" class="level2" data-number="61.6"><h2 data-number="61.6" class="anchored" data-anchor-id="residui">
<span class="header-section-number">61.6</span> Residui</h2>
<p>In precedenza abbiamo detto che il residuo, ovvero la componente di ciascuna osservazione <span class="math inline">\(y_i\)</span> che non viene predetta dal modello di regressione, corrisponde alla <em>distanza verticale</em> tra il valore <span class="math inline">\(y_i\)</span> osservato e il valore <span class="math inline">\(\hat{y}_i\)</span> predetto dal modello di regressione:</p>
<p><span class="math display">\[
e_i = y_i - (a + b x_i).
\]</span></p>
<p>Per fare un esempio numerico, consideriamo il punteggio osservato del QI del primo bambino.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 65</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il QI della madre è</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 121.1</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Per questo bambino, il valore predetto dal modello di regressione è</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 99.68</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’errore che compiamo per predire il QI del bambino utilizzando il modello di regressione (ovvero, il residuo) è</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -34.68</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Per tutte le osservazioni abbiamo</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span> <span class="op">-</span> <span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>È una proprietà del modello di regressione (calcolato con il metodo dei minimi quadrati) che la somma dei residui sia uguale a zero.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.444e-11</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questo significa che ogni valore osservato <span class="math inline">\(y_i\)</span> viene scomposto dal modello di regressione in due componenti distinte. La componente deterministica <span class="math inline">\(\hat{y}_i\)</span>, che è predicibile da <span class="math inline">\(x_i\)</span>, è data da <span class="math inline">\(\hat{y}_i = a + b x_i\)</span>. Il residuo, invece, è dato da <span class="math inline">\(e_i = y_i - \hat{y}_i\)</span>. La somma di queste due componenti, ovviamente, riproduce il valore osservato.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Creazione di un data frame con i valori calcolati</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  kid_score <span class="op">=</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span>,</span>
<span>  mom_iq <span class="op">=</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span>,</span>
<span>  y_hat <span class="op">=</span> <span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span>,</span>
<span>  e <span class="op">=</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span> <span class="op">-</span> <span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span>,</span>
<span>  y_hat_plus_e <span class="op">=</span> <span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span> <span class="op">-</span> <span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualizzazione dei primi 6 valori</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   kid_score mom_iq y_hat       e y_hat_plus_e</span></span>
<span><span class="co">#&gt; 1        65 121.12 99.68 -34.678           65</span></span>
<span><span class="co">#&gt; 2        98  89.36 80.31  17.692           98</span></span>
<span><span class="co">#&gt; 3        85 115.44 96.22 -11.217           85</span></span>
<span><span class="co">#&gt; 4        83  99.45 86.46  -3.462           83</span></span>
<span><span class="co">#&gt; 5       115  92.75 82.37  32.628          115</span></span>
<span><span class="co">#&gt; 6        98 107.90 91.62   6.383           98</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="trasformazione-dei-dati" class="level2" data-number="61.7"><h2 data-number="61.7" class="anchored" data-anchor-id="trasformazione-dei-dati">
<span class="header-section-number">61.7</span> Trasformazione dei dati</h2>
<p>In generale, per variabili a livello di scala ad intervalli, l’intercetta del modello di regressione lineare non ha un’interpretazione utile. Questo perché l’intercetta indica il valore atteso di <span class="math inline">\(y\)</span> quando <span class="math inline">\(x = 0\)</span>, ma in caso di variabili a scala di intervalli, il valore “0” di <span class="math inline">\(x\)</span> è arbitrario e non corrisponde ad un “assenza” della variabile <span class="math inline">\(x\)</span>. Ad esempio, un QI della madre pari a 0 non indica un’assenza di intelligenza, ma solo un valore arbitrario del test usato per misurare il QI. Quindi, sapere il valore medio del QI dei bambini quando il QI della madre è 0 non è di alcun interesse.</p>
<p>Per fornire all’intercetta del modello di regressione un’interpretazione più utile, dobbiamo trasformare le osservazioni di <span class="math inline">\(x\)</span>. Per esempio, esprimiamo <span class="math inline">\(x\)</span> come differenza dalla media. Chiamiamo questa nuova variabile <span class="math inline">\(xd\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kidiq</span><span class="op">$</span><span class="va">xd</span> <span class="op">&lt;-</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kidiq</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   kid_score mom_hs mom_iq mom_work mom_age       xd</span></span>
<span><span class="co">#&gt; 1        65      1 121.12        4      27  21.1175</span></span>
<span><span class="co">#&gt; 2        98      1  89.36        4      25 -10.6381</span></span>
<span><span class="co">#&gt; 3        85      1 115.44        4      27  15.4432</span></span>
<span><span class="co">#&gt; 4        83      1  99.45        3      25  -0.5504</span></span>
<span><span class="co">#&gt; 5       115      1  92.75        4      27  -7.2543</span></span>
<span><span class="co">#&gt; 6        98      0 107.90        1      18   7.9018</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se ora usiamo le coppie di osservazioni <span class="math inline">\((xd_i, y_i)\)</span>, il diagramma a dispersione assume la forma seguente.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Aggiungiamo una nuova variabile centrata (scarti dalla media)</span></span>
<span><span class="va">kidiq</span> <span class="op">&lt;-</span> <span class="va">kidiq</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>xd <span class="op">=</span> <span class="va">mom_iq</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mom_iq</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo della retta di regressione</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">xd</span>, <span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">xd</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">)</span> <span class="op">-</span> <span class="va">b</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">xd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Grafico con ggplot2</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">kidiq</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">xd</span>, y <span class="op">=</span> <span class="va">kid_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Punti del grafico</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="va">a</span>, slope <span class="op">=</span> <span class="va">b</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Retta di regressione</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"QI della madre (scarti dalla media)"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"QI del bambino"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Retta di regressione sui dati centrati"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="01_reglin_frequentist_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="01_reglin_frequentist_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>In pratica, abbiamo spostato tutti i punti del grafico lungo l’asse delle <span class="math inline">\(x\)</span>, in modo tale che la media dei valori di <span class="math inline">\(x\)</span> sia uguale a 0. Questo non ha cambiato la forma dei punti nel grafico, ma ha solo spostato l’origine dell’asse <span class="math inline">\(x\)</span>. La pendenza della linea di regressione tra <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> rimane la stessa, sia per i dati originali che per quelli trasformati. L’unica cosa che cambia è il valore dell’intercetta della linea di regressione, che ora ha un’interpretazione più significativa.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">kid_score</span> <span class="op">~</span> <span class="va">xd</span>, data <span class="op">=</span> <span class="va">kidiq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Intercept)          xd </span></span>
<span><span class="co">#&gt;       86.80        0.61</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’intercetta rappresenta il punto in cui la retta di regressione incontra l’asse <span class="math inline">\(y\)</span> nel diagramma a dispersione. Nel caso dei dati trasformati, abbiamo spostato la nube di punti lungo l’asse <span class="math inline">\(x\)</span> di una quantità pari a <span class="math inline">\(x - \bar{x}\)</span>, ma le relazioni spaziali tra i punti rimangono invariate. Pertanto, la pendenza della retta di regressione non cambia rispetto ai dati non trasformati. Tuttavia, il valore dell’intercetta viene influenzato dalla trasformazione. In particolare, poiché <span class="math inline">\(xd = 0\)</span> corrisponde a <span class="math inline">\(x = \bar{x}\)</span> nei dati grezzi, l’intercetta del modello di regressione lineare calcolata sui dati trasformati corrisponde al valore atteso di <span class="math inline">\(y\)</span> quando <span class="math inline">\(x\)</span> assume il valore medio sulla scala dei dati grezzi. In altre parole, l’intercetta del modello di regressione lineare sui dati trasformati rappresenta il valore atteso del QI dei bambini corrispondente al QI medio delle madri.</p>
</section><section id="il-metodo-dei-minimi-quadrati" class="level2" data-number="61.8"><h2 data-number="61.8" class="anchored" data-anchor-id="il-metodo-dei-minimi-quadrati">
<span class="header-section-number">61.8</span> Il metodo dei minimi quadrati</h2>
<p>Per stimare i coefficienti <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span>, possiamo minimizzare la somma dei quadrati dei residui tra i valori osservati <span class="math inline">\(y_i\)</span> e quelli previsti <span class="math inline">\(a + b x_i\)</span>.</p>
<p>Iniziamo con il creare una griglia per i valori di <span class="math inline">\(b\)</span>. Supponiamo che il valore di <span class="math inline">\(a\)</span> sia noto (<span class="math inline">\(a = 25.79978\)</span>). Usiamo R per creare una griglia di valori possibili per <span class="math inline">\(b\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Griglia di valori per b</span></span>
<span><span class="va">b_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">1001</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">25.79978</span>  <span class="co"># Intercetta nota</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Definiamo ora una funzione che calcola la somma dei quadrati dei residui (<span class="math inline">\(SSE\)</span>) per ciascun valore di <span class="math inline">\(b\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Funzione per la somma dei quadrati dei residui</span></span>
<span><span class="va">sse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Applichiamo la funzione <code>sse</code> alla griglia di valori <span class="math inline">\(b\)</span> per calcolare la somma dei quadrati dei residui per ogni valore di <span class="math inline">\(b\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcolo di SSE per ciascun valore di b</span></span>
<span><span class="va">sse_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span></span>
<span>  <span class="va">b_grid</span>, </span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="fu">sse</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span>, <span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>
<strong><code>sapply</code></strong>:
<ul>
<li>È una funzione di R che applica una funzione ad ogni elemento di un vettore (o lista) e restituisce i risultati in un vettore.</li>
<li>Qui, applica la funzione <code>sse</code> a ciascun valore di <span class="math inline">\(b\)</span> contenuto in <code>b_grid</code>.</li>
</ul>
</li>
<li>
<strong><code>function(b)</code></strong>:
<ul>
<li>È una funzione anonima definita al volo per specificare come calcolare <span class="math inline">\(SSE\)</span> per ciascun valore di <span class="math inline">\(b\)</span>.</li>
<li>All’interno, viene chiamata la funzione <code>sse(a, b, x, y)</code> con i seguenti parametri:
<ul>
<li>
<code>a</code>: il valore dell’intercetta (fissato in precedenza o noto).</li>
<li>
<code>b</code>: il valore corrente nella griglia <code>b_grid</code>.</li>
<li>
<code>x</code>: la variabile indipendente del dataset (<code>kidiq$mom_iq</code>).</li>
<li>
<code>y</code>: la variabile dipendente del dataset (<code>kidiq$kid_score</code>).</li>
</ul>
</li>
</ul>
</li>
<li>Il risultato è un vettore, <code>sse_vals</code>, che contiene i valori di <span class="math inline">\(SSE\)</span> corrispondenti a ciascun valore di <span class="math inline">\(b\)</span> in <code>b_grid</code>.</li>
</ul>
<p>Tracciamo un grafico che mostra la somma dei quadrati dei residui (<span class="math inline">\(SSE\)</span>) in funzione dei valori di <span class="math inline">\(b\)</span>, evidenziando il minimo.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Identificazione del valore di b che minimizza SSE</span></span>
<span><span class="va">b_min</span> <span class="op">&lt;-</span> <span class="va">b_grid</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">sse_vals</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Creazione del dataframe per ggplot</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>b_grid <span class="op">=</span> <span class="va">b_grid</span>, sse_vals <span class="op">=</span> <span class="va">sse_vals</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Genera il grafico</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">b_grid</span>, y <span class="op">=</span> <span class="va">sse_vals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    <span class="st">"point"</span>, x <span class="op">=</span> <span class="va">b_min</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">sse_vals</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span>  <span class="co"># Punto minimo</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Possibili valori di "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Somma dei quadrati dei residui"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Minimizzazione dei residui quadratici"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    <span class="st">"text"</span>, x <span class="op">=</span> <span class="va">b_min</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">sse_vals</span><span class="op">)</span>, </span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="01_reglin_frequentist_files/figure-html/unnamed-chunk-25-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="01_reglin_frequentist_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Infine, identifichiamo il valore di <span class="math inline">\(b\)</span> che minimizza la somma dei quadrati dei residui.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">b_min</span></span>
<span><span class="co">#&gt; [1] 0.61</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con questa simulazione, abbiamo stimato il coefficiente <span class="math inline">\(b\)</span> minimizzando la somma dei quadrati dei residui.</p>
<p>Questo approccio può essere esteso per stimare simultaneamente entrambi i coefficienti (<span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span>) utilizzando metodi di ottimizzazione più avanzati, come <code>optim</code> in R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">optim_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span></span>
<span>  par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">25</span>, b <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,  <span class="co"># Valori iniziali</span></span>
<span>  fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="fu">sse</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span>, <span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Coefficienti stimati</span></span>
<span><span class="va">optim_result</span><span class="op">$</span><span class="va">par</span></span>
<span><span class="co">#&gt;       a       b </span></span>
<span><span class="co">#&gt; 25.7874  0.6101</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questa simulazione illustra come, tramite il metodo dei minimi quadrati, sia possibile stimare i parametri di un modello bivariato di regressione.</p>
</section><section id="lerrore-standard-della-regressione" class="level2" data-number="61.9"><h2 data-number="61.9" class="anchored" data-anchor-id="lerrore-standard-della-regressione">
<span class="header-section-number">61.9</span> L’errore standard della regressione</h2>
<p>Il secondo obiettivo del modello di regressione lineare è quello di misurare quanto della variabilità di <span class="math inline">\(y\)</span> possa essere spiegata dalla variabilità di <span class="math inline">\(x\)</span> per ogni osservazione. L’indice di bontà di adattamento del modello viene fornito dalla deviazione standard dei residui, chiamata anche <strong>errore standard della stima</strong> (o <strong>errore standard della regressione</strong>), <span class="math inline">\(s_e\)</span>.</p>
<p>Per calcolare <span class="math inline">\(s_e\)</span>, si sommano i quadrati dei residui <span class="math inline">\(e_i\)</span> per ogni osservazione e si divide per <span class="math inline">\(n-2\)</span>, dove <span class="math inline">\(n\)</span> rappresenta la numerosità del campione e <span class="math inline">\(2\)</span> il numero di coefficienti stimati nel modello di regressione. Si prende poi la radice quadrata del risultato:</p>
<p><span id="eq-reglin-err-standard-regr"><span class="math display">\[
\sqrt{\frac{1}{n-2} \sum_{i=1}^n \big(y_i - (\hat{a} + \hat{b}x_i)\big)^2},
\tag{61.5}\]</span></span></p>
<p>L’indice <span class="math inline">\(s_e\)</span> possiede la stessa unità di misura di <span class="math inline">\(y\)</span> ed è una stima della deviazione standard dei residui nella popolazione.</p>
<p>Illustriamo il calcolo di <span class="math inline">\(s_e\)</span> con i dati a disposizione. I residui <span class="math inline">\(e\)</span> possono essere calcolati sottraendo ai valori osservati <span class="math inline">\(y_i\)</span> i valori predetti dal modello <span class="math inline">\(a + b x_i\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcolo dei residui</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span> <span class="op">-</span> <span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mostriamo i primi 10 residui</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">e</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] -34.678  17.692 -11.217  -3.462  32.628   6.383 -41.521   3.865  26.414</span></span>
<span><span class="co">#&gt; [10]  11.208</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcoliamo il valore medio assoluto dei residui per avere un’indicazione della deviazione media rispetto alla retta di regressione.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Media assoluta dei residui</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 14.47</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’errore standard della stima <span class="math inline">\(s_e\)</span> si calcola come la radice quadrata della somma dei quadrati dei residui divisa per <span class="math inline">\(n-2\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcolo di s_e</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">e</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">se</span></span>
<span><span class="co">#&gt; [1] 18.27</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notiamo che il valore medio assoluto dei residui e l’errore standard <span class="math inline">\(s_e\)</span> non sono identici, ma hanno lo stesso ordine di grandezza. <span class="math inline">\(s_e\)</span> è una misura più rigorosa della deviazione standard dei residui.</p>
<p>Questa analisi dimostra come <span class="math inline">\(s_e\)</span> consenta di valutare quanto le previsioni del modello si discostino (in media) dai dati osservati.</p>
<section id="sottostima-dellerrore-nel-modello-di-regressione" class="level3" data-number="61.9.1"><h3 data-number="61.9.1" class="anchored" data-anchor-id="sottostima-dellerrore-nel-modello-di-regressione">
<span class="header-section-number">61.9.1</span> Sottostima dell’Errore nel Modello di Regressione</h3>
<p>Come discusso da <span class="citation" data-cites="gelman2021regression">Gelman et al. (<a href="#ref-gelman2021regression" role="doc-biblioref">2021</a>)</span>, l’errore standard della regressione tende a sottostimare la vera deviazione standard <span class="math inline">\(\sigma\)</span> dell’errore nel modello di regressione nella popolazione. Questa sottostima è dovuta al fenomeno del <strong>sovradimensionamento</strong>, dato che i parametri <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span> sono stimati utilizzando gli stessi <span class="math inline">\(n\)</span> punti dati su cui vengono calcolati i residui. In altre parole, i residui non sono del tutto indipendenti dal modello.</p>
<p>Un approccio alternativo per valutare l’errore predittivo e mitigare il problema del sovradimensionamento è la <strong>validazione incrociata</strong>. In particolare, l’approccio leave-one-out (LOOCV) offre una soluzione semplice ed efficace. Questo metodo consiste nell’adattare il modello <span class="math inline">\(n\)</span> volte, escludendo ogni volta un punto dati, adattando il modello ai rimanenti <span class="math inline">\(n-1\)</span> punti, e utilizzando tale modello per predire l’osservazione esclusa.</p>
<section id="procedura-leave-one-out" class="level4" data-number="61.9.1.1"><h4 data-number="61.9.1.1" class="anchored" data-anchor-id="procedura-leave-one-out">
<span class="header-section-number">61.9.1.1</span> Procedura Leave-One-Out:</h4>
<ul>
<li>
<p>Per <span class="math inline">\(i = 1, \ldots, n\)</span>:</p>
<ol type="1">
<li><p>Adatta il modello <span class="math inline">\(y = a + bx + \text{errore}\)</span> ai <span class="math inline">\(n-1\)</span> punti dati <span class="math inline">\((x, y)_j, j \neq i\)</span>. Denomina i coefficienti stimati come <span class="math inline">\(\hat{a}_{-i}\)</span> e <span class="math inline">\(\hat{b}_{-i}\)</span>.</p></li>
<li>
<p>Calcola il residuo validato incrociato:</p>
<p><span class="math display">\[
e_{\text{CV}} = y_i - (\hat{a}_{-i} + \hat{b}_{-i} x_i).
\]</span></p>
</li>
<li><p>Salva il residuo al quadrato per il calcolo successivo.</p></li>
</ol>
</li>
<li>
<p>Calcola infine la stima di <span class="math inline">\(\sigma_{\text{CV}}\)</span> come:</p>
<p><span class="math display">\[
\sigma_{\text{CV}} = \sqrt{\frac{1}{n} \sum_{i=1}^n e_{\text{CV}}^2}.
\]</span></p>
</li>
</ul></section><section id="applicazione-pratica" class="level4" data-number="61.9.1.2"><h4 data-number="61.9.1.2" class="anchored" data-anchor-id="applicazione-pratica">
<span class="header-section-number">61.9.1.2</span> Applicazione Pratica:</h4>
<p>Ecco un esempio applicato al modello che predice l’intelligenza del bambino (<span class="math inline">\(\texttt{kid\_score}\)</span>) in funzione dell’intelligenza della madre (<span class="math inline">\(\texttt{mom\_iq}\)</span>) utilizzando il dataset <code>kidiq</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>round <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Array per salvare i residui validati incrociati</span></span>
<span><span class="va">residuals_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop per la validazione incrociata leave-one-out</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Dati di training escludendo l'i-esimo punto</span></span>
<span>  <span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">kidiq</span><span class="op">[</span><span class="op">-</span><span class="va">i</span>, <span class="op">]</span></span>
<span>  <span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">kidiq</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Addestramento del modello</span></span>
<span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_iq</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Predizione sull'i-esimo punto</span></span>
<span>  <span class="va">y_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model</span>, newdata <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calcolo del residuo validato incrociato</span></span>
<span>  <span class="va">residual_cv</span> <span class="op">&lt;-</span> <span class="va">test_data</span><span class="op">$</span><span class="va">kid_score</span> <span class="op">-</span> <span class="va">y_pred</span></span>
<span>  <span class="va">residuals_cv</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">residual_cv</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Calcolo di sigma_cv</span></span>
<span><span class="va">sigma_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">residuals_cv</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Stima di σ_CV:"</span>, <span class="va">sigma_cv</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Stima di σ_CV: 18.31</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcoliamo ora la stima tradizionale di <span class="math inline">\(\sigma\)</span> utilizzando il modello completo e confrontiamola con <span class="math inline">\(\sigma_{\text{CV}}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Modello completo</span></span>
<span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_iq</span>, data <span class="op">=</span> <span class="va">kidiq</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stima tradizionale dell'errore standard della regressione</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Errore standard della regressione (tradizionale):"</span>, <span class="va">res</span><span class="op">$</span><span class="va">sigma</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Errore standard della regressione (tradizionale): 18.27</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nel caso analizzato, i valori stimati di <span class="math inline">\(\sigma_{\text{CV}}\)</span> e <span class="math inline">\(\hat{\sigma}_e\)</span> tradizionale possono risultare molto simili. Tuttavia, in generale, la stima di <span class="math inline">\(\sigma_{\text{CV}}\)</span> tende a essere leggermente superiore, in quanto riflette meglio l’errore predittivo su dati non utilizzati per adattare il modello. Questo rende <span class="math inline">\(\sigma_{\text{CV}}\)</span> una misura più robusta e conservativa dell’incertezza del modello.</p>
<p>In conclusione, la validazione incrociata, e in particolare l’approccio LOOCV, rappresenta uno strumento importante per valutare le performance predittive di un modello di regressione e per ottenere stime più affidabili della deviazione standard dell’errore.</p>
</section></section></section><section id="indice-di-determinazione" class="level2" data-number="61.10"><h2 data-number="61.10" class="anchored" data-anchor-id="indice-di-determinazione">
<span class="header-section-number">61.10</span> Indice di determinazione</h2>
<p>Un importante risultato dell’analisi di regressione riguarda la scomposizione della varianza della variabile dipendente <span class="math inline">\(y\)</span> in due componenti: la varianza spiegata dal modello e la varianza residua. Questa scomposizione è descritta mediante l’indice di determinazione <span class="math inline">\(R^2\)</span>, che fornisce una misura della bontà di adattamento del modello ai dati del campione.</p>
<p>Per una generica osservazione <span class="math inline">\(x_i, y_i\)</span>, la deviazione di <span class="math inline">\(y_i\)</span> rispetto alla media <span class="math inline">\(\bar{y}\)</span> può essere espressa come la somma di due componenti: il residuo <span class="math inline">\(e_i=y_i- \hat{y}_i\)</span> e lo scarto di <span class="math inline">\(\hat{y}_i\)</span> rispetto alla media <span class="math inline">\(\bar{y}\)</span>:</p>
<p><span class="math display">\[
y_i - \bar{y} = (y_i- \hat{y}_i) + (\hat{y}_i - \bar{y}) = e_i + (\hat{y}_i - \bar{y}).
\]</span></p>
<p>La varianza totale di <span class="math inline">\(y\)</span> può quindi essere scritta come:</p>
<p><span class="math display">\[
\sum_{i=1}^{n}(y_i - \bar{y})^2 = \sum_{i=1}^{n}(e_i + (\hat{y}_i - \bar{y}))^2.
\]</span></p>
<p>Sviluppando il quadrato e sommando, si ottiene:</p>
<p><span id="eq-reglin-dev"><span class="math display">\[
\sum_{i=1}^{n}(y_i - \bar{y})^2 = \sum_{i=1}^{n}(y_i - \hat{y}_i)^2 + \sum_{i=1}^{n}(\hat{y}_i - \bar{y})^2.
\tag{61.6}\]</span></span></p>
<p>Il primo termine rappresenta la <strong>varianza residua</strong>, mentre il secondo termine rappresenta la <strong>varianza spiegata</strong> dal modello. Questa scomposizione della devianza va sotto il nome di <strong>teorema della scomposizione della devianza</strong>.</p>
<p>L’indice di determinazione <span class="math inline">\(R^2\)</span> è definito come il rapporto tra la varianza spiegata e la varianza totale:</p>
<p><span id="eq-reglin-r2"><span class="math display">\[
R^2 = \frac{\sum_{i=1}^{n}(\hat{y}_i - \bar{y})^2}{\sum_{i=1}^{n}(y_i - \bar{y})^2}.
\tag{61.7}\]</span></span></p>
<p>Questo indice varia tra 0 e 1 e indica la frazione di varianza totale di <span class="math inline">\(y\)</span> spiegata dal modello di regressione lineare. Un valore alto di <span class="math inline">\(R^2\)</span> indica che il modello di regressione lineare si adatta bene ai dati, in quanto una grande parte della varianza di <span class="math inline">\(y\)</span> è spiegata dalla variabile indipendente <span class="math inline">\(x\)</span>.</p>
<p>Per l’esempio in discussione, possiamo calcolare la devianza totale, la devianza spiegata e l’indice di determinazione <span class="math inline">\(R^2\)</span> come segue:</p>
<p>La devianza totale misura la variabilità complessiva dei punteggi osservati <span class="math inline">\(y\)</span> rispetto alla loro media:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Devianza totale</span></span>
<span><span class="va">dev_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dev_t</span></span>
<span><span class="co">#&gt; [1] 180386</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La devianza spiegata misura la variabilità che il modello è in grado di spiegare, considerando i valori predetti <span class="math inline">\(a + b x\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Devianza spiegata</span></span>
<span><span class="va">dev_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dev_r</span></span>
<span><span class="co">#&gt; [1] 36249</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’indice <span class="math inline">\(R^2\)</span> è il rapporto tra la devianza spiegata e la devianza totale, e indica la frazione della variabilità totale che è spiegata dal modello di regressione:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Indice di determinazione</span></span>
<span><span class="va">R2</span> <span class="op">&lt;-</span> <span class="va">dev_r</span> <span class="op">/</span> <span class="va">dev_t</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">R2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.201</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Per verificare i calcoli, utilizziamo il modello di regressione lineare in R e leggiamo <span class="math inline">\(R^2\)</span> direttamente dal sommario del modello:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Modello di regressione lineare</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_iq</span>, data <span class="op">=</span> <span class="va">kidiq</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sommario del modello per leggere R^2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span>
<span><span class="co">#&gt; [1] 0.201</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il risultato mostra che circa il 20% della variabilità nei punteggi del QI dei bambini è spiegabile conoscendo il QI delle madri. Questo significa che il modello cattura una porzione rilevante della relazione, ma lascia anche spazio a fattori non inclusi nel modello che influenzano il QI dei bambini.</p>
</section><section id="inferenza-sul-modello-di-regressione" class="level2" data-number="61.11"><h2 data-number="61.11" class="anchored" data-anchor-id="inferenza-sul-modello-di-regressione">
<span class="header-section-number">61.11</span> Inferenza sul modello di regressione</h2>
<p>L’inferenza statistica sui coefficienti di regressione richiede la definizione della <strong>distribuzione campionaria</strong> dei coefficienti di regressione. Il modello di regressione bivariata (o lineare semplice) è:</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i,\]</span></p>
<p>dove <span class="math inline">\(Y_i\)</span> è la variabile dipendente per l’osservazione <span class="math inline">\(i\)</span>, <span class="math inline">\(X_i\)</span> è la variabile indipendente, <span class="math inline">\(\beta_0\)</span> è l’intercetta (parametro ignoto), <span class="math inline">\(\beta_1\)</span> è il coefficiente angolare (il parametro che ci interessa stimare), e <span class="math inline">\(\varepsilon_i\)</span> è il termine di errore per l’osservazione <span class="math inline">\(i\)</span>.</p>
<p>Nell’inferenza, il nostro obiettivo è stimare i parametri ignoti <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> usando i dati campionari disponibili. Il metodo più comune è quello dei Minimi Quadrati Ordinari (OLS), che ci fornisce gli stimatori <span class="math inline">\(\hat{\beta}_0\)</span> e <span class="math inline">\(\hat{\beta}_1\)</span> (spesso indicati semplicemente con <span class="math inline">\(b_0\)</span> e <span class="math inline">\(b_1\)</span>). Lo stimatore per il coefficiente angolare è dato dalla formula:</p>
<p><span class="math display">\[\hat{\beta}_1 = b_1 = \frac{\sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{\sum_{i=1}^n (X_i - \bar{X})^2}.\]</span></p>
</section><section id="cosè-la-distribuzione-campionaria-di-b_1" class="level2" data-number="61.12"><h2 data-number="61.12" class="anchored" data-anchor-id="cosè-la-distribuzione-campionaria-di-b_1">
<span class="header-section-number">61.12</span> Cos’è la Distribuzione Campionaria di <span class="math inline">\(b_1\)</span> ?</h2>
<p>Lo stimatore <span class="math inline">\(b_1\)</span> è una <strong>variabile casuale</strong>. Perché? Perché il suo valore dipende dal campione casuale di dati <span class="math inline">\((X_i, Y_i)\)</span> che abbiamo estratto dalla popolazione.</p>
<p>Immaginiamo di poter ripetere il processo di campionamento e stima del modello infinite volte:</p>
<ol type="1">
<li>Estraiamo un campione casuale di dimensione <span class="math inline">\(n\)</span>.</li>
<li>Calcoliamo lo stimatore <span class="math inline">\(b_1\)</span> per quel campione.</li>
<li>Registriamo il valore di <span class="math inline">\(b_1\)</span>.</li>
<li>Estraiamo un nuovo campione casuale (indipendentemente dal primo).</li>
<li>Calcoliamo il “nuovo” <span class="math inline">\(b_1\)</span>.</li>
<li>Registriamo il valore.</li>
<li>… e così via, per infinite volte.</li>
</ol>
<p>La <strong>distribuzione campionaria di <span class="math inline">\(b_1\)</span></strong> è la distribuzione di probabilità di tutti i valori di <span class="math inline">\(b_1\)</span> che otterremmo da questi infiniti campioni casuali di dimensione <span class="math inline">\(n\)</span> estratti dalla stessa popolazione.</p>
</section><section id="proprietà-della-distribuzione-campionaria-di-b_1" class="level2" data-number="61.13"><h2 data-number="61.13" class="anchored" data-anchor-id="proprietà-della-distribuzione-campionaria-di-b_1">
<span class="header-section-number">61.13</span> Proprietà della Distribuzione Campionaria di <span class="math inline">\(b_1\)</span>
</h2>
<p>Il modello statistico standard della regressione bivariata assume che:</p>
<ul>
<li>
<p><strong>1. Linearità nei parametri:</strong> La relazione tra la variabile dipendente (<span class="math inline">\(Y\)</span>) e la variabile indipendente (<span class="math inline">\(X\)</span>) è lineare nei parametri (<span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>). Questo implica che il valore atteso di <span class="math inline">\(Y_i\)</span> condizionato a <span class="math inline">\(X_i\)</span>, indicato con <span class="math inline">\(E(Y_i \mid X_i)\)</span>, sia espresso correttamente come <span class="math inline">\(E(Y_i) = \beta_0 + \beta_1 X_i\)</span>.</p>
<ul>
<li>È importante notare che questa assunzione non richiede che i singoli punti dati giacciano esattamente su una retta, ma che la <strong>funzione di regressione della popolazione</strong> (cioè la relazione tra la media di <span class="math inline">\(Y\)</span> e <span class="math inline">\(X\)</span>) sia lineare. L’impatto medio di una variazione unitaria in <span class="math inline">\(X\)</span> su <span class="math inline">\(Y\)</span>, quantificato attraverso il parametro <span class="math inline">\(\beta_1\)</span>, è <strong>additivo</strong> (contribuisce in modo indipendente da altre variabili) e <strong>costante</strong> (non dipende dal livello di <span class="math inline">\(X\)</span>). Ad esempio, un aumento di 1 unità in <span class="math inline">\(X\)</span> è associato sempre a un aumento di <span class="math inline">\(\beta_1\)</span> unità in <span class="math inline">\(Y\)</span>, indipendentemente dal valore iniziale di <span class="math inline">\(X\)</span>.</li>
</ul>
</li>
<li><p><strong>2. Campionamento Casuale:</strong> I dati osservati <span class="math inline">\((X_i, Y_i)\)</span> per <span class="math inline">\(i = 1, \dots, n\)</span> rappresentano un campione casuale estratto dalla popolazione di interesse. Questo implica che le osservazioni sono indipendenti l’una dall’altra e provengono dalla stessa distribuzione congiunta di <span class="math inline">\((X, Y)\)</span>.</p></li>
<li>
<p><strong>3. Esogeneità (o Media Condizionata degli Errori Nulla):</strong> Il valore atteso del termine di errore (<span class="math inline">\(\epsilon_i\)</span>) è zero, condizionatamente al valore della variabile indipendente (<span class="math inline">\(X_i\)</span>). Formalmente: <span class="math inline">\(E(\epsilon_i \mid X_i) = 0\)</span>. Questa è un’assunzione cruciale. Implica che non ci siano altri fattori (contenuti nell’errore <span class="math inline">\(\epsilon_i\)</span>) che sono correlati con la variabile indipendente <span class="math inline">\(X_i\)</span> e che influenzano anche <span class="math inline">\(Y_i\)</span>.</p>
<ul>
<li>Se questa assunzione è violata (ad esempio, a causa di variabili omesse correlate sia con <span class="math inline">\(X\)</span> che con <span class="math inline">\(Y\)</span>), lo stimatore OLS <span class="math inline">\(b_1\)</span> sarà distorto e inconsistente.</li>
</ul>
</li>
<li>
<p><strong>4. Omoschedasticità (Varianza Costante degli Errori):</strong> La varianza del termine di errore (<span class="math inline">\(\epsilon_i\)</span>) è costante per tutti i valori della variabile indipendente (<span class="math inline">\(X_i\)</span>). Formalmente: <span class="math inline">\(Var(\epsilon_i \mid X_i) = \sigma^2\)</span>, dove <span class="math inline">\(\sigma^2\)</span> è una costante sconosciuta e finita.</p>
<ul>
<li>Questa assunzione implica che la dispersione degli errori attorno alla retta di regressione è la stessa lungo tutto il range di valori di <span class="math inline">\(X\)</span>. Se questa assunzione è violata (eteroschedasticità), lo stimatore OLS <span class="math inline">\(b_1\)</span> rimane non distorto, ma i suoi errori standard stimati non saranno corretti, invalidando i test di ipotesi e gli intervalli di confidenza basati su di essi.</li>
</ul>
</li>
<li>
<p><strong>5. Assenza di Collinearità Perfetta:</strong> Nel modello bivariato, questa assunzione si riduce semplicemente al fatto che la variabile indipendente <span class="math inline">\(X_i\)</span> non deve essere una costante per tutte le osservazioni nel campione. Ovvero, <span class="math inline">\(\sum_{i=1}^n (X_i - \bar{X})^2 &gt; 0\)</span>.</p>
<ul>
<li>Se <span class="math inline">\(X_i\)</span> fosse costante, non ci sarebbe variazione in <span class="math inline">\(X\)</span> da cui stimare l’effetto sulla variazione in <span class="math inline">\(Y\)</span>, e la formula per <span class="math inline">\(b_1\)</span> implicherebbe una divisione per zero.</li>
</ul>
</li>
<li>
<p><strong>6. Normalità degli Errori (Opzionale per piccoli campioni):</strong> Il termine di errore (<span class="math inline">\(\epsilon_i\)</span>) è distribuito normalmente con media zero e varianza costante <span class="math inline">\(\sigma^2\)</span>. Formalmente: <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span>.</p>
<ul>
<li>Questa assunzione <em>non</em> è necessaria perché gli stimatori OLS <span class="math inline">\(b_0\)</span> e <span class="math inline">\(b_1\)</span> siano non distorti e per le proprietà di grandi campioni (come la consistenza e la normalità asintotica). Tuttavia, è cruciale per derivare le distribuzioni di probabilità <em>esatte</em> (come la distribuzione t di Student per i test sui coefficienti) degli stimatori nei campioni di piccole dimensioni, permettendo un’inferenza valida in questi casi. Per grandi campioni, la distribuzione asintotica (approssimata) normale degli stimatori vale anche senza questa assunzione.</li>
</ul>
</li>
</ul>
<p>Sotto le precedenti assunzioni, chiamate <strong>assunzioni di Gauss-Markov</strong>, più l’assunzione di normalità degli errori per l’inferenza nei piccoli campioni, la distribuzione campionaria di <span class="math inline">\(b_1\)</span> viene specificata come segue:</p>
<ol type="1">
<li>
<p><strong>Media (o Valore Atteso): Unbiasedness (Non Distorsione)</strong> Sotto le prime tre assunzioni di Gauss-Markov (Linearità, Campionamento Casuale, Esogeneità dei regressori), lo stimatore OLS <span class="math inline">\(b_1\)</span> è <strong>non distorto</strong> (<em>unbiased</em>) per il vero parametro di popolazione <span class="math inline">\(\beta_1\)</span>. Questo significa che la media della distribuzione campionaria di <span class="math inline">\(b_1\)</span> è uguale al vero valore di <span class="math inline">\(\beta_1\)</span>:</p>
<p><span class="math display">\[E(b_1) = \beta_1.\]</span></p>
<p>In altre parole, se potessimo prendere infiniti campioni, la media degli stimatori <span class="math inline">\(b_1\)</span> che otterremmo sarebbe esattamente il vero coefficiente angolare della popolazione. Il nostro singolo stimatore <span class="math inline">\(b_1\)</span> calcolato su un campione specifico è solo una realizzazione di questa variabile casuale la cui distribuzione è centrata sul vero valore <span class="math inline">\(\beta_1\)</span>.</p>
</li>
<li>
<p><strong>Varianza (o Errore Standard): Precisione dello Stimatore</strong> La varianza della distribuzione campionaria di <span class="math inline">\(b_1\)</span> ci dice quanto sono dispersi i valori di <span class="math inline">\(b_1\)</span> attorno alla loro media (che è <span class="math inline">\(\beta_1\)</span>). Una varianza minore indica che gli stimatori ottenuti da campioni diversi tendono ad essere più vicini al vero <span class="math inline">\(\beta_1\)</span>, il che significa che lo stimatore è più preciso. Sotto le assunzioni di Gauss–Markov (inclusa l’omoschedasticità, ossia errori con varianza costante <span class="math inline">\(\sigma^2_\varepsilon\)</span>), la varianza di <span class="math inline">\(b_1\)</span> è data da:</p>
<p><span class="math display">\[
\mathrm{Var}(b_1) \;=\; \frac{\sigma^2_\varepsilon}{\sum_{i=1}^n (X_i - \bar{X})^2}.
\]</span></p>
<p>L’<strong>errore standard</strong> di <span class="math inline">\(b_1\)</span>, radice quadrata della varianza, è la misura più comunemente usata per indicare la precisione dello stimatore:</p>
<p><span class="math display">\[
SE(b_1) \;=\; \sqrt{\frac{\sigma^2_\varepsilon}{\sum_{i=1}^n (X_i - \bar{X})^2}}.
\]</span></p>
<p>Dalla formula, possiamo osservare che la precisione di <span class="math inline">\(b_1\)</span>:</p>
<ul>
<li>diminuisce all’aumentare della varianza degli errori (<span class="math inline">\(\sigma^2_\varepsilon\)</span>): più “rumore” c’è nei dati, meno preciso sarà lo stimatore;</li>
<li>aumenta all’aumentare della variabilità della variabile indipendente <span class="math inline">\(X\)</span> (misurata da <span class="math inline">\(\sum_{i=1}^n (X_i - \bar{X})^2\)</span>): se i valori di <span class="math inline">\(X\)</span> sono molto concentrati, è difficile stimare la pendenza; se sono ben distribuiti, la stima è più precisa;</li>
<li>aumenta all’aumentare della dimensione del campione (<span class="math inline">\(n\)</span>): campioni più grandi forniscono più informazioni e quindi stime più precise.</li>
</ul>
<p>Nella pratica, non conosciamo la vera varianza degli errori <span class="math inline">\(\sigma^2_\varepsilon\)</span>, perciò la stimiamo usando la varianza dei residui del modello (<span class="math inline">\(s^2_e\)</span>), calcolata come:</p>
<p><span class="math display">\[
s^2_e \;=\; \frac{\sum_{i=1}^n e_i^2}{n - 2},
\]</span></p>
<p>dove <span class="math inline">\(n - 2\)</span> riflette i <strong>gradi di libertà persi</strong> nella stima dei due parametri (<span class="math inline">\(b_0\)</span> e <span class="math inline">\(b_1\)</span>). L’errore standard stimato diventa quindi:</p>
<p><span class="math display">\[
SE(b_1) \;=\; \sqrt{\frac{s^2_e}{\sum_{i=1}^n (X_i - \bar{X})^2}}.
\]</span></p>
<p>Questa è la formula riportata nei principali software statistici (R, Stata, Python).</p>
</li>
<li>
<p><strong>Forma della Distribuzione:</strong></p>
<ul>
<li>Sotto le assunzioni di Gauss-Markov (ma <em>senza</em> assumere la normalità degli errori), per <strong>grandi campioni</strong> (in virtù del Teorema del Limite Centrale), la distribuzione campionaria di <span class="math inline">\(b_1\)</span> è approssimativamente <strong>Normale</strong>.</li>
<li>Se aggiungiamo l’assunzione che i termini di errore <span class="math inline">\(\varepsilon_i\)</span> si distribuiscano normalmente, <span class="math inline">\(\varepsilon_i \sim N(0, \sigma^2)\)</span>, allora la distribuzione campionaria di <span class="math inline">\(b_1\)</span> è <strong>esattamente Normale</strong> per <em>qualsiasi</em> dimensione del campione <span class="math inline">\(n\)</span>. Tuttavia, quando usiamo l’errore standard <em>stimato</em> (che dipende dalla stima della varianza degli errori), la statistica test (t-statistic) segue una distribuzione t di Student.</li>
</ul>
</li>
</ol>
<p><strong>Importanza della Distribuzione Campionaria di <span class="math inline">\(b_1\)</span></strong></p>
<p>Conoscere la distribuzione campionaria di <span class="math inline">\(b_1\)</span> permette all’approccio frequentista di:</p>
<ul>
<li>
<strong>Testare Ipotesi:</strong> Possiamo testare se la variabile indipendente <span class="math inline">\(X\)</span> ha un effetto statisticamente significativo sulla variabile dipendente <span class="math inline">\(Y\)</span>. L’ipotesi nulla più comune è <span class="math inline">\(H_0: \beta_1 = 0\)</span> (non c’è relazione lineare tra <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>). Usiamo il valore stimato <span class="math inline">\(b_1\)</span> e il suo errore standard per calcolare una statistica test (il <span class="math inline">\(t\)</span>-value) e confrontarla con una distribuzione teorica (Normale o <span class="math inline">\(t\)</span> di Student) per ottenere un <span class="math inline">\(p\)</span>-value.</li>
<li>
<strong>Costruire Intervalli di Confidenza:</strong> Possiamo costruire un intervallo di valori plausibili per il vero parametro di popolazione <span class="math inline">\(\beta_1\)</span> basato sul nostro campione. Un intervallo di confidenza al 95% per <span class="math inline">\(\beta_1\)</span> significa che se ripetessimo il campionamento e la stima molte volte, il 95% degli intervalli costruiti in questo modo conterrebbe il vero valore di <span class="math inline">\(\beta_1\)</span>.</li>
</ul>
<p>In sintesi, la distribuzione campionaria di <span class="math inline">\(b_1\)</span> descrive la variabilità attesa dello stimatore del coefficiente angolare attraverso diversi campioni casuali. Comprendere le sue proprietà (media, varianza, forma) è essenziale per interpretare correttamente i risultati di una regressione e trarre conclusioni affidabili sulla relazione nella popolazione.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</section><section id="simulazione-in-r" class="level2" data-number="61.14"><h2 data-number="61.14" class="anchored" data-anchor-id="simulazione-in-r">
<span class="header-section-number">61.14</span> Simulazione in R</h2>
<p><strong>Modello Simulato</strong></p>
<p>Studiamo il modello di regressione lineare senza intercetta, per variabili <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> <strong>standardizzate</strong>:</p>
<p><span class="math display">\[
Y_i = \beta X_i + \varepsilon_i, \quad \varepsilon_i \sim N(0, \sigma_\varepsilon = 0.5).
\]</span> Fissiamo <span class="math inline">\(\beta = 1.5\)</span>, <span class="math inline">\(n = 30\)</span> (dimensione del campione) e ripetiamo la simulazione <span class="math inline">\(100,\!000\)</span> volte per approssimare la distribuzione campionaria di <span class="math inline">\(\hat{\beta}_1\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Parametri del modello</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">1.5</span>           <span class="co"># Vero valore del coefficiente</span></span>
<span><span class="va">sigma_e</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>        <span class="co"># Deviazione standard degli errori</span></span>
<span><span class="va">n_sample</span> <span class="op">&lt;-</span> <span class="fl">30</span>        <span class="co"># Dimensione del campione per ogni simulazione</span></span>
<span><span class="va">nrep</span> <span class="op">&lt;-</span> <span class="fl">100000</span>        <span class="co"># Numero di repliche (campioni) da generare</span></span>
<span></span>
<span><span class="co"># Preallocazione di un vettore per salvare gli stimatori</span></span>
<span><span class="va">b_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">nrep</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Genera la variabile indipendente X una volta (fissa tra i campioni)</span></span>
<span><span class="co"># Questo corrisponde a condizionare sulle X, come nelle assunzioni di Gauss-Markov</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_sample</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ciclo per replicare il processo di campionamento</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nrep</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># 1. Genera errori casuali ε_i ~ N(0, σ_ε)</span></span>
<span>  <span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_sample</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="va">sigma_e</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># 2. Genera la variabile dipendente Y_i = β * X_i + ε_i</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="va">e</span></span>
<span>  </span>
<span>  <span class="co"># 3. Stima β_1 usando la formula OLS: Cov(X,Y)/Var(X)</span></span>
<span>  <span class="co"># Questa formula è valida per modelli con intercetta, ma qui X è centrata (media ≈ 0)</span></span>
<span>  <span class="va">b_hat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Analisi dei risultati</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span></span>
<span>  <span class="va">b_hat</span>, </span>
<span>  breaks <span class="op">=</span> <span class="fl">50</span>, </span>
<span>  col <span class="op">=</span> <span class="st">"lightblue"</span>, </span>
<span>  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Distribuzione Campionaria di"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, </span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Valore Stimato"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  freq <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sovrappone una curva normale con media teorica e deviazione standard osservata</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">b_hat</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">b_hat</span><span class="op">)</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="01_reglin_frequentist_files/figure-html/unnamed-chunk-38-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="01_reglin_frequentist_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Media empirica di β̂₁ (dovrebbe essere vicina a β = 1.5)</span></span>
<span><span class="va">mean_b_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">b_hat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Media empirica di β̂₁:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mean_b_hat</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Media empirica di β̂₁: 1.5</span></span>
<span></span>
<span><span class="co"># Deviazione standard empirica di β̂₁ (confronto con teoria)</span></span>
<span><span class="va">sd_b_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">b_hat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Deviazione standard empirica di β̂₁:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sd_b_hat</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Deviazione standard empirica di β̂₁: 0.074</span></span>
<span></span>
<span><span class="co"># Calcolo dell'errore standard teorico</span></span>
<span><span class="co"># Var(β̂₁) = σ_ε² / Σ(X_i - X̄)²</span></span>
<span><span class="va">theoretical_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sigma_e</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Errore standard teorico:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">theoretical_se</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Errore standard teorico: 0.074</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Interpretazione dei Risultati</strong></p>
<p><strong>1. Non Distorsione (Unbiasedness)</strong></p>
<ul>
<li>La <strong>media empirica</strong> di <span class="math inline">\(\hat{\beta}_1\)</span> (calcolata come <code>mean(b_hat)</code>) dovrebbe essere molto vicina al valore vero <span class="math inline">\(\beta = 1.5\)</span>.<br>
</li>
<li>
<strong>Teoria:</strong> Sotto le assunzioni di Gauss-Markov (linearità, esogeneità, campionamento casuale), lo stimatore OLS è non distorto: <span class="math inline">\(E(\hat{\beta}_1) = \beta_1\)</span>.<br>
</li>
<li>
<strong>Simulazione:</strong> Se la media è prossima a <span class="math inline">\(1.5\)</span>, confermiamo questa proprietà.</li>
</ul>
<p><strong>2. Precisione (Varianza)</strong></p>
<ul>
<li>La <strong>deviazione standard empirica</strong> (<code>sd(b_hat)</code>) misura la dispersione dello stimatore attorno al valore vero.<br>
</li>
<li>
<strong>Teoria:</strong> La varianza di <span class="math inline">\(\hat{\beta}_1\)</span> dipende da:
<ul>
<li>La varianza degli errori <span class="math inline">\(\sigma_\varepsilon^2\)</span> (maggiore rumore → minore precisione),</li>
<li>La variabilità di <span class="math inline">\(X\)</span> (<span class="math inline">\(\sum (X_i - \bar{X})^2\)</span>; maggiore variabilità → maggiore precisione).</li>
</ul>
</li>
<li>
<strong>Simulazione:</strong> Confrontiamo <code>sd(b_hat)</code> con l’errore standard teorico calcolato come: <span class="math display">\[
SE(\hat{\beta}_1) = \sqrt{\frac{\sigma_\varepsilon^2}{\sum_{i=1}^n (X_i - \bar{X})^2}}.
\]</span> I valori dovrebbero essere simili.</li>
</ul>
<p><strong>3. Normalità Asintotica</strong></p>
<ul>
<li>L’istogramma mostra la distribuzione degli stimatori <span class="math inline">\(\hat{\beta}_1\)</span> ottenuti nei <span class="math inline">\(100,\!000\)</span> campioni.<br>
</li>
<li>
<strong>Teoria:</strong> Per grandi campioni (o se gli errori sono normali), la distribuzione campionaria di <span class="math inline">\(\hat{\beta}_1\)</span> è normale.<br>
</li>
<li>
<strong>Simulazione:</strong> La curva rossa (densità normale) dovrebbe sovrapporsi bene all’istogramma, confermando la forma normale.</li>
</ul>
<p><strong>Collegamento con le Assunzioni del Modello</strong></p>
<ol type="1">
<li><p><strong>Esogeneità (<span class="math inline">\(E(\varepsilon_i \mid X_i) = 0\)</span>):</strong><br>
Nella simulazione, gli errori <span class="math inline">\(\varepsilon_i\)</span> sono generati indipendentemente da <span class="math inline">\(X_i\)</span>, soddisfacendo questa assunzione. Se invece <span class="math inline">\(\varepsilon_i\)</span> fosse correlato con <span class="math inline">\(X_i\)</span> (es. <span class="math inline">\(X_i\)</span> influenzasse <span class="math inline">\(\varepsilon_i\)</span>), lo stimatore sarebbe distorto.</p></li>
<li><p><strong>Omoschedasticità:</strong><br>
La varianza degli errori è costante (<span class="math inline">\(\sigma_\varepsilon = 0.5\)</span>), garantendo che la formula dell’errore standard sia corretta. In presenza di eteroschedasticità, l’errore standard teorico non sarebbe più affidabile.</p></li>
<li><p><strong>Normalità degli Errori:</strong><br>
Gli errori sono generati da una distribuzione normale, ma la normalità asintotica della distribuzione campionaria di <span class="math inline">\(\hat{\beta}_1\)</span> sarebbe comunque approssimativamente valida anche con errori non normali (per il Teorema del Limite Centrale).</p></li>
</ol>
<p><strong>Conclusione</strong></p>
<p>La simulazione conferma le proprietà teoriche della distribuzione campionaria di <span class="math inline">\(\hat{\beta}_1\)</span>:</p>
<ul>
<li>
<strong>non distorsione:</strong> la media empirica coincide con il valore vero;</li>
<li>
<strong>precisione:</strong> la varianza dello stimatore diminuisce con la variabilità di <span class="math inline">\(X\)</span> e aumenta con la dimensione del campione;</li>
<li>
<strong>normalità:</strong> la distribuzione è simmetrica e approssimativamente normale, anche per <span class="math inline">\(n = 30\)</span>.</li>
</ul>
<p>Questo esempio pratico chiarisce come le assunzioni del modello influenzino la qualità delle stime e l’affidabilità dell’inferenza statistica.</p>
</section><section id="riflessioni-conclusive" class="level2" data-number="61.15"><h2 data-number="61.15" class="anchored" data-anchor-id="riflessioni-conclusive">
<span class="header-section-number">61.15</span> Riflessioni conclusive&nbsp;</h2>
<p>Il <strong>modello lineare bivariato</strong> costituisce uno strumento basilare per analizzare la relazione tra due variabili e rappresenta una pietra miliare dell’approccio frequentista. In questo capitolo abbiamo mostrato come il modello permetta di quantificare l’associazione fra una variabile indipendente <span class="math inline">\(X\)</span> e una variabile dipendente <span class="math inline">\(Y\)</span> tramite una relazione lineare.</p>
<p>Nell’ambito frequentista, i coefficienti <span class="math inline">\(b_0\)</span> (intercetta) e <span class="math inline">\(b_1\)</span> (pendenza) vengono stimati con il <strong>metodo dei minimi quadrati</strong>, che minimizza la somma dei quadrati dei residui e individua la retta che meglio approssima i dati osservati. L’<strong>indice di determinazione</strong> (<span class="math inline">\(R^2\)</span>) misura la bontà di adattamento del modello, indicando quale quota della variabilità di <span class="math inline">\(Y\)</span> è spiegata da <span class="math inline">\(X\)</span>.</p>
<p>In pratica, il modello lineare bivariato consente di rispondere a domande fondamentali quali:</p>
<ul>
<li><em>Come varia la variabile dipendente al variare della variabile indipendente?</em></li>
<li><em>Qual è intensità e segno dell’associazione tra le due variabili?</em></li>
</ul>
<p>La <strong>semplicità</strong> del modello lo rende utile non solo per descrivere e analizzare relazioni, ma anche per formulare previsioni. Pur limitandosi a un singolo predittore, costituisce la base concettuale per modelli più complessi (ad es. la regressione multipla).</p>
<p>Derivare la <strong>distribuzione campionaria</strong> dei coefficienti permette di svolgere inferenza sui parametri. Tuttavia, nel paradigma frequentista l’inferenza si fonda:</p>
<ol type="1">
<li>sul test dell’ipotesi nulla (che assume, nella popolazione, pendenza esattamente pari a zero);</li>
<li>sulla costruzione degli <strong>intervalli di fiducia</strong>, i quali descrivono le proprietà a lungo termine della <em>procedura</em> di campionamento, ma non forniscono probabilità per il singolo intervallo.</li>
</ol>
<p>La riflessione metodologica contemporanea ha evidenziato i limiti di questa impostazione, mostrando come l’inferenza frequentista sia vulnerabile a pratiche scorrette che hanno alimentato la crisi di riproducibilità in psicologia. Per tali motivi, risulta spesso più informativo riformulare l’inferenza in termini <strong>bayesiani</strong>, dove si ottengono distribuzioni a posteriori dei parametri che consentono interpretazioni probabilistiche dirette e maggior trasparenza nel processo inferenziale.</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Problemi">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problemi
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>1&nbsp;– Definizione e scopi della regressione</strong><br>
Secondo <em>Gelman et al.</em> (2021), quali sono i quattro principali utilizzi della regressione? Fornisci una breve descrizione di ciascuno.</p>
<p><strong>2&nbsp;– Errore di specificazione</strong><br>
Cos’è l’“errore di specificazione” in un modello di regressione? Quali effetti ha sulle stime dei parametri?</p>
<p><strong>3&nbsp;– Stima del modello con <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code></strong><br>
Usando il data‑set <code>kidiq</code> (variabili <code>kid_score</code> e <code>mom_iq</code>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># carica i dati</span></span>
<span><span class="va">kidiq</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"kidiq.dta"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Adatta il modello <code>kid_score ~ mom_iq</code> e riporta intercetta e pendenza.</p>
<p><strong>4&nbsp;– Interpretazione della pendenza</strong><br>
Interpreta in parole la pendenza stimata al punto&nbsp;3 nel contesto dei QI di madri e figli.</p>
<p><strong>5&nbsp;– Indice&nbsp;R²</strong><br>
Calcola l’R² del modello di cui al punto&nbsp;3. Cosa indica il suo valore?</p>
<p><strong>6&nbsp;– Centratura del predittore</strong><br>
Crea la variabile centrata <code>mom_iq_c = mom_iq - mean(mom_iq)</code> e ri‑adatta il modello <code>kid_score ~ mom_iq_c</code>. Qual è la nuova intercetta e perché adesso è più interpretabile?</p>
<p><strong>7&nbsp;– Calcolo manuale di&nbsp;<span class="math inline">\(b\)</span></strong><br>
Calcola manualmente la pendenza con la formula<br><span class="math inline">\(b = \frac{\text{Cov}(x,y)}{\text{Var}(x)}\)</span><br>
e confrontala col risultato di <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p>
<p><strong>8&nbsp;– Confronto tra σ̂ (tradizionale) e σ_CV</strong><br>
* (a)&nbsp;Calcola l’errore standard della regressione (σ̂) usando il modello completo.<br>
* (b)&nbsp;Esegui una validazione incrociata leave‑one‑out (LOOCV) e ottieni σ_CV.<br>
* (c)&nbsp;Spiega perché, in genere, σ_CV è ≥ σ̂.</p>
<p><strong>9&nbsp;– Assunzioni di Gauss‑Markov</strong><br>
Elenca le cinque assunzioni di Gauss‑Markov per la regressione lineare semplice e indica quale, se violata, rende distorto lo stimatore OLS della pendenza.</p>
<p><strong>10&nbsp;– Simulazione della distribuzione campionaria di&nbsp;<span class="math inline">\(b\)</span></strong><br>
Simula&nbsp;100 000 campioni (n = 30) dal modello<br><span class="math inline">\(Y_i = 1.5\,X_i + \varepsilon_i,\; X_i \sim \mathcal N(0,1),\; \varepsilon_i \sim \mathcal N(0,0.5^2)\)</span>.<br>
Per ogni campione calcola <span class="math inline">\(b̂\)</span>. Rappresenta l’istogramma dei 100 000&nbsp;<span class="math inline">\(b̂\)</span>, riporta media e deviazione standard empiriche e confrontale con l’errore standard teorico.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Soluzioni">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Soluzioni
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>1&nbsp;– Definizione e scopi</strong><br>
1. <strong>Previsione</strong>&nbsp;– modellare / predire nuove osservazioni.<br>
2. <strong>Esplorazione delle associazioni</strong>&nbsp;– quantificare relazioni <span class="math inline">\(X \rightarrow Y\)</span>.<br>
3. <strong>Estrapolazione</strong>&nbsp;– generalizzare dal campione alla popolazione.<br>
4. <strong>Inferenza causale</strong>&nbsp;– stimare l’effetto di un intervento quando il design lo consente.</p>
<p><strong>2&nbsp;– Errore di specificazione</strong><br>
Omettere un predittore rilevante ⇒ i residui assorbono la sua varianza ⇒ stime di <span class="math inline">\(b\)</span> distorte (bias) e varianze sottostimate → inferenze non valide.</p>
<p><strong>3&nbsp;– Stima del modello</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gesistsa.github.io/rio/">rio</a></span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="va">kidiq</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html">import</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"kidiq.dta"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_iq</span>, data <span class="op">=</span> <span class="va">kidiq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Intercept)      mom_iq </span></span>
<span><span class="co">#&gt;       25.80        0.61</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esempio di output</p>
<pre><code>(Intercept)     mom_iq 
 25.800        0.610 </code></pre>
<p><strong>4&nbsp;– Interpretazione della pendenza</strong><br>
Un punto in più di QI materno è associato, in media, a <strong>0.61 punti</strong> di QI del figlio.</p>
<p><strong>5&nbsp;– Indice&nbsp;R²</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span>
<span><span class="co">#&gt; [1] 0.201</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Output ≈ 0.20 ⇒ il 20 % della varianza di <code>kid_score</code> è spiegato da <code>mom_iq</code>.</p>
<p><strong>6&nbsp;– Centratura</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq_c</span> <span class="op">&lt;-</span> <span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span></span>
<span><span class="va">mod_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_iq_c</span>, data <span class="op">=</span> <span class="va">kidiq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod_c</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Intercept)    mom_iq_c </span></span>
<span><span class="co">#&gt;       86.80        0.61</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’intercetta ora ≈ <strong>media del QI dei bambini</strong> quando il QI&nbsp;materno è medio.<br>
La pendenza resta 0.61.</p>
<p><strong>7&nbsp;– Calcolo manuale di&nbsp;<code>b</code></strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">b_manual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span>, <span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">mom_iq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">b_manual</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[</span><span class="st">"mom_iq"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "names for current but not for target"</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>TRUE</code> → concordanza perfetta (salvo arrotondamenti).</p>
<p><strong>8&nbsp;– σ̂ vs&nbsp;σ_CV</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># (a) σ̂</span></span>
<span><span class="va">sigma_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">$</span><span class="va">sigma</span></span>
<span></span>
<span><span class="co"># (b) LOOCV</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">)</span></span>
<span><span class="va">res_cv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">fit_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_iq</span>, data <span class="op">=</span> <span class="va">kidiq</span><span class="op">[</span><span class="op">-</span><span class="va">i</span>,<span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">res_cv2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">kidiq</span><span class="op">$</span><span class="va">kid_score</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_i</span>, <span class="va">kidiq</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sigma_CV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">res_cv2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>sigma_hat <span class="op">=</span> <span class="va">sigma_hat</span>, sigma_CV <span class="op">=</span> <span class="va">sigma_CV</span><span class="op">)</span></span>
<span><span class="co">#&gt; sigma_hat  sigma_CV </span></span>
<span><span class="co">#&gt;     18.27     18.31</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>σ_CV</em> tende a superare σ̂ perché ogni predizione è fatta su dati che <strong>non</strong> hanno “visto” quell’osservazione → niente sovradimensionamento.</p>
<p><strong>9&nbsp;– Assunzioni Gauss‑Markov</strong><br>
1. Linearità nei parametri<br>
2. Campionamento casuale IID<br>
3. Esogeneità <span class="math inline">\(E(\varepsilon_i\!\mid X_i)=0\)</span> ← <strong>questa garantisce non‑distorsione</strong><br>
4. Omoschedasticità<br>
5. Assenza di collinearità perfetta</p>
<p><strong>10&nbsp;– Simulazione</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">beta</span>  <span class="op">&lt;-</span> <span class="fl">1.5</span>; <span class="va">sigma_e</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>; <span class="va">n</span>  <span class="op">&lt;-</span> <span class="fl">30</span>; <span class="va">nrep</span> <span class="op">&lt;-</span> <span class="fl">1e5</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">b_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">nrep</span>, <span class="op">{</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="va">sigma_e</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mean_emp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">b_hat</span><span class="op">)</span></span>
<span><span class="va">sd_emp</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">b_hat</span><span class="op">)</span></span>
<span><span class="va">se_theo</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sigma_e</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>media_empirica <span class="op">=</span> <span class="va">mean_emp</span>, sd_empirica <span class="op">=</span> <span class="va">sd_emp</span>, SE_teorico <span class="op">=</span> <span class="va">se_theo</span><span class="op">)</span></span>
<span><span class="co">#&gt; media_empirica    sd_empirica     SE_teorico </span></span>
<span><span class="co">#&gt;        1.50006        0.09477        0.09464</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’istogramma (codice sotto) mostra la forma quasi normale centrata su 1.5.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">b_hat</span>, breaks <span class="op">=</span> <span class="fl">60</span>, freq <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"Distribuzione campionaria di b̂"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"b̂"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">mean_emp</span>, <span class="va">sd_emp</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="01_reglin_frequentist_files/figure-html/unnamed-chunk-47-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="01_reglin_frequentist_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>-&nbsp;La media empirica ≈ 1.5 ⇒ <strong>unbiased</strong>.<br>
-&nbsp;La sd empirica ≈ SE teorico ⇒ formula varianza confermata.<br>
-&nbsp;Distribuzione simmetrica&nbsp;≈&nbsp;Normale ⇒ normalità asintotica verificata.</p>
</div>
</div>
</div>
</section><section id="informazioni-sullambiente-di-sviluppo" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="informazioni-sullambiente-di-sviluppo">Informazioni sull’Ambiente di Sviluppo</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.0 (2025-04-11)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] broom_1.0.8      thematic_0.1.6   MetBrewer_0.2.0  ggokabeito_0.1.0</span></span>
<span><span class="co">#&gt;  [5] see_0.11.0       gridExtra_2.3    patchwork_1.3.0  bayesplot_1.12.0</span></span>
<span><span class="co">#&gt;  [9] psych_2.5.3      scales_1.4.0     markdown_2.0     knitr_1.50      </span></span>
<span><span class="co">#&gt; [13] lubridate_1.9.4  forcats_1.0.0    stringr_1.5.1    dplyr_1.1.4     </span></span>
<span><span class="co">#&gt; [17] purrr_1.0.4      readr_2.1.5      tidyr_1.3.1      tibble_3.2.1    </span></span>
<span><span class="co">#&gt; [21] ggplot2_3.5.2    tidyverse_2.0.0  rio_1.2.3        here_1.0.1      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] generics_0.1.4     stringi_1.8.7      lattice_0.22-7    </span></span>
<span><span class="co">#&gt;  [4] hms_1.1.3          digest_0.6.37      magrittr_2.0.3    </span></span>
<span><span class="co">#&gt;  [7] evaluate_1.0.3     grid_4.5.0         timechange_0.3.0  </span></span>
<span><span class="co">#&gt; [10] RColorBrewer_1.1-3 fastmap_1.2.0      Matrix_1.7-3      </span></span>
<span><span class="co">#&gt; [13] R.oo_1.27.1        rprojroot_2.0.4    jsonlite_2.0.0    </span></span>
<span><span class="co">#&gt; [16] R.utils_2.13.0     backports_1.5.0    mgcv_1.9-3        </span></span>
<span><span class="co">#&gt; [19] mnormt_2.1.1       cli_3.6.5          rlang_1.1.6       </span></span>
<span><span class="co">#&gt; [22] R.methodsS3_1.8.2  splines_4.5.0      withr_3.0.2       </span></span>
<span><span class="co">#&gt; [25] tools_4.5.0        parallel_4.5.0     tzdb_0.5.0        </span></span>
<span><span class="co">#&gt; [28] pacman_0.5.1       vctrs_0.6.5        R6_2.6.1          </span></span>
<span><span class="co">#&gt; [31] lifecycle_1.0.4    htmlwidgets_1.6.4  pkgconfig_2.0.3   </span></span>
<span><span class="co">#&gt; [34] pillar_1.10.2      gtable_0.3.6       glue_1.8.0        </span></span>
<span><span class="co">#&gt; [37] haven_2.5.4        xfun_0.52          tidyselect_1.2.1  </span></span>
<span><span class="co">#&gt; [40] rstudioapi_0.17.1  farver_2.1.2       htmltools_0.5.8.1 </span></span>
<span><span class="co">#&gt; [43] nlme_3.1-168       labeling_0.4.3     rmarkdown_2.29    </span></span>
<span><span class="co">#&gt; [46] compiler_4.5.0</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bibliografia" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-alter2025navigating" class="csl-entry" role="listitem">
Alter, U., Too, M. A., &amp; Cribbie, R. A. (2025). Navigating the Bayes maze: The psychologist’s guide to Bayesian statistics, a hands-on tutorial with R code. <em>International Journal of Psychology</em>, <em>60</em>(1), e13271.
</div>
<div id="ref-caudek2001statistica" class="csl-entry" role="listitem">
Caudek, C., &amp; Luccio, R. (2001). <em>Statistica per psicologi</em> (III rist. 2023, Vol. 11, p. 320). Laterza.
</div>
<div id="ref-fox2015applied" class="csl-entry" role="listitem">
Fox, J. (2015). <em>Applied regression analysis and generalized linear models</em>. Sage publications.
</div>
<div id="ref-gelman2021regression" class="csl-entry" role="listitem">
Gelman, A., Hill, J., &amp; Vehtari, A. (2021). <em>Regression and other stories</em>. Cambridge University Press.
</div>
<div id="ref-schervish2014probability" class="csl-entry" role="listitem">
Schervish, M. J., &amp; DeGroot, M. H. (2014). <em>Probability and statistics</em> (Vol. 563). Pearson Education London, UK:
</div>
<div id="ref-stigler1986" class="csl-entry" role="listitem">
Stigler, S. (1986). <em>The History of Statistics</em>. Belknap Harvard.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Per un approfondimento sull’approccio frequentista alla regressione, si veda, per esempio, <span class="citation" data-cites="caudek2001statistica">Caudek &amp; Luccio (<a href="#ref-caudek2001statistica" role="doc-biblioref">2001</a>)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/linear_models/introduction_linear_models.html" class="pagination-link" aria-label="Introduzione">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduzione</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="pagination-link" aria-label="La regressione verso la media">
        <span class="nav-page-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> è una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/linear_models/01_reglin_frequentist.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>