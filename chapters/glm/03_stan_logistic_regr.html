<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Corrado Caudek">
<title>73&nbsp; Regressione logistica con Stan – Psicometria</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/entropy/01_entropy.html" rel="next">
<link href="../../chapters/glm/introduction_glm.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-5ce6d56fc2a85cf1942de8a9da5c14ea.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a5df851992ffb0fa85403c99d5182cd1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/glm/introduction_glm.html">GLM</a></li><li class="breadcrumb-item"><a href="../../chapters/glm/03_stan_logistic_regr.html"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Regressione logistica con Stan</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Eseguire il codice" class="quarto-navigation-tool px-1" aria-label="Eseguire il codice"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informazioni generali</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/key_notions/introduction_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fondamenti</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/01_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">La crisi di replicazione e la riforma metodologica in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/02_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Concetti chiave</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/03_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Campionamento, metodologia sperimentale e studi osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/04_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/05_cognitive_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dalla descrizione alla spiegazione: modelli meccanicistici e computazionali in psicologia</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/R/introduction_r_lang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/01_r_syntax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Un approccio moderno all’analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/02_utility_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Utility functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/03_r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Programmazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/04_r_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Pacchetti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/05_dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduzione a <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/06_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/07_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">L’ambiente di programmazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/08_ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Utilizzo di strumenti AI</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/eda/introduction_eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/01_project_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Le fasi del progetto di analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/02_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Flusso di lavoro per la pulizia dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/04_exploring_qualitative_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Esplorare i dati qualitativi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/05_exploring_numeric_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Esplorare i dati numerici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/06_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Principi della visualizzazione dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07_loc_scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Indicatori di tendenza centrale e variabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07a_introduction_normal_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Introduzione alla distribuzione normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/08_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Relazioni tra variabili</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/09_causality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/10_estimand.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Estimandi teorici e estimandi empirici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/11_outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Outlier</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/probability/introduction_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilità</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/01_intro_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Interpretazione della probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/02_probability_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Modelli probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/03_prob_spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">La Probabilità come misura della certezza razionale: un’interpretazione Bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/04_sigma-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Dal Discreto al Continuo: la <span class="math inline">\(\sigma\)</span>-algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/05_conditional_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Probabilità condizionata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/06_bayes_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/07_random_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/08_prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Distribuzioni di massa e di densità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/09_expval_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Proprietà delle variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/10_sampling_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11a_joint_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Probabilità congiunta</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11b_cov_cor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Covarianza e correlazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11c_joint_prob_cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Caso continuo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12a_intro_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Introduzione alle distribuzioni di probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12_discr_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/13_cont_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/14_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Assunzione di gaussianità e trasformazioni dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/15_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">La verosimiglianza</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_intro_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_bayesian_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Aggiornare le credenze su un parametro: dal prior alla posterior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_conjugate_families_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_conjugate_families_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (2)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/11_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/12_gamma_exponential_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Modello gamma-esponenziale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/13_prior_pred_check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Controllo predittivo a priori (Prior Predictive Check)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/14_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04a_stan_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Regressione lineare in Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07a_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto: valutare la rilevanza pratica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Pianificazione della dimensione campionaria</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_anova_2vie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">ANOVA ad due vie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/12_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni indipendenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/13_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">GLM</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/introduction_glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/03_stan_logistic_regr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Regressione logistica con Stan</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Entropia</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/01_entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Entropia e informazione di Shannon</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/02_kl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/03_model_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Valutare i modelli bayesiani: Log-Score, LPPD, ELPD e LOO-CV</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Modelli</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Teorie formali dei fenomeni psicologici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/01_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Il modello di revisione degli obiettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/02_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Estensioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/03_rescorla_wagner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Decisioni</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/decision_analysis/01_study_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Analisi delle decisioni</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Missing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/missing/01_mnar_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Dati mancanti in psicologia: identificare e modellare i casi MNAR con un approccio Bayesiano in Stan</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">Frequentismo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/introduction_frequentist_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01_intro_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01a_stime_parametri.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/02_conf_interv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">85</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/03_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">86</span>&nbsp; <span class="chapter-title">La grandezza del campione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/04_test_ipotesi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">87</span>&nbsp; <span class="chapter-title">Significatività statistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/05_two_ind_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">88</span>&nbsp; <span class="chapter-title">Test t di Student per campioni indipendenti</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">89</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">90</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">91</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">92</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">93</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">94</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_piranha.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">95</span>&nbsp; <span class="chapter-title">Il Problema del priming: sfide e paradossi nella psicologia sociale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">96</span>&nbsp; <span class="chapter-title">I gradi di libertà del ricercatore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/09_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">97</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendici</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01a_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Cartelle e documenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a47_first_order_markov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Catene di Markov</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Indice</h2>
   
  <ul class="collapse">
<li><a href="#modello-di-regressione-logistica-per-variabili-binarie" id="toc-modello-di-regressione-logistica-per-variabili-binarie" class="nav-link active" data-scroll-target="#modello-di-regressione-logistica-per-variabili-binarie"><span class="header-section-number">73.1</span> Modello di regressione logistica per variabili binarie</a></li>
  <li><a href="#modello-lineare-nelle-probabilit%C3%A0" id="toc-modello-lineare-nelle-probabilità" class="nav-link" data-scroll-target="#modello-lineare-nelle-probabilit%C3%A0"><span class="header-section-number">73.2</span> Modello Lineare nelle Probabilità</a></li>
  <li><a href="#modello-lineare-nelle-probabilit%C3%A0-vincolato" id="toc-modello-lineare-nelle-probabilità-vincolato" class="nav-link" data-scroll-target="#modello-lineare-nelle-probabilit%C3%A0-vincolato"><span class="header-section-number">73.3</span> Modello lineare nelle probabilità vincolato</a></li>
  <li><a href="#regressione-logistica" id="toc-regressione-logistica" class="nav-link" data-scroll-target="#regressione-logistica"><span class="header-section-number">73.4</span> Regressione logistica</a></li>
  <li><a href="#componente-sistematica" id="toc-componente-sistematica" class="nav-link" data-scroll-target="#componente-sistematica"><span class="header-section-number">73.5</span> Componente sistematica</a></li>
  <li><a href="#componente-aleatoria" id="toc-componente-aleatoria" class="nav-link" data-scroll-target="#componente-aleatoria"><span class="header-section-number">73.6</span> Componente aleatoria</a></li>
  <li><a href="#funzione-legame" id="toc-funzione-legame" class="nav-link" data-scroll-target="#funzione-legame"><span class="header-section-number">73.7</span> Funzione legame</a></li>
  <li><a href="#coefficienti-del-modello-nella-regressione-logistica-e-la-loro-interpretazione" id="toc-coefficienti-del-modello-nella-regressione-logistica-e-la-loro-interpretazione" class="nav-link" data-scroll-target="#coefficienti-del-modello-nella-regressione-logistica-e-la-loro-interpretazione"><span class="header-section-number">73.8</span> Coefficienti del modello nella regressione logistica e la loro interpretazione</a></li>
  <li><a href="#un-esempio-numerico" id="toc-un-esempio-numerico" class="nav-link" data-scroll-target="#un-esempio-numerico"><span class="header-section-number">73.9</span> Un esempio numerico</a></li>
  <li><a href="#regressione-logistica-con-sola-intercetta" id="toc-regressione-logistica-con-sola-intercetta" class="nav-link" data-scroll-target="#regressione-logistica-con-sola-intercetta"><span class="header-section-number">73.10</span> Regressione logistica con sola intercetta</a></li>
  <li><a href="#regressione-logistica-con-un-singolo-predittore-binario" id="toc-regressione-logistica-con-un-singolo-predittore-binario" class="nav-link" data-scroll-target="#regressione-logistica-con-un-singolo-predittore-binario"><span class="header-section-number">73.11</span> Regressione logistica con un singolo predittore binario</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/glm/03_stan_logistic_regr.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/glm/introduction_glm.html">GLM</a></li><li class="breadcrumb-item"><a href="../../chapters/glm/03_stan_logistic_regr.html"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Regressione logistica con Stan</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-reg-logistic-stan" class="quarto-section-identifier"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Regressione logistica con Stan</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">brms</span>, <span class="va">cmdstanr</span>, <span class="va">posterior</span>, <span class="va">brms</span>, <span class="va">bayestestR</span>, <span class="va">insight</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="introduzione" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="introduzione">Introduzione</h2>
<div class="lead">
<p>La regressione logistica è un modello additivo utilizzato per dati binari, ossia dati <span class="math inline">\(y\)</span> che assumono valori 0 o 1. Per modellare i dati binari, dobbiamo aggiungere due caratteristiche al modello base <span class="math inline">\(y = a + bx\)</span>: una trasformazione non lineare che vincola l’output tra 0 e 1 (a differenza di <span class="math inline">\(a + bx\)</span>, che è illimitato), e un metodo per interpretare i numeri risultanti come probabilità che un evento si verifichi.</p>
</div>
<p>In questo capitolo, approfondiremo la regressione logistica bivariata, un modello statistico che ci consente di analizzare le relazioni tra una variabile di esito binaria e una singola variabile indipendente. Esploreremo il processo di stima dei coefficienti del modello attraverso un approccio bayesiano e forniremo un’interpretazione dei risultati ottenuti. Mostreremo come i coefficienti influenzano la probabilità di successo della variabile binaria di esito, nonché come interpretare il loro segno e ampiezza.</p>
<p>La presente trattazione ricalca, in parte, quella fornita da <span class="citation" data-cites="fox2015applied">Fox (<a href="#ref-fox2015applied" role="doc-biblioref">2015</a>)</span>, adattandola a nuovi contesti applicativi. Per una trattazione più ampia dei fondamenti teorici, si consenta la consultazione del suddetto riferimento.</p>
</section><section id="modello-di-regressione-logistica-per-variabili-binarie" class="level2" data-number="73.1"><h2 data-number="73.1" class="anchored" data-anchor-id="modello-di-regressione-logistica-per-variabili-binarie">
<span class="header-section-number">73.1</span> Modello di regressione logistica per variabili binarie</h2>
<p>Il modello di regressione logistica è utilizzato per analizzare la relazione tra una variabile dipendente dicotomica, che assume i valori di “successo” e “fallimento”, e una o più variabili indipendenti, che possono essere sia quantitative che qualitative. Qui ci concentreremo sul caso di una sola variabile indipendente.</p>
<p>Consideriamo <span class="math inline">\(n\)</span> osservazioni i.i.d., dove <span class="math inline">\(Y_i\)</span> indica l’osservazione <span class="math inline">\(i\)</span>-esima della variabile risposta, per <span class="math inline">\(i=1, \dots, n\)</span>. Ogni osservazione è associata a un vettore di variabili esplicative <span class="math inline">\((x_1, \dots, x_p)\)</span>. La relazione che vogliamo esaminare è tra la probabilità di successo <span class="math inline">\(\pi_i\)</span> e la variabile esplicativa, espressa dalla formula:</p>
<p><span class="math display">\[
P(Y=1 \mid X=x_i) = \pi_i.
\]</span></p>
<p>In questo contesto, la variabile dipendente <span class="math inline">\(Y\)</span> segue una distribuzione di Bernoulli, con i seguenti possibili valori:</p>
<p><span class="math display">\[
y_i =
\begin{cases}
    1 &amp; \text{per un successo (per l'osservazione $i$-esima)},\\
    0 &amp; \text{per un fallimento}.
\end{cases}
\]</span></p>
<p>Le probabilità associate a questi valori sono rispettivamente <span class="math inline">\(\pi\)</span> per il successo e <span class="math inline">\(1-\pi\)</span> per il fallimento:</p>
<p><span class="math display">\[
\begin{aligned}
    P(Y_i = 1) &amp;= \pi,\\
    P(Y_i = 0) &amp;= 1-\pi.
\end{aligned}
\]</span></p>
<p>Questo modello permette di studiare come le variabili esplicative influenzino la probabilità di un evento binario, come il successo o il fallimento.</p>
<p>La media condizionata <span class="math inline">\(\mathbb{E}(Y \mid X=x)\)</span> in una popolazione può essere vista come la proporzione di valori 1 per un dato punteggio <span class="math inline">\(x\)</span> sulla variabile esplicativa, ovvero la probabilità condizionata <span class="math inline">\(\pi_i\)</span> di osservare l’esito <span class="math inline">\(Y = 1\)</span> in corrispondenza di un certo livello <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[
\pi_i \equiv P(Y = 1 \mid X = x).
\]</span></p>
<p>Il valore atteso diventa:</p>
<p><span class="math display">\[
\mathbb{E}(Y \mid x) = \pi_i.
\]</span></p>
<p>Se <span class="math inline">\(X\)</span> è una variabile discreta, possiamo calcolare la proporzione di <span class="math inline">\(Y=1\)</span> per ogni valore di <span class="math inline">\(X=x\)</span> nel campione. Queste proporzioni rappresentano una stima non parametrica della funzione di regressione di <span class="math inline">\(Y\)</span> su <span class="math inline">\(X\)</span>, e possono essere stimate tramite tecniche di smoothing.</p>
<p>Per valori bassi della variabile <span class="math inline">\(X\)</span>, la proporzione condizionata di valori <span class="math inline">\(Y=1\)</span> sarà prossima allo 0. Per valori alti di <span class="math inline">\(X\)</span>, la proporzione di valori <span class="math inline">\(Y=1\)</span> sarà prossima a 1. A livelli intermedi di <span class="math inline">\(X\)</span>, la curva di regressione non parametrica gradualmente approssima i valori 0 e 1 seguendo un andamento sigmoidale.</p>
<p>Per illustrare, generiamo dei dati simulati con una variabile dicotomica <span class="math inline">\(Y\)</span> e una variabile discreta <span class="math inline">\(X\)</span> nei quali la probabilità che <span class="math inline">\(Y=1\)</span> aumenta con il valore di <span class="math inline">\(X\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># --- Setup ---------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>                      <span class="co"># Per riproducibilità</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span>                         <span class="co"># Numero di osservazioni</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">9</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># Predittore discreto con livelli 0..9</span></span>
<span></span>
<span><span class="co"># --- Modello logistico e generazione dati -------------------------------</span></span>
<span><span class="va">logistic</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">beta0</span>, <span class="va">beta1</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">beta0</span> <span class="op">+</span> <span class="va">beta1</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span></span>
<span><span class="va">beta1</span> <span class="op">&lt;-</span> <span class="fl">1</span>                       <span class="co"># Maggiore pendenza</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">logistic</span><span class="op">(</span><span class="va">X</span>, <span class="va">beta0</span>, <span class="va">beta1</span><span class="op">)</span>   <span class="co"># Probabilità di successo</span></span>
<span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span>  <span class="co"># Esito dicotomico</span></span>
<span></span>
<span><span class="co"># --- Media di successo e SE per ciascun livello di X --------------------</span></span>
<span><span class="co"># SE stimato come sd(Y)/sqrt(n_k); per proporzioni è vicino a sqrt(p*(1-p)/n_k)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>, Y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_by_X</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_success_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># (opzionale) Limita le barre d’errore all’intervallo [0, 1]</span></span>
<span><span class="va">summary_by_X</span> <span class="op">&lt;-</span> <span class="va">summary_by_X</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    ymin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">mean_success_rate</span> <span class="op">-</span> <span class="va">se</span><span class="op">)</span>,</span>
<span>    ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmin</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">mean_success_rate</span> <span class="op">+</span> <span class="va">se</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Grafico: punti + barre d’errore + smoother non-parametrico (LOESS) --</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">summary_by_X</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">mean_success_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">ymin</span>, ymax <span class="op">=</span> <span class="va">ymax</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, span <span class="op">=</span> <span class="fl">0.3</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X"</span>, y <span class="op">=</span> <span class="st">"Mean Success Rate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="03_stan_logistic_regr_files/figure-html/unnamed-chunk-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="03_stan_logistic_regr_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="modello-lineare-nelle-probabilità" class="level2" data-number="73.2"><h2 data-number="73.2" class="anchored" data-anchor-id="modello-lineare-nelle-probabilità">
<span class="header-section-number">73.2</span> Modello Lineare nelle Probabilità</h2>
<p>Potremmo pensare di usare una funzione lineare per rappresentare la dipendenza di <span class="math inline">\(Y\)</span> da <span class="math inline">\(X\)</span>. Introduciamo un modello lineare con le seguenti assunzioni standard:</p>
<p><span class="math display">\[
Y_i = \alpha + \beta X_i + \varepsilon_i,
\]</span></p>
<p>dove <span class="math inline">\(\varepsilon_i\)</span> segue una distribuzione normale con media 0 e varianza 1 (<span class="math inline">\(\varepsilon_i \sim \mathcal{N}(0, 1)\)</span>) e gli errori <span class="math inline">\(\varepsilon_i\)</span> e <span class="math inline">\(\varepsilon_j\)</span> sono indipendenti per ogni <span class="math inline">\(i \neq j\)</span>. Il valore atteso di <span class="math inline">\(Y_i\)</span> è quindi <span class="math inline">\(\mathbb{E}(Y_i) = \alpha + \beta X_i\)</span>, portando a:</p>
<p><span class="math display">\[
\pi_i = \alpha + \beta X_i.
\]</span></p>
<p>Questo è noto come <em>modello lineare nelle probabilità</em> (<em>linear probability model</em>). Tuttavia, questo approccio presenta una limitazione significativa: non garantisce che i valori predetti di <span class="math inline">\(\pi_i\)</span> siano confinati nell’intervallo [0,1], come richiesto per le probabilità.</p>
<section id="problemi-di-normalità" class="level3" data-number="73.2.1"><h3 data-number="73.2.1" class="anchored" data-anchor-id="problemi-di-normalità">
<span class="header-section-number">73.2.1</span> Problemi di normalità</h3>
<p>Considerando che <span class="math inline">\(Y_i\)</span> può assumere solo i valori 0 o 1, i residui <span class="math inline">\(\varepsilon_i\)</span> risultano anch’essi dicotomici e quindi non possono seguire una distribuzione normale. Ad esempio, se <span class="math inline">\(Y_i=1\)</span> con probabilità <span class="math inline">\(\pi_i\)</span>, il residuo sarà:</p>
<p><span class="math display">\[
\varepsilon_i = 1 - \mathbb{E}(Y_i) = 1 - (\alpha + \beta X_i) = 1 - \pi_i.
\]</span></p>
<p>Se, invece, <span class="math inline">\(Y_i=0\)</span> con probabilità <span class="math inline">\(1-\pi_i\)</span>, il residuo sarà:</p>
<p><span class="math display">\[
\varepsilon_i = 0 - \mathbb{E}(Y_i) = 0 - (\alpha + \beta X_i) = - \pi_i.
\]</span></p>
<p>Tuttavia, se la dimensione del campione è grande, il teorema del limite centrale può mitigare l’importanza dell’assunzione di normalità per le stime dei minimi quadrati.</p>
</section><section id="problematiche-di-eteroschedasticità" class="level3" data-number="73.2.2"><h3 data-number="73.2.2" class="anchored" data-anchor-id="problematiche-di-eteroschedasticità">
<span class="header-section-number">73.2.2</span> Problematiche di eteroschedasticità</h3>
<p>Utilizzare il metodo dei minimi quadrati può essere inappropriato in questo contesto poiché la varianza dei residui non è costante ma dipende dalla media, e quindi dalla variabile <span class="math inline">\(X\)</span>. Assumendo che il modello sia lineare, abbiamo che <span class="math inline">\(\mathbb{E}(\varepsilon_i)=0\)</span>. Sfruttando le relazioni discusse in precedenza, la varianza dei residui si calcola come:</p>
<p><span class="math display">\[
\mathbb{V}(\varepsilon_i) = (1-\pi_i)\pi_i.
\]</span></p>
<p>Consideriamo che la varianza dei residui <span class="math inline">\(\varepsilon_i\)</span> può essere espressa come:</p>
<p><span class="math display">\[
\text{Var}(\varepsilon_i) = \mathbb{E}(\varepsilon_i^2) - \mathbb{E}(\varepsilon_i)^2,
\]</span></p>
<p>dove <span class="math inline">\(\mathbb{E}(\varepsilon_i^2)\)</span> è il valore atteso del quadrato dei residui e <span class="math inline">\(\mathbb{E}(\varepsilon_i)^2\)</span> è il quadrato del valore atteso dei residui.</p>
<p>Ora calcoliamo <span class="math inline">\(\mathbb{E}(\varepsilon_i^2)\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
\mathbb{E}(\varepsilon_i^2) &amp;= \mathbb{E}[(Y_i - \mathbb{E}(Y_i))^2] \\
&amp;= \mathbb{E}[(Y_i - \pi_i)^2] \\
&amp;= \mathbb{E}[(Y_i^2 - 2Y_i\pi_i + \pi_i^2)] \\
&amp;= \mathbb{E}(Y_i^2) - 2\mathbb{E}(Y_i\pi_i) + \mathbb{E}(\pi_i^2) \\
&amp;= \mathbb{E}(Y_i) - 2\mathbb{E}(Y_i\pi_i) + \pi_i^2 \\
&amp;= \pi_i - 2\pi_i^2 + \pi_i^2 \\
&amp;= \pi_i - \pi_i^2 \\
&amp;= \pi_i(1 - \pi_i)
\end{align*}
\]</span></p>
<p>Ora calcoliamo <span class="math inline">\(\mathbb{E}(\varepsilon_i)^2\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
\mathbb{E}(\varepsilon_i)^2 &amp;= (\mathbb{E}(Y_i - \mathbb{E}(Y_i)))^2 \\
&amp;= (\mathbb{E}(Y_i - \pi_i))^2 \\
&amp;= (0)^2 \\
&amp;= 0
\end{align*}
\]</span></p>
<p>Quindi, sostituendo questi risultati nella formula della varianza dei residui, otteniamo:</p>
<p><span class="math display">\[
\text{Var}(\varepsilon_i) = \mathbb{E}(\varepsilon_i^2) - \mathbb{E}(\varepsilon_i)^2 = \pi_i(1 - \pi_i)
\]</span></p>
<p>Quindi, abbiamo dimostrato che la varianza dei residui nel modello lineare nelle probabilità può essere espressa come <span class="math inline">\((1-\pi_i)\pi_i\)</span>.</p>
<p>Dato che <span class="math inline">\(\pi_i\)</span> dipende da <span class="math inline">\(x\)</span>, ciò significa che la varianza non è costante in funzione di <span class="math inline">\(x\)</span>. Questa eteroschedasticità dei residui rappresenta un problema per le stime dei minimi quadrati nel modello lineare, specialmente quando le probabilità <span class="math inline">\(\pi_i\)</span> sono vicine a 0 o 1.</p>
</section><section id="linearità" class="level3" data-number="73.2.3"><h3 data-number="73.2.3" class="anchored" data-anchor-id="linearità">
<span class="header-section-number">73.2.3</span> Linearità</h3>
<p>Il maggiore inconveniente connesso all’adozione del modello lineare nelle probabilità deriva dal fatto che la stima della probabilità di successo, <span class="math inline">\(P(\hat{Y}_i=1)=\hat{\pi}_i\)</span>, non è necessariamente compresa nell’intervallo <span class="math inline">\((0,1)\)</span>, ma può essere sia negativa sia maggiore di 1. Nel caso dell’esempio in discussione, ciò significa che la retta dei minimi quadrati produce valori attesi <span class="math inline">\(\hat{\pi}\)</span> inferiori a 0 per bassi valori della variabile <span class="math inline">\(X\)</span> e valori <span class="math inline">\(\hat{\pi}\)</span> superiori a 1 per valori di <span class="math inline">\(X\)</span> alti.</p>
</section></section><section id="modello-lineare-nelle-probabilità-vincolato" class="level2" data-number="73.3"><h2 data-number="73.3" class="anchored" data-anchor-id="modello-lineare-nelle-probabilità-vincolato">
<span class="header-section-number">73.3</span> Modello lineare nelle probabilità vincolato</h2>
<p>Una soluzione per mantenere <span class="math inline">\(\pi\)</span> all’interno dell’intervallo (0, 1) è la seguente specificazione del modello:</p>
<p><span class="math display">\[
\pi=
\begin{cases}
  0                           &amp;\text{se $\alpha + \beta X &lt; 0$},\\
  \alpha + \beta X           &amp;\text{se $0 \leq \alpha + \beta X \leq 1$},\\
  1 &amp;\text{se $\alpha + \beta X &gt; 1$}.
\end{cases}
\]</span></p>
<p>Questo <em>modello lineare nelle probabilità vincolato</em> mostra alcune instabilità, soprattutto a causa della sua dipendenza critica dai valori estremi di <span class="math inline">\(\pi\)</span>, dove assume i valori 0 o 1. La linearità di <span class="math inline">\(\pi = \alpha + \beta X\)</span> si basa fortemente sui punti in cui si verificano questi estremi. In particolare, la stima di <span class="math inline">\(\pi = 0\)</span> può essere influenzata dal valore minimo di <span class="math inline">\(X\)</span> associato a <span class="math inline">\(Y=1\)</span>, mentre la stima di <span class="math inline">\(\pi = 1\)</span> può dipendere dal valore massimo di <span class="math inline">\(X\)</span> per cui <span class="math inline">\(Y=0\)</span>. Questi valori estremi tendono a variare significativamente tra diversi campioni e possono diventare più estremi all’aumentare della dimensione del campione.</p>
<p>La presenza di più variabili esplicative (<span class="math inline">\(k \geq 2\)</span>) complica ulteriormente la stima dei parametri del modello. Inoltre, il modello mostra un cambiamento brusco nella pendenza della curva di regressione ai punti estremi (0 e 1 di <span class="math inline">\(\pi\)</span>), risultando poco realistico in molte situazioni pratiche. Questo rende il modello meno adatto a descrivere relazioni complesse e gradualmente variabili tra <span class="math inline">\(\pi\)</span> e <span class="math inline">\(X\)</span>.</p>
<p>Una funzione che modella una relazione più fluida e continua tra <span class="math inline">\(\pi\)</span> e <span class="math inline">\(X\)</span> sarebbe più realistica e rappresentativa delle dinamiche osservate. Questo motiva la preferenza per modelli alternativi, come il modello di regressione logistica, che tende a fornire una rappresentazione più accurata e realistica delle interazioni tra variabili dicotomiche e esplicative.</p>
</section><section id="regressione-logistica" class="level2" data-number="73.4"><h2 data-number="73.4" class="anchored" data-anchor-id="regressione-logistica">
<span class="header-section-number">73.4</span> Regressione logistica</h2>
<p>Un metodo efficace per gestire il problema del vincolo sulle probabilità è specificare modelli non direttamente per le probabilità stesse, ma per una loro trasformazione che elimina tale vincolo. Invece di definire un modello lineare per la probabilità condizionata <span class="math inline">\(\pi_i\)</span>, si può specificare un modello lineare per il logaritmo degli odds (logit):</p>
<p><span class="math display">\[
\eta_i = \log_e \frac{\pi_i}{1-\pi_i} = \alpha + \beta x_i,
\]</span></p>
<p>Questo approccio non presenta problemi poiché il logit <span class="math inline">\(\eta_i\)</span> è sempre un numero reale, permettendo di modellare una trasformazione lineare di <span class="math inline">\(\pi_i\)</span>. La trasformazione inversa, che ci permette di ottenere <span class="math inline">\(\pi_i\)</span> da <span class="math inline">\(\eta_i\)</span>, è data dalla funzione logistica:</p>
<p><span class="math display">\[
\pi_i = \frac{e^{\eta_i}}{1 + e^{\eta_i}} = \frac{e^{\alpha + \beta x_i}}{1 + e^{\alpha + \beta x_i}}.
\]</span></p>
<section id="vantaggi-della-regressione-logistica" class="level3" data-number="73.4.1"><h3 data-number="73.4.1" class="anchored" data-anchor-id="vantaggi-della-regressione-logistica">
<span class="header-section-number">73.4.1</span> Vantaggi della regressione logistica</h3>
<p>La regressione logistica presenta diversi vantaggi rispetto al modello lineare delle probabilità:</p>
<ol type="1">
<li>
<strong>Vincolo delle Probabilità:</strong> La trasformazione logistica assicura che i valori predetti di <span class="math inline">\(\pi_i\)</span> siano sempre compresi nell’intervallo [0,1].</li>
<li>
<strong>Interpretabilità degli Odds Ratio:</strong> Il coefficiente <span class="math inline">\(\beta\)</span> può essere interpretato come il cambiamento logaritmico negli odds di successo associato a un incremento unitario di <span class="math inline">\(X\)</span>. In altre parole, <span class="math inline">\(e^\beta\)</span> rappresenta il fattore di aumento (o diminuzione) degli odds per un incremento unitario della variabile indipendente.</li>
<li>
<strong>Gestione dell’Eteroschedasticità:</strong> La forma funzionale della varianza del modello di regressione logistica <span class="math inline">\(\pi_i (1 - \pi_i)\)</span> è intrinsecamente considerata nel processo di stima tramite il metodo della massima verosimiglianza.</li>
</ol></section><section id="esempio-numerico" class="level3" data-number="73.4.2"><h3 data-number="73.4.2" class="anchored" data-anchor-id="esempio-numerico">
<span class="header-section-number">73.4.2</span> Esempio numerico</h3>
<p>Per illustrare l’applicazione della regressione logistica, consideriamo nuovamente i dati simulati precedentemente. Applichiamo il modello di regressione logistica ai dati e tracciamo la curva logistica risultante:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Supponiamo che df contenga X e Y (0/1) già generati</span></span>
<span><span class="co"># Calcolo delle medie e degli errori standard</span></span>
<span><span class="va">summary_by_X</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean_success_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    ymin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">mean_success_rate</span> <span class="op">-</span> <span class="va">se</span><span class="op">)</span>,</span>
<span>    ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmin</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">mean_success_rate</span> <span class="op">+</span> <span class="va">se</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Modello di regressione logistica</span></span>
<span><span class="va">logit_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predizioni su una griglia fine di valori di X</span></span>
<span><span class="va">x_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">X</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">X</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">pred_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">x_vals</span><span class="op">)</span></span>
<span><span class="va">pred_df</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">logit_model</span>, newdata <span class="op">=</span> <span class="va">pred_df</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Grafico</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">summary_by_X</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">mean_success_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">ymin</span>, ymax <span class="op">=</span> <span class="va">ymax</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">pred_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X"</span>, y <span class="op">=</span> <span class="st">"Mean Success Rate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="03_stan_logistic_regr_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="03_stan_logistic_regr_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Questo esempio dimostra come la regressione logistica possa essere utilizzata per modellare una variabile dicotomica in funzione di una variabile indipendente. La curva logistica risultante rappresenta adeguatamente la relazione tra <span class="math inline">\(X\)</span> e la probabilità di successo <span class="math inline">\(Y\)</span>, garantendo che i valori predetti di <span class="math inline">\(\pi_i\)</span> siano sempre compresi nell’intervallo [0,1].</p>
<p>Nelle sezioni seguenti, descriveremo in dettaglio il modello di regressione logistica utilizzato per generare la curva logistica mostrata nella figura precedente. Inizieremo chiarendo i concetti di odds e logit e la loro relazione con le probabilità.</p>
</section></section><section id="componente-sistematica" class="level2" data-number="73.5"><h2 data-number="73.5" class="anchored" data-anchor-id="componente-sistematica">
<span class="header-section-number">73.5</span> Componente sistematica</h2>
<p>La componente sistematica mette in relazione un vettore (<span class="math inline">\(\eta_1, \eta_2, \dots, \eta_k\)</span>) con le variabili esplicative mediante un modello lineare. Sia <span class="math inline">\(X_{ij}\)</span> il valore della <span class="math inline">\(j\)</span>-esima variabile esplicativa (<span class="math inline">\(j=1, 2, \dots, p\)</span>) per l’<span class="math inline">\(i\)</span>-esima osservazione (<span class="math inline">\(i=1, \dots, k\)</span>). Allora</p>
<p><span class="math display">\[
\eta_i = \sum_j \beta_j X_{ij}.
\]</span></p>
<p>Questa combinazione lineare di variabili esplicative è chiamata il <em>predittore lineare</em>. Un <span class="math inline">\(X_{ij}=1, \forall i\)</span> viene utilizzato per il coefficiente dell’intercetta del modello (talvolta denotata da <span class="math inline">\(\alpha\)</span>).</p>
</section><section id="componente-aleatoria" class="level2" data-number="73.6"><h2 data-number="73.6" class="anchored" data-anchor-id="componente-aleatoria">
<span class="header-section-number">73.6</span> Componente aleatoria</h2>
<p>La componente aleatoria del modello suppone l’esistenza di <span class="math inline">\(k\)</span> osservazioni indipendenti <span class="math inline">\(y_1, y_2, \dots, y_k\)</span>, ciascuna delle quali viene trattata come la realizzazione di una variabile casuale <span class="math inline">\(Y_i\)</span>. Si assume che <span class="math inline">\(Y_i\)</span> abbia una distribuzione binomiale:</p>
<p><span class="math display">\[
Y_i \sim Bin(n_i, \pi_i)
\]</span></p>
<p>con parametri <span class="math inline">\(n_i\)</span> e <span class="math inline">\(\pi_i\)</span>. Per dati individuali (uno per ciascun valore <span class="math inline">\(x_i\)</span>), <span class="math inline">\(n_i=1,
    \forall i\)</span>.</p>
</section><section id="funzione-legame" class="level2" data-number="73.7"><h2 data-number="73.7" class="anchored" data-anchor-id="funzione-legame">
<span class="header-section-number">73.7</span> Funzione legame</h2>
<p>La funzione legame <span class="math inline">\(g(\cdot)\)</span> mette in relazione il valore atteso della variabile risposta <span class="math inline">\(Y_i\)</span> con la componente sistematica <span class="math inline">\(\eta_i\)</span> del modello. Abbiamo visto che <span class="math inline">\(\mathbb{E}(Y_i)=\pi_i\)</span>. Che relazione c’è tra <span class="math inline">\(\pi_i\)</span> e il predittore lineare <span class="math inline">\(\eta_i= \alpha + \sum_j  \beta_j X_{ij}\)</span>? La risposta a questa domanda è data dalla funzione legame:</p>
<p><span class="math display">\[
\eta_i = g(\pi_i) = \ln{\frac{\pi_i}{1-\pi_i}} .
\]</span></p>
<p>Si noti che la funzione legame non trasforma la variabile risposta <span class="math inline">\(Y_i\)</span> ma bensì il suo valore atteso <span class="math inline">\(\pi_i\)</span>.</p>
<p>La funzione legame è invertibile: anziché trasformare il valore atteso nel predittore lineare si può trasformare il predittore lineare nel valore atteso <span class="math inline">\(\pi_i\)</span>:</p>
<p><span class="math display">\[
\pi_i = \frac{e^{\eta_i}}{1+e^{\eta_i}} =  \frac{e^{\alpha + \sum_j  \beta_j X_{ij}}}{1+e^{\alpha + \sum_j  \beta_j X_{ij}}}.
\]</span></p>
<p>Si ottiene così un modello non lineare per le probabilità <span class="math inline">\(\pi_i\)</span>.</p>
<p>In conclusione, la regressione logistica estende il concetto di regressione lineare per modellare le probabilità condizionate di esiti Bernoulliani $ Y <span class="math inline">\(, adoperando la funzione logistica come collegamento per trasformare relazioni lineari tra predittori (\)</span> _i = _0 + <em>1 X</em>{i} $) in probabilità nell’intervallo [0,1]. Questo metodo permette di passare dalla modellazione diretta della probabilità $ p $ alla modellazione di una funzione di tale probabilità attraverso una relazione lineare, impiegando la funzione logit come funzione di collegamento.</p>
</section><section id="coefficienti-del-modello-nella-regressione-logistica-e-la-loro-interpretazione" class="level2" data-number="73.8"><h2 data-number="73.8" class="anchored" data-anchor-id="coefficienti-del-modello-nella-regressione-logistica-e-la-loro-interpretazione">
<span class="header-section-number">73.8</span> Coefficienti del modello nella regressione logistica e la loro interpretazione</h2>
<p>Un aspetto cruciale per comprendere la relazione tra le variabili predittive e una variabile di risposta binaria è l’interpretazione dei coefficienti del modello.</p>
<section id="odds-ratio" class="level3" data-number="73.8.1"><h3 data-number="73.8.1" class="anchored" data-anchor-id="odds-ratio">
<span class="header-section-number">73.8.1</span> Odds Ratio</h3>
<p>Il caso più semplice che consente di interpetare l’odds ratio in una regressione logistica è quando la variabile indipendente (X) è binaria (cioè può assumere solo valori 0 e 1).</p>
<p>In una regressione logistica, il modello assume la forma:</p>
<p><span class="math display">\[
\log \left( \frac{P(Y = 1)}{P(Y = 0)} \right) = \beta_0 + \beta_1 X ,
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(\log \left( \frac{P(Y = 1)}{P(Y = 0)} \right)\)</span> è il logaritmo dell’odds che l’evento <span class="math inline">\(Y = 1\)</span> avvenga,</li>
<li>
<span class="math inline">\(\beta_0\)</span> è l’intercetta del modello,</li>
<li>
<span class="math inline">\(\beta_1\)</span> è il coefficiente per la variabile indipendente <span class="math inline">\(X\)</span>.</li>
</ul></section><section id="passo-1-calcolare-gli-odds-per-i-due-valori-di-x" class="level3" data-number="73.8.2"><h3 data-number="73.8.2" class="anchored" data-anchor-id="passo-1-calcolare-gli-odds-per-i-due-valori-di-x">
<span class="header-section-number">73.8.2</span> Passo 1: Calcolare gli odds per i due valori di <span class="math inline">\(X\)</span>
</h3>
<p>Quando <span class="math inline">\(X = 0\)</span>, l’equazione diventa:</p>
<p><span class="math display">\[
\log \left( \frac{P(Y = 1 \mid X = 0)}{P(Y = 0 \mid X = 0)} \right) = \beta_0 .
\]</span></p>
<p>Questo significa che l’odds di <span class="math inline">\(Y = 1\)</span> dato che <span class="math inline">\(X = 0\)</span> è:</p>
<p><span class="math display">\[
\frac{P(Y = 1 \mid X = 0)}{P(Y = 0 \mid X = 0)} = e^{\beta_0} .
\]</span></p>
<p>Allo stesso modo, quando <span class="math inline">\(X = 1\)</span>, l’equazione diventa:</p>
<p><span class="math display">\[
\log \left( \frac{P(Y = 1 \mid X = 1)}{P(Y = 0 \mid X = 1)} \right) = \beta_0 + \beta_1 .
\]</span></p>
<p>Quindi, l’odds di <span class="math inline">\(Y = 1\)</span> dato che <span class="math inline">\(X = 1\)</span> è:</p>
<p><span class="math display">\[
\frac{P(Y = 1 \mid X = 1)}{P(Y = 0 \mid X = 1)} = e^{\beta_0 + \beta_1} .
\]</span></p>
</section><section id="passo-2-calcolare-lodds-ratio" class="level3" data-number="73.8.3"><h3 data-number="73.8.3" class="anchored" data-anchor-id="passo-2-calcolare-lodds-ratio">
<span class="header-section-number">73.8.3</span> Passo 2: Calcolare l’Odds Ratio</h3>
<p>L’odds ratio è il rapporto tra gli odds quando <span class="math inline">\(X = 1\)</span> e quando <span class="math inline">\(X = 0\)</span>:</p>
<p><span class="math display">\[
\text{Odds Ratio} = \frac{\frac{P(Y = 1 \mid X = 1)}{P(Y = 0 \mid X = 1)}}{\frac{P(Y = 1 \mid X = 0)}{P(Y = 0 \mid X = 0)}} = \frac{e^{\beta_0 + \beta_1}}{e^{\beta_0}}.
\]</span></p>
<p>Semplificando, otteniamo:</p>
<p><span class="math display">\[
\text{Odds Ratio} = e^{\beta_1} .
\]</span></p>
</section><section id="interpretazione-dellodds-ratio" class="level3" data-number="73.8.4"><h3 data-number="73.8.4" class="anchored" data-anchor-id="interpretazione-dellodds-ratio">
<span class="header-section-number">73.8.4</span> Interpretazione dell’Odds Ratio</h3>
<p>L’odds ratio <span class="math inline">\(e^{\beta_1}\)</span> rappresenta il cambiamento relativo negli odds di <span class="math inline">\(Y = 1\)</span> per un aumento di una unità di <span class="math inline">\(X\)</span> (in questo caso, il passaggio da <span class="math inline">\(X = 0\)</span> a <span class="math inline">\(X = 1\)</span>).</p>
<p>Se <span class="math inline">\(\beta_1\)</span> è:</p>
<ul>
<li>
<strong>Maggiore di zero</strong> (<span class="math inline">\(e^{\beta_1} &gt; 1\)</span>): l’odds di <span class="math inline">\(Y = 1\)</span> aumenta quando <span class="math inline">\(X\)</span> passa da 0 a 1.</li>
<li>
<strong>Minore di zero</strong> (<span class="math inline">\(e^{\beta_1} &lt; 1\)</span>): l’odds di <span class="math inline">\(Y = 1\)</span> diminuisce quando <span class="math inline">\(X\)</span> passa da 0 a 1.</li>
<li>
<strong>Uguale a zero</strong> (<span class="math inline">\(e^{\beta_1} = 1\)</span>): l’odds di <span class="math inline">\(Y = 1\)</span> non cambia in base ai valori di <span class="math inline">\(X\)</span>.</li>
</ul>
<p>In sintesi, l’odds ratio <span class="math inline">\(e^{\beta_1}\)</span> fornisce una misura dell’associazione tra la variabile binaria <span class="math inline">\(X\)</span> e la probabilità dell’evento <span class="math inline">\(Y = 1\)</span>, rappresentando il moltiplicatore degli odds nel caso in cui <span class="math inline">\(X\)</span> passi da 0 a 1.</p>
</section><section id="interpretazione-sui-logit" class="level3" data-number="73.8.5"><h3 data-number="73.8.5" class="anchored" data-anchor-id="interpretazione-sui-logit">
<span class="header-section-number">73.8.5</span> Interpretazione sui Logit</h3>
<p>Nella regressione logistica, ogni coefficiente <span class="math inline">\(\beta_j\)</span> del modello può essere interpretato direttamente in termini di log-odds, che sono i logaritmi delle probabilità di ottenere un evento con esito positivo (<span class="math inline">\(y=1\)</span>). Quando interpretiamo i coefficienti:</p>
<ul>
<li><p><strong>Coefficienti Positivi (<span class="math inline">\(\beta_j &gt; 0\)</span>)</strong>: Un coefficiente positivo indica che c’è una relazione diretta tra il predittore e l’aumento dei log-odds di osservare l’evento di interesse. Questo significa che all’aumentare del valore del predittore, la probabilità dell’evento di interesse aumenta.</p></li>
<li><p><strong>Coefficienti Negativi (<span class="math inline">\(\beta_j &lt; 0\)</span>)</strong>: Al contrario, un coefficiente negativo indica una relazione inversa tra il predittore e la probabilità logistica dell’evento. Con l’aumentare del predittore, i log-odds e quindi la probabilità dell’evento diminuiscono.</p></li>
</ul></section><section id="interpretazione-sugli-odds-ratio-or" class="level3" data-number="73.8.6"><h3 data-number="73.8.6" class="anchored" data-anchor-id="interpretazione-sugli-odds-ratio-or">
<span class="header-section-number">73.8.6</span> Interpretazione sugli Odds Ratio (OR)</h3>
<p>L’interpretazione dei coefficienti nella regressione logistica può estendersi agli odds ratio (OR), che forniscono informazioni sulla relazione tra i predittori e la probabilità dell’evento di interesse. Per esempio, consideriamo un modello con un predittore continuo <span class="math inline">\(X\)</span> e un coefficiente <span class="math inline">\(\beta_1 = 0.50\)</span>. Il logaritmo naturale dell’odds ratio, <span class="math inline">\(\log(OR) = 0.50\)</span>, viene esponenziato per ottenere:</p>
<p><span class="math display">\[
OR = e^{0.50} \approx 1.65.
\]</span></p>
<p>Questo risultato indica che per un’unità di incremento in <span class="math inline">\(X\)</span>, l’odds di sperimentare l’evento di interesse è circa 1.65 volte maggiore. In altre parole, l’incremento di una unità nel predittore <span class="math inline">\(X\)</span> aumenta l’odds di sperimentare l’evento di interesse di circa il 65%. Viceversa, un coefficiente negativo indicherebbe una diminuzione dell’odds per un incremento di una unità in <span class="math inline">\(X\)</span>.</p>
</section><section id="interpretazione-sulla-scala-delle-probabilità" class="level3" data-number="73.8.7"><h3 data-number="73.8.7" class="anchored" data-anchor-id="interpretazione-sulla-scala-delle-probabilità">
<span class="header-section-number">73.8.7</span> Interpretazione sulla Scala delle Probabilità</h3>
<p>La regressione logistica consente di interpretare i coefficienti non solo in termini di log-odds, ma anche relativamente alle variazioni di probabilità. Consideriamo un modello che predice la probabilità di superare un esame basandosi sul numero di ore di studio (<span class="math inline">\(X\)</span>).</p>
<p>Supponiamo che il coefficiente associato alle ore di studio sia <span class="math inline">\(\beta_1 = 0.5\)</span>. Questo valore indica che ogni ora aggiuntiva di studio incrementa i log-odds di successo nell’esame. Per comprendere l’impatto di un’ora in più di studio sulla probabilità di successo, possiamo utilizzare la seguente formula:</p>
<p><span class="math display">\[
\Delta p = \frac{1}{1 + e^{-(\beta_0 + 0.5 \cdot (X_1 + 1))}} - \frac{1}{1 + e^{-(\beta_0 + 0.5 \cdot X_1)}}.
\]</span></p>
<p>Questa formula calcola la differenza tra la probabilità di successo dopo aver aggiunto un’ora di studio e la probabilità di successo prima di tale aggiunta. In termini pratici, <span class="math inline">\(\Delta p\)</span> rappresenta l’incremento della probabilità di superare l’esame attribuibile a un’ora supplementare di studio. Questa interpretazione è cruciale per valutare quantitativamente l’effetto delle ore di studio sulla probabilità di superare l’esame.</p>
</section></section><section id="un-esempio-numerico" class="level2" data-number="73.9"><h2 data-number="73.9" class="anchored" data-anchor-id="un-esempio-numerico">
<span class="header-section-number">73.9</span> Un esempio numerico</h2>
<p>Consideriamo nuovamente i dati simulati in precedenza</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span><span class="co">#&gt;       X     Y</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1     0     0</span></span>
<span><span class="co">#&gt; 2     4     1</span></span>
<span><span class="co">#&gt; 3     0     0</span></span>
<span><span class="co">#&gt; 4     8     1</span></span>
<span><span class="co">#&gt; 5     9     1</span></span>
<span><span class="co">#&gt; 6     3     0</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Stimeremo ora i coefficienti del modello di regressione logistica usando Stan. Definiamo i dati nel formato atteso da Stan:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stan_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Y</span>,</span>
<span>  x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compiliamo il modello di regressione logistica e stampiamo lo script Stan:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Costruisci il path al file Stan</span></span>
<span><span class="va">stan_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"stan"</span>, <span class="st">"logistic_regression.stan"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Compila il modello Stan</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">cmdstan_model</span><span class="op">(</span><span class="va">stan_file</span><span class="op">)</span></span>
<span><span class="co"># Stampa il codice Stan</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="va">stan_file</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; data {</span></span>
<span><span class="co">#&gt;   int&lt;lower=0&gt; N;</span></span>
<span><span class="co">#&gt;   vector[N] x;</span></span>
<span><span class="co">#&gt;   array[N] int&lt;lower=0, upper=1&gt; y;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; parameters {</span></span>
<span><span class="co">#&gt;   real alpha;</span></span>
<span><span class="co">#&gt;   real beta;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; model {</span></span>
<span><span class="co">#&gt;   y ~ bernoulli_logit(alpha + beta * x);</span></span>
<span><span class="co">#&gt; }</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Eseguiamo il campionamento MCMC:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">stan_data</span>,</span>
<span>  iter_warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  iter_sampling <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span>          <span class="co"># 0 = non mostrare progress bar</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esaminiamo le tracce:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Estrai i draw posteriori come array</span></span>
<span><span class="va">posterior_array</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mcmc_trace</span><span class="op">(</span><span class="va">posterior_array</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="03_stan_logistic_regr_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="03_stan_logistic_regr_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Otteniamo le stime a posteriori dei parametri:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 10</span></span>
<span><span class="co">#&gt;   variable  mean median    sd   mad    q5   q95  rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 alpha    -1.73  -1.73  0.17  0.17 -2.02 -1.45  1.00  2394.45  2658.68</span></span>
<span><span class="co">#&gt; 2 beta      0.90   0.90  0.06  0.06  0.80  1.01  1.00  2390.48  2555.30</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Creiamo un nuovo DataFrame con 100 valori <span class="math inline">\(x\)</span> nell’intervallo [0, 9]:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">new_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">9</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">new_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;         x</span></span>
<span><span class="co">#&gt; 1 0.00000</span></span>
<span><span class="co">#&gt; 2 0.09091</span></span>
<span><span class="co">#&gt; 3 0.18182</span></span>
<span><span class="co">#&gt; 4 0.27273</span></span>
<span><span class="co">#&gt; 5 0.36364</span></span>
<span><span class="co">#&gt; 6 0.45455</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Otteniamo le medie a posteriori dei parametri <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="st">"alpha"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">beta</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="st">"beta"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -1.732</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.905</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcoliamo i logit per ogni valore <span class="math inline">\(x\)</span> nel dataset <code>new_data</code> utilizzando le stime a posteriori dei parametri <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> ottenute dal modello di regressione logistica. Nel modello di regressione logistica, il logit della probabilità è una funzione lineare di <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[
\log \left( \frac{p}{1-p} \right) = \alpha + \beta x
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">logit_p</span> <span class="op">=</span> <span class="va">alpha</span> <span class="op">+</span> <span class="va">new_data</span><span class="op">$</span><span class="va">x</span> <span class="op">*</span> <span class="va">beta</span></span>
<span><span class="va">logit_p</span></span>
<span><span class="co">#&gt;   [1] -1.732313 -1.650044 -1.567776 -1.485508 -1.403239 -1.320971 -1.238702</span></span>
<span><span class="co">#&gt;   [8] -1.156434 -1.074166 -0.991897 -0.909629 -0.827361 -0.745092 -0.662824</span></span>
<span><span class="co">#&gt;  [15] -0.580555 -0.498287 -0.416019 -0.333750 -0.251482 -0.169213 -0.086945</span></span>
<span><span class="co">#&gt;  [22] -0.004677  0.077592  0.159860  0.242128  0.324397  0.406665  0.488934</span></span>
<span><span class="co">#&gt;  [29]  0.571202  0.653470  0.735739  0.818007  0.900275  0.982544  1.064812</span></span>
<span><span class="co">#&gt;  [36]  1.147081  1.229349  1.311617  1.393886  1.476154  1.558423  1.640691</span></span>
<span><span class="co">#&gt;  [43]  1.722959  1.805228  1.887496  1.969764  2.052033  2.134301  2.216570</span></span>
<span><span class="co">#&gt;  [50]  2.298838  2.381106  2.463375  2.545643  2.627911  2.710180  2.792448</span></span>
<span><span class="co">#&gt;  [57]  2.874717  2.956985  3.039253  3.121522  3.203790  3.286059  3.368327</span></span>
<span><span class="co">#&gt;  [64]  3.450595  3.532864  3.615132  3.697400  3.779669  3.861937  3.944206</span></span>
<span><span class="co">#&gt;  [71]  4.026474  4.108742  4.191011  4.273279  4.355548  4.437816  4.520084</span></span>
<span><span class="co">#&gt;  [78]  4.602353  4.684621  4.766889  4.849158  4.931426  5.013695  5.095963</span></span>
<span><span class="co">#&gt;  [85]  5.178231  5.260500  5.342768  5.425036  5.507305  5.589573  5.671842</span></span>
<span><span class="co">#&gt;  [92]  5.754110  5.836378  5.918647  6.000915  6.083184  6.165452  6.247720</span></span>
<span><span class="co">#&gt;  [99]  6.329989  6.412257</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esaminiamo graficamente la relazione tra il logit <span class="math inline">\(\log \left( \frac{p}{1-p} \right)\)</span> e <span class="math inline">\(x\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Aggiungi la colonna logit_p a new_data</span></span>
<span><span class="va">new_data</span><span class="op">$</span><span class="va">logit_p</span> <span class="op">&lt;-</span> <span class="va">logit_p</span></span>
<span></span>
<span><span class="co"># Grafico</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">new_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">logit_p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Logit Predetti in Funzione di X"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"X"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Logit"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="03_stan_logistic_regr_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="03_stan_logistic_regr_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Calcoliamo i logit per ogni valore <span class="math inline">\(x\)</span> nel dataset <code>new_data</code> utilizzando le stime a posteriori dei parametri <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> ottenute dal modello di regressione logistica. Nel modello di regressione logistica, il logit della probabilità è una funzione lineare di <span class="math inline">\(x\)</span>. Per ottenere la probabilità <span class="math inline">\(p\)</span> dalla trasformazione del logit, possiamo utilizzare la funzione logistica inversa. Svolgiamo la conversione:</p>
<ol type="1">
<li>
<p>Calcoliamo il logit per ogni valore di <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[
\text{logit}_p = \alpha + \beta x
\]</span></p>
</li>
<li>
<p>Applichiamo la funzione logistica inversa (antilogit) per ottenere la probabilità <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
p = \frac{e^{\text{logit}_p}}{1 + e^{\text{logit}_p}} = \frac{e^{\alpha + \beta x}}{1 + e^{\alpha + \beta x}}
\]</span></p>
</li>
</ol>
<p>Questa formula ci permette di trasformare il logit in una probabilità compresa tra 0 e 1 per ogni valore di <span class="math inline">\(x\)</span> nel dataset <code>new_data</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcola le probabilità dalla scala logit</span></span>
<span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">new_data</span><span class="op">$</span><span class="va">logit_p</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">new_data</span><span class="op">$</span><span class="va">logit_p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Aggiungi la colonna a new_data</span></span>
<span><span class="va">new_data</span><span class="op">$</span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="va">prob</span></span>
<span></span>
<span><span class="co"># Grafico con ggplot2</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">new_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">prob</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Probabilità Predetta in Funzione di X"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"X"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Probabilità Predetta"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="03_stan_logistic_regr_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="03_stan_logistic_regr_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<section id="interpretazione-dei-coefficienti-nella-regressione-logistica" class="level3" data-number="73.9.1"><h3 data-number="73.9.1" class="anchored" data-anchor-id="interpretazione-dei-coefficienti-nella-regressione-logistica">
<span class="header-section-number">73.9.1</span> Interpretazione dei coefficienti nella regressione logistica</h3>
<p>Abbiamo stimato i coefficienti <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> dal modello di regressione logistica con i seguenti valori:</p>
<ul>
<li><span class="math inline">\(\alpha = -1.7784477\)</span></li>
<li><span class="math inline">\(\beta = 1.003503126\)</span></li>
</ul>
<p>Esamineremo ora l’interpretazione di questi coefficienti sulla scala dei logit, dell’odds ratio e delle probabilità.</p>
<section id="la-regola-del-dividere-per-4" class="level4" data-number="73.9.1.1"><h4 data-number="73.9.1.1" class="anchored" data-anchor-id="la-regola-del-dividere-per-4">
<span class="header-section-number">73.9.1.1</span> La regola del dividere per 4</h4>
<p>La regola del dividere per 4 è un metodo utile per interpretare i coefficienti della regressione logistica. Dividendo il coefficiente <span class="math inline">\(\beta\)</span> per 4, si ottiene un’approssimazione della massima variazione nella probabilità <span class="math inline">\(\Pr(y = 1)\)</span> per un incremento unitario in <span class="math inline">\(x\)</span>, in corrispondenza di <span class="math inline">\(p = 0.5\)</span>.</p>
<p>La curva logistica è più ripida al centro, dove <span class="math inline">\(\alpha + \beta x = 0\)</span> e quindi <span class="math inline">\(\text{logit}^{-1}(\alpha + \beta x) = 0.5\)</span>. In questo punto, la pendenza della curva, ovvero la derivata della funzione logistica, è massima e raggiunge il valore <span class="math inline">\(\beta / 4\)</span>.</p>
<p>Per esempio, nel modello con <span class="math inline">\(\alpha = -1.778\)</span> e <span class="math inline">\(\beta = 1.003\)</span>, dividendo <span class="math inline">\(\beta\)</span> per 4 otteniamo circa 0.25. Questo valore rappresenta l’aumento massimo, in termini di probabilità, che possiamo aspettarci per un incremento unitario in <span class="math inline">\(x\)</span>, in corrispondenza di <span class="math inline">\(p = 0.5\)</span>.</p>
<p>In sintesi, la regola del dividere per 4 semplifica l’interpretazione dei coefficienti della regressione logistica, fornendo un’indicazione intuitiva di come la variabile indipendente influisce sulla probabilità dell’evento di interesse.</p>
</section><section id="scala-dei-logit" class="level4" data-number="73.9.1.2"><h4 data-number="73.9.1.2" class="anchored" data-anchor-id="scala-dei-logit">
<span class="header-section-number">73.9.1.2</span> Scala dei Logit</h4>
<p>Nella regressione logistica, la funzione logit rappresenta una relazione lineare tra il logit della probabilità di successo e la variabile indipendente <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[
\log \left( \frac{p}{1-p} \right) = \alpha + \beta x
\]</span></p>
<p>Con i coefficienti stimati, la funzione logit diventa:</p>
<p><span class="math display">\[
\log \left( \frac{p}{1-p} \right) = -1.7784477 + 1.003503126 \cdot x
\]</span></p>
<ul>
<li>
<strong><span class="math inline">\(\alpha = -1.7784477\)</span></strong>: Questo è l’intercetta del modello, il valore del logit quando <span class="math inline">\(x = 0\)</span>. Indica che, quando <span class="math inline">\(x\)</span> è 0, il logit della probabilità di successo è <span class="math inline">\(-1.778\)</span>.</li>
<li>
<strong><span class="math inline">\(\beta = 1.003503126\)</span></strong>: Questo è il coefficiente di <span class="math inline">\(x\)</span> e rappresenta il cambiamento nel logit per ogni incremento unitario in <span class="math inline">\(x\)</span>. In altre parole, per ogni incremento di 1 unità in <span class="math inline">\(x\)</span>, il logit della probabilità di successo aumenta di circa <span class="math inline">\(1.0035\)</span>.</li>
</ul></section><section id="odds-ratio-1" class="level4" data-number="73.9.1.3"><h4 data-number="73.9.1.3" class="anchored" data-anchor-id="odds-ratio-1">
<span class="header-section-number">73.9.1.3</span> Odds Ratio</h4>
<p>L’odds ratio (OR) misura il cambiamento relativo nelle odds di successo per un incremento unitario in <span class="math inline">\(x\)</span>. È ottenuto esponenziando il coefficiente <span class="math inline">\(\beta\)</span>:</p>
<p><span class="math display">\[
\text{OR} = e^{\beta} = e^{1.0035} \approx 2.728
\]</span></p>
<p>Un odds ratio di circa <span class="math inline">\(2.728\)</span> indica che, per ogni incremento unitario in <span class="math inline">\(x\)</span>, le odds di successo aumentano di circa <span class="math inline">\(172.8\%\)</span>. In altre parole, l’odds di successo è circa <span class="math inline">\(2.728\)</span> volte maggiore per ogni unità aggiuntiva di <span class="math inline">\(x\)</span>.</p>
</section><section id="scala-delle-probabilità" class="level4" data-number="73.9.1.4"><h4 data-number="73.9.1.4" class="anchored" data-anchor-id="scala-delle-probabilità">
<span class="header-section-number">73.9.1.4</span> Scala delle Probabilità</h4>
<p>Per interpretare l’effetto di <span class="math inline">\(\beta\)</span> sulla scala delle probabilità, possiamo considerare come la probabilità <span class="math inline">\(p\)</span> cambia in corrispondenza di specifici valori di <span class="math inline">\(x\)</span>.</p>
<ol type="1">
<li>Quando <span class="math inline">\(x = 0\)</span>:</li>
</ol>
<p><span class="math display">\[
\log \left( \frac{p}{1-p} \right) = -1.778
\]</span></p>
<p>Invertendo il logit per ottenere <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
p = \frac{e^{-1.7784477}}{1 + e^{-1.7784477}} \approx \frac{0.169} {1 + 0.169} \approx 0.144
\]</span></p>
<p>Quindi, la probabilità di successo quando <span class="math inline">\(x = 0\)</span> è circa <span class="math inline">\(14.4\%\)</span>.</p>
<ol start="2" type="1">
<li>Per un incremento unitario in <span class="math inline">\(x\)</span>, diciamo <span class="math inline">\(x = 1\)</span>:</li>
</ol>
<p><span class="math display">\[
\log \left( \frac{p}{1-p} \right) = -1.778 + 1.0035 \cdot 1 \approx -0.7749
\]</span></p>
<p>Invertendo il logit per ottenere <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
p = \frac{e^{-0.774944574}}{1 + e^{-0.774944574}} \approx \frac{0.461} {1 + 0.461} \approx 0.316
\]</span></p>
<p>Quindi, la probabilità di successo quando <span class="math inline">\(x = 1\)</span> è circa <span class="math inline">\(31.6\%\)</span>. Tuttavia questo incremento non è costante per i diversi livelli <span class="math inline">\(x\)</span> e il modo più semplice per mostrare la relazione tra probabilità di successo e la variabile <span class="math inline">\(X\)</span> è quella di generare un grafico come quello che abbimo prodotto in precedenza.</p>
</section></section><section id="riassunto" class="level3" data-number="73.9.2"><h3 data-number="73.9.2" class="anchored" data-anchor-id="riassunto">
<span class="header-section-number">73.9.2</span> Riassunto</h3>
<ul>
<li>
<strong>Scala dei Logit</strong>: Un incremento unitario in <span class="math inline">\(x\)</span> aumenta il logit della probabilità di successo di <span class="math inline">\(1.0035\)</span>.</li>
<li>
<strong>Odds Ratio</strong>: Le odds di successo aumentano di circa <span class="math inline">\(2.728\)</span> volte per ogni incremento unitario in <span class="math inline">\(x\)</span>.</li>
<li>
<strong>Scala delle Probabilità</strong>: Quando <span class="math inline">\(x\)</span> passa da 0 a 1, la probabilità di successo aumenta da circa <span class="math inline">\(14.4\%\)</span> a <span class="math inline">\(31.6\%\)</span>. Per la relazione tra ciascun livello <span class="math inline">\(x\)</span> e la probabilità di successo è necessario generare un grafico.</li>
</ul>
<p>Questa analisi dimostra come i coefficienti del modello di regressione logistica possono essere interpretati su diverse scale, fornendo un quadro completo della relazione tra la variabile indipendente e la probabilità di successo.</p>
</section></section><section id="regressione-logistica-con-sola-intercetta" class="level2" data-number="73.10"><h2 data-number="73.10" class="anchored" data-anchor-id="regressione-logistica-con-sola-intercetta">
<span class="header-section-number">73.10</span> Regressione logistica con sola intercetta</h2>
<p>Nella regressione lineare, un modello con sola intercetta stima semplicemente la media del campione. Analogamente, un modello lineare con un singolo predittore binario stima la differenza tra due medie. Per la regressione logistica, un modello con sola intercetta stima invece un’unica proporzione: la probabilità che la variabile risposta assuma valore 1, uguale per tutte le unità del campione.</p>
<section id="esempio" class="level3" data-number="73.10.1"><h3 data-number="73.10.1" class="anchored" data-anchor-id="esempio">
<span class="header-section-number">73.10.1</span> Esempio</h3>
<p>Supponiamo di avere un campione casuale di 50 persone, sottoposte a un test per una certa caratteristica psicologica (es. la tendenza a ricordare dettagli irrilevanti in un compito di memoria). Il risultato è che 10 persone (20%) presentano la caratteristica.</p>
<p>Per 10 successi su 50 prove, la stima puntuale frequentista è:</p>
<p><span class="math display">\[
  \hat{p}=\frac{10}{50}=0{.}20,\qquad
  SE_{\text{Wald}}=\sqrt{\frac{\hat p(1-\hat p)}{n}}
  =\sqrt{\frac{0.2\cdot 0.8}{50}}\approx 0{.}06.
\]</span></p>
<p>Gli <strong>intervalli di confidenza al 95%</strong> possono essere calcolati in modi diversi nell’approccio frequentista. Di seguito i principali:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Dati</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">p_hat</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">/</span> <span class="va">n</span></span>
<span><span class="va">p_hat</span></span>
<span><span class="co">#&gt; [1] 0.2</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>Wald (approssimazione normale)</li>
</ol>
<blockquote class="blockquote">
<p>Semplice ma spesso <strong>instabile</strong> con n moderati o p vicino a 0/1.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">se_wald</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">p_hat</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_hat</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">ci_wald</span> <span class="op">&lt;-</span> <span class="va">p_hat</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se_wald</span></span>
<span><span class="va">ci_wald</span></span>
<span><span class="co">#&gt; [1] 0.08913 0.31087</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Wilson / score</li>
</ol>
<blockquote class="blockquote">
<p>In genere <strong>preferibile</strong> al Wald. In <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> la correzione di continuità è attiva di default.</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ci_wilson_cc</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span>   <span class="co"># score + correzione di continuità</span></span>
<span><span class="va">ci_wilson_nocc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span> <span class="co"># score senza correzione</span></span>
<span><span class="va">ci_wilson_nocc</span></span>
<span><span class="co">#&gt; [1] 0.1124 0.3304</span></span>
<span><span class="co">#&gt; attr(,"conf.level")</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Esatto (Clopper–Pearson)</li>
</ol>
<blockquote class="blockquote">
<p>Basato sulla binomiale; tende a essere <strong>conservativo</strong> (intervalli più ampi).</p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ci_exact</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span></span>
<span><span class="va">ci_exact</span></span>
<span><span class="co">#&gt; [1] 0.1003 0.3372</span></span>
<span><span class="co">#&gt; attr(,"conf.level")</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="riepilogo" class="level4" data-number="73.10.1.1"><h4 data-number="73.10.1.1" class="anchored" data-anchor-id="riepilogo">
<span class="header-section-number">73.10.1.1</span> Riepilogo</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Tabella riassuntiva con i principali metodi</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  metodo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Wald"</span>, <span class="st">"Wilson (no cc)"</span>, <span class="st">"Wilson (cc)"</span>, <span class="st">"Clopper–Pearson"</span><span class="op">)</span>,</span>
<span>  lower  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ci_wald</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ci_wilson_nocc</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ci_wilson_cc</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ci_exact</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  upper  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ci_wald</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">ci_wilson_nocc</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">ci_wilson_cc</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">ci_exact</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt;            metodo   lower  upper</span></span>
<span><span class="co">#&gt; 1            Wald 0.08913 0.3109</span></span>
<span><span class="co">#&gt; 2  Wilson (no cc) 0.11244 0.3304</span></span>
<span><span class="co">#&gt; 3     Wilson (cc) 0.10502 0.3414</span></span>
<span><span class="co">#&gt; 4 Clopper–Pearson 0.10030 0.3372</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Possiamo ottenere la stessa informazione tramite una regressione logistica bayesiana con sola intercetta:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Dati</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Modello bernoulli con sola intercetta</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">bernoulli</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, round_to <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: bernoulli </span></span>
<span><span class="co">#&gt;   Links: mu = logit </span></span>
<span><span class="co">#&gt; Formula: y ~ 1 </span></span>
<span><span class="co">#&gt;    Data: df (Number of observations: 50) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept    -1.38      0.34    -2.09    -0.74 1.00     1658     2284</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il coefficiente stimato <code>b_Intercept</code> è sulla <strong>scala logit</strong>. Per ottenere la probabilità, si usa la trasformazione inversa:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Valori stimati dal modello (esempio)</span></span>
<span><span class="va">intercept</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1.38</span></span>
<span><span class="va">error</span> <span class="op">&lt;-</span> <span class="fl">0.34</span></span>
<span></span>
<span><span class="co"># Probabilità media stimata</span></span>
<span><span class="va">p_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">intercept</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Limiti di credibilità (approx ±1 SE sulla scala logit)</span></span>
<span><span class="va">lower_bound</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">intercept</span> <span class="op">-</span> <span class="va">error</span><span class="op">)</span></span>
<span><span class="va">upper_bound</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">intercept</span> <span class="op">+</span> <span class="va">error</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"p_hat: %.3f, Lower bound: %.3f, Upper bound: %.3f"</span>,</span>
<span>            <span class="va">p_hat</span>, <span class="va">lower_bound</span>, <span class="va">upper_bound</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; p_hat: 0.201, Lower bound: 0.152, Upper bound: 0.261</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Risultato atteso:</p>
<p><span class="math display">\[
\hat{p} \approx 0.20,\quad \text{CrI 95\%} \approx [0.14, 0.27].
\]</span></p>
</section></section><section id="confronto-tra-approcci" class="level3" data-number="73.10.2"><h3 data-number="73.10.2" class="anchored" data-anchor-id="confronto-tra-approcci">
<span class="header-section-number">73.10.2</span> Confronto tra approcci</h3>
<p>Le stime ottenute dalla regressione logistica e quelle calcolate con la formula classica possono differire leggermente per due motivi principali:</p>
<ol type="1">
<li>
<strong>Uso dei priori</strong>: in <code>brm</code> il modello è bayesiano e, anche con priori deboli, questi contribuiscono leggermente alla stima.</li>
<li>
<strong>Inferenza esatta</strong>: l’errore standard classico è un’approssimazione, valida asintoticamente, mentre il modello bayesiano restituisce la distribuzione posteriore completa, che tiene conto esattamente della natura discreta dei dati.</li>
</ol>
<p><strong>Interpretazione psicologica</strong> In un contesto di ricerca, questo tipo di modello è utile quando vogliamo stimare la prevalenza di un comportamento o di un tratto in una popolazione, con un’incertezza ben quantificata. Ad esempio, potremmo voler stimare la proporzione di studenti che provano ansia significativa durante un esame, o la percentuale di pazienti che mostrano un certo pattern cognitivo in un test clinico.</p>
</section></section><section id="regressione-logistica-con-un-singolo-predittore-binario" class="level2" data-number="73.11"><h2 data-number="73.11" class="anchored" data-anchor-id="regressione-logistica-con-un-singolo-predittore-binario">
<span class="header-section-number">73.11</span> Regressione logistica con un singolo predittore binario</h2>
<p>Quando il predittore è una variabile dicotomica, la regressione logistica è concettualmente equivalente a un <strong>confronto di proporzioni</strong>. La differenza è che il modello logit ci permette di ottenere stime e intervalli di credibilità direttamente dal modello probabilistico, senza ricorrere a formule approssimate per l’errore standard, e può essere facilmente esteso ad altri predittori o a strutture gerarchiche.</p>
<p>Per rendere l’esempio più vicino alla psicologia, immaginiamo uno <strong>studio sperimentale sulla memoria</strong>: 50 partecipanti svolgono un compito di richiamo libero senza alcun aiuto (condizione 0), altri 60 lo svolgono con un suggerimento iniziale (condizione 1). La variabile <code>y</code> indica se il partecipante ha ricordato correttamente un elemento target (1 = corretto, 0 = errato). Supponiamo che nella condizione senza suggerimento 10 su 50 partecipanti ricordino correttamente (20%), mentre nella condizione con suggerimento il numero salga a 20 su 60 (33%).</p>
<p>Questi dati possono essere organizzati così:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>,   <span class="co"># condizione 0: 40 errori, 10 successi</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span>   <span class="co"># condizione 1: 40 errori, 20 successi</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span>, <span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt;      0  1</span></span>
<span><span class="co">#&gt;   0 40 10</span></span>
<span><span class="co">#&gt;   1 40 20</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="stima-del-modello" class="level3" data-number="73.11.1"><h3 data-number="73.11.1" class="anchored" data-anchor-id="stima-del-modello">
<span class="header-section-number">73.11.1</span> Stima del modello</h3>
<p>Usiamo <code>brm</code> per stimare un modello di regressione logistica bayesiano, specificando la famiglia <code>bernoulli</code> con link logit:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,  <span class="co"># logit(p) = b_Intercept + b_x * x</span></span>
<span>  data   <span class="op">=</span> <span class="va">df</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">bernoulli</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">2000</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: bernoulli </span></span>
<span><span class="co">#&gt;   Links: mu = logit </span></span>
<span><span class="co">#&gt; Formula: y ~ x </span></span>
<span><span class="co">#&gt;    Data: df (Number of observations: 110) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept    -1.41      0.36    -2.15    -0.73 1.00     2639     2321</span></span>
<span><span class="co">#&gt; x             0.71      0.45    -0.18     1.61 1.00     3266     2709</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="interpretazione-dei-coefficienti" class="level3" data-number="73.11.2"><h3 data-number="73.11.2" class="anchored" data-anchor-id="interpretazione-dei-coefficienti">
<span class="header-section-number">73.11.2</span> Interpretazione dei coefficienti</h3>
<ul>
<li>
<code>b_Intercept</code> è il <strong>logit</strong> della probabilità di successo nella condizione 0 (<span class="math inline">\(p(x=0)\)</span>).</li>
<li>
<code>b_x</code> rappresenta la <strong>differenza di logit</strong> tra condizione 1 e condizione 0.</li>
<li>Per ottenere le probabilità sulla scala naturale, si applica la funzione <strong>logit-inversa</strong>: <span class="math inline">\(p = \mathrm{plogis}(\text{logit}) = \frac{1}{1+e^{-\text{logit}}}\)</span>.</li>
</ul></section><section id="probabilità-posteriori-e-differenza" class="level3" data-number="73.11.3"><h3 data-number="73.11.3" class="anchored" data-anchor-id="probabilità-posteriori-e-differenza">
<span class="header-section-number">73.11.3</span> Probabilità posteriori e differenza</h3>
<p>Calcoliamo <span class="math inline">\(p(0)\)</span>, <span class="math inline">\(p(1)\)</span> e la loro differenza <span class="math inline">\(\Delta\)</span> per ciascun campione del posteriore, e riassumiamo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>  <span class="co"># dal pacchetto 'posterior'</span></span>
<span></span>
<span><span class="va">p0</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">draws</span><span class="op">$</span><span class="va">b_Intercept</span><span class="op">)</span></span>
<span><span class="va">p1</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">draws</span><span class="op">$</span><span class="va">b_Intercept</span> <span class="op">+</span> <span class="va">draws</span><span class="op">$</span><span class="va">b_x</span><span class="op">)</span></span>
<span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">-</span> <span class="va">p0</span></span>
<span></span>
<span><span class="va">summ</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  quantity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p(x=0)"</span>, <span class="st">"p(x=1)"</span>, <span class="st">"diff = p(1)-p(0)"</span><span class="op">)</span>,</span>
<span>  mean     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  median   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  q2.5     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">p0</span>, <span class="fl">.025</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">p1</span>, <span class="fl">.025</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">diff</span>, <span class="fl">.025</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  q97.5    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">p0</span>, <span class="fl">.975</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">p1</span>, <span class="fl">.975</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">diff</span>, <span class="fl">.975</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sd       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">summ</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 6</span></span>
<span><span class="co">#&gt;   quantity          mean median    q2.5 q97.5     sd</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;            &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 p(x=0)           0.202  0.199  0.105  0.325 0.0567</span></span>
<span><span class="co">#&gt; 2 p(x=1)           0.334  0.332  0.224  0.453 0.0595</span></span>
<span><span class="co">#&gt; 3 diff = p(1)-p(0) 0.131  0.133 -0.0351 0.290 0.0824</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="commento-ai-risultati" class="level3" data-number="73.11.4"><h3 data-number="73.11.4" class="anchored" data-anchor-id="commento-ai-risultati">
<span class="header-section-number">73.11.4</span> Commento ai risultati</h3>
<p>In questo caso, la probabilità media stimata di richiamo corretto è circa <strong>20%</strong> nella condizione senza suggerimento e <strong>33%</strong> con suggerimento. La differenza <span class="math inline">\(\Delta\)</span> è quindi di circa <strong>0.13</strong> punti percentuali, con un intervallo di credibilità al 95% che va da valori leggermente negativi (indicando che il suggerimento potrebbe non essere sempre utile) a valori positivi fino a circa <strong>0.29</strong>.</p>
<p>L’ampiezza dell’intervallo riflette l’incertezza dovuta alla dimensione campionaria relativamente ridotta. In un’ottica psicologica, questo tipo di stima ci permette di dire che, pur essendo plausibile un effetto positivo del suggerimento, non possiamo escludere del tutto la possibilità che l’effetto sia nullo o trascurabile. La regressione logistica fornisce una base formale per incorporare ulteriori predittori (ad esempio età, livello di ansia da test) o effetti gerarchici (partecipanti, item) in studi più complessi.</p>
</section><section id="distribuzione-posteriore-della-differenza" class="level3" data-number="73.11.5"><h3 data-number="73.11.5" class="anchored" data-anchor-id="distribuzione-posteriore-della-differenza">
<span class="header-section-number">73.11.5</span> Distribuzione posteriore della differenza</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>diff <span class="op">=</span> <span class="va">diff</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">40</span>, fill <span class="op">=</span> <span class="st">"skyblue"</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Distribuzione posteriore di "</span>, <span class="va">Delta</span>, <span class="st">" = p(x=1) - p(x=0)"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Differenza di probabilità"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequenza"</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="03_stan_logistic_regr_files/figure-html/plot-diff-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="03_stan_logistic_regr_files/figure-html/plot-diff-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="informazioni-sullambiente-di-sviluppo" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="informazioni-sullambiente-di-sviluppo">Informazioni sull’ambiente di sviluppo</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Zagreb</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] insight_1.3.1         bayestestR_0.16.1     cmdstanr_0.9.0       </span></span>
<span><span class="co">#&gt;  [4] pillar_1.11.0         tinytable_0.11.0      patchwork_1.3.1      </span></span>
<span><span class="co">#&gt;  [7] ggdist_3.3.3          tidybayes_3.0.7       bayesplot_1.13.0     </span></span>
<span><span class="co">#&gt; [10] ggplot2_3.5.2         reliabilitydiag_0.2.1 priorsense_1.1.0     </span></span>
<span><span class="co">#&gt; [13] posterior_1.6.1       loo_2.8.0             rstan_2.32.7         </span></span>
<span><span class="co">#&gt; [16] StanHeaders_2.32.10   brms_2.22.0           Rcpp_1.1.0           </span></span>
<span><span class="co">#&gt; [19] conflicted_1.2.0      janitor_2.2.1         matrixStats_1.5.0    </span></span>
<span><span class="co">#&gt; [22] modelr_0.1.11         tibble_3.3.0          dplyr_1.1.4          </span></span>
<span><span class="co">#&gt; [25] tidyr_1.3.1           rio_1.2.3             here_1.0.1           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gridExtra_2.3        inline_0.3.21        sandwich_3.1-1      </span></span>
<span><span class="co">#&gt;  [4] rlang_1.1.6          magrittr_2.0.3       multcomp_1.4-28     </span></span>
<span><span class="co">#&gt;  [7] snakecase_0.11.1     compiler_4.5.1       mgcv_1.9-3          </span></span>
<span><span class="co">#&gt; [10] vctrs_0.6.5          reshape2_1.4.4       stringr_1.5.1       </span></span>
<span><span class="co">#&gt; [13] pkgconfig_2.0.3      arrayhelpers_1.1-0   fastmap_1.2.0       </span></span>
<span><span class="co">#&gt; [16] backports_1.5.0      labeling_0.4.3       utf8_1.2.6          </span></span>
<span><span class="co">#&gt; [19] rmarkdown_2.29       ps_1.9.1             purrr_1.1.0         </span></span>
<span><span class="co">#&gt; [22] xfun_0.52            cachem_1.1.0         jsonlite_2.0.0      </span></span>
<span><span class="co">#&gt; [25] broom_1.0.9          parallel_4.5.1       R6_2.6.1            </span></span>
<span><span class="co">#&gt; [28] stringi_1.8.7        RColorBrewer_1.1-3   lubridate_1.9.4     </span></span>
<span><span class="co">#&gt; [31] estimability_1.5.1   knitr_1.50           zoo_1.8-14          </span></span>
<span><span class="co">#&gt; [34] pacman_0.5.1         Matrix_1.7-3         splines_4.5.1       </span></span>
<span><span class="co">#&gt; [37] timechange_0.3.0     tidyselect_1.2.1     abind_1.4-8         </span></span>
<span><span class="co">#&gt; [40] yaml_2.3.10          codetools_0.2-20     curl_6.4.0          </span></span>
<span><span class="co">#&gt; [43] processx_3.8.6       pkgbuild_1.4.8       plyr_1.8.9          </span></span>
<span><span class="co">#&gt; [46] lattice_0.22-7       withr_3.0.2          bridgesampling_1.1-2</span></span>
<span><span class="co">#&gt; [49] coda_0.19-4.1        evaluate_1.0.4       survival_3.8-3      </span></span>
<span><span class="co">#&gt; [52] RcppParallel_5.1.10  tensorA_0.36.2.1     checkmate_2.3.2     </span></span>
<span><span class="co">#&gt; [55] stats4_4.5.1         distributional_0.5.0 generics_0.1.4      </span></span>
<span><span class="co">#&gt; [58] rprojroot_2.1.0      rstantools_2.4.0     scales_1.4.0        </span></span>
<span><span class="co">#&gt; [61] xtable_1.8-4         glue_1.8.0           emmeans_1.11.2      </span></span>
<span><span class="co">#&gt; [64] tools_4.5.1          data.table_1.17.8    mvtnorm_1.3-3       </span></span>
<span><span class="co">#&gt; [67] grid_4.5.1           QuickJSR_1.8.0       colorspace_2.1-1    </span></span>
<span><span class="co">#&gt; [70] nlme_3.1-168         cli_3.6.5            svUnit_1.0.6        </span></span>
<span><span class="co">#&gt; [73] Brobdingnag_1.2-9    V8_6.0.5             gtable_0.3.6        </span></span>
<span><span class="co">#&gt; [76] digest_0.6.37        TH.data_1.1-3        htmlwidgets_1.6.4   </span></span>
<span><span class="co">#&gt; [79] farver_2.1.2         memoise_2.0.1        htmltools_0.5.8.1   </span></span>
<span><span class="co">#&gt; [82] lifecycle_1.0.4      MASS_7.3-65</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bibliografia" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-fox2015applied" class="csl-entry" role="listitem">
Fox, J. (2015). <em>Applied regression analysis and generalized linear models</em>. Sage publications.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/glm/introduction_glm.html" class="pagination-link" aria-label="Introduzione">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduzione</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/entropy/01_entropy.html" class="pagination-link" aria-label="Entropia e informazione di Shannon">
        <span class="nav-page-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Entropia e informazione di Shannon</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> è una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/glm/03_stan_logistic_regr.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>