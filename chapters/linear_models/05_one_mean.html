<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Corrado Caudek">
<title>65&nbsp; Inferenza bayesiana su una media – Psicometria</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/linear_models/06_prediction_stan.html" rel="next">
<link href="../../chapters/linear_models/04_synt_sugar.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-51e9ba6732aa6bc0134376f05742e55b.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-be4ac3c225b26f991c14b13db7ee7aa0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/linear_models/introduction_linear_models.html">Regressione</a></li><li class="breadcrumb-item"><a href="../../chapters/linear_models/05_one_mean.html"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Eseguire il codice" class="quarto-navigation-tool px-1" aria-label="Eseguire il codice"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informazioni Generali</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefazione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/key_notions/introduction_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fondamenti</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/01_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Concetti chiave</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/02_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Campionamento, metodologia sperimentale e studi osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/03_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/04_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La riforma metodologica in psicologia: dalla crisi alla rivoluzione bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/05_cognitive_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelli cognitivi</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/R/introduction_r_lang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/01_r_syntax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Un approccio moderno all’analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/02_utility_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Utility functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/03_r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Programmazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/04_r_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Pacchetti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/05_dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduzione a <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/06_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/07_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">L’ambiente di programmazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/08_ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Utilizzo di strumenti AI</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/eda/introduction_eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/01_project_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Le fasi del progetto di analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/02_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Flusso di lavoro per la pulizia dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/04_exploring_qualitative_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Esplorare i dati qualitativi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/05_exploring_numeric_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Esplorare i dati numerici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/06_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Principi della visualizzazione dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07_loc_scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Indicatori di tendenza centrale e variabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07a_introduction_normal_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Introduzione alla distribuzione normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/08_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Relazioni tra variabili</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/09_causality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/10_estimand.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Estimandi teorici e estimandi empirici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/11_outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Outlier</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/probability/introduction_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilità</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/01_intro_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Interpretazione della probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/02_probability_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Modelli probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/03_prob_spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">La Probabilità come misura della certezza razionale: un’interpretazione Bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/04_sigma-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Dal Discreto al Continuo: la <span class="math inline">\(\sigma\)</span>-algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/05_conditional_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Probabilità condizionata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/06_bayes_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/07_random_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/08_prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Distribuzioni di massa e di densità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/09_expval_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Proprietà delle variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/10_sampling_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11a_joint_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Probabilità congiunta</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11b_cov_cor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Covarianza e correlazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11c_joint_prob_cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Caso continuo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12a_intro_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Introduzione alle distribuzioni di probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12_discr_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/13_cont_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/14_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Assunzione di gaussianità e trasformazioni dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/15_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">La verosimiglianza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/16_likelihood_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">La verosimiglianza gaussiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/17_likelihood_ratio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Il rapporto di verosimiglianze</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_intro_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_bayesian_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Pensare ad una proporzione in termini soggettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_grid_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Calcolo della distribuzione a posteriori gaussiana tramite metodo a griglia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_conjugate_families_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_conjugate_families_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (2)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/11_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/12_gamma_exponential_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Modello gamma-esponenziale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/13_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata: un approccio frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_one_mean.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_prediction_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Predizione e inferenza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07a_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Stima bayesiana della grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07b_posterior_draws.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Manipolazione dei campioni a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Disegno della ricerca e potere statistico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_anova_2vie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">ANOVA ad due vie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/12_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni indipendenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/13_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Frequentismo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/introduction_frequentist_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01_intro_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01a_stime_parametri.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/02_conf_interv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/03_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">La grandezza del campione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/04_test_ipotesi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Significatività statistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/05_two_ind_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Test t di Student per campioni indipendenti</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">85</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">86</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">87</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_piranha.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">88</span>&nbsp; <span class="chapter-title">Il Problema del priming: sfide e paradossi nella psicologia sociale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">89</span>&nbsp; <span class="chapter-title">I gradi di libertà del ricercatore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/09_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">90</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendici</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01a_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Cartelle e documenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a47_first_order_markov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Catene di Markov</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Indice</h2>
   
  <ul class="collapse">
<li><a href="#preparazione-del-notebook" id="toc-preparazione-del-notebook" class="nav-link active" data-scroll-target="#preparazione-del-notebook"><span class="header-section-number">65.1</span> Preparazione del Notebook</a></li>
  <li><a href="#introduzione" id="toc-introduzione" class="nav-link" data-scroll-target="#introduzione"><span class="header-section-number">65.2</span> Introduzione</a></li>
  <li><a href="#il-modello-normale" id="toc-il-modello-normale" class="nav-link" data-scroll-target="#il-modello-normale"><span class="header-section-number">65.3</span> Il modello Normale</a></li>
  <li><a href="#un-esempio-concreto" id="toc-un-esempio-concreto" class="nav-link" data-scroll-target="#un-esempio-concreto"><span class="header-section-number">65.4</span> Un esempio concreto</a></li>
  <li><a href="#modello-bayesiano-per-una-singola-media" id="toc-modello-bayesiano-per-una-singola-media" class="nav-link" data-scroll-target="#modello-bayesiano-per-una-singola-media"><span class="header-section-number">65.5</span> Modello Bayesiano per una singola media</a></li>
  <li><a href="#il-modello-frequentista" id="toc-il-modello-frequentista" class="nav-link" data-scroll-target="#il-modello-frequentista"><span class="header-section-number">65.6</span> Il modello frequentista</a></li>
  <li><a href="#modello-bayesiano-senza-specificare-prior-prior-debolmente-informativi" id="toc-modello-bayesiano-senza-specificare-prior-prior-debolmente-informativi" class="nav-link" data-scroll-target="#modello-bayesiano-senza-specificare-prior-prior-debolmente-informativi"><span class="header-section-number">65.7</span> Modello Bayesiano senza specificare prior (prior debolmente informativi)</a></li>
  <li><a href="#riportare-i-risultati" id="toc-riportare-i-risultati" class="nav-link" data-scroll-target="#riportare-i-risultati"><span class="header-section-number">65.8</span> Riportare i Risultati</a></li>
  <li><a href="#uso-dei-prior-nel-modello-bayesiano" id="toc-uso-dei-prior-nel-modello-bayesiano" class="nav-link" data-scroll-target="#uso-dei-prior-nel-modello-bayesiano"><span class="header-section-number">65.9</span> Uso dei Prior nel Modello Bayesiano</a></li>
  <li><a href="#funzioni-bayesplot" id="toc-funzioni-bayesplot" class="nav-link" data-scroll-target="#funzioni-bayesplot"><span class="header-section-number">65.10</span> Funzioni <em>bayesplot</em></a></li>
  <li><a href="#lapproccio-tradizionale" id="toc-lapproccio-tradizionale" class="nav-link" data-scroll-target="#lapproccio-tradizionale"><span class="header-section-number">65.11</span> L’approccio Tradizionale</a></li>
  <li><a href="#riflessioni-conlusive" id="toc-riflessioni-conlusive" class="nav-link" data-scroll-target="#riflessioni-conlusive"><span class="header-section-number">65.12</span> Riflessioni Conlusive</a></li>
  <li><a href="#informazioni-sullambiente-di-sviluppo" id="toc-informazioni-sullambiente-di-sviluppo" class="nav-link" data-scroll-target="#informazioni-sullambiente-di-sviluppo">Informazioni sull’Ambiente di Sviluppo</a></li>
  <li><a href="#bibliografia" id="toc-bibliografia" class="nav-link" data-scroll-target="#bibliografia">Bibliografia</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/linear_models/05_one_mean.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/linear_models/introduction_linear_models.html">Regressione</a></li><li class="breadcrumb-item"><a href="../../chapters/linear_models/05_one_mean.html"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-mcmc-one-mean" class="quarto-section-identifier"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In questo capitolo imparerai a
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>fare inferenza sulla media di un campione;</li>
<li>trovare le distribuzioni a posteriori usando <code>brms</code>;</li>
<li>verificare il modello usando i pp-check plots.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Leggere il capitolo <em>Geocentric models</em> di Statistical rethinking <span class="citation" data-cites="McElreath_rethinking">(<a href="#ref-McElreath_rethinking" role="doc-biblioref">McElreath, 2020</a>)</span>.</li>
</ul>
</div>
</div>
<section id="preparazione-del-notebook" class="level2 .callout-caution" data-number="65.1"><h2 data-number="65.1" class="anchored" data-anchor-id="preparazione-del-notebook">
<span class="header-section-number">65.1</span> Preparazione del Notebook</h2>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">cmdstanr</span>, <span class="va">posterior</span>, <span class="va">bayestestR</span>, <span class="va">brms</span>, <span class="va">ggdist</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="introduzione" class="level2" data-number="65.2"><h2 data-number="65.2" class="anchored" data-anchor-id="introduzione">
<span class="header-section-number">65.2</span> Introduzione</h2>
<p>L’obiettivo principale di questo capitolo è esaminare un contesto che abbiamo già preso in considerazione in precedenza: ci troviamo di fronte a un campione di dati misurati su una scala a intervalli o rapporti e desideriamo effettuare inferenze sulla media della popolazione da cui il campione è stato estratto. Tuttavia, anziché procedere con una derivazione analitica della distribuzione a posteriori della media della popolazione, in questo caso utilizzeremo <code>brms</code>.</p>
</section><section id="il-modello-normale" class="level2" data-number="65.3"><h2 data-number="65.3" class="anchored" data-anchor-id="il-modello-normale">
<span class="header-section-number">65.3</span> Il modello Normale</h2>
<p>I priori coniugati Normali di una Normale non richiedono l’approssimazione numerica ottenuta mediante metodi MCMC. In questo capitolo, tuttavia, ripetiamo l’esercizio descritto nel <a href="../bayesian_inference/08_conjugate_families_2.html" class="quarto-xref"><span>Capitolo 52</span></a> usando <code>brms</code>.</p>
</section><section id="un-esempio-concreto" class="level2" data-number="65.4"><h2 data-number="65.4" class="anchored" data-anchor-id="un-esempio-concreto">
<span class="header-section-number">65.4</span> Un esempio concreto</h2>
<p>Per applicare il modello Normale, utilizzeremo i dati del censimento parziale dell’area di Dobe dei !Kung San, raccolti attraverso interviste condotte da Nancy Howell alla fine degli anni ’60. I !Kung San sono una suddivisione della popolazione San, che vive nel deserto del Kalahari, tra Namibia, Botswana e Angola, e mantengono un’economia basata su caccia e raccolta. Riprodurremo l’analisi descritta da <span class="citation" data-cites="McElreath_rethinking">McElreath (<a href="#ref-McElreath_rethinking" role="doc-biblioref">2020</a>)</span>, esaminando unicamente i valori dell’altezza di individui di età superiore ai 18 anni.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"Howell_18.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   height weight age male</span></span>
<span><span class="co">#&gt; 1  151.8  47.83  63    1</span></span>
<span><span class="co">#&gt; 2  139.7  36.49  63    0</span></span>
<span><span class="co">#&gt; 3  136.5  31.86  65    0</span></span>
<span><span class="co">#&gt; 4  156.8  53.04  41    1</span></span>
<span><span class="co">#&gt; 5  145.4  41.28  51    0</span></span>
<span><span class="co">#&gt; 6  163.8  62.99  35    1</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il campione include 352 osservazioni:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 352</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">5</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Istogramma dell'Altezza"</span>, x <span class="op">=</span> <span class="st">"Altezza (cm)"</span>, y <span class="op">=</span> <span class="st">"Frequenza"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="05_one_mean_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="05_one_mean_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Come indicato dall’istogramma, i dati sono approssimativamente distribuiti in maniera gaussiana:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>sample <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_qq</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_qq_line</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Normal Q-Q plot"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Teorici (Z-score)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Valori osservati"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="05_one_mean_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="05_one_mean_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>In realtà, dal Q-Q plot si nota un piccolo scostamento sistematico. Quando la retta che approssima i punti empirici risulta più <strong>piatta</strong> rispetto alla diagonale teorica (che avrebbe pendenza 1 se i dati fossero perfettamente normali), la distribuzione empirica risulta <strong>meno dispersa</strong> di una Gaussiana di riferimento: i quantili empirici aumentano più lentamente di quelli teorici, indicando una varianza leggermente inferiore (o code meno ampie). Nel caso presente, tuttavia, questo scostamento è di modesta entità e si può comunque procedere all’adattamento di un modello gaussiano.</p>
</section><section id="modello-bayesiano-per-una-singola-media" class="level2" data-number="65.5"><h2 data-number="65.5" class="anchored" data-anchor-id="modello-bayesiano-per-una-singola-media">
<span class="header-section-number">65.5</span> Modello Bayesiano per una singola media</h2>
<p>Immaginiamo di voler modellare l’altezza (in cm) di un gruppo di persone. Per ogni osservazione <span class="math inline">\(y_n\)</span> (con <span class="math inline">\(n=1,\dots,N\)</span>) assumiamo:</p>
<p><span class="math display">\[
y_n \;\sim\; \mathcal N\!\bigl(\mu,\;\sigma\bigr) ,
\]</span></p>
<p>dove</p>
<ul>
<li>
<strong><span class="math inline">\(\mu\)</span></strong> è la <em>media vera</em> (ignota) dell’altezza nella popolazione;</li>
<li>
<strong><span class="math inline">\(\sigma\)</span></strong> è la <em>deviazione standard vera</em> (anch’essa ignota), che misura quanto le altezze oscillano attorno a <span class="math inline">\(\mu\)</span>.</li>
</ul>
<section id="cosa-significa-lassunzione-iid" class="level3" data-number="65.5.1"><h3 data-number="65.5.1" class="anchored" data-anchor-id="cosa-significa-lassunzione-iid">
<span class="header-section-number">65.5.1</span> Cosa significa l’assunzione “iid”</h3>
<ul>
<li><p><strong>Identicamente distribuiti</strong> – tutti i <span class="math inline">\(t_n\)</span> provengono dalla stessa distribuzione normale <span class="math inline">\(\mathcal N(\mu,\sigma)\)</span>.</p></li>
<li>
<p><strong>Indipendenti</strong> – conoscere l’errore commesso su un individuo non dà alcuna informazione sull’errore commesso su un altro:</p>
<p><span class="math display">\[
  \operatorname{cov}(y_i-\mu,\; y_j-\mu)=0 \quad\text{per } i\neq j.
\]</span></p>
</li>
</ul>
<p>Scrivere “<span class="math inline">\(y_n \sim \mathcal N(\mu,\sigma)\)</span>” è quindi un modo compatto per dire che i dati osservati sono <em>iid</em> dalla distribuzione normale parametrizzata da <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span>.</p>
</section><section id="esplorare-i-dati" class="level3" data-number="65.5.2"><h3 data-number="65.5.2" class="anchored" data-anchor-id="esplorare-i-dati">
<span class="header-section-number">65.5.2</span> Esplorare i dati</h3>
<p>Prima di inserire priors ed eseguire l’inferenza Bayesiana può essere utile vedere che cosa raccontano i dati grezzi.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># media campionaria</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 154.6</span></span>
<span></span>
<span><span class="co"># deviazione standard campionaria</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.742</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>
<strong>Media campionaria</strong>: una stima preliminare di <span class="math inline">\(\mu\)</span>.</li>
<li>
<strong>Deviazione standard campionaria</strong>: una stima preliminare di <span class="math inline">\(\sigma\)</span>.</li>
</ul>
<p>Questi riassunti <em>non</em> sostituiscono l’inferenza Bayesiana, ma aiutano a:</p>
<ol type="1">
<li>
<strong>scegliere priors ragionevoli</strong> (per esempio centrare la prior di <span class="math inline">\(\mu\)</span> vicino alla media campionaria).</li>
<li>
<strong>controllare outlier o errori di misura</strong> che, essendo la Normal sensibile agli estremi, potrebbero distorcere l’analisi.</li>
</ol></section></section><section id="il-modello-frequentista" class="level2" data-number="65.6"><h2 data-number="65.6" class="anchored" data-anchor-id="il-modello-frequentista">
<span class="header-section-number">65.6</span> Il modello frequentista</h2>
<p>Nel contesto frequentista, se vogliamo stimare la <strong>media dell’altezza</strong> nella popolazione, possiamo usare un modello lineare molto semplice: un modello <strong>senza predittori</strong>, che stima solo l’intercetta.</p>
<p>In R, questo si traduce nella formula:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">height</span> <span class="op">~</span> <span class="fl">1</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Il simbolo <code>1</code> indica che vogliamo stimare <strong>solo l’intercetta</strong>, cioè la media dell’altezza nel campione. Il modello si può specificare così:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">height</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>  data <span class="op">=</span> <span class="va">df</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interpretazione-del-modello" class="level3" data-number="65.6.1"><h3 data-number="65.6.1" class="anchored" data-anchor-id="interpretazione-del-modello">
<span class="header-section-number">65.6.1</span> Interpretazione del modello</h3>
<p>L’output del comando:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = height ~ 1, data = df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -18.072  -6.007  -0.292   6.058  24.473 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)  154.597      0.413     375   &lt;2e-16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 7.74 on 351 degrees of freedom</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>mostra:</p>
<ul>
<li>la <strong>stima puntuale dell’intercetta</strong> (<span class="math inline">\(\hat{\alpha}\)</span>), che in questo caso coincide con la <strong>media campionaria di <code>height</code></strong>;</li>
<li>l’<strong>errore standard</strong> della stima;</li>
<li>il <strong>p-value</strong> (relativo all’ipotesi nulla che la media sia zero, anche se raramente è di interesse reale);</li>
<li>l’<strong>R-squared</strong>, che però <strong>non è informativo</strong> in un modello senza predittori.</li>
</ul></section><section id="intervallo-di-confidenza-al-95-per-la-media" class="level3" data-number="65.6.2"><h3 data-number="65.6.2" class="anchored" data-anchor-id="intervallo-di-confidenza-al-95-per-la-media">
<span class="header-section-number">65.6.2</span> Intervallo di confidenza al 95% per la media</h3>
<p>Per ottenere l’intervallo di confidenza frequentista al 95% per <span class="math inline">\(\alpha\)</span> (cioè per la media campionaria), possiamo usare la funzione <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">fm1</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt;             2.5 % 97.5 %</span></span>
<span><span class="co">#&gt; (Intercept) 153.8  155.4</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Quest’intervallo si basa sulla formula classica:</p>
<p><span class="math display">\[
\hat{\alpha} \pm t_{\text{df}} \cdot \text{SE}(\hat{\alpha})
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(\hat{\alpha}\)</span> è la stima puntuale della media;</li>
<li>
<span class="math inline">\(t_{\text{df}}\)</span> è il quantile della distribuzione t di Student, con un numero di gradi di libertà pari a <span class="math inline">\(n - 1\)</span>;</li>
<li>
<span class="math inline">\(\text{SE}(\hat{\alpha})\)</span> è l’errore standard della stima.</li>
</ul></section><section id="calcolo-manuale-dellintervallo" class="level3" data-number="65.6.3"><h3 data-number="65.6.3" class="anchored" data-anchor-id="calcolo-manuale-dellintervallo">
<span class="header-section-number">65.6.3</span> Calcolo manuale dell’intervallo</h3>
<p>Se vogliamo calcolare l’intervallo “a mano”, possiamo scrivere:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">0.975</span>, <span class="fu"><a href="https://rdrr.io/r/stats/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.413</span></span>
<span><span class="co">#&gt; [1] 153.8 155.4</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>
<code>coef(fm1)</code> restituisce la stima della media;</li>
<li>
<code>qt(0.975, df.residual(fm1))</code> restituisce il valore critico della distribuzione <span class="math inline">\(t\)</span> per un intervallo al 95%;</li>
<li>
<code>0.413</code> è l’errore standard della stima (può essere sostituito con il valore esatto fornito da <code>summary(fm1)</code>).</li>
</ul>
<p>In sintesi, questo è l’approccio frequentista classico per stimare la media e costruire un intervallo di confidenza. Si basa su:</p>
<ul>
<li>la <strong>distribuzione campionaria</strong> della media,</li>
<li>l’assunzione di <strong>normalità</strong> e <strong>indipendenza</strong> degli errori.</li>
</ul></section></section><section id="modello-bayesiano-senza-specificare-prior-prior-debolmente-informativi" class="level2" data-number="65.7"><h2 data-number="65.7" class="anchored" data-anchor-id="modello-bayesiano-senza-specificare-prior-prior-debolmente-informativi">
<span class="header-section-number">65.7</span> Modello Bayesiano senza specificare prior (prior debolmente informativi)</h2>
<p>Dopo aver stimato la media dell’altezza con il modello frequentista, ora vogliamo <strong>replicare lo stesso modello</strong> usando un approccio <strong>bayesiano</strong> con il pacchetto <code>brms</code>.</p>
<p>Nel modello bayesiano, è sempre necessario specificare delle <strong>distribuzioni a priori</strong> per i parametri. Tuttavia, se <strong>non le specifichiamo esplicitamente</strong>, <code>brms</code> utilizzerà dei <strong>prior debolmente informativi</strong>: distribuzioni ampie e generiche, che influenzano poco l’inferenza quando i dati sono informativi. In pratica, è come dire “non abbiamo forti idee a priori, lasciamo che siano i dati a parlare”.</p>
<section id="specifica-del-modello" class="level3" data-number="65.7.1"><h3 data-number="65.7.1" class="anchored" data-anchor-id="specifica-del-modello">
<span class="header-section-number">65.7.1</span> Specifica del modello</h3>
<p>Il codice per stimare il modello è simile a quello usato con <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">height</span> <span class="op">~</span> <span class="fl">1</span>,        <span class="co"># come prima, stimiamo solo l'intercetta</span></span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,         <span class="co"># specifica la distribuzione dei dati (Normal)</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span>,                   <span class="co"># dataset</span></span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,                  <span class="co"># numero di catene indipendenti</span></span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,                 <span class="co"># numero totale di iterazioni per catena</span></span>
<span>  warmup <span class="op">=</span> <span class="fl">1000</span>,               <span class="co"># iterazioni iniziali usate per "scaldare" l'algoritmo</span></span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>         <span class="co"># motore di calcolo usato (più veloce e trasparente)</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vediamo nel dettaglio alcune opzioni:</p>
<ol type="1">
<li><p><strong><code>formula = height ~ 1</code></strong> Indica che stiamo stimando solo l’intercetta, cioè la media dell’altezza.</p></li>
<li><p><strong><code>family = gaussian()</code></strong> Rende esplicito che i dati seguono una distribuzione normale. (Con <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> era implicito.)</p></li>
<li><p><strong><code>prior = ...</code></strong> In questo caso non lo abbiamo specificato, quindi <code>brms</code> userà i <strong>prior di default</strong> (debolmente informativi).</p></li>
<li>
<p><strong><code>chains</code>, <code>iter</code>, <code>warmup</code></strong> Sono parametri che controllano come viene effettuato il campionamento Bayesiano, cioè la stima della distribuzione a posteriori dei parametri:</p>
<ul>
<li>
<code>chains</code>: quante catene indipendenti vengono eseguite (default = 4).</li>
<li>
<code>iter</code>: numero totale di iterazioni per catena.</li>
<li>
<code>warmup</code>: prime iterazioni da scartare (servono ad “adattare” il campionatore).</li>
</ul>
</li>
</ol>
<p>L’algoritmo usato da <code>brms</code> per il campionamento si chiama <strong>NUTS</strong> (No-U-Turn Sampler), un’evoluzione del metodo Hamiltonian Monte Carlo. È molto efficiente nel campionare distribuzioni complesse.</p>
</section><section id="struttura-del-modello" class="level3" data-number="65.7.2"><h3 data-number="65.7.2" class="anchored" data-anchor-id="struttura-del-modello">
<span class="header-section-number">65.7.2</span> Struttura del modello</h3>
<p>Anche in questo caso, il modello può essere scritto così:</p>
<p><span class="math display">\[
y_i = \alpha + \varepsilon_i, \quad \varepsilon_i \sim \mathcal{N}(0, \sigma)
\]</span></p>
<p>La differenza è che qui <strong>stiamo stimando la distribuzione a posteriori</strong> di <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\sigma\)</span>, e non solo un valore puntuale.</p>
</section><section id="analisi-delloutput" class="level3" data-number="65.7.3"><h3 data-number="65.7.3" class="anchored" data-anchor-id="analisi-delloutput">
<span class="header-section-number">65.7.3</span> Analisi dell’output</h3>
<p>Una volta stimato il modello, possiamo esaminare i risultati con:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">#&gt; Formula: height ~ 1 </span></span>
<span><span class="co">#&gt;    Data: df (Number of observations: 352) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept   154.59      0.41   153.76   155.38 1.00     2729     2179</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sigma     7.77      0.30     7.20     8.37 1.00     3096     2129</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’output mostrerà:</p>
<ul>
<li>la <strong>media (o mediana)</strong> della distribuzione a posteriori per <span class="math inline">\(\alpha\)</span> (cioè la nostra stima della media dell’altezza),</li>
<li>l’<strong>errore standard a posteriori</strong>,</li>
<li>l’<strong>intervallo di credibilità al 95%</strong>, che rappresenta la zona in cui, dato il modello e i dati, si trova con alta probabilità il valore vero di <span class="math inline">\(\alpha\)</span>.</li>
</ul>
<p>Questo <strong>intervallo di credibilità</strong> è diverso dall’intervallo di confidenza frequentista: in ottica bayesiana possiamo davvero dire che “c’è il 95% di probabilità che <span class="math inline">\(\alpha\)</span> sia dentro l’intervallo”, dato che stiamo ragionando in termini di probabilità sui parametri.</p>
<p>Se il modello converge correttamente (nessun avviso di problemi), il comando <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> fornisce un riassunto completo della stima Bayesiana, rendendo il passaggio dal mondo frequentista a quello bayesiano molto intuitivo.</p>
</section></section><section id="riportare-i-risultati" class="level2" data-number="65.8"><h2 data-number="65.8" class="anchored" data-anchor-id="riportare-i-risultati">
<span class="header-section-number">65.8</span> Riportare i Risultati</h2>
<p>Nel caso frequentista, il risultato può essere riportato nel modo seguente:</p>
<blockquote class="blockquote">
<p>l’analisi ha fornito una stima puntuale di α pari a 154.6, con un intervallo di confidenza al 95% compreso tra [153.8; 155.4].</p>
</blockquote>
<p>Nel caso bayesiano diciamo:</p>
<blockquote class="blockquote">
<p>l’analisi bayesiana, condotta con una prior non informativa, ha restituito una stima a posteriori di α pari a 154.6, con un intervallo di credibilità al 95% [153.8; 155.4].</p>
</blockquote>
<section id="analisi-dei-campioni-a-posteriori" class="level3" data-number="65.8.1"><h3 data-number="65.8.1" class="anchored" data-anchor-id="analisi-dei-campioni-a-posteriori">
<span class="header-section-number">65.8.1</span> Analisi dei Campioni a Posteriori</h3>
<p>Dopo aver stimato il modello con <code><a href="https://paulbuerkner.com/brms/reference/brm.html">brm()</a></code>, possiamo accedere ai <strong>campioni a posteriori</strong> dei parametri. Ogni campione rappresenta una possibile combinazione di valori plausibili di <span class="math inline">\(\alpha\)</span> (la media) e <span class="math inline">\(\sigma\)</span> (la deviazione standard), estratta dalla distribuzione a posteriori.</p>
<p>Per esplorare questi campioni, usiamo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A draws_df: 3 iterations, 1 chains, and 5 variables</span></span>
<span><span class="co">#&gt;   b_Intercept sigma Intercept lprior  lp__</span></span>
<span><span class="co">#&gt; 1         155   8.0       155   -6.1 -1224</span></span>
<span><span class="co">#&gt; 2         155   7.5       155   -6.0 -1224</span></span>
<span><span class="co">#&gt; 3         155   8.1       155   -6.1 -1225</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nella tabella risultante, la colonna <strong><code>b_Intercept</code></strong> rappresenta i campioni per <span class="math inline">\(\mu\)</span>, cioè la media dell’altezza stimata a posteriori.</p>
<p>Possiamo ignorare le ultime tre colonne:</p>
<ul>
<li>
<code>Intercept</code>: un’intercetta “ausiliaria” usata se ci fossero predittori centrati (coincide con <code>b_Intercept</code> in questo caso).</li>
<li>
<code>lprior</code>: la log-verosimiglianza del prior, utile per strumenti diagnostici (es. con il pacchetto <a href="https://github.com/n-kall/priorsense"><code>priorsense</code></a>).</li>
<li>
<code>lp__</code>: la log-verosimiglianza a posteriori non normalizzata, utile per il campionamento ma non per l’inferenza diretta.</li>
</ul></section><section id="calcoli-riassuntivi-sui-campioni-a-posteriori" class="level3" data-number="65.8.2"><h3 data-number="65.8.2" class="anchored" data-anchor-id="calcoli-riassuntivi-sui-campioni-a-posteriori">
<span class="header-section-number">65.8.2</span> Calcoli riassuntivi sui campioni a posteriori</h3>
<p>Possiamo calcolare direttamente <strong>media</strong>, <strong>deviazione standard</strong> e <strong>intervallo di credibilità al 95%</strong> per <span class="math inline">\(\mu\)</span>, usando i campioni della colonna <code>b_Intercept</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Media a posteriori (stima puntuale)</span></span>
<span><span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span><span class="op">$</span><span class="va">b_Intercept</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 154.6</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Deviazione standard a posteriori (errore standard)</span></span>
<span><span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span><span class="op">$</span><span class="va">b_Intercept</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4117</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Intervallo di credibilità al 95%</span></span>
<span><span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span><span class="op">$</span><span class="va">b_Intercept</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  2.5% 97.5% </span></span>
<span><span class="co">#&gt; 153.8 155.4</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="conclusioni-intermedie" class="level3" data-number="65.8.3"><h3 data-number="65.8.3" class="anchored" data-anchor-id="conclusioni-intermedie">
<span class="header-section-number">65.8.3</span> Conclusioni Intermedie</h3>
<ul>
<li><p>Con <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> (modello <strong>frequentista</strong>), otteniamo una stima puntuale di <span class="math inline">\(\alpha\)</span> tramite il <strong>metodo della massima verosimiglianza</strong>, e un <strong>intervallo di confidenza al 95%</strong>, che esprime quanto sarebbe variabile la nostra stima in campioni ripetuti.</p></li>
<li><p>Con <code><a href="https://paulbuerkner.com/brms/reference/brm.html">brm()</a></code> (modello <strong>bayesiano</strong>), otteniamo una <strong>distribuzione a posteriori</strong> per <span class="math inline">\(\alpha\)</span>, che riflette l’incertezza residua dopo aver visto i dati. Anche usando un <strong>prior debolmente informativo</strong>, i risultati numerici sono molto simili a quelli frequentisti—ma la <strong>prospettiva interpretativa è diversa</strong>: un intervallo come <span class="math inline">\([153.78,\ 155.41]\)</span> significa che c’è <strong>il 95% di probabilità</strong> che il vero valore di <span class="math inline">\(\alpha\)</span> sia compreso in quell’intervallo.</p></li>
<li><p>Se decidessimo di includere <strong>informazioni a priori specifiche</strong> (ad esempio, provenienti da studi precedenti), potremmo definire un <strong>prior informativo</strong> per <span class="math inline">\(\alpha\)</span> all’interno di <code><a href="https://paulbuerkner.com/brms/reference/brm.html">brm()</a></code>. In questo caso, i risultati potrebbero <strong>divergere sensibilmente</strong> da quelli frequentisti, <strong>soprattutto quando i dati sono scarsi</strong> o poco informativi.</p></li>
</ul>
<p>Questo esempio mostra come il modello bayesiano generalizzi il caso frequentista, offrendo maggiore flessibilità e un’interpretazione probabilistica più diretta.</p>
</section></section><section id="uso-dei-prior-nel-modello-bayesiano" class="level2" data-number="65.9"><h2 data-number="65.9" class="anchored" data-anchor-id="uso-dei-prior-nel-modello-bayesiano">
<span class="header-section-number">65.9</span> Uso dei Prior nel Modello Bayesiano</h2>
<p>Abbiamo visto che è possibile stimare il nostro modello anche senza specificare esplicitamente le distribuzioni a priori, ottenendo comunque le distribuzioni a posteriori dei parametri. Tuttavia, prima di interpretare i risultati, è importante porsi alcune domande fondamentali:</p>
<ul>
<li><strong>Quali informazioni stiamo introducendo attraverso i prior?</strong></li>
<li><strong>I prior riflettono credenze plausibili e coerenti con il contesto del problema?</strong></li>
<li><strong>La funzione di verosimiglianza scelta è adatta ai dati osservati?</strong></li>
</ul>
<p>Per rispondere a queste domande, nei prossimi passaggi esamineremo sia la <strong>distribuzione predittiva a priori</strong> sia quella <strong>a posteriori</strong>, e condurremo analisi di <strong>sensibilità ai prior</strong>. Questi strumenti permettono di valutare quanto le assunzioni iniziali influenzino i risultati finali.</p>
<section id="specificare-i-priori-un-esempio-concreto" class="level3" data-number="65.9.1"><h3 data-number="65.9.1" class="anchored" data-anchor-id="specificare-i-priori-un-esempio-concreto">
<span class="header-section-number">65.9.1</span> Specificare i priori: un esempio concreto</h3>
<p>Nel paradigma bayesiano, possiamo incorporare <strong>conoscenze pregresse</strong> sotto forma di distribuzioni a priori. In questo esempio, ipotizziamo di avere qualche aspettativa informata sull’altezza media e sulla sua variabilità. Assegniamo:</p>
<ul>
<li>una prior <span class="math inline">\(\mathcal{N}(181,\ 30)\)</span> per <span class="math inline">\(\mu\)</span>, la media dell’altezza,</li>
<li>una prior <span class="math inline">\(\mathcal{N}(0,\ 20)\)</span>, <strong>troncata inferiormente a zero</strong>, per <span class="math inline">\(\sigma\)</span>, la deviazione standard.</li>
</ul>
<p>La scelta del valore centrale di 181 cm per <span class="math inline">\(\mu\)</span> segue l’esempio di <span class="citation" data-cites="McElreath_rethinking">McElreath (<a href="#ref-McElreath_rethinking" role="doc-biblioref">2020</a>)</span>, che ironicamente propone la propria altezza come ipotesi iniziale informata. È un modo per mostrare che anche una conoscenza soggettiva può entrare nel modello, purché dichiarata apertamente.</p>
</section><section id="descrizione-formale-del-modello" class="level3" data-number="65.9.2"><h3 data-number="65.9.2" class="anchored" data-anchor-id="descrizione-formale-del-modello">
<span class="header-section-number">65.9.2</span> Descrizione formale del modello</h3>
<p>Il modello bayesiano assume la seguente forma:</p>
<p><span class="math display">\[
\begin{aligned}
Y_i &amp;\sim \mathcal{N}(\mu, \sigma) \\
\mu &amp;\sim \mathcal{N}(181,\ 30) \\
\sigma &amp;\sim \mathcal{N}^+(0,\ 20)
\end{aligned}
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(Y_i\)</span> rappresenta l’altezza osservata per l’individuo <span class="math inline">\(i\)</span>,</li>
<li>
<span class="math inline">\(\mu\)</span> è la media da stimare,</li>
<li>
<span class="math inline">\(\sigma\)</span> è la deviazione standard,</li>
<li>
<span class="math inline">\(\mathcal{N}^+\)</span> indica una <strong>normale troncata</strong> per garantire che <span class="math inline">\(\sigma &gt; 0\)</span>.</li>
</ul>
<p>In ambito bayesiano, <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span> sono trattati come <strong>variabili casuali</strong>: non esistono come valori fissi da scoprire, ma come quantità soggette a incertezza, aggiornabili in base ai dati.</p>
</section><section id="implementazione-in-brms" class="level3" data-number="65.9.3"><h3 data-number="65.9.3" class="anchored" data-anchor-id="implementazione-in-brms">
<span class="header-section-number">65.9.3</span> Implementazione in <code>brms</code>
</h3>
<p>Il codice per stimare questo modello in <code>brms</code> è il seguente:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm3</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">height</span> <span class="op">~</span> <span class="fl">1</span>,             <span class="co"># Modello con sola intercetta (μ)</span></span>
<span>  data    <span class="op">=</span> <span class="va">df</span>,</span>
<span>  family  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,             <span class="co"># Modello normale</span></span>
<span>  prior   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">181</span>, <span class="fl">30</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span>,  <span class="co"># Prior informativo su μ</span></span>
<span>    <span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span>         <span class="co"># Prior (troncato) su σ</span></span>
<span>  <span class="op">)</span>,</span>
<span>  chains  <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter    <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  seed    <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una volta stimato il modello, possiamo ottenere un riepilogo dei risultati con:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm3</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">#&gt; Formula: height ~ 1 </span></span>
<span><span class="co">#&gt;    Data: df (Number of observations: 352) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept   154.60      0.41   153.80   155.41 1.00     3156     2659</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sigma     7.77      0.29     7.20     8.38 1.00     3256     2596</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="risultati-e-interpretazione" class="level3" data-number="65.9.4"><h3 data-number="65.9.4" class="anchored" data-anchor-id="risultati-e-interpretazione">
<span class="header-section-number">65.9.4</span> Risultati e interpretazione</h3>
<p>Anche con questi <strong>prior informativi ma ampi</strong>, i risultati per <span class="math inline">\(\mu\)</span> saranno simili a quelli del modello frequentista se i dati sono sufficientemente informativi. In questo caso, i dati “prevalgono” sul prior: è un comportamento desiderabile quando i prior non sono troppo restrittivi.</p>
</section><section id="cambiare-il-livello-dellintervallo-di-credibilità" class="level3" data-number="65.9.5"><h3 data-number="65.9.5" class="anchored" data-anchor-id="cambiare-il-livello-dellintervallo-di-credibilità">
<span class="header-section-number">65.9.5</span> Cambiare il livello dell’intervallo di credibilità</h3>
<p>Possiamo chiedere a <code>brms</code> di calcolare un <strong>intervallo di credibilità all’89%</strong> (anziché al consueto 95%):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm3</span>, prob <span class="op">=</span> <span class="fl">0.89</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">#&gt; Formula: height ~ 1 </span></span>
<span><span class="co">#&gt;    Data: df (Number of observations: 352) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-89% CI u-89% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept   154.60      0.41   153.94   155.27 1.00     3156     2659</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;       Estimate Est.Error l-89% CI u-89% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sigma     7.77      0.29     7.32     8.25 1.00     3256     2596</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="citation" data-cites="McElreath_rethinking">McElreath (<a href="#ref-McElreath_rethinking" role="doc-biblioref">2020</a>)</span> suggerisce l’intervallo all’89% come default nel suo approccio didattico, per evitare che i lettori lo interpretino come un test di significatività mascherato. Aggiunge anche con ironia:</p>
<blockquote class="blockquote">
<p>Why 89%? It’s just the default. It displays a quite wide interval, so it shows a high-probability range of parameter values. If you want another interval, such as the conventional and mindless 95%, you can use <code>precis(m4.1, prob = 0.95)</code>. But I don’t recommend 95% intervals, because readers will have a hard time not viewing them as significance tests. 89 is also a prime number, so if someone asks you to justify it, you can stare at them meaningfully and incant, ‘Because it is prime.’ That’s no worse justification than the conventional justification for 95%.</p>
</blockquote>
<p>Oltre all’ironia, il messaggio è chiaro: la scelta dell’intervallo di credibilità deve riflettere <strong>una rappresentazione onesta dell’incertezza</strong>, piuttosto che un’adesione meccanica a convenzioni statistiche.</p>
<p>In sintesi, l’uso dei prior consente di:</p>
<ul>
<li>incorporare conoscenze pregresse nel modello,</li>
<li>rendere l’inferenza più robusta quando i dati sono scarsi,</li>
<li>esplicitare le proprie ipotesi, invece di nasconderle dietro un’apparente “oggettività”.</li>
</ul>
<p>Nel modello bayesiano, ogni assunzione è esplicita, e i risultati sono interpretati come <strong>distribuzioni di probabilità sui parametri</strong>, non come stime puntuali affette da errore. Questo rende l’approccio particolarmente adatto in contesti in cui la <strong>trasparenza dell’incertezza</strong> è essenziale.</p>
</section></section><section id="funzioni-bayesplot" class="level2" data-number="65.10"><h2 data-number="65.10" class="anchored" data-anchor-id="funzioni-bayesplot">
<span class="header-section-number">65.10</span> Funzioni <em>bayesplot</em>
</h2>
<p>Il pacchetto <strong><code>bayesplot</code></strong> mette a disposizione un insieme di funzioni molto utili per <strong>visualizzare</strong> la distribuzione a posteriori di uno o più parametri e per <strong>verificare</strong> la bontà di adattamento del modello ai dati.</p>
<section id="traceplot" class="level3" data-number="65.10.1"><h3 data-number="65.10.1" class="anchored" data-anchor-id="traceplot">
<span class="header-section-number">65.10.1</span> Traceplot</h3>
<p>Un <strong>traceplot</strong> consente di verificare la convergenza delle catene MCMC e di controllare l’autocorrelazione dei campioni a posteriori. Nel seguente esempio, si mostrano le tracce (i valori campionati lungo le iterazioni) per i parametri “Intercept” e “sigma”:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mcmc_trace</span><span class="op">(</span></span>
<span>  <span class="va">fm3</span>, </span>
<span>  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>  facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="05_one_mean_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="05_one_mean_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li>L’asse orizzontale indica il numero di iterazione MCMC,<br>
</li>
<li>L’asse verticale mostra il valore assunto dal parametro in quella iterazione,<br>
</li>
<li>Avere catene che si mescolano bene e appaiono “stazionarie” (senza trend crescenti o calanti) è un buon segnale di convergenza.</li>
</ul></section><section id="distribuzione-a-posteriori-di-un-singolo-parametro" class="level3" data-number="65.10.2"><h3 data-number="65.10.2" class="anchored" data-anchor-id="distribuzione-a-posteriori-di-un-singolo-parametro">
<span class="header-section-number">65.10.2</span> Distribuzione a posteriori di un singolo parametro</h3>
<p>Se vogliamo visualizzare la <strong>distribuzione a posteriori</strong> di un singolo parametro (ad esempio l’intercetta, qui chiamata “b_Intercept” nel modello <code>brms</code>), possiamo usare:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mcmc_areas</span><span class="op">(</span><span class="va">fm3</span>, regex_pars <span class="op">=</span> <span class="st">"b_Intercept"</span>, prob <span class="op">=</span> <span class="fl">0.89</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="05_one_mean_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="05_one_mean_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Viene mostrata la <strong>densità a posteriori</strong>, con un’area evidenziata corrispondente all’<strong>89% di credibilità</strong> (specificabile con <code>prob = 0.89</code> o un altro valore).<br>
</li>
<li>Se desideriamo un intervallo di credibilità al 95%, useremo <code>prob = 0.95</code>.</li>
</ul></section><section id="rappresentazione-congiunta-di-due-parametri" class="level3" data-number="65.10.3"><h3 data-number="65.10.3" class="anchored" data-anchor-id="rappresentazione-congiunta-di-due-parametri">
<span class="header-section-number">65.10.3</span> Rappresentazione congiunta di due parametri</h3>
<p>Per studiare la relazione tra due parametri (ad esempio “Intercept” e “sigma”):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mcmc_scatter</span><span class="op">(</span><span class="va">fm3</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="05_one_mean_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="05_one_mean_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Si ottiene un <strong>diagramma di dispersione</strong> dei campioni a posteriori sui due assi, uno per ciascun parametro, con eventuali isodensità che mostrano le aree più probabili nella distribuzione congiunta.</li>
</ul></section><section id="posterior-predictive-check" class="level3" data-number="65.10.4"><h3 data-number="65.10.4" class="anchored" data-anchor-id="posterior-predictive-check">
<span class="header-section-number">65.10.4</span> Posterior Predictive Check</h3>
<p>La funzione <code><a href="https://mc-stan.org/bayesplot/reference/pp_check.html">pp_check()</a></code> è utilizzata per valutare se il modello è in grado di riprodurre i dati osservati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fm3</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="05_one_mean_files/figure-html/unnamed-chunk-23-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="05_one_mean_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Questa funzione genera un <strong>confronto</strong> tra la distribuzione dei dati reali (rappresentati, ad esempio, con una linea nera su un istogramma) e la distribuzione di diversi <em>dataset simulati</em> dal modello, sfruttando la <strong>distribuzione a posteriori</strong> dei parametri (<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\sigma\)</span>, ecc.).<br>
</li>
<li>Poiché il modello bayesiano è <strong>generativo</strong>, possiamo campionare nuovi dati “fittizi” a partire da ogni draw della posterior: in questo modo otteniamo molteplici dataset simulati, ognuno generato con un diverso valore di <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\sigma\)</span> estratto dalle distribuzioni posteriori.</li>
</ul>
<p>Nel grafico prodotto da <code><a href="https://mc-stan.org/bayesplot/reference/pp_check.html">pp_check()</a></code>, i dati osservati compaiono spesso come <strong>linea continua nera</strong>, mentre i dati simulati dal modello (ad esempio, 8 repliche di default) sono mostrati in <strong>colori più chiari</strong> o linee semitrasparenti. Se la distribuzione empirica si sovrappone bene a quelle generate, significa che il modello <strong>spiega adeguatamente</strong> i dati.</p>
<ul>
<li>Nel nostro caso, notiamo che le distribuzioni simulate risultano <strong>molto simili</strong> a quella osservata, indicando che la stima di <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\sigma\)</span> cattura in modo soddisfacente la variabilità dei dati.<br>
</li>
<li>Se invece avessimo osservato <strong>discrepanze sistematiche</strong> (ad esempio, dati reali con code più pesanti, oppure un picco in posizioni diverse rispetto alle distribuzioni simulate), ci saremmo insospettiti riguardo all’adeguatezza del modello. In situazioni del genere, conviene rivedere le assunzioni (e.g.&nbsp;normalità, varianza costante, eventuali covariate assenti, ecc.) prima di trarre conclusioni dai risultati a posteriori.</li>
</ul>
<p>In sintesi, il pacchetto <strong><code>bayesplot</code></strong> fornisce strumenti fondamentali per:</p>
<ol type="1">
<li>
<strong>Valutare la convergenza</strong> delle catene MCMC (<em>traceplot, autocorrelation plots</em>),<br>
</li>
<li>
<strong>Esplorare</strong> la distribuzione a posteriori dei parametri (<em>mcmc_areas, mcmc_density, mcmc_scatter, …</em>),<br>
</li>
<li>
<strong>Verificare</strong> la bontà del modello rispetto ai dati osservati mediante <em>posterior predictive checks</em> (<em>pp_check</em>).</li>
</ol>
<p>Queste analisi grafiche forniscono informazioni cruciali sia sulla qualità del campionamento (e dunque sulla stabilità delle stime) sia sull’adeguatezza delle ipotesi modellistiche adottate.</p>
</section></section><section id="lapproccio-tradizionale" class="level2" data-number="65.11"><h2 data-number="65.11" class="anchored" data-anchor-id="lapproccio-tradizionale">
<span class="header-section-number">65.11</span> L’approccio Tradizionale</h2>
<p>Prima dell’avvento dei metodi bayesiani e di altri approcci moderni, l’inferenza sulla <strong>media</strong> di una popolazione veniva spesso affrontata ricorrendo al <strong>test t di Student</strong>.</p>
<section id="la-statistica-t-di-student" class="level3" data-number="65.11.1"><h3 data-number="65.11.1" class="anchored" data-anchor-id="la-statistica-t-di-student">
<span class="header-section-number">65.11.1</span> La statistica T di Student</h3>
<p>Il test si basa sulla seguente statistica:</p>
<p><span class="math display">\[
T = \frac{\bar{X} - \mu_0}{s / \sqrt{n}},
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(\bar{X}\)</span> è la <strong>media campionaria</strong> di <span class="math inline">\(n\)</span> osservazioni,<br>
</li>
<li>
<span class="math inline">\(\mu_0\)</span> è il <strong>valore ipotizzato</strong> dalla cosiddetta “ipotesi nulla” (solitamente <span class="math inline">\(\mu_0 = 0\)</span>, ma può essere qualsiasi valore di riferimento),<br>
</li>
<li>
<span class="math inline">\(s\)</span> è la <strong>deviazione standard campionaria corretta</strong> (ovvero stimatore di <span class="math inline">\(\sigma\)</span>),<br>
</li>
<li>
<span class="math inline">\(n\)</span> è la <strong>dimensione del campione</strong>.</li>
</ul>
<p>Quando <span class="math inline">\(\sigma\)</span> (deviazione standard vera) è sconosciuta e sostituita da <span class="math inline">\(s\)</span>, la statistica <span class="math inline">\(\,T\)</span> segue (in teoria) una distribuzione t di Student con <span class="math inline">\(n - 1\)</span> gradi di libertà:</p>
<p><span class="math display">\[
T \sim t_{(n-1)}.
\]</span></p>
</section><section id="collegamento-con-la-distribuzione-z" class="level3" data-number="65.11.2"><h3 data-number="65.11.2" class="anchored" data-anchor-id="collegamento-con-la-distribuzione-z">
<span class="header-section-number">65.11.2</span> Collegamento con la distribuzione Z</h3>
<p>Se <span class="math inline">\(\sigma\)</span> fosse nota, useremmo la statistica:</p>
<p><span class="math display">\[
Z = \frac{\bar{X} - \mu}{\sigma / \sqrt{n}},
\]</span></p>
<p>la quale segue una <strong>distribuzione Normale Standard</strong> (<span class="math inline">\(Z \sim \mathcal{N}(0,1)\)</span>). Quando invece <span class="math inline">\(\sigma\)</span> è sostituita da <span class="math inline">\(s\)</span>, la distribuzione di questa statistica diventa una <strong>t di Student</strong> (che, per <span class="math inline">\(n\)</span> grande, si avvicina molto alla <span class="math inline">\(\mathcal{N}(0,1)\)</span>).</p>
</section><section id="intervallo-di-confidenza" class="level3" data-number="65.11.3"><h3 data-number="65.11.3" class="anchored" data-anchor-id="intervallo-di-confidenza">
<span class="header-section-number">65.11.3</span> Intervallo di confidenza</h3>
<p>Con il test t di Student, si ottiene anche il <strong>tradizionale intervallo di confidenza</strong> al 95% per <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math display">\[
\bar{X} \pm t_{0.975,\,n-1} \cdot \frac{s}{\sqrt{n}},
\]</span></p>
<p>dove <span class="math inline">\(t_{0.975,\,n-1}\)</span> è il quantile al 97.5% della distribuzione t con <span class="math inline">\(n-1\)</span> gradi di libertà (circa 2.0 se <span class="math inline">\(n\)</span> è sufficientemente grande, mentre 1.96 è il valore per la distribuzione normale standard).</p>
<section id="esempio-in-r" class="level4" data-number="65.11.3.1"><h4 data-number="65.11.3.1" class="anchored" data-anchor-id="esempio-in-r">
<span class="header-section-number">65.11.3.1</span> Esempio in R</h4>
<p>Nell’esempio riportato, se vogliamo costruire l’intervallo di confidenza al 95% manualmente, possiamo scrivere:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">0.975</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 153.8 155.4</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>oppure usare direttamente la funzione:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  One Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  df$height</span></span>
<span><span class="co">#&gt; t = 375, df = 351, p-value &lt;2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  153.8 155.4</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x </span></span>
<span><span class="co">#&gt;     154.6</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>che restituisce sia il <strong>valore della statistica T</strong>, sia l’<strong>intervallo di confidenza</strong> e il <strong>p-value</strong> del test t (ipotizzando, in questo esempio, <span class="math inline">\(\mu_0 = 0\)</span> come ipotesi nulla).</p>
</section></section><section id="confronto-con-il-modello-di-regressione-a-sola-intercetta" class="level3" data-number="65.11.4"><h3 data-number="65.11.4" class="anchored" data-anchor-id="confronto-con-il-modello-di-regressione-a-sola-intercetta">
<span class="header-section-number">65.11.4</span> Confronto con il modello di regressione a sola intercetta</h3>
<p>Si noti che i risultati (media stimata e intervallo di confidenza) coincidono con quanto si otterrebbe usando una <strong>regressione lineare</strong> con sola intercetta (come <code>lm(height ~ 1, data=df)</code>) e richiedendo l’intervallo di confidenza con <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code>. Sia il test <span class="math inline">\(t\)</span> di Student sia la regressione lineare semplice (senza covariate) condividono infatti le stesse assunzioni di base e forniscono risultati equivalenti per quanto riguarda l’inferenza sulla media.</p>
</section></section><section id="riflessioni-conlusive" class="level2" data-number="65.12"><h2 data-number="65.12" class="anchored" data-anchor-id="riflessioni-conlusive">
<span class="header-section-number">65.12</span> Riflessioni Conlusive</h2>
<p>In questo capitolo abbiamo esaminato l’inferenza sulla media di una popolazione partendo da un semplice modello con sola intercetta, sia nell’ottica frequentista che in quella bayesiana. Utilizzando <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, abbiamo ricavato la stima puntuale della media campionaria e il corrispondente intervallo di confidenza al 95%, interpretato come proprietà della procedura di stima. Con <code><a href="https://paulbuerkner.com/brms/reference/brm.html">brm()</a></code>, abbiamo ottenuto risultati numericamente simili, ma con una diversa interpretazione epistemologica: l’intervallo di credibilità rappresenta <strong>il grado di incertezza a posteriori sulla media</strong>, dato il modello e i dati osservati. Infine, abbiamo mostrato come introdurre informazioni a priori nel modello bayesiano, evidenziando come i risultati possano discostarsi da quelli frequentisti soprattutto in presenza di campioni piccoli o dati poco informativi. In sintesi, la modellazione bayesiana offre un quadro più flessibile e trasparente, sia nell’incorporare conoscenze pregresse sia nel rappresentare incertezza, rendendola particolarmente adatta a contesti psicologici dove le fonti di variabilità sono spesso molteplici e complesse.</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Problemi">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problemi
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Obiettivo:</strong> Utilizzare i dati dello studio di <span class="citation" data-cites="tarrats2025efficacy">Tarrats-Pons et al. (<a href="#ref-tarrats2025efficacy" role="doc-biblioref">2025</a>)</span> per replicare i risultati riportati nella Figura 2 , applicando sia l’approccio frequentista che il framework bayesiano. Calcolare inoltre la grandezza dell’effetto nel contesto bayesiano (Cohen’s <span class="math inline">\(d\)</span>) e generare un grafico che visualizzi la distribuzione a posteriori della grandezza dell’effetto ottenuta.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Soluzioni">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Soluzioni
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/posterior/">posterior</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/bayestestR/">bayestestR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span></span>
<span>    <span class="st">"data"</span>,</span>
<span>    <span class="st">"Tarrats-Pons.xlsx"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Sample</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    avg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`CESS-D`</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">df_wide</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">IdentificationNumber</span>, <span class="va">Sample</span>, CESS_D <span class="op">=</span> <span class="va">`CESS-D`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">Sample</span>, <span class="co"># da POST/PRE</span></span>
<span>    values_from <span class="op">=</span> <span class="va">CESS_D</span>, <span class="co"># i valori da mettere nelle colonne</span></span>
<span>    names_prefix <span class="op">=</span> <span class="st">"CESSD_"</span> <span class="co"># opzionale, per nominare CESSD_POST, CESSD_PRE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Controlla il risultato</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df_wide</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_wide</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="va">df_wide</span><span class="op">$</span><span class="va">CESSD_PRE</span> <span class="op">-</span> <span class="va">df_wide</span><span class="op">$</span><span class="va">CESSD_POST</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df_wide</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">df_wide</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># t-test sulle differenze</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">df_wide</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Numero di soggetti</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">df_wide</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo di Cohen's d</span></span>
<span><span class="va">d_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mostro risultato</span></span>
<span><span class="va">d_t</span></span>
<span></span>
<span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">diff</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># Modello con sola intercetta (mu)</span></span>
<span>  data <span class="op">=</span> <span class="va">df_wide</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># Distribuzione Normale</span></span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span>, <span class="co"># Prior su mu</span></span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span> <span class="co"># Prior su sigma</span></span>
<span>  <span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/pp_check.html">pp_check</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">diff</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># Modello con sola intercetta (mu)</span></span>
<span>  data <span class="op">=</span> <span class="va">df_wide</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html">student</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># Distribuzione Normale</span></span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span>, <span class="co"># Prior su mu</span></span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span> <span class="co"># Prior su sigma</span></span>
<span>  <span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/pp_check.html">pp_check</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post_samples</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_df.html">as_draws_df</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="va">post_samples</span><span class="op">$</span><span class="va">b_Intercept</span> <span class="op">/</span> <span class="va">post_samples</span><span class="op">$</span><span class="va">sigma</span></span>
<span></span>
<span><span class="co"># Calcolo diretto delle statistiche dell'effect size</span></span>
<span><span class="va">mean_effect_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span><span class="op">)</span></span>
<span><span class="va">sd_effect_size</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span><span class="op">)</span></span>
<span><span class="va">ci_effect_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stampa dei risultati</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"=== Statistiche dell'Effect Size Bayesiano ===\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Effect size medio:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mean_effect_size</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"SD dell'effect size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sd_effect_size</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>  <span class="st">"Intervallo di credibilità al 95%:"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ci_effect_size</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="st">"-"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ci_effect_size</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="st">"\n\n"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Interpretazione dell'effect size secondo le convenzioni di Cohen</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">mean_effect_size</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">interpretation</span> <span class="op">&lt;-</span> <span class="st">"piccolo"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">mean_effect_size</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">interpretation</span> <span class="op">&lt;-</span> <span class="st">"medio-piccolo"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">mean_effect_size</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">interpretation</span> <span class="op">&lt;-</span> <span class="st">"medio"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">interpretation</span> <span class="op">&lt;-</span> <span class="st">"grande"</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Interpretazione (Cohen):"</span>, <span class="va">interpretation</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcola la probabilità che l'effect size sia maggiore di zero</span></span>
<span><span class="va">prob_positive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>  <span class="st">"Probabilità che l'effect size sia positivo:"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_positive</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="st">"%\n"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Se necessario, calcola probabilità per altre soglie</span></span>
<span><span class="va">prob_medium</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>  <span class="st">"Probabilità che l'effect size sia &gt; 0.5 (medio):"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_medium</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="st">"%\n"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">prob_large</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span> <span class="op">&gt;</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>  <span class="st">"Probabilità che l'effect size sia &gt; 0.8 (grande):"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_large</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="st">"%\n"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualizzazione della distribuzione posteriore dell'effect size</span></span>
<span><span class="co"># (Per eseguire questo blocco, devi avere ggplot2 installato e caricato)</span></span>
<span><span class="co"># library(ggplot2)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">post_samples</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">effect_size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"skyblue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="va">mean_effect_size</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="va">ci_effect_size</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dotted"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="va">ci_effect_size</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dotted"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Distribuzione posteriore dell'Effect Size"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Effect Size (Cohen's d)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Densità"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="informazioni-sullambiente-di-sviluppo" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="informazioni-sullambiente-di-sviluppo">Informazioni sull’Ambiente di Sviluppo</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.0 (2025-04-11)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] readxl_1.4.5      ggdist_3.3.3      brms_2.22.0       Rcpp_1.0.14      </span></span>
<span><span class="co">#&gt;  [5] bayestestR_0.15.3 posterior_1.6.1   cmdstanr_0.9.0    thematic_0.1.6   </span></span>
<span><span class="co">#&gt;  [9] MetBrewer_0.2.0   ggokabeito_0.1.0  see_0.11.0        gridExtra_2.3    </span></span>
<span><span class="co">#&gt; [13] patchwork_1.3.0   bayesplot_1.12.0  psych_2.5.3       scales_1.4.0     </span></span>
<span><span class="co">#&gt; [17] markdown_2.0      knitr_1.50        lubridate_1.9.4   forcats_1.0.0    </span></span>
<span><span class="co">#&gt; [21] stringr_1.5.1     dplyr_1.1.4       purrr_1.0.4       readr_2.1.5      </span></span>
<span><span class="co">#&gt; [25] tidyr_1.3.1       tibble_3.2.1      ggplot2_3.5.2     tidyverse_2.0.0  </span></span>
<span><span class="co">#&gt; [29] rio_1.2.3         here_1.0.1       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] mnormt_2.1.1         inline_0.3.21        rlang_1.1.6         </span></span>
<span><span class="co">#&gt;  [4] magrittr_2.0.3       matrixStats_1.5.0    ggridges_0.5.6      </span></span>
<span><span class="co">#&gt;  [7] compiler_4.5.0       loo_2.8.0            vctrs_0.6.5         </span></span>
<span><span class="co">#&gt; [10] reshape2_1.4.4       pkgconfig_2.0.3      fastmap_1.2.0       </span></span>
<span><span class="co">#&gt; [13] backports_1.5.0      labeling_0.4.3       utf8_1.2.5          </span></span>
<span><span class="co">#&gt; [16] rmarkdown_2.29       tzdb_0.5.0           ps_1.9.1            </span></span>
<span><span class="co">#&gt; [19] xfun_0.52            jsonlite_2.0.0       parallel_4.5.0      </span></span>
<span><span class="co">#&gt; [22] R6_2.6.1             stringi_1.8.7        RColorBrewer_1.1-3  </span></span>
<span><span class="co">#&gt; [25] StanHeaders_2.32.10  cellranger_1.1.0     estimability_1.5.1  </span></span>
<span><span class="co">#&gt; [28] rstan_2.32.7         pacman_0.5.1         R.utils_2.13.0      </span></span>
<span><span class="co">#&gt; [31] Matrix_1.7-3         timechange_0.3.0     tidyselect_1.2.1    </span></span>
<span><span class="co">#&gt; [34] rstudioapi_0.17.1    abind_1.4-8          yaml_2.3.10         </span></span>
<span><span class="co">#&gt; [37] codetools_0.2-20     curl_6.2.2           processx_3.8.6      </span></span>
<span><span class="co">#&gt; [40] pkgbuild_1.4.7       lattice_0.22-7       plyr_1.8.9          </span></span>
<span><span class="co">#&gt; [43] withr_3.0.2          bridgesampling_1.1-2 coda_0.19-4.1       </span></span>
<span><span class="co">#&gt; [46] evaluate_1.0.3       RcppParallel_5.1.10  pillar_1.10.2       </span></span>
<span><span class="co">#&gt; [49] tensorA_0.36.2.1     checkmate_2.3.2      stats4_4.5.0        </span></span>
<span><span class="co">#&gt; [52] insight_1.2.0        distributional_0.5.0 generics_0.1.4      </span></span>
<span><span class="co">#&gt; [55] rprojroot_2.0.4      hms_1.1.3            rstantools_2.4.0    </span></span>
<span><span class="co">#&gt; [58] xtable_1.8-4         glue_1.8.0           emmeans_1.11.1      </span></span>
<span><span class="co">#&gt; [61] tools_4.5.0          data.table_1.17.2    mvtnorm_1.3-3       </span></span>
<span><span class="co">#&gt; [64] grid_4.5.0           QuickJSR_1.7.0       colorspace_2.1-1    </span></span>
<span><span class="co">#&gt; [67] nlme_3.1-168         cli_3.6.5            Brobdingnag_1.2-9   </span></span>
<span><span class="co">#&gt; [70] V8_6.0.3             gtable_0.3.6         R.methodsS3_1.8.2   </span></span>
<span><span class="co">#&gt; [73] digest_0.6.37        htmlwidgets_1.6.4    farver_2.1.2        </span></span>
<span><span class="co">#&gt; [76] htmltools_0.5.8.1    R.oo_1.27.1          lifecycle_1.0.4</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bibliografia" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-McElreath_rethinking" class="csl-entry" role="listitem">
McElreath, R. (2020). <em>Statistical rethinking: <span>A</span> <span>Bayesian</span> course with examples in <span>R</span> and <span>Stan</span></em> (2nd Edition). CRC Press.
</div>
<div id="ref-tarrats2025efficacy" class="csl-entry" role="listitem">
Tarrats-Pons, E., Mussons-Torras, M., &amp; Jiménez-Pérez, Y. (2025). Efficacy of a Positive Psychology Intervention in Enhancing Optimism and Reducing Depression Among University Students: A Quasi-Experimental Study. <em>Behavioral Sciences</em>, <em>15</em>(5), 571.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/linear_models/04_synt_sugar.html" class="pagination-link" aria-label="Zucchero sintattico">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/linear_models/06_prediction_stan.html" class="pagination-link" aria-label="Predizione e inferenza">
        <span class="nav-page-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Predizione e inferenza</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> è una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/linear_models/05_one_mean.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>