<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Corrado Caudek">
<title>58&nbsp; Confronto tra le medie di due gruppi</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/linear_models/09_sample_size.html" rel="next">
<link href="../../chapters/linear_models/06_prediction_stan.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-86daaaaad7353f9cc0c554efc1dd6d94.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-f8dc6eab18fde03278982b0b35885446.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-ee6228b97b460754b7d5d18bb2bb12c3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-bc9f1d3aef906c45e091843ae87821a0.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/linear_models/introduction_linear_models.html">Regressione</a></li><li class="breadcrumb-item"><a href="../../chapters/linear_models/07_two_means.html"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Eseguire il codice" class="quarto-navigation-tool px-1" aria-label="Eseguire il codice"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Attiva/disattiva la modalità oscura"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benvenuti</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefazione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Calendario</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../programmazione2024.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programma didattico e dettaglio del corso</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/key_notions/introduction_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fondamenti</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/01_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/02_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Concetti chiave</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/03_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Campionamento, metodologia sperimentale e studi osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/04_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/05_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">La riforma metodologica in psicologia: dalla crisi alla rivoluzione bayesiana</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/R/introduction_r_lang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/01_r_syntax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Science e R: un approccio moderno all’analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/02_utility_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Utility functions in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/03_r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Programmazione in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/04_r_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Pacchetti in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/05_dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduzione a <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/06_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/07_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">L’ambiente di programmazione in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/08_ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Utilizzo di strumenti AI per la programmazione</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/eda/introduction_eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/01_project_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Le fasi del progetto di analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/02_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Flusso di lavoro per la pulizia dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/04_exploring_qualitative_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Esplorare i dati qualitativi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/05_exploring_numeric_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Esplorare i dati numerici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/06_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Principi della visualizzazione dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07_loc_scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Indicatori di tendenza centrale e variabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/08_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Relazioni tra variabili</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/09_causality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/10_estimand.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Estimandi teorici e estimandi empirici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/11_outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Outlier</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/probability/introduction_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilità</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/01_intro_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Interpretazione della probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/02_prob_spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Misura di Probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/03_prob_on_general_spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fondamenti della probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/04_conditional_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Probabilità condizionata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/05_random_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/06_expval_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Proprietà delle variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/07_bayes_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/08_sampling_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/09_joint_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Probabilità congiunta</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/10_prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Distribuzioni di massa e di densità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11_discr_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12_cont_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/13_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Assunzione di gaussianità e trasformazioni dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/14_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">La verosimiglianza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/15_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Simulazioni</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_intro_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_bayesian_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Pensare ad una proporzione in termini soggettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_grid_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Calcolo della Distribuzione a Posteriori Gaussiana tramite Metodo a Griglia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_conjugate_families_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_conjugate_families_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate (2)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_gamma_exponential_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Modello gamma-esponenziale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/11_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata: un approccio frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_synt_sugar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_prediction_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Predizione e inferenza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_two_means.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Disegno della ricerca e potere statistico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_anova_2vie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">ANOVA ad due vie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/12_brms_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Frequentismo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/introduction_frequentist_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01_intro_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Introduzione all’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/02_conf_interv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/03_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">La grandezza del campione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/04_test_ipotesi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Significatività statistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/05_two_ind_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Test t di Student per campioni indipendenti</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_piranha.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Il Problema del priming: sfide e paradossi nella psicologia sociale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendice</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a10_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Indice</h2>
   
  <ul>
<li><a href="#introduzione" id="toc-introduzione" class="nav-link active" data-scroll-target="#introduzione"><span class="header-section-number">58.1</span> Introduzione</a></li>
  <li><a href="#regressione-bayesiana-per-due-gruppi-indipendenti" id="toc-regressione-bayesiana-per-due-gruppi-indipendenti" class="nav-link" data-scroll-target="#regressione-bayesiana-per-due-gruppi-indipendenti"><span class="header-section-number">58.2</span> Regressione bayesiana per due gruppi indipendenti</a></li>
  <li>
<a href="#approccio-frequentista" id="toc-approccio-frequentista" class="nav-link" data-scroll-target="#approccio-frequentista"><span class="header-section-number">58.3</span> Approccio Frequentista</a>
  <ul class="collapse">
<li><a href="#inferenza-sulla-differenza-delle-medie" id="toc-inferenza-sulla-differenza-delle-medie" class="nav-link" data-scroll-target="#inferenza-sulla-differenza-delle-medie"><span class="header-section-number">58.3.1</span> Inferenza sulla differenza delle medie</a></li>
  <li><a href="#distribuzione-della-statistica" id="toc-distribuzione-della-statistica" class="nav-link" data-scroll-target="#distribuzione-della-statistica"><span class="header-section-number">58.3.2</span> Distribuzione della statistica</a></li>
  </ul>
</li>
  <li>
<a href="#un-esempio-illustrativo" id="toc-un-esempio-illustrativo" class="nav-link" data-scroll-target="#un-esempio-illustrativo"><span class="header-section-number">58.4</span> Un esempio illustrativo</a>
  <ul class="collapse">
<li><a href="#esplorazione-iniziale-dei-dati" id="toc-esplorazione-iniziale-dei-dati" class="nav-link" data-scroll-target="#esplorazione-iniziale-dei-dati"><span class="header-section-number">58.4.1</span> Esplorazione iniziale dei dati</a></li>
  </ul>
</li>
  <li>
<a href="#parallelo-tra-approccio-frequentista-e-bayesiano-nel-confronto-tra-due-medie" id="toc-parallelo-tra-approccio-frequentista-e-bayesiano-nel-confronto-tra-due-medie" class="nav-link" data-scroll-target="#parallelo-tra-approccio-frequentista-e-bayesiano-nel-confronto-tra-due-medie"><span class="header-section-number">58.5</span> Parallelo tra approccio frequentista e bayesiano nel confronto tra due medie</a>
  <ul class="collapse">
<li><a href="#approccio-frequentista-1" id="toc-approccio-frequentista-1" class="nav-link" data-scroll-target="#approccio-frequentista-1"><span class="header-section-number">58.5.1</span> Approccio Frequentista</a></li>
  <li><a href="#approccio-bayesiano" id="toc-approccio-bayesiano" class="nav-link" data-scroll-target="#approccio-bayesiano"><span class="header-section-number">58.5.2</span> Approccio Bayesiano</a></li>
  <li><a href="#differenze-tra-i-due-approcci" id="toc-differenze-tra-i-due-approcci" class="nav-link" data-scroll-target="#differenze-tra-i-due-approcci"><span class="header-section-number">58.5.3</span> Differenze tra i due approcci</a></li>
  <li><a href="#intervallo-di-credibilit%C3%A0" id="toc-intervallo-di-credibilità" class="nav-link" data-scroll-target="#intervallo-di-credibilit%C3%A0"><span class="header-section-number">58.5.4</span> Intervallo di credibilità</a></li>
  <li><a href="#distribuzione-predittiva-a-posteriori" id="toc-distribuzione-predittiva-a-posteriori" class="nav-link" data-scroll-target="#distribuzione-predittiva-a-posteriori"><span class="header-section-number">58.5.5</span> Distribuzione Predittiva a Posteriori</a></li>
  <li><a href="#r%C2%B2-bayesiano" id="toc-r²-bayesiano" class="nav-link" data-scroll-target="#r%C2%B2-bayesiano"><span class="header-section-number">58.5.6</span> R² bayesiano</a></li>
  </ul>
</li>
  <li>
<a href="#una-parametrizzazione-alternativa" id="toc-una-parametrizzazione-alternativa" class="nav-link" data-scroll-target="#una-parametrizzazione-alternativa"><span class="header-section-number">58.6</span> Una Parametrizzazione Alternativa</a>
  <ul class="collapse">
<li><a href="#verifica-del-modello" id="toc-verifica-del-modello" class="nav-link" data-scroll-target="#verifica-del-modello"><span class="header-section-number">58.6.1</span> Verifica del modello</a></li>
  <li><a href="#valutazione-delle-stime" id="toc-valutazione-delle-stime" class="nav-link" data-scroll-target="#valutazione-delle-stime"><span class="header-section-number">58.6.2</span> Valutazione delle stime</a></li>
  <li><a href="#intervallo-di-credibilit%C3%A0-1" id="toc-intervallo-di-credibilità-1" class="nav-link" data-scroll-target="#intervallo-di-credibilit%C3%A0-1"><span class="header-section-number">58.6.3</span> Intervallo di credibilità</a></li>
  <li><a href="#valutazione-della-variabilit%C3%A0-spiegata" id="toc-valutazione-della-variabilità-spiegata" class="nav-link" data-scroll-target="#valutazione-della-variabilit%C3%A0-spiegata"><span class="header-section-number">58.6.4</span> Valutazione della variabilità spiegata</a></li>
  </ul>
</li>
  <li>
<a href="#prior-predictive-checks" id="toc-prior-predictive-checks" class="nav-link" data-scroll-target="#prior-predictive-checks"><span class="header-section-number">58.7</span> Prior Predictive Checks</a>
  <ul class="collapse">
<li><a href="#specifica-dei-priori" id="toc-specifica-dei-priori" class="nav-link" data-scroll-target="#specifica-dei-priori"><span class="header-section-number">58.7.1</span> Specifica dei Priori</a></li>
  <li><a href="#aggiunta-dei-priori-al-modello" id="toc-aggiunta-dei-priori-al-modello" class="nav-link" data-scroll-target="#aggiunta-dei-priori-al-modello"><span class="header-section-number">58.7.2</span> Aggiunta dei Priori al Modello</a></li>
  <li><a href="#esame-della-distribuzione-predittiva-a-priori" id="toc-esame-della-distribuzione-predittiva-a-priori" class="nav-link" data-scroll-target="#esame-della-distribuzione-predittiva-a-priori"><span class="header-section-number">58.7.3</span> Esame della Distribuzione Predittiva a Priori</a></li>
  <li><a href="#massima-verosimiglianza-vs-approccio-bayesiano" id="toc-massima-verosimiglianza-vs-approccio-bayesiano" class="nav-link" data-scroll-target="#massima-verosimiglianza-vs-approccio-bayesiano"><span class="header-section-number">58.7.4</span> Massima Verosimiglianza vs Approccio Bayesiano</a></li>
  <li><a href="#test-t-di-student-vs-bayesiano" id="toc-test-t-di-student-vs-bayesiano" class="nav-link" data-scroll-target="#test-t-di-student-vs-bayesiano"><span class="header-section-number">58.7.5</span> Test <span class="math inline">\(t\)</span> di Student vs Bayesiano</a></li>
  <li><a href="#esempio-con-prior-informativi" id="toc-esempio-con-prior-informativi" class="nav-link" data-scroll-target="#esempio-con-prior-informativi"><span class="header-section-number">58.7.6</span> Esempio con Prior Informativi</a></li>
  <li><a href="#test-di-ipotesi-bayesiano-con-hypothesis" id="toc-test-di-ipotesi-bayesiano-con-hypothesis" class="nav-link" data-scroll-target="#test-di-ipotesi-bayesiano-con-hypothesis"><span class="header-section-number">58.7.7</span> Test di Ipotesi Bayesiano con <code>hypothesis()</code></a></li>
  <li><a href="#integrazione-bayesiana-nella-pratica" id="toc-integrazione-bayesiana-nella-pratica" class="nav-link" data-scroll-target="#integrazione-bayesiana-nella-pratica"><span class="header-section-number">58.7.8</span> Integrazione Bayesiana nella Pratica</a></li>
  </ul>
</li>
  <li><a href="#riflessioni-conclusive" id="toc-riflessioni-conclusive" class="nav-link" data-scroll-target="#riflessioni-conclusive"><span class="header-section-number">58.8</span> Riflessioni Conclusive</a></li>
  <li><a href="#informazioni-sullambiente-di-sviluppo" id="toc-informazioni-sullambiente-di-sviluppo" class="nav-link" data-scroll-target="#informazioni-sullambiente-di-sviluppo">Informazioni sull’Ambiente di Sviluppo</a></li>
  <li><a href="#bibliografia" id="toc-bibliografia" class="nav-link" data-scroll-target="#bibliografia">Bibliografia</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/linear_models/07_two_means.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/linear_models/introduction_linear_models.html">Regressione</a></li><li class="breadcrumb-item"><a href="../../chapters/linear_models/07_two_means.html"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-linear-models-two-groups" class="quarto-section-identifier"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In questo capitolo imparerai a
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>condurre un confronto bayesiano tra le medie di due gruppi utilizzando la funzione <code>brm()</code> del pacchetto <strong>brms</strong>.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Consultare l’articolo “Bayesian estimation supersedes the t test” <span class="citation" data-cites="kruschke2013bayesian">(<a href="#ref-kruschke2013bayesian" role="doc-biblioref">Kruschke, 2013</a>)</span>.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">cmdstanr</span>, <span class="va">posterior</span>, <span class="va">brms</span>, <span class="va">bayestestR</span>, <span class="va">insight</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="introduzione" class="level2" data-number="58.1"><h2 data-number="58.1" class="anchored" data-anchor-id="introduzione">
<span class="header-section-number">58.1</span> Introduzione</h2>
<p>Spesso, ci troviamo ad affrontare la necessità di confrontare due gruppi di dati. Potrebbe interessarci sapere se la media di un gruppo è maggiore o diversa rispetto a quella di un altro gruppo. Per effettuare tale confronto, è fondamentale utilizzare un modello statistico, poiché le vere differenze tra i gruppi sono spesso accompagnate da rumore di misurazione o fluttuazioni casuali del fenomeno in esame. Questo rende difficile trarre conclusioni basandosi unicamente sulle differenze calcolate dai dati osservati.</p>
<p>Il metodo tradizionale per confrontare statisticamente due o più gruppi è quello di utilizzare un test di ipotesi statistico. Questo approccio prevede l’individuazione di un’ipotesi nulla, che solitamente afferma che non ci sono differenze tra i gruppi, e l’utilizzo di una statistica test per determinare se i dati osservati sono plausibili sotto questa ipotesi. L’ipotesi nulla viene rifiutata quando la statistica test calcolata supera una soglia predefinita.</p>
<p>Tuttavia, i test di ipotesi possono essere complessi e i risultati spesso soggetti a interpretazioni errate. La scelta delle specifiche del test statistico (ad esempio, quale test utilizzare, quale ipotesi nulla testare, quale livello di significatività adottare) è spesso arbitraria e basata su convenzioni piuttosto che sulla specificità del problema o delle decisioni da prendere (Johnson, 1999). Inoltre, i risultati forniti dai test sono spesso indiretti, incompleti e tendono a sovrastimare le evidenze contro l’ipotesi nulla (Goodman, 1999).</p>
<p><strong>Un approccio più informativo ed efficace per il confronto tra gruppi è quello basato sulla stima invece che sul test dell’ipotesi nulla</strong>, ed è guidato dalla probabilità bayesiana anziché dalla frequentista. In pratica, invece di testare se ci sono differenze tra i gruppi, si cerca di ottenere una stima di quanto siano effettivamente diversi. Questo approccio è intrinsecamente più informativo. Inoltre, viene inclusa una stima dell’incertezza associata a tale differenza, che tiene conto sia dell’incertezza dovuta alla nostra mancanza di conoscenza dei parametri del modello (incertezza epistemica) sia dell’incertezza causata dalla variabilità intrinseca del sistema (incertezza aleatoria).</p>
<p>Per affrontare tale problema possiamo usare un modello di regressione. In questo caso, anziché calcolare direttamente la differenza tra le medie, si introduce una variabile indicatrice (o “dummy”) <span class="math inline">\(D\)</span> nel modello di regressione, come segue:</p>
<p><span class="math display">\[
y_i = \alpha + \gamma D_i + \varepsilon_i.
\]</span></p>
<p>La variabile indicatrice <span class="math inline">\(D\)</span> specifica l’appartenenza ai gruppi attraverso valori binari: 0 per il gruppo di riferimento e 1 per il gruppo di confronto, definita come:</p>
<p><span class="math display">\[
D_i =
\begin{cases}
0 &amp; \text{se l'osservazione } i \text{ appartiene al gruppo 0,} \\
1 &amp; \text{se l'osservazione } i \text{ appartiene al gruppo 1.}
\end{cases}
\]</span></p>
<p>Entrambi i metodi sono appropriati per studiare la differenza tra le medie di due gruppi indipendenti. Tuttavia, il modello di regressione offre maggiore flessibilità e possibilità di estensione. Questa metodologia consente di includere ulteriori variabili esplicative, migliorando la comprensione dei fattori che influenzano l’esito di interesse. Tale flessibilità diventa particolarmente utile per esplorare come altre variabili incidano sulla differenza tra le medie o per analizzare contemporaneamente più variabili.</p>
</section><section id="regressione-bayesiana-per-due-gruppi-indipendenti" class="level2" data-number="58.2"><h2 data-number="58.2" class="anchored" data-anchor-id="regressione-bayesiana-per-due-gruppi-indipendenti">
<span class="header-section-number">58.2</span> Regressione bayesiana per due gruppi indipendenti</h2>
<p>In un approccio bayesiano, il modello di regressione può essere espresso come:</p>
<p><span class="math display">\[
\begin{align*}
y_i &amp; \sim \mathcal{N}(\mu_i, \sigma), \\
\mu_i &amp; = \alpha + \gamma D_i.
\end{align*}
\]</span></p>
<p>In questo modello:</p>
<ul>
<li>
<span class="math inline">\(\alpha\)</span> rappresenta l’intercetta, corrispondente alla media del gruppo con <span class="math inline">\(D = 0\)</span> (gruppo di riferimento),</li>
<li>
<span class="math inline">\(\gamma\)</span> quantifica la differenza attesa tra le medie dei due gruppi,</li>
<li>
<span class="math inline">\(\sigma\)</span> rappresenta la deviazione standard associata agli errori casuali.</li>
</ul>
<p>Per il gruppo di riferimento (<span class="math inline">\(D = 0\)</span>), il modello si riduce a:</p>
<p><span class="math display">\[
\begin{align*}
y_i &amp; \sim \mathcal{N}(\mu_i, \sigma), \\
\mu_i &amp; = \alpha.
\end{align*}
\]</span></p>
<p>In questo caso, <span class="math inline">\(\alpha\)</span> rappresenta direttamente la media del gruppo 0.</p>
<p>Per il gruppo di confronto (<span class="math inline">\(D = 1\)</span>), il modello diventa:</p>
<p><span class="math display">\[
\begin{align*}
y_i &amp; \sim \mathcal{N}(\mu_i, \sigma), \\
\mu_i &amp; = \alpha + \gamma.
\end{align*}
\]</span></p>
<p>Qui, <span class="math inline">\(\alpha + \gamma\)</span> rappresenta la media del gruppo 1, mentre <span class="math inline">\(\gamma\)</span> riflette la differenza tra la media del gruppo 1 e quella del gruppo 0.</p>
<p>Di conseguenza, l’analisi della differenza tra le medie dei due gruppi si traduce nell’inferenza sul parametro <span class="math inline">\(\gamma\)</span>. In un contesto bayesiano, ciò comporta l’esame della distribuzione a posteriori di <span class="math inline">\(\gamma\)</span>, che consente di effettuare confronti diretti e di valutare l’incertezza associata alla stima di tale differenza.</p>
</section><section id="approccio-frequentista" class="level2" data-number="58.3"><h2 data-number="58.3" class="anchored" data-anchor-id="approccio-frequentista">
<span class="header-section-number">58.3</span> Approccio Frequentista</h2>
<p>L’inferenza frequentista si basa sulla costruzione della <strong>distribuzione campionaria</strong> di una statistica di interesse. Nel caso presente, la statistica di interesse è la <strong>differenza tra le medie di due gruppi indipendenti</strong>. Supponiamo che i dati provengano da due popolazioni distribuite normalmente:</p>
<p><span class="math display">\[
Y_1 \sim \mathcal{N}(\mu_1, \sigma_1) \quad \text{e} \quad Y_2 \sim \mathcal{N}(\mu_2, \sigma_2),
\]</span></p>
<p>dove <span class="math inline">\(\mu_1\)</span> e <span class="math inline">\(\mu_2\)</span> sono le medie delle popolazioni, e <span class="math inline">\(\sigma_1\)</span> e <span class="math inline">\(\sigma_2\)</span> sono le deviazioni standard. Assumiamo inoltre che le varianze delle due popolazioni siano uguali, ovvero <span class="math inline">\(\sigma_1 = \sigma_2 = \sigma\)</span>.</p>
<section id="inferenza-sulla-differenza-delle-medie" class="level3" data-number="58.3.1"><h3 data-number="58.3.1" class="anchored" data-anchor-id="inferenza-sulla-differenza-delle-medie">
<span class="header-section-number">58.3.1</span> Inferenza sulla differenza delle medie</h3>
<p>Siamo interessati a fare inferenza sulla differenza <span class="math inline">\(\mu_1 - \mu_2\)</span>. La statistica campionaria corrispondente è la differenza tra le medie campionarie:</p>
<p><span class="math display">\[
\bar{Y}_1 - \bar{Y}_2.
\]</span></p>
<p>Per fare inferenza, dobbiamo determinare la distribuzione di <span class="math inline">\(\bar{Y}_1 - \bar{Y}_2\)</span> nell’universo dei campioni.</p>
<section id="valore-atteso" class="level4" data-number="58.3.1.1"><h4 data-number="58.3.1.1" class="anchored" data-anchor-id="valore-atteso">
<span class="header-section-number">58.3.1.1</span> Valore atteso</h4>
<p>Il valore atteso della differenza tra le medie campionarie è:</p>
<p><span class="math display">\[
E(\bar{Y}_1 - \bar{Y}_2) = E(\bar{Y}_1) - E(\bar{Y}_2) = \mu_1 - \mu_2.
\]</span></p>
</section><section id="varianza" class="level4" data-number="58.3.1.2"><h4 data-number="58.3.1.2" class="anchored" data-anchor-id="varianza">
<span class="header-section-number">58.3.1.2</span> Varianza</h4>
<p>La varianza della differenza tra le medie campionarie dipende dall’indipendenza dei due campioni. Se <span class="math inline">\(\bar{Y}_1\)</span> e <span class="math inline">\(\bar{Y}_2\)</span> sono indipendenti, la covarianza tra di essi è zero, e la varianza è data da:</p>
<p><span class="math display">\[
\begin{align}
V(\bar{Y}_1 - \bar{Y}_2) &amp;= V(\bar{Y}_1) + V(\bar{Y}_2) - 2 \text{Cov}(\bar{Y}_1, \bar{Y}_2) \\
&amp;= V(\bar{Y}_1) + V(\bar{Y}_2) \quad \text{(poiché $\text{Cov}(\bar{Y}_1, \bar{Y}_2) = 0$)} \\
&amp;= \frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2},
\end{align}
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(\sigma_1^2\)</span> e <span class="math inline">\(\sigma_2^2\)</span> sono le varianze delle popolazioni da cui sono estratti i campioni,</li>
<li>
<span class="math inline">\(n_1\)</span> e <span class="math inline">\(n_2\)</span> sono le dimensioni dei campioni <span class="math inline">\(\bar{Y}_1\)</span> e <span class="math inline">\(\bar{Y}_2\)</span>.</li>
</ul>
<p>Se invece <span class="math inline">\(\bar{Y}_1\)</span> e <span class="math inline">\(\bar{Y}_2\)</span> non sono indipendenti, la covarianza <span class="math inline">\(\text{Cov}(\bar{Y}_1, \bar{Y}_2)\)</span> deve essere inclusa nel calcolo:</p>
<p><span class="math display">\[
V(\bar{Y}_1 - \bar{Y}_2) = \frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2} - 2 \text{Cov}(\bar{Y}_1, \bar{Y}_2).
\]</span></p>
<p>Tuttavia, in generale, la covarianza non è nota, e l’inferenza frequentista si applica principalmente al caso in cui i due campioni sono indipendenti, ovvero <span class="math inline">\(\text{Cov}(\bar{Y}_1, \bar{Y}_2) = 0\)</span>.</p>
</section></section><section id="distribuzione-della-statistica" class="level3" data-number="58.3.2"><h3 data-number="58.3.2" class="anchored" data-anchor-id="distribuzione-della-statistica">
<span class="header-section-number">58.3.2</span> Distribuzione della statistica</h3>
<p>Per due campioni indipendenti provenienti da popolazioni normali, la statistica <span class="math inline">\(\bar{Y}_1 - \bar{Y}_2\)</span> segue una distribuzione normale:</p>
<p><span class="math display">\[
\bar{Y}_1 - \bar{Y}_2 \sim \mathcal{N}\left(\mu_1 - \mu_2, \sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}\right).
\]</span></p>
<p>Nel caso in cui <span class="math inline">\(\sigma_1 = \sigma_2 = \sigma\)</span>, è possibile stimare la varianza comune <span class="math inline">\(\sigma^2\)</span> utilizzando una <strong>varianza pooled</strong>:</p>
<p><span class="math display">\[
s_p^2 = \frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2},
\]</span></p>
<p>dove <span class="math inline">\(s_1^2\)</span> e <span class="math inline">\(s_2^2\)</span> sono le varianze campionarie dei due gruppi, calcolate come:</p>
<p><span class="math display">\[
s_1^2 = \frac{1}{n_1 - 1} \sum_{i=1}^{n_1} (y_{1,i} - \bar{y}_1)^2 \quad \text{e} \quad s_2^2 = \frac{1}{n_2 - 1} \sum_{i=1}^{n_2} (y_{2,i} - \bar{y}_2)^2.
\]</span></p>
<p>In sintesi, per due campioni indipendenti provenienti da popolazioni normali con varianze uguali, la differenza delle medie campionarie <span class="math inline">\(\bar{Y}_1 - \bar{Y}_2\)</span> segue una distribuzione normale con:</p>
<ul>
<li>
<strong>Valore atteso</strong>: <span class="math inline">\(\mu_1 - \mu_2\)</span>,</li>
<li>
<strong>Varianza</strong>: <span class="math inline">\(\frac{\sigma^2}{n_1} + \frac{\sigma^2}{n_2}\)</span>, stimabile tramite la varianza pooled <span class="math inline">\(s_p^2\)</span>.</li>
</ul>
<p>Questo risultato è fondamentale per costruire test di ipotesi e intervalli di confidenza sulla differenza delle medie. Questi argomenti verranno approfonditi in seguito. Per ora, limitiamoci a costruire la distribuzione campionaria della statistica <span class="math inline">\(\bar{Y}_1 - \bar{Y}_2\)</span> e a calcolare delle probabilità.</p>
</section></section><section id="un-esempio-illustrativo" class="level2" data-number="58.4"><h2 data-number="58.4" class="anchored" data-anchor-id="un-esempio-illustrativo">
<span class="header-section-number">58.4</span> Un esempio illustrativo</h2>
<p>Consideriamo il dataset relativo al quoziente di intelligenza (QI) di un campione di bambini, distinguendo tra quelli le cui madri hanno completato la scuola superiore e quelli le cui madri non l’hanno completata. Vediamo come implementare l’analisi descritta sopra passo per passo.</p>
<section id="esplorazione-iniziale-dei-dati" class="level3" data-number="58.4.1"><h3 data-number="58.4.1" class="anchored" data-anchor-id="esplorazione-iniziale-dei-dati">
<span class="header-section-number">58.4.1</span> Esplorazione iniziale dei dati</h3>
<p>Carichiamo i dati e osserviamo una sintesi delle prime righe per capire la struttura del dataset:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kidiq</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"kidiq.dta"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">kidiq</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   kid_score mom_hs mom_iq mom_work mom_age</span></span>
<span><span class="co">#&gt; 1        65      1  121.1        4      27</span></span>
<span><span class="co">#&gt; 2        98      1   89.4        4      25</span></span>
<span><span class="co">#&gt; 3        85      1  115.4        4      27</span></span>
<span><span class="co">#&gt; 4        83      1   99.4        3      25</span></span>
<span><span class="co">#&gt; 5       115      1   92.7        4      27</span></span>
<span><span class="co">#&gt; 6        98      0  107.9        1      18</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Successivamente, analizziamo la distribuzione dei bambini nei due gruppi, in base all’educazione delle madri:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kidiq</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">mom_hs</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    avg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kid_score</span><span class="op">)</span>,</span>
<span>    std <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">kid_score</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span><span class="co">#&gt;   mom_hs   avg   std     n</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1      0  77.5  22.6    93</span></span>
<span><span class="co">#&gt; 2      1  89.3  19.0   341</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I risultati mostrano che:</p>
<ul>
<li>
<strong>93 bambini</strong> hanno madri che non hanno completato la scuola superiore.</li>
<li>
<strong>341 bambini</strong> hanno madri diplomate,</li>
</ul>
<p>con le medie e deviazioni standard del QI riportate sopra.</p>
<p>La differenza tra le medie del QI dei due gruppi può essere calcolata direttamente come:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">[</span><span class="va">kidiq</span><span class="op">$</span><span class="va">mom_hs</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span><span class="op">$</span><span class="va">kid_score</span><span class="op">)</span> <span class="op">-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">kidiq</span><span class="op">[</span><span class="va">kidiq</span><span class="op">$</span><span class="va">mom_hs</span> <span class="op">==</span> <span class="fl">0</span>, <span class="op">]</span><span class="op">$</span><span class="va">kid_score</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 11.8</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questa analisi preliminare evidenzia la differenza media tra i gruppi.</p>
<p>Per comprendere meglio la distribuzione dei dati, utilizziamo un violin plot, che mostra la densità stimata dei punteggi del QI nei due gruppi:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">kidiq</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">mom_hs</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">kid_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span>trim <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Livello di istruzione della madre"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"QI del bambino"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Distribuzione dei punteggi QI in base all'istruzione materna"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_discrete</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Non diplomata"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Diplomata"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_two_means_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="parallelo-tra-approccio-frequentista-e-bayesiano-nel-confronto-tra-due-medie" class="level2" data-number="58.5"><h2 data-number="58.5" class="anchored" data-anchor-id="parallelo-tra-approccio-frequentista-e-bayesiano-nel-confronto-tra-due-medie">
<span class="header-section-number">58.5</span> Parallelo tra approccio frequentista e bayesiano nel confronto tra due medie</h2>
<p>Il confronto tra le medie di due gruppi indipendenti può essere affrontato sia con un approccio frequentista, basato sulla distribuzione campionaria, sia con un approccio bayesiano, basato sull’aggiornamento delle credenze a posteriori. Vediamo i due approcci in dettaglio.</p>
<section id="approccio-frequentista-1" class="level3" data-number="58.5.1"><h3 data-number="58.5.1" class="anchored" data-anchor-id="approccio-frequentista-1">
<span class="header-section-number">58.5.1</span> Approccio Frequentista</h3>
<p>L’inferenza frequentista si basa sulla <strong>distribuzione campionaria</strong> della differenza tra le medie dei due gruppi. Supponiamo che i dati provengano da due popolazioni distribuite normalmente:</p>
<p><span class="math display">\[
Y_1 \sim \mathcal{N}(\mu_1, \sigma_1) \quad \text{e} \quad Y_2 \sim \mathcal{N}(\mu_2, \sigma_2),
\]</span></p>
<p>dove <span class="math inline">\(\mu_1\)</span> e <span class="math inline">\(\mu_2\)</span> sono le medie delle popolazioni, e <span class="math inline">\(\sigma_1\)</span> e <span class="math inline">\(\sigma_2\)</span> sono le deviazioni standard.</p>
<p>Siamo interessati alla <strong>differenza delle medie campionarie</strong>, <span class="math inline">\(\bar{Y}_1 - \bar{Y}_2\)</span>, che ha una distribuzione normale:</p>
<p><span class="math display">\[
\bar{Y}_1 - \bar{Y}_2 \sim \mathcal{N}\left(\mu_1 - \mu_2, \sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}\right).
\]</span></p>
<p>Se le varianze delle due popolazioni sono uguali (<span class="math inline">\(\sigma_1 = \sigma_2 = \sigma\)</span>), possiamo stimare <span class="math inline">\(\sigma^2\)</span> tramite una <strong>varianza poolata</strong>:</p>
<p><span class="math display">\[
s_p^2 = \frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}.
\]</span></p>
<p>Con questa stima, possiamo calcolare la probabilità che la differenza osservata tra le medie campionarie superi un certo valore, ad esempio 5 punti.</p>
<section id="esempio-pratico" class="level4" data-number="58.5.1.1"><h4 data-number="58.5.1.1" class="anchored" data-anchor-id="esempio-pratico">
<span class="header-section-number">58.5.1.1</span> Esempio pratico</h4>
<p>Consideriamo i dati:</p>
<ul>
<li>
<strong>Gruppo 1</strong> (madri diplomate): <span class="math inline">\(n_1 = 341\)</span>, <span class="math inline">\(\bar{Y}_1 = 89.3\)</span>, <span class="math inline">\(s_1 = 19.0\)</span>,</li>
<li>
<strong>Gruppo 2</strong> (madri non diplomate): <span class="math inline">\(n_2 = 93\)</span>, <span class="math inline">\(\bar{Y}_2 = 77.5\)</span>, <span class="math inline">\(s_2 = 22.6\)</span>.</li>
</ul>
<p>Calcoliamo la probabilità che la differenza campionaria <span class="math inline">\(\bar{Y}_1 - \bar{Y}_2\)</span> superi 5 punti:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Dati</span></span>
<span><span class="va">mean_1</span> <span class="op">&lt;-</span> <span class="fl">89.3</span></span>
<span><span class="va">std_1</span> <span class="op">&lt;-</span> <span class="fl">19.0</span></span>
<span><span class="va">n_1</span> <span class="op">&lt;-</span> <span class="fl">341</span></span>
<span></span>
<span><span class="va">mean_2</span> <span class="op">&lt;-</span> <span class="fl">77.5</span></span>
<span><span class="va">std_2</span> <span class="op">&lt;-</span> <span class="fl">22.6</span></span>
<span><span class="va">n_2</span> <span class="op">&lt;-</span> <span class="fl">93</span></span>
<span></span>
<span><span class="co"># Varianza poolata</span></span>
<span><span class="va">pooled_variance</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">n_1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">std_1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="op">(</span><span class="va">n_2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">std_2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n_1</span> <span class="op">+</span> <span class="va">n_2</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Deviazione standard della differenza</span></span>
<span><span class="va">std_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">pooled_variance</span> <span class="op">/</span> <span class="va">n_1</span> <span class="op">+</span> <span class="va">pooled_variance</span> <span class="op">/</span> <span class="va">n_2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Probabilità</span></span>
<span><span class="va">diff_threshold</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">diff_threshold</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="va">std_diff</span><span class="op">)</span></span>
<span><span class="va">p_value</span></span>
<span><span class="co">#&gt; [1] 0.0155</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="approccio-bayesiano" class="level3" data-number="58.5.2"><h3 data-number="58.5.2" class="anchored" data-anchor-id="approccio-bayesiano">
<span class="header-section-number">58.5.2</span> Approccio Bayesiano</h3>
<p>L’approccio bayesiano utilizza un modello di regressione con una variabile indicatrice (dummy) per distinguere i due gruppi. La formula del modello è:</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 \cdot \text{mom\_hs} + \epsilon,
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(\beta_0\)</span> è la media del gruppo di riferimento (madri non diplomate),</li>
<li>
<span class="math inline">\(\beta_1\)</span> è la differenza tra le medie dei due gruppi,</li>
<li>
<span class="math inline">\(\epsilon \sim \mathcal{N}(0, \sigma^2)\)</span>.</li>
</ul>
<section id="specifica-del-modello-e-stima" class="level4" data-number="58.5.2.1"><h4 data-number="58.5.2.1" class="anchored" data-anchor-id="specifica-del-modello-e-stima">
<span class="header-section-number">58.5.2.1</span> Specifica del modello e stima</h4>
<p>Utilizziamo il pacchetto <code>brms</code> per stimare il modello, con distribuzioni a priori debolmente informative:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_hs</span>, </span>
<span>  data <span class="op">=</span> <span class="va">kidiq</span>, </span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>  silent <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dopo aver stimato il modello, possiamo esaminare la distribuzione a posteriori del coefficiente <span class="math inline">\(\beta_1\)</span>, che rappresenta la differenza tra le medie.</p>
</section><section id="probabilità-e-intervalli-di-credibilità" class="level4" data-number="58.5.2.2"><h4 data-number="58.5.2.2" class="anchored" data-anchor-id="probabilità-e-intervalli-di-credibilità">
<span class="header-section-number">58.5.2.2</span> Probabilità e intervalli di credibilità</h4>
<p>Calcoliamo la probabilità che la differenza tra le medie sia maggiore di 5 punti:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Campioni posteriori del coefficiente mom_hs</span></span>
<span><span class="va">posterior_samples</span> <span class="op">&lt;-</span> <span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fit_1</span><span class="op">)</span></span>
<span><span class="va">mom_hs_coef</span> <span class="op">&lt;-</span> <span class="va">posterior_samples</span><span class="op">$</span><span class="va">b_mom_hs</span></span>
<span></span>
<span><span class="co"># Probabilità che la differenza sia maggiore di 5</span></span>
<span><span class="va">prob_greater_than_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mom_hs_coef</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">prob_greater_than_5</span></span>
<span><span class="co">#&gt; [1] 0.998</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="differenze-tra-i-due-approcci" class="level3" data-number="58.5.3"><h3 data-number="58.5.3" class="anchored" data-anchor-id="differenze-tra-i-due-approcci">
<span class="header-section-number">58.5.3</span> Differenze tra i due approcci</h3>
<p>I risultati ottenuti con i due approcci possono differire perché calcolano la probabilità sotto assunzioni e modelli differenti. Vediamo nel dettaglio le differenze tra i due approcci per chiarire la discrepanza.</p>
<section id="approccio-frequentista-2" class="level4" data-number="58.5.3.1"><h4 data-number="58.5.3.1" class="anchored" data-anchor-id="approccio-frequentista-2">
<span class="header-section-number">58.5.3.1</span> Approccio frequentista</h4>
<ul>
<li>
<strong>Ipotesi</strong>: La differenza tra le medie campionarie <span class="math inline">\(\bar{Y}_1 - \bar{Y}_2\)</span> è distribuita secondo una normale centrata in <span class="math inline">\(0\)</span> (sotto l’ipotesi nulla che <span class="math inline">\(\mu_1 = \mu_2\)</span>).</li>
<li>
<strong>Distribuzione utilizzata</strong>: La distribuzione normale ha una deviazione standard basata sulla stima poolata della varianza campionaria.</li>
<li>
<strong>Risultato</strong>: La probabilità calcolata rappresenta quanto è improbabile osservare una differenza di almeno 5 punti <strong>sotto l’ipotesi nulla</strong>.</li>
</ul>
<p>Questo approccio parte dall’ipotesi di uguali medie (<span class="math inline">\(\mu_1 = \mu_2\)</span>) e misura l’evidenza contro questa ipotesi. In sostanza, stiamo testando un’ipotesi frequentista sulla differenza campionaria.</p>
</section><section id="approccio-bayesiano-1" class="level4" data-number="58.5.3.2"><h4 data-number="58.5.3.2" class="anchored" data-anchor-id="approccio-bayesiano-1">
<span class="header-section-number">58.5.3.2</span> Approccio bayesiano</h4>
<ul>
<li>
<strong>Ipotesi</strong>: Modello lineare bayesiano che stima il valore del coefficiente <span class="math inline">\(\beta\)</span> associato a <code>mom_hs</code>, usando i dati osservati per costruire una distribuzione a posteriori.</li>
<li>
<strong>Distribuzione utilizzata</strong>: La distribuzione a posteriori del coefficiente <span class="math inline">\(\beta\)</span>, che rappresenta la plausibilità dei valori di <span class="math inline">\(\beta\)</span> dati i dati osservati.</li>
<li>
<strong>Risultato</strong>: La probabilità calcolata è la proporzione di campioni posteriori in cui <span class="math inline">\(\beta &gt; 5\)</span>.</li>
</ul>
<p>Questo approccio riflette l’evidenza dei dati osservati rispetto al modello stimato, senza partire dall’ipotesi che <span class="math inline">\(\mu_1 = \mu_2\)</span>.</p>
</section><section id="perché-i-risultati-differiscono" class="level4" data-number="58.5.3.3"><h4 data-number="58.5.3.3" class="anchored" data-anchor-id="perché-i-risultati-differiscono">
<span class="header-section-number">58.5.3.3</span> Perché i risultati differiscono?</h4>
<ol type="1">
<li>
<strong>Assunzioni di partenza</strong>:
<ul>
<li>Frequentista: Parte dall’ipotesi nulla <span class="math inline">\(\mu_1 = \mu_2\)</span> e calcola quanto è improbabile osservare una differenza di almeno 5 punti sotto questa ipotesi.</li>
<li>Bayesiano: Parte da una distribuzione a priori per i parametri del modello, aggiornata con i dati osservati per stimare la distribuzione a posteriori. Non assume <span class="math inline">\(\mu_1 = \mu_2\)</span>, ma stima direttamente la probabilità che la differenza sia maggiore di 5.</li>
</ul>
</li>
<li>
<strong>Distribuzione di riferimento</strong>:
<ul>
<li>Nel metodo frequentista, la distribuzione normale è centrata su <span class="math inline">\(0\)</span> con varianza stimata.</li>
<li>Nel metodo bayesiano, la distribuzione è centrata sulla stima massima a posteriori (MAP) del coefficiente <span class="math inline">\(\beta\)</span>, che riflette il valore più plausibile dato i dati.</li>
</ul>
</li>
<li>
<strong>Effetto dei dati osservati</strong>:
<ul>
<li>Nel metodo frequentista, il valore di <span class="math inline">\(5\)</span> è confrontato con una distribuzione teorica basata sull’ipotesi nulla.</li>
<li>Nel metodo bayesiano, il valore di <span class="math inline">\(5\)</span> è confrontato con una distribuzione basata sui dati osservati.</li>
</ul>
</li>
</ol>
<p><strong>Quale metodo usare?</strong></p>
<p>Dipende dall’interpretazione desiderata: - se vogliamo testare quanto sono compatibili i dati con l’ipotesi <span class="math inline">\(\mu_1 = \mu_2\)</span>, il metodo frequentista è appropriato; - se vogliamo stimare direttamente la probabilità che la differenza sia maggiore di 5 punti, data la distribuzione a posteriori, il metodo bayesiano è più adatto.</p>
<p>La discrepanza tra i risultati riflette le diverse filosofie statistiche dei due approcci. Tuttavia, se partiamo dal presupposto che l’ipotesi nulla (<span class="math inline">\(\mu_1 = \mu_2\)</span>) sia sicuramente falsa, come accade quasi sempre nel mondo reale (poiché una differenza, per quanto piccola, è inevitabile), l’approccio frequentista perde di utilità pratica. Testare cosa accadrebbe se la differenza fosse esattamente zero è una costruzione teorica che raramente offre informazioni utili per comprendere i dati osservati.</p>
<p>L’approccio bayesiano, invece, permette di concentrarsi su una domanda più pertinente: qual è il grado di incertezza sulla differenza tra le medie delle due popolazioni? Questo approccio combina i dati osservati con informazioni a priori (esplicite o deboli) per costruire una distribuzione a posteriori che descrive la plausibilità dei possibili valori della differenza. In altre parole, ci consente di stimare direttamente quanto è probabile che la differenza tra le medie superi una soglia significativa (ad esempio, 5 punti), senza fare affidamento su ipotesi non realistiche come quella di una differenza esattamente nulla.</p>
<p>In sintesi, l’approccio bayesiano è più utile in questo contesto perché:</p>
<ol type="1">
<li>Non si basa su un’ipotesi nulla idealizzata che sappiamo non essere vera.</li>
<li>Stima direttamente la nostra incertezza rispetto alla differenza tra le medie, fornendo una risposta concreta e interpretabile in termini di probabilità.</li>
<li>Permette di integrare le evidenze dei dati con la conoscenza preesistente, per ottenere inferenze più realistiche e informate.</li>
</ol>
<p>Pertanto, l’approccio bayesiano è particolarmente adatto quando l’obiettivo è comprendere e quantificare l’incertezza riguardo alla differenza tra gruppi, piuttosto che testare una condizione ipotetica che difficilmente riflette la realtà.</p>
</section></section><section id="intervallo-di-credibilità" class="level3" data-number="58.5.4"><h3 data-number="58.5.4" class="anchored" data-anchor-id="intervallo-di-credibilità">
<span class="header-section-number">58.5.4</span> Intervallo di credibilità</h3>
<p>Sviluppiamo l’analisi bayesiana. Calcoliamo anche l’intervallo di credibilità per <span class="math inline">\(\beta_1\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">bayestestR</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/hdi.html">hdi</a></span><span class="op">(</span><span class="va">fit_1</span>, parameters <span class="op">=</span> <span class="st">"mom_hs"</span>, ci <span class="op">=</span> <span class="fl">0.89</span><span class="op">)</span></span>
<span><span class="co">#&gt; Highest Density Interval</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter |       89% HDI</span></span>
<span><span class="co">#&gt; -------------------------</span></span>
<span><span class="co">#&gt; mom_hs    | [8.36, 15.66]</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="distribuzione-predittiva-a-posteriori" class="level3" data-number="58.5.5"><h3 data-number="58.5.5" class="anchored" data-anchor-id="distribuzione-predittiva-a-posteriori">
<span class="header-section-number">58.5.5</span> Distribuzione Predittiva a Posteriori</h3>
<p>Effettuiamo un controllo grafico per confrontare i dati osservati con quelli predetti dal modello:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit_1</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_two_means_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="r²-bayesiano" class="level3" data-number="58.5.6"><h3 data-number="58.5.6" class="anchored" data-anchor-id="r²-bayesiano">
<span class="header-section-number">58.5.6</span> R² bayesiano</h3>
<p>Infine, calcoliamo il coefficiente di determinazione (Bayesiano <span class="math inline">\(R^2\)</span>) per valutare la capacità del modello di spiegare la variabilità nei dati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">bayes_R2</span><span class="op">(</span><span class="va">fit_1</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Estimate Est.Error   Q2.5 Q97.5</span></span>
<span><span class="co">#&gt; R2   0.0577    0.0206 0.0218 0.101</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questo esempio dimostra come l’analisi di regressione bayesiana consenta di replicare e approfondire i risultati ottenuti in precedenza. Il modello non solo stima la differenza tra i gruppi, ma offre anche un quadro completo dell’incertezza associata, evidenziando la flessibilità e la potenza di questo approccio.</p>
</section></section><section id="una-parametrizzazione-alternativa" class="level2" data-number="58.6"><h2 data-number="58.6" class="anchored" data-anchor-id="una-parametrizzazione-alternativa">
<span class="header-section-number">58.6</span> Una Parametrizzazione Alternativa</h2>
<p>Poiché il <strong>posterior predictive check</strong> (pp-check) ha evidenziato una leggera discrepanza tra i valori osservati (<span class="math inline">\(y\)</span>) e quelli predetti dal modello, consideriamo una parametrizzazione alternativa. Adottiamo un modello gaussiano esteso con un parametro aggiuntivo per modellare l’asimmetria nella distribuzione, utilizzando una famiglia di distribuzioni skew-normal.</p>
<p>Ecco come definiamo e stimiamo il nuovo modello:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_2</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_hs</span>, </span>
<span>  family <span class="op">=</span> <span class="fu">skew_normal</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, </span>
<span>  silent <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  data <span class="op">=</span> <span class="va">kidiq</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="verifica-del-modello" class="level3" data-number="58.6.1"><h3 data-number="58.6.1" class="anchored" data-anchor-id="verifica-del-modello">
<span class="header-section-number">58.6.1</span> Verifica del modello</h3>
<p>Dopo aver stimato il modello, eseguiamo nuovamente il pp-check per confrontare i dati osservati con quelli predetti:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit_2</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_two_means_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>I risultati mostrano un miglioramento nell’adattamento del modello, indicando che l’aggiunta del parametro per l’asimmetria ha contribuito a ridurre le discrepanze.</p>
</section><section id="valutazione-delle-stime" class="level3" data-number="58.6.2"><h3 data-number="58.6.2" class="anchored" data-anchor-id="valutazione-delle-stime">
<span class="header-section-number">58.6.2</span> Valutazione delle stime</h3>
<p>Analizziamo le stime posteriori dei parametri per verificare eventuali variazioni rispetto al modello precedente:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws.html">as_draws</a></span><span class="op">(</span><span class="va">fit_2</span>, variable <span class="op">=</span> <span class="st">"^b_"</span>, regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">draws</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"mcse_mean"</span>, <span class="st">"mcse_sd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   variable     mean    sd mcse_mean mcse_sd</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 b_Intercept 79.2   1.99    0.0325  0.0290</span></span>
<span><span class="co">#&gt; 2 b_mom_hs     9.65  2.24    0.0361  0.0321</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="intervallo-di-credibilità-1" class="level3" data-number="58.6.3"><h3 data-number="58.6.3" class="anchored" data-anchor-id="intervallo-di-credibilità-1">
<span class="header-section-number">58.6.3</span> Intervallo di credibilità</h3>
<p>Calcoliamo l’intervallo di credibilità a densità massima (HDI) per il parametro associato a <code>mom_hs</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">bayestestR</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/hdi.html">hdi</a></span><span class="op">(</span><span class="va">fit_2</span>, parameters <span class="op">=</span> <span class="st">"mom_hs"</span>, ci <span class="op">=</span> <span class="fl">0.89</span><span class="op">)</span></span>
<span><span class="co">#&gt; Highest Density Interval</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter |       89% HDI</span></span>
<span><span class="co">#&gt; -------------------------</span></span>
<span><span class="co">#&gt; mom_hs    | [6.10, 13.27]</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="valutazione-della-variabilità-spiegata" class="level3" data-number="58.6.4"><h3 data-number="58.6.4" class="anchored" data-anchor-id="valutazione-della-variabilità-spiegata">
<span class="header-section-number">58.6.4</span> Valutazione della variabilità spiegata</h3>
<p>Infine, calcoliamo il coefficiente di determinazione Bayesiano (<span class="math inline">\(R^2\)</span>) per quantificare la capacità del modello di spiegare la variabilità nei dati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">bayes_R2</span><span class="op">(</span><span class="va">fit_2</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Estimate Est.Error   Q2.5  Q97.5</span></span>
<span><span class="co">#&gt; R2     0.04    0.0171 0.0114 0.0769</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In conclusioni, il modello con distribuzione skew-normal offre un adattamento migliore rispetto al modello gaussiano standard, come evidenziato dal pp-check. Tuttavia, le stime posteriori dei parametri differiscono solo marginalmente rispetto al modello precedente. Questo suggerisce che, sebbene l’aggiunta dell’asimmetria migliori l’adattamento, l’effetto sulla stima della relazione tra <code>kid_score</code> e <code>mom_hs</code> è limitato.</p>
</section></section><section id="prior-predictive-checks" class="level2" data-number="58.7"><h2 data-number="58.7" class="anchored" data-anchor-id="prior-predictive-checks">
<span class="header-section-number">58.7</span> Prior Predictive Checks</h2>
<p>Il punto di partenza per valutare le prestazioni predittive dei priori consiste nell’effettuare <strong>controlli predittivi grafici sui priori</strong>. In <code>brms</code>, questi controlli possono essere eseguiti in modo quasi identico ai posterior predictive checks. Basta indicare a <code>brms</code> di ignorare i dati durante il campionamento, concentrandosi unicamente sui priori. Per fare ciò, è fondamentale che tutti i parametri abbiano priori propri e, idealmente, non eccessivamente ampi o poco plausibili.</p>
<p>Partiamo specificando priori debolmente informativi per il nostro modello gaussiano applicato ai dati <code>kidiq</code>. Esaminiamo prima i priori predefiniti da <code>brms</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">get_prior</span><span class="op">(</span><span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_hs</span>, data <span class="op">=</span> <span class="va">kidiq</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   prior     class   coef group resp dpar nlpar lb ub</span></span>
<span><span class="co">#&gt;  student_t(3, 90, 19.3) Intercept                                   </span></span>
<span><span class="co">#&gt;                  (flat)         b                                   </span></span>
<span><span class="co">#&gt;                  (flat)         b mom_hs                            </span></span>
<span><span class="co">#&gt;   student_t(3, 0, 19.3)     sigma                               0   </span></span>
<span><span class="co">#&gt;        source</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;       default</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="specifica-dei-priori" class="level3" data-number="58.7.1"><h3 data-number="58.7.1" class="anchored" data-anchor-id="specifica-dei-priori">
<span class="header-section-number">58.7.1</span> Specifica dei Priori</h3>
<p>Modifichiamo i priori predefiniti per utilizzare prior debolmente informativi personalizzati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prior_gaussian</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">90</span>, <span class="fl">20</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"b"</span>, coef <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"b"</span>, coef <span class="op">=</span> <span class="st">"mom_hs"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">prior</span><span class="op">(</span><span class="fu">cauchy</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="aggiunta-dei-priori-al-modello" class="level3" data-number="58.7.2"><h3 data-number="58.7.2" class="anchored" data-anchor-id="aggiunta-dei-priori-al-modello">
<span class="header-section-number">58.7.2</span> Aggiunta dei Priori al Modello</h3>
<p>Aggiungiamo i priori definiti alla funzione <code>brm</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_3</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="fu">bf</span><span class="op">(</span><span class="va">kid_score</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">mom_hs</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>  <span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_hs</span>, </span>
<span>  prior <span class="op">=</span> <span class="va">prior_gaussian</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, </span>
<span>  silent <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  data <span class="op">=</span> <span class="va">kidiq</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le stime a posteriori per i parametri <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> corrispondono ai valori ottenuti in precedenza:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws.html">as_draws</a></span><span class="op">(</span><span class="va">fit_3</span>, variable <span class="op">=</span> <span class="st">"^b_"</span>, regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">draws</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"mcse_mean"</span>, <span class="st">"mcse_sd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   variable     mean    sd mcse_mean mcse_sd</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 b_Intercept  78.0  2.05    0.0534  0.0414</span></span>
<span><span class="co">#&gt; 2 b_mom_hs     11.2  2.29    0.0593  0.0469</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="esame-della-distribuzione-predittiva-a-priori" class="level3" data-number="58.7.3"><h3 data-number="58.7.3" class="anchored" data-anchor-id="esame-della-distribuzione-predittiva-a-priori">
<span class="header-section-number">58.7.3</span> Esame della Distribuzione Predittiva a Priori</h3>
<p>Per generare campioni unicamente dalla distribuzione dei priori, specifichiamo l’argomento <code>sample_prior = "only"</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_4</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="fu">bf</span><span class="op">(</span><span class="va">kid_score</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">mom_hs</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>  <span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_hs</span>, </span>
<span>  prior <span class="op">=</span> <span class="va">prior_gaussian</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, </span>
<span>  silent <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  data <span class="op">=</span> <span class="va">kidiq</span>,</span>
<span>  sample_prior <span class="op">=</span> <span class="st">"only"</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Quando analizziamo il sommario del modello, osserviamo che i valori stimati dai “posteriori” riflettono effettivamente i priori:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_4</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">#&gt; Formula: kid_score ~ 1 + mom_hs </span></span>
<span><span class="co">#&gt;          autocor ~ tructure(list(), class = "formula", .Environment = &lt;environment&gt;)</span></span>
<span><span class="co">#&gt;    Data: kidiq (Number of observations: 434) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept    89.89     20.01    50.65   128.40 1.00     3689     2858</span></span>
<span><span class="co">#&gt; mom_hs       -0.04     14.73   -27.63    28.42 1.00     3613     2922</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sigma   240.42   4297.30     0.66   578.48 1.00     3095     2039</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Possiamo utilizzare <code>pp_check</code> per visualizzare i prior predictive checks:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit_4</span>, ndraws <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlim</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">180</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_two_means_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>La distribuzione predittiva a priori risulta più ampia rispetto alla distribuzione dei dati osservati, ma rimane comunque dello stesso ordine di grandezza. Questo è esattamente ciò che ci aspettiamo: i priori dovrebbero essere abbastanza ampi da consentire flessibilità, ma non così eccessivi da risultare irrealistici. Sebbene questo controllo non garantisca con certezza che tutti i priori siano ragionevoli, è utile per identificare priori potenzialmente troppo ampi o poco informativi.</p>
</section><section id="massima-verosimiglianza-vs-approccio-bayesiano" class="level3" data-number="58.7.4"><h3 data-number="58.7.4" class="anchored" data-anchor-id="massima-verosimiglianza-vs-approccio-bayesiano">
<span class="header-section-number">58.7.4</span> Massima Verosimiglianza vs Approccio Bayesiano</h3>
<p>Il modello di regressione basato sulla massima verosimiglianza stima i parametri ottimizzando la funzione di verosimiglianza, che rappresenta la probabilità dei dati dati i parametri. Sebbene questo approccio sia robusto, si limita a fornire stime puntuali e intervalli di fiducia frequentisti, che non hanno un’interpretazione probabilistica diretta (ad esempio, non possiamo dire che c’è una probabilità del 95% che il vero parametro sia contenuto nell’intervallo).</p>
<p>L’approccio bayesiano, al contrario:</p>
<ol type="1">
<li>
<strong>Costruisce una distribuzione a posteriori</strong> per il parametro di interesse (ad esempio, la differenza tra gruppi), combinando i dati osservati con informazioni a priori.</li>
<li>
<strong>Permette di calcolare probabilità dirette</strong>: ad esempio, la probabilità che la differenza sia maggiore di un certo valore (<span class="math inline">\(P(\beta_{mean\_diff} &gt; 5)\)</span>).</li>
<li>
<strong>Integra incertezze multiple</strong>: ogni fonte di incertezza viene propagata naturalmente nella distribuzione a posteriori, rendendo l’analisi più realistica.</li>
</ol></section><section id="test-t-di-student-vs-bayesiano" class="level3" data-number="58.7.5"><h3 data-number="58.7.5" class="anchored" data-anchor-id="test-t-di-student-vs-bayesiano">
<span class="header-section-number">58.7.5</span> Test <span class="math inline">\(t\)</span> di Student vs Bayesiano</h3>
<p>Il test <span class="math inline">\(t\)</span> di Student si basa su un’ipotesi nulla rigida (<span class="math inline">\(\mu_1 = \mu_2\)</span>), mentre l’approccio bayesiano permette di valutare la probabilità che la differenza sia significativa rispetto a un valore ipotetico (es. 5 o 10 punti). Questo consente un’analisi più flessibile e rilevante:</p>
<ul>
<li>
<strong>Nessun focus sull’ipotesi nulla</strong>: Invece di testare l’ipotesi nulla che sappiamo essere quasi certamente falsa, l’approccio bayesiano si concentra su ciò che i dati ci dicono direttamente riguardo alla differenza.</li>
<li>
<strong>Informazioni aggiuntive</strong>: Il test bayesiano, attraverso la distribuzione a posteriori, permette di visualizzare l’incertezza e valutare intervalli di credibilità attorno alla stima.</li>
</ul></section><section id="esempio-con-prior-informativi" class="level3" data-number="58.7.6"><h3 data-number="58.7.6" class="anchored" data-anchor-id="esempio-con-prior-informativi">
<span class="header-section-number">58.7.6</span> Esempio con Prior Informativi</h3>
<p>Un ulteriore approfondimento dell’approccio bayesiano consiste nell’uso di prior informativi. Ad esempio, se studi precedenti indicano che le differenze tra i due gruppi tendono ad essere intorno a 10 punti, possiamo specificare un prior normale centrato su 10 con una deviazione standard moderata. Questo prior può influenzare i risultati quando i dati sono scarsi o poco informativi, ma con un campione ampio come in questo caso, i dati tendono a prevalere sui prior.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_5</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">kid_score</span> <span class="op">~</span> <span class="va">mom_hs</span>,</span>
<span>  data <span class="op">=</span> <span class="va">kidiq</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">set_prior</span><span class="op">(</span><span class="st">"normal(10, 5)"</span>, class <span class="op">=</span> <span class="st">"b"</span>, coef <span class="op">=</span> <span class="st">"mom_hs"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>  silent <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_5</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">#&gt; Formula: kid_score ~ mom_hs </span></span>
<span><span class="co">#&gt;    Data: kidiq (Number of observations: 434) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept    77.81      1.92    74.07    81.58 1.00     4427     3120</span></span>
<span><span class="co">#&gt; mom_hs       11.43      2.12     7.37    15.60 1.00     4265     3078</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sigma    19.88      0.66    18.62    21.20 1.00     4270     3219</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con prior informativi, i risultati rifletteranno sia le evidenze dei dati sia il nostro stato di conoscenza precedente, arricchendo ulteriormente l’inferenza.</p>
</section><section id="test-di-ipotesi-bayesiano-con-hypothesis" class="level3" data-number="58.7.7"><h3 data-number="58.7.7" class="anchored" data-anchor-id="test-di-ipotesi-bayesiano-con-hypothesis">
<span class="header-section-number">58.7.7</span> Test di Ipotesi Bayesiano con <code>hypothesis()</code>
</h3>
<p>Il comando <code>hypothesis()</code> in <code>brms</code> consente di verificare ipotesi specifiche direttamente sulla distribuzione a posteriori. Ad esempio:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">hypothesis</span><span class="op">(</span><span class="va">fit_1</span>, <span class="st">"mom_hs &gt; 5"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hypothesis Tests for class b:</span></span>
<span><span class="co">#&gt;         Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio</span></span>
<span><span class="co">#&gt; 1 (mom_hs)-(5) &gt; 0     6.78      2.31     3.02     10.5        399</span></span>
<span><span class="co">#&gt;   Post.Prob Star</span></span>
<span><span class="co">#&gt; 1         1    *</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; 'CI': 90%-CI for one-sided and 95%-CI for two-sided hypotheses.</span></span>
<span><span class="co">#&gt; '*': For one-sided hypotheses, the posterior probability exceeds 95%;</span></span>
<span><span class="co">#&gt; for two-sided hypotheses, the value tested against lies outside the 95%-CI.</span></span>
<span><span class="co">#&gt; Posterior probabilities of point hypotheses assume equal prior probabilities.</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Confrontando questo approccio al test frequentista:</p>
<ul>
<li>Il test bayesiano non restituisce un <span class="math inline">\(p\)</span>-value, ma una probabilità interpretabile, come “c’è una probabilità del 99.8% che la differenza tra i gruppi sia maggiore di 5 punti”.</li>
<li>L’output include un intervallo di credibilità, che rappresenta un range di valori plausibili per il parametro con una certa probabilità (ad esempio, 89%).</li>
</ul></section><section id="integrazione-bayesiana-nella-pratica" class="level3" data-number="58.7.8"><h3 data-number="58.7.8" class="anchored" data-anchor-id="integrazione-bayesiana-nella-pratica">
<span class="header-section-number">58.7.8</span> Integrazione Bayesiana nella Pratica</h3>
<p>L’approccio bayesiano si distingue per la sua flessibilità, soprattutto quando:</p>
<ol type="1">
<li>L’ipotesi nulla è irrealistica o poco utile.</li>
<li>Si desidera incorporare conoscenze precedenti in modo sistematico.</li>
<li>Si vuole ottenere inferenze probabilistiche più dirette e intuitive, come la probabilità che un parametro superi una soglia rilevante.</li>
</ol>
<p>Con l’aumentare della complessità dei modelli o della necessità di rispondere a domande più sfumate, l’approccio bayesiano diventa lo strumento più adatto per catturare la reale incertezza e complessità dei dati.</p>
</section></section><section id="riflessioni-conclusive" class="level2" data-number="58.8"><h2 data-number="58.8" class="anchored" data-anchor-id="riflessioni-conclusive">
<span class="header-section-number">58.8</span> Riflessioni Conclusive</h2>
<p>In questo capitolo abbiamo esplorato le numerose funzionalità offerte da <strong>brms</strong> per la modellazione bayesiana, dimostrando come questo pacchetto consenta di implementare analisi sofisticate in modo intuitivo e flessibile. Dalla specifica dei modelli all’interpretazione probabilistica dei risultati, <strong>brms</strong> si è rivelato uno strumento particolarmente utile per tradurre domande di ricerca complesse in analisi statistiche rigorose.</p>
<p>Un punto chiave emerso è l’importanza dell’approccio bayesiano nel superare i limiti delle inferenze frequentiste, permettendo di stimare direttamente l’incertezza sui parametri e di testare ipotesi rilevanti senza fare affidamento su ipotesi nulle spesso irrealistiche. Inoltre, abbiamo visto come la capacità di incorporare conoscenze pregresse attraverso i priori consenta di adattare i modelli al contesto specifico della ricerca, rendendo l’approccio bayesiano non solo potente, ma anche estremamente versatile.</p>
<p>In definitiva, <strong>brms</strong> non è soltanto un software per l’analisi statistica, ma uno strumento che favorisce un cambiamento nella mentalità analitica, promuovendo una visione più completa e realistica dell’incertezza e della probabilità. Questo capitolo dovrebbe servire come base per l’applicazione di modelli bayesiani in scenari reali, fornendo sia le competenze tecniche che una prospettiva critica sui vantaggi dell’approccio bayesiano nella ricerca quantitativa moderna.</p>
</section><section id="informazioni-sullambiente-di-sviluppo" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="informazioni-sullambiente-di-sviluppo">Informazioni sull’Ambiente di Sviluppo</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.2 (2024-10-31)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] rstan_2.32.6         StanHeaders_2.32.10  insight_1.0.1       </span></span>
<span><span class="co">#&gt;  [4] bayestestR_0.15.0    brms_2.22.0          Rcpp_1.0.14         </span></span>
<span><span class="co">#&gt;  [7] posterior_1.6.0.9000 cmdstanr_0.8.1       MetBrewer_0.2.0     </span></span>
<span><span class="co">#&gt; [10] ggokabeito_0.1.0     see_0.9.0            gridExtra_2.3       </span></span>
<span><span class="co">#&gt; [13] patchwork_1.3.0      bayesplot_1.11.1     psych_2.4.12        </span></span>
<span><span class="co">#&gt; [16] scales_1.3.0         markdown_1.13        knitr_1.49          </span></span>
<span><span class="co">#&gt; [19] lubridate_1.9.4      forcats_1.0.0        stringr_1.5.1       </span></span>
<span><span class="co">#&gt; [22] dplyr_1.1.4          purrr_1.0.2          readr_2.1.5         </span></span>
<span><span class="co">#&gt; [25] tidyr_1.3.1          tibble_3.2.1         ggplot2_3.5.1       </span></span>
<span><span class="co">#&gt; [28] tidyverse_2.0.0      rio_1.2.3            here_1.0.1          </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] mnormt_2.1.1         inline_0.3.21        sandwich_3.1-1      </span></span>
<span><span class="co">#&gt;  [4] rlang_1.1.5          magrittr_2.0.3       multcomp_1.4-26     </span></span>
<span><span class="co">#&gt;  [7] matrixStats_1.5.0    compiler_4.4.2       loo_2.8.0           </span></span>
<span><span class="co">#&gt; [10] vctrs_0.6.5          reshape2_1.4.4       pkgconfig_2.0.3     </span></span>
<span><span class="co">#&gt; [13] fastmap_1.2.0        backports_1.5.0      labeling_0.4.3      </span></span>
<span><span class="co">#&gt; [16] utf8_1.2.4           rmarkdown_2.29       tzdb_0.4.0          </span></span>
<span><span class="co">#&gt; [19] haven_2.5.4          ps_1.8.1             xfun_0.50           </span></span>
<span><span class="co">#&gt; [22] jsonlite_1.8.9       parallel_4.4.2       R6_2.5.1            </span></span>
<span><span class="co">#&gt; [25] stringi_1.8.4        estimability_1.5.1   zoo_1.8-12          </span></span>
<span><span class="co">#&gt; [28] pacman_0.5.1         R.utils_2.12.3       Matrix_1.7-2        </span></span>
<span><span class="co">#&gt; [31] splines_4.4.2        timechange_0.3.0     tidyselect_1.2.1    </span></span>
<span><span class="co">#&gt; [34] abind_1.4-8          yaml_2.3.10          codetools_0.2-20    </span></span>
<span><span class="co">#&gt; [37] curl_6.2.0           processx_3.8.5       pkgbuild_1.4.6      </span></span>
<span><span class="co">#&gt; [40] lattice_0.22-6       plyr_1.8.9           withr_3.0.2         </span></span>
<span><span class="co">#&gt; [43] bridgesampling_1.1-2 coda_0.19-4.1        evaluate_1.0.3      </span></span>
<span><span class="co">#&gt; [46] survival_3.8-3       RcppParallel_5.1.10  pillar_1.10.1       </span></span>
<span><span class="co">#&gt; [49] tensorA_0.36.2.1     checkmate_2.3.2      stats4_4.4.2        </span></span>
<span><span class="co">#&gt; [52] distributional_0.5.0 generics_0.1.3       rprojroot_2.0.4     </span></span>
<span><span class="co">#&gt; [55] hms_1.1.3            rstantools_2.4.0     munsell_0.5.1       </span></span>
<span><span class="co">#&gt; [58] xtable_1.8-4         glue_1.8.0           emmeans_1.10.6      </span></span>
<span><span class="co">#&gt; [61] tools_4.4.2          data.table_1.16.4    mvtnorm_1.3-3       </span></span>
<span><span class="co">#&gt; [64] grid_4.4.2           QuickJSR_1.5.1       datawizard_1.0.0    </span></span>
<span><span class="co">#&gt; [67] colorspace_2.1-1     nlme_3.1-167         cli_3.6.3           </span></span>
<span><span class="co">#&gt; [70] Brobdingnag_1.2-9    V8_6.0.0             gtable_0.3.6        </span></span>
<span><span class="co">#&gt; [73] R.methodsS3_1.8.2    digest_0.6.37        TH.data_1.1-3       </span></span>
<span><span class="co">#&gt; [76] htmlwidgets_1.6.4    farver_2.1.2         htmltools_0.5.8.1   </span></span>
<span><span class="co">#&gt; [79] R.oo_1.27.0          lifecycle_1.0.4      MASS_7.3-64</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bibliografia" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-kruschke2013bayesian" class="csl-entry" role="listitem">
Kruschke, J. K. (2013). Bayesian estimation supersedes the t test. <em>Journal of Experimental Psychology: General</em>, <em>142</em>(2), 573–603.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiato!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiato!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/linear_models/06_prediction_stan.html" class="pagination-link" aria-label="Predizione e inferenza">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Predizione e inferenza</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/linear_models/09_sample_size.html" class="pagination-link" aria-label="Disegno della ricerca e potere statistico">
        <span class="nav-page-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Disegno della ricerca e potere statistico</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> è una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/linear_models/07_two_means.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>