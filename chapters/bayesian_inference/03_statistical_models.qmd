# Modelli statistici {#sec-bayes-stat-models}

::: callout-important
## In questo capitolo approfondirai i seguenti concetti fondamentali:

- *Differenza tra modelli fenomenologici e meccanicistici*: cosa significa descrivere i dati rispetto a spiegare i processi che li generano.  
- *Errore di specificazione*: i limiti dei modelli fenomenologici e perché possono indurre in errore.  
- *Modellizzazione probabilistica*: il ruolo delle distribuzioni di probabilità per rappresentare l’incertezza.  
- *Valutazione dei modelli*: come confrontare modelli alternativi e scegliere quelli che meglio descrivono i dati e generalizzano a nuovi contesti.  
:::  

::: callout-tip
## Prerequisiti

- Leggere il capitolo *Common Statistical Models* del testo di @kroese2025statistical.
:::

::: callout-caution
## Preparazione del Notebook

```{r}
here::here("code", "_common.R") |> 
  source()
```
:::


## Introduzione  {.unnumbered .unlisted}

::: {.lead}
Quando utilizziamo modelli statistici, il nostro obiettivo non è semplicemente *descrivere i dati*, ma soprattutto *comprendere i processi* che li hanno generati.  
:::

Questa distinzione porta a differenziare due famiglie di modelli:  

- i *modelli fenomenologici*, che si limitano a rappresentare le associazioni osservabili tra variabili. Sono descrittivi, ma spesso vulnerabili a errori di specificazione;  
- i *modelli meccanicistici*, che cercano invece di formalizzare il *processo generativo* sottostante ai dati. Sono più impegnativi da costruire, ma hanno un potenziale esplicativo molto maggiore.  

::: callout-warning
## Attenzione
I modelli fenomenologici (come la regressione) possono adattarsi bene ai dati osservati, ma rischiano di fallire completamente quando applicati a nuove situazioni. Per avanzare nella conoscenza scientifica è cruciale sviluppare e confrontare modelli che riflettano i processi reali.
:::

Il quadro concettuale per la modellizzazione e l’analisi statistica è illustrato nella figura seguente. Il punto di partenza è un problema reale e un corrispondente insieme di dati. Sulla base dei dati, costruiamo un modello probabilistico che riflette sia ciò che sappiamo sulla realtà, sia le ipotesi implicite del nostro ragionamento. All’interno del modello eseguiamo analisi e calcoli, che portano a conclusioni sul modello stesso. Infine, traduciamo queste conclusioni in affermazioni sulla realtà.  

::: {#fig-modeling-analysis}
![](../../figures/modeling_analysis.png){width="90%"}

Modellizzazione e analisi statistica [figura tratta da @kroese2025statistical].
:::

La statistica matematica utilizza la teoria della probabilità e altri rami della matematica per studiare i dati. In questo approccio, i dati sono considerati come realizzazioni di variabili casuali la cui distribuzione congiunta è specificata (almeno in parte) dal modello. Alcuni parametri della distribuzione restano sconosciuti e vanno stimati. L’analisi si concentra quindi sul modello e sui suoi parametri, con l’obiettivo di avvicinarsi al processo reale che ha generato i dati.


## Campionamento indipendente da una distribuzione fissa

Uno dei modelli più semplici è quello in cui i dati $X_1, \ldots, X_n$ sono considerati *indipendenti e identicamente distribuiti* (iid).  

$$
X_1, \ldots, X_n \stackrel{\text{iid}}{\sim} f \quad \text{oppure} \quad X_1, \ldots, X_n \stackrel{\text{iid}}{\sim} \text{Dist} .
$$

dove $f$ rappresenta la funzione di densità di probabilità (pdf) e "Dist" indica una generica distribuzione.  

Poiché le variabili sono indipendenti e identicamente distribuite, la distribuzione congiunta si scrive come prodotto delle pdf individuali:  

$$
f(x_1, \ldots, x_n) = f(x_1) \cdot f(x_2) \cdot \ldots \cdot f(x_n).
$$

Questa ipotesi (iid) è alla base di moltissimi modelli statistici di uso comune.  

::: callout-note
## Esempio
Pensiamo a un test psicologico somministrato a 100 persone. Se assumiamo che ciascuna risposta sia indipendente dalle altre e provenga dalla stessa distribuzione, stiamo implicitamente adottando un modello iid.  
:::

## Modelli fenomenologici: descrivere le associazioni

Un modello fenomenologico cerca di sintetizzare i dati osservati attraverso relazioni statistiche. Un esempio tipico è la *regressione lineare*:  

$$
y_i = \alpha + \beta x_i + \varepsilon_i .
$$

Questa formula descrive come varia la media di $y$ in funzione di $x$. È utile per riassumere e predire, ma non dice nulla sul *meccanismo psicologico* che produce la relazione.  


### Il problema dell’errore di specificazione

I modelli fenomenologici sono esposti a gravi rischi:  

- possono adattarsi bene ai dati osservati ma essere falsi nel rappresentare la realtà;  
- trascurano variabili latenti o meccanismi che non vengono osservati direttamente;  
- possono generare correlazioni spurie e interpretazioni fuorvianti.  

Esempio: una regressione che mostra un legame tra “tempo sui social” e “ansia” non ci dice nulla sul ruolo di mediazione di variabili cognitive o sociali.  


## Modelli meccanicistici: spiegare i processi

I modelli meccanicistici non si limitano a descrivere relazioni, ma cercano di rappresentare il *processo generativo*.  


### Esempi in psicologia

- *Rescorla-Wagner*: formalizza come le aspettative di un soggetto vengono aggiornate in base agli errori di previsione durante l’apprendimento associativo.  
- *Drift Diffusion Model (DDM)*: descrive scelte binarie e tempi di reazione come risultato di un processo di accumulo di evidenza.  

Questi modelli sono più vicini a una teoria psicologica esplicita, e possono essere testati confrontando le loro previsioni con i dati osservati.  

::: callout-note
## Differenza intuitiva

Un modello fenomenologico può dire: “più ore di studio → voti più alti”.  
Un modello meccanicistico può dire: “ogni sessione di studio incrementa la memoria con un tasso di apprendimento definito, che a sua volta determina la probabilità di rispondere correttamente”.  
:::


## Valutazione e confronto dei modelli

In un approccio bayesiano, il confronto tra modelli è parte integrante della pratica scientifica. Non si tratta solo di “adattare” un modello ai dati, ma di chiedersi:  

- Quanto bene il modello descrive i dati osservati?  
- Quanto bene si generalizza a nuovi dati?  
- Quanto è coerente con la teoria psicologica di riferimento?  

Queste domande permettono di superare la visione ingenua secondo cui “un modello buono è quello che si adatta bene ai dati”.  


## Riflessioni conclusive  {.unnumbered .unlisted}

La distinzione tra modelli fenomenologici e meccanicistici è centrale per la ricerca psicologica:  

- i *modelli fenomenologici* sono utili come strumenti descrittivi e predittivi a breve termine, ma rischiano di produrre conclusioni fuorvianti se presi come spiegazioni;  
- i *modelli meccanicistici* permettono di andare oltre la descrizione, offrendo ipotesi concrete sui processi psicologici che generano i dati;
- la modellazione bayesiana fornisce strumenti potenti per confrontare modelli alternativi, scegliere quelli più predittivi e verificare la loro generalizzabilità.  

In sintesi, il compito della scienza psicologica non è trovare correlazioni, ma sviluppare e testare *modelli dei processi*. È lì che si decide se la conoscenza prodotta è robusta e utile. 


## Esercizi {.unnumbered .unlisted}

::: {.callout-important title="Problemi" collapse="true"}
1. Qual è il processo concettuale alla base della modellizzazione e dell'analisi statistica?  

2. Cosa significa che un campione è indipendente e identicamente distribuito (iid) e perché questa assunzione è importante nei modelli statistici?

3. Come si differenziano i modelli di campionamento da una singola distribuzione rispetto ai modelli di campioni multipli indipendenti?  

4. Qual è la differenza tra regressione lineare semplice e regressione lineare multipla? 

5. In che modo i modelli computazionali, come il modello di apprendimento associativo e il modello drift-diffusion, si differenziano dai modelli statistici tradizionali?

*Consegna:* Rispondi con parole tue e carica il file .qmd, convertito in PDF su Moodle.
:::

::: {.callout-tip title="Soluzioni" collapse="true"}

1. Il processo concettuale della modellizzazione e analisi statistica inizia con un problema reale e i dati raccolti su tale problema. Si costruisce quindi un modello probabilistico che rappresenta le conoscenze disponibili e il modo in cui i dati sono stati ottenuti. L’analisi viene condotta all’interno del modello, producendo conclusioni sui suoi parametri. Infine, i risultati vengono tradotti in inferenze sulla realtà, con lo scopo di migliorare la comprensione del fenomeno studiato.

2. Un campione è detto indipendente e identicamente distribuito (iid) se le osservazioni sono indipendenti tra loro e seguono la stessa distribuzione di probabilità. Questa assunzione è fondamentale perché semplifica le analisi statistiche e permette di applicare risultati teorici importanti, come la legge dei grandi numeri e il teorema del limite centrale.  

3. Nei modelli di campionamento da una singola distribuzione, si assume che tutte le osservazioni provengano da una stessa popolazione e seguano la stessa distribuzione. Nei modelli di campioni multipli indipendenti, invece, si confrontano più gruppi distinti, ciascuno con la propria distribuzione, per studiare differenze tra le popolazioni. Un esempio è il confronto tra altezze di individui con madri fumatrici e non fumatrici. 

4. La regressione lineare semplice analizza la relazione tra una variabile dipendente e una sola variabile indipendente attraverso una relazione lineare. La regressione lineare multipla, invece, estende questo concetto a più variabili indipendenti, permettendo di modellare fenomeni più complessi e controllare l’effetto di più fattori simultaneamente.  

5. I modelli computazionali, come il modello di apprendimento associativo e il modello drift-diffusion, differiscono dai modelli statistici tradizionali perché mirano a simulare i processi mentali e decisionali sottostanti il comportamento umano. I modelli statistici descrivono principalmente relazioni tra variabili nei dati osservati, mentre i modelli computazionali cercano di rappresentare dinamicamente i meccanismi cognitivi e comportamentali che generano tali dati.
:::

## Informazioni sull'ambiente di sviluppo  {.unnumbered .unlisted}

```{r}
sessionInfo()
```

## Bibliografia  {.unnumbered .unlisted}

