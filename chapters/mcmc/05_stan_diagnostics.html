<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>52&nbsp; Diagnostica delle catene markoviane – Psicometria</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/mcmc/06_mcmc_prediction.html" rel="next">
<link href="../../chapters/mcmc/03_stan_intro.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0a72236910a44089af39cd28873f322e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-ba810abc37aac82aefffdb53edf03a99.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><style>html{ scroll-behavior: smooth; }</style>
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
</script><script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
// Suggerimento CSS: vedi sezione 3 per gli spazi attorno a display math
</script><script>
window.MathJax = {
  tex: {
    packages: {'[+]': ['boldsymbol']},
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: { fontCache: 'global' }
};
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../style/_typography-extras.css">
<link rel="stylesheet" href="../../style/_code-extras.css">
<link rel="stylesheet" href="../../style/_math-extras.css">
<link rel="stylesheet" href="../../style/styles.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/mcmc/introduction_mcmc.html">MCMC</a></li><li class="breadcrumb-item"><a href="../../chapters/mcmc/05_stan_diagnostics.html"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informazioni generali</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/key_notions/introduction_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fondamenti</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/01_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">La crisi di replicazione e la riforma metodologica in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/02_key_notions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Concetti chiave</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/03_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Campionamento, metodologia sperimentale e studi osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/04_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La misurazione in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/key_notions/05_cognitive_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dalla descrizione alla spiegazione</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/R/introduction_r_lang.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/01_r_syntax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Un approccio moderno all’analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/02_utility_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Utility functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/03_r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Programmazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/04_r_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Pacchetti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/05_dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Usare <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/06_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/07_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">L’ambiente di programmazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/R/08_ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Utilizzo di strumenti AI</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/eda/introduction_eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/01_project_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Il ciclo di vita di un progetto di analisi dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/02_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Flusso di lavoro per la pulizia dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/03_exploring_qualitative_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Esplorare i dati qualitativi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/04_exploring_numeric_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Esplorare i dati numerici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/05_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Principi della visualizzazione dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/06_loc_scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Indicatori di tendenza centrale e variabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/07_introduction_normal_distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Introduzione alla distribuzione normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/08_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Relazioni tra variabili</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/09_causality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Causalità dai dati osservazionali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/eda/10_outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Outlier</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../chapters/probability/introduction_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilità</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/01_intro_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Interpretazione della probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/02_probability_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Modelli probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/03_sigma-algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Dal Discreto al Continuo: la <span class="math inline">\(\sigma\)</span>-algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/04_conditional_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Probabilità condizionata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/05_bayes_theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Il teorema di Bayes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/06_random_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/07_prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Distribuzioni di massa e di densità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/08_expval_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Proprietà delle variabili casuali</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/09_sampling_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/10_joint_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Probabilità congiunta</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/11_cov_cor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Covarianza e correlazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/12_intro_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Introduzione alle distribuzioni di probabilità</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/13_discr_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. discrete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/14_cont_rv_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Distribuzioni di v.c. continue</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/15_gauss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Assunzione di gaussianità e trasformazioni dei dati</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/probability/16_likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">La verosimiglianza</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_intro_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Aggiornare le credenze su un parametro: dal prior alla posterior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_prior_pred_check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Controllo predittivo a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/03_stan_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Introduzione pratica a Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/05_stan_diagnostics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/06_mcmc_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Controlli predittivi bayesiani (a priori e a posteriori) con <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/08_stan_odds_ratio_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Analisi bayesiana dell’odds ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/11_stan_poisson_model_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar_sea_ice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_stan_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Regressione lineare in Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_specification_error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Errore di specificazione e bias da variabile omessa</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto: valutare la rilevanza pratica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Pianificazione della dimensione campionaria</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">GLM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/introduction_glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/01_logistic_regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Regressione logistica con Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/02_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/03_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni con la regressione logistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/04_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/05_logistic_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Dal GLM a un modello processuale per dati binari</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Entropia</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/01_entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Entropia e informazione di Shannon</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/02_kl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/03_model_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Valutare i modelli bayesiani</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Modelli</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Teorie formali dei fenomeni psicologici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/01_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Il modello di revisione degli obiettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/02_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Estensioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/03_rescorla_wagner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Decisioni</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/decision_analysis/01_study_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Decisione ottimale e utilità attesa: l’approccio bayesiano</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Missing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/missing/01_mnar_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Dati mancanti in psicologia</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">Frequentismo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/introduction_frequentist_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01_galton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/02_stime_parametri.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/03_conf_interv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/04_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">85</span>&nbsp; <span class="chapter-title">La grandezza del campione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/05_test_ipotesi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">86</span>&nbsp; <span class="chapter-title">Significatività statistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/06_two_ind_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">87</span>&nbsp; <span class="chapter-title">Test t di Student per campioni indipendenti</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">88</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">89</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">90</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">91</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">92</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">93</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_piranha.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">94</span>&nbsp; <span class="chapter-title">Il Problema del priming: sfide e paradossi nella psicologia sociale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">95</span>&nbsp; <span class="chapter-title">I gradi di libertà del ricercatore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/09_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">96</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01a_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Cartelle e documenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a35_other_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Altre famiglie coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a36_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a41_cmdstanr_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Implementazione di modelli Bayesiani con Stan tramite <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a47_first_order_markov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Catene di Markov</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">O</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul class="collapse">
<li><a href="#grafici-di-tracciamento" id="toc-grafici-di-tracciamento" class="nav-link active" data-scroll-target="#grafici-di-tracciamento"><span class="header-section-number">52.1</span> Grafici di tracciamento</a></li>
  <li><a href="#i-grafici-della-densit%C3%A0-posteriore-sono-adeguati" id="toc-i-grafici-della-densità-posteriore-sono-adeguati" class="nav-link" data-scroll-target="#i-grafici-della-densit%C3%A0-posteriore-sono-adeguati"><span class="header-section-number">52.2</span> I grafici della densità posteriore sono adeguati?</a></li>
  <li><a href="#lautocorrelazione-nelle-catene-mcmc-come-interpretarla-e-gestirla" id="toc-lautocorrelazione-nelle-catene-mcmc-come-interpretarla-e-gestirla" class="nav-link" data-scroll-target="#lautocorrelazione-nelle-catene-mcmc-come-interpretarla-e-gestirla"><span class="header-section-number">52.3</span> L’autocorrelazione nelle catene MCMC: come interpretarla e gestirla</a></li>
  <li><a href="#la-dimensione-effettiva-del-campione-un-indicatore-cruciale-per-laffidabilit%C3%A0-delle-stime" id="toc-la-dimensione-effettiva-del-campione-un-indicatore-cruciale-per-laffidabilità-delle-stime" class="nav-link" data-scroll-target="#la-dimensione-effettiva-del-campione-un-indicatore-cruciale-per-laffidabilit%C3%A0-delle-stime"><span class="header-section-number">52.4</span> La dimensione effettiva del campione: un indicatore cruciale per l’affidabilità delle stime</a></li>
  <li><a href="#la-statistica-hatr-il-termometro-della-convergenza-delle-catene" id="toc-la-statistica-hatr-il-termometro-della-convergenza-delle-catene" class="nav-link" data-scroll-target="#la-statistica-hatr-il-termometro-della-convergenza-delle-catene"><span class="header-section-number">52.5</span> La statistica <span class="math inline">\(\hat{R}\)</span>: il termometro della convergenza delle catene</a></li>
  <li><a href="#la-diagnostica-di-geweke" id="toc-la-diagnostica-di-geweke" class="nav-link" data-scroll-target="#la-diagnostica-di-geweke"><span class="header-section-number">52.6</span> La diagnostica di Geweke</a></li>
  <li><a href="#transizioni-divergenti-segnali-dallarme-nellalgoritmo-hmc" id="toc-transizioni-divergenti-segnali-dallarme-nellalgoritmo-hmc" class="nav-link" data-scroll-target="#transizioni-divergenti-segnali-dallarme-nellalgoritmo-hmc"><span class="header-section-number">52.7</span> Transizioni divergenti: segnali d’allarme nell’algoritmo HMC</a></li>
  <li><a href="#la-bayesian-fraction-of-missing-information-bfmi-un-indicatore-di-efficienza-esplorativa" id="toc-la-bayesian-fraction-of-missing-information-bfmi-un-indicatore-di-efficienza-esplorativa" class="nav-link" data-scroll-target="#la-bayesian-fraction-of-missing-information-bfmi-un-indicatore-di-efficienza-esplorativa"><span class="header-section-number">52.8</span> La Bayesian Fraction of Missing Information (BFMI): un indicatore di efficienza esplorativa</a></li>
  <li><a href="#la-leave-one-out-cross-validation-uno-sguardo-allaffidabilit%C3%A0-predittiva-del-modello" id="toc-la-leave-one-out-cross-validation-uno-sguardo-allaffidabilità-predittiva-del-modello" class="nav-link" data-scroll-target="#la-leave-one-out-cross-validation-uno-sguardo-allaffidabilit%C3%A0-predittiva-del-modello"><span class="header-section-number">52.9</span> La Leave-One-Out Cross-Validation: uno sguardo all’affidabilità predittiva del modello</a></li>
  <li><a href="#il-parametro-%CE%BA-un-indicatore-cruciale-per-laffidabilit%C3%A0-delle-stime" id="toc-il-parametro-κ-un-indicatore-cruciale-per-laffidabilità-delle-stime" class="nav-link" data-scroll-target="#il-parametro-%CE%BA-un-indicatore-cruciale-per-laffidabilit%C3%A0-delle-stime"><span class="header-section-number">52.10</span> Il parametro κ: un indicatore cruciale per l’affidabilità delle stime</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/mcmc/05_stan_diagnostics.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/mcmc/introduction_mcmc.html">MCMC</a></li><li class="breadcrumb-item"><a href="../../chapters/mcmc/05_stan_diagnostics.html"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-mcmc-diagnostics" class="quarto-section-identifier"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introduzione" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="introduzione">Introduzione</h2>
<p>Una volta eseguita la stima di un modello in Stan, il primo passo non è interpretare subito i parametri, ma verificare se la procedura di campionamento ha funzionato correttamente. Le catene MCMC, infatti, possono produrre risultati fuorvianti se non hanno esplorato in modo adeguato lo spazio dei parametri.</p>
<p>Per questo motivo, Stan fornisce diversi indicatori diagnostici che permettono di valutare la qualità del campionamento. Questi strumenti servono a rispondere a domande fondamentali:</p>
<ul>
<li>Le catene hanno raggiunto la convergenza verso una stessa distribuzione?</li>
<li>La variabilità campionata rappresenta in modo fedele la distribuzione posteriore?</li>
<li>Ci sono segnali che i campioni non siano sufficienti o che alcune regioni della distribuzione non siano state esplorate?</li>
</ul>
<p>Prima di utilizzare i risultati di un modello, è quindi necessario controllare con attenzione queste diagnosi. Solo dopo aver verificato che il campionamento sia affidabile possiamo procedere con l’analisi e l’interpretazione dei parametri.</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="Preparazione del Notebook">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Carichiamo i pacchetti necessari</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">cmdstanr</span>, <span class="va">posterior</span>, <span class="va">insight</span>, <span class="va">bayesplot</span>, <span class="va">ggplot2</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="grafici-di-tracciamento" class="level2" data-number="52.1"><h2 data-number="52.1" class="anchored" data-anchor-id="grafici-di-tracciamento">
<span class="header-section-number">52.1</span> Grafici di tracciamento</h2>
<p>Un modo semplice e visivo per capire se un algoritmo MCMC (un metodo per stimare modelli bayesiani) sta funzionando bene è osservare i <em>grafici di tracciamento</em>, o <em>trace plots</em>. Immaginate che ogni parametro del modello (ad esempio, l’effetto di un farmaco o la correlazione tra due variabili) abbia una sua “storia”, raccontata attraverso migliaia di passaggi (iterazioni) dell’algoritmo. Il trace plot non è altro che il grafico di questa storia: sull’asse orizzontale ci sono le iterazioni, su quello verticale i valori che il parametro assume di volta in volta.</p>
<p>Quando tutto funziona correttamente, il grafico assomiglia a una “ciaspata” rumorosa e compatta attorno a un valore medio stabile – un po’ come guardare la neve sullo schermo di una TV non sintonizzata, ma confinata in una fascia orizzontale. Questo significa che la catena si sta <em>mescolando bene</em>: l’algoritmo sta esplorando in modo efficace la distribuzione dei valori plausibili per quel parametro.</p>
<p>Al contrario, un trace plot che mostra andamenti strani ci avvisa che qualcosa non va. Per esempio:</p>
<ul>
<li>se due catene diverse (partite da punti diversi) per lo stesso parametro non si incontrano mai e restano separate, significa che non stanno convergendo verso la stessa conclusione;</li>
<li>se si osservano salti ampi o andamenti a gradini, l’algoritmo potrebbe non stare campionando in modo efficiente.</li>
</ul>
<p>L’obiettivo è quindi riconoscere un andamento “sano”: un rumore casuale e stabile, senza pattern sistematici o derive nel tempo. Questo ci dà fiducia che le stime ottenute siano affidabili.</p>
<p>Come suggerito da <span class="citation" data-cites="martin2022bayesian">Martin et al. (<a href="#ref-martin2022bayesian" role="doc-biblioref">2022</a>)</span>, è utile confrontare trace plot di catene che convergono bene con altri che mostrano problemi. Questi ultimi segnalano che è necessario rivedere il modello o le impostazioni dell’algoritmo, prima di trarre conclusioni.</p>
<p>Osservando i grafici qui sotto, noterete:</p>
<ul>
<li>a sinistra, l’andamento della catena (trace plot),</li>
<li>a destra, la densità stimata dei valori campionati.</li>
</ul>
<p>Un trace plot ideale mostra un andamento oscillante ma stabile, e la densità si avvicina alla classica forma a campana.</p>
<div class="cell" data-layout-align="center">
<pre><code>#&gt; $good_chains
#&gt; [1]    2 2000
#&gt; 
#&gt; $bad_chains0
#&gt; [1]    2 2000
#&gt; 
#&gt; $bad_chains1
#&gt; [1]    2 2000</code></pre>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="05_stan_diagnostics_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="05_stan_diagnostics_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="05_stan_diagnostics_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<section id="cosa-fare-se-le-catene-non-convergono" class="level3" data-number="52.1.1"><h3 data-number="52.1.1" class="anchored" data-anchor-id="cosa-fare-se-le-catene-non-convergono">
<span class="header-section-number">52.1.1</span> Cosa fare se le catene non convergono?</h3>
<p>Nella pratica, non sappiamo come sia fatta la “vera” distribuzione a posteriori. Per questo i trace plot sono così utili: ci avvisano quando qualcosa non funziona. Se ottenete grafici simili agli esempi “cattivi”, potete provare a:</p>
<ol type="1">
<li>
<strong>Rivedere il modello</strong>. Le assunzioni fatte (siano esse le prior o la struttura del modello) sono appropriate per i vostri dati?</li>
<li>
<strong>Aumentare il numero di iterazioni</strong>. A volte, far girare l’algoritmo più a lungo aiuta a smussare comportamenti anomali a breve termine.</li>
</ol>
<p>Quello dei trace plot è uno strumento diagnostico semplice ma potente, fondamentale per chiunque voglia utilizzare modelli bayesiani in modo consapevole.</p>
</section></section><section id="i-grafici-della-densità-posteriore-sono-adeguati" class="level2" data-number="52.2"><h2 data-number="52.2" class="anchored" data-anchor-id="i-grafici-della-densità-posteriore-sono-adeguati">
<span class="header-section-number">52.2</span> I grafici della densità posteriore sono adeguati?</h2>
<p>I grafici della densità posteriore sono tra gli strumenti più immediati e informativi per valutare la qualità dei risultati di un’analisi bayesiana. Questi grafici mostrano la forma della distribuzione dei valori campionati per un parametro, offrendo una rappresentazione visiva diretta della nostra incertezza dopo aver osservato i dati.</p>
<p>In condizioni ideali, la densità posteriore di un parametro dovrebbe presentare una forma regolare e coerente con le aspettative teoriche. Ad esempio, se abbiamo utilizzato una distribuzione a priori normale, ci aspettiamo spesso (ma non sempre) una forma approssimativamente simmetrica e unimodale. Una curva liscia e ben definita suggerisce che le catene di Markov hanno esplorato in modo efficace lo spazio del parametro e che i campioni ottenuti sono rappresentativi della distribuzione sottostante.</p>
<p>Tuttavia, quando la densità appare irregolare – mostrando asimmetrie estreme, picchi multipli (bimodalità), o code eccessivamente lunghe – è un segnale che qualcosa potrebbe non aver funzionato come previsto. Una forma bimodale, in particolare, può indicare che l’algoritmo si è “bloccato” in regioni distinte dello spazio dei parametri, senza riuscire a integrarle in un’unica distribuzione coerente. In altri casi, una forma troppo piatta o irregolare può denotare una mancata convergenza o un’esplorazione incompleta.</p>
<p>Cosa fare se la densità posteriore non sembra adeguata?</p>
<ul>
<li>
<strong>Aumentare il numero di iterazioni</strong>: Un campionamento più prolungato può aiutare a stabilizzare la stima e a fondare eventuali modalità separate.</li>
<li>
<strong>Rivedere le distribuzioni a priori</strong>: Una prior troppo vaga o inappropriata può portare a posteriori instabili o difficili da campionare.</li>
<li>
<strong>Ottimizzare l’algoritmo MCMC</strong>: A volte è necessario modificare i parametri di campionamento, come il passo di proposta o il numero di catene, per migliorare l’efficienza esplorativa.</li>
</ul>
<p>In sintesi, l’ispezione visiva della densità posteriore non è solo un passaggio tecnico, ma un momento critico di riflessione metodologica. Ci permette di valutare se le nostre stime sono robuste e credibili, e se il modello è riuscito a cogliere la struttura dei dati in modo equilibrato e affidabile.</p>
</section><section id="lautocorrelazione-nelle-catene-mcmc-come-interpretarla-e-gestirla" class="level2" data-number="52.3"><h2 data-number="52.3" class="anchored" data-anchor-id="lautocorrelazione-nelle-catene-mcmc-come-interpretarla-e-gestirla">
<span class="header-section-number">52.3</span> L’autocorrelazione nelle catene MCMC: come interpretarla e gestirla</h2>
<p>Quando utilizziamo il metodo Monte Carlo basato su catene di Markov (MCMC) per stimare modelli bayesiani, dobbiamo tenere presente un aspetto cruciale: i campioni successivi prodotti dall’algoritmo non sono completamente indipendenti tra loro. Questo fenomeno, noto come autocorrelazione, è naturale nelle catene di Markov, ma quando diventa troppo pronunciato può indicare problemi nell’efficienza del campionamento.</p>
<p>L’autocorrelazione misura quanto un campione nella catena sia simile ai campioni precedenti. Idealmente, vorremmo che questa somiglianza diminuisca rapidamente all’aumentare della distanza tra i campioni. Per visualizzare questo comportamento, utilizziamo i correlogrammi – grafici che mostrano l’autocorrelazione a diverse “distanze” (lag) tra i campioni.</p>
<p>Un correlogramma ideale mostra:</p>
<ul>
<li>un’autocorrelazione iniziale (lag 1) non troppo elevata,</li>
<li>un rapido decadimento verso lo zero all’aumentare del lag</li>
</ul>
<p>Quando osserviamo questo pattern, possiamo essere confidenti che la catena si sta “mescolando” bene e sta esplorando efficientemente lo spazio dei parametri. Al contrario, un’autocorrelazione che persiste per molti lag suggerisce che la catena si muove lentamente attraverso lo spazio dei parametri, producendo campioni altamente correlati. Questo riduce l’efficienza del campionamento, poiché otteniamo meno informazioni indipendenti da ogni iterazione.</p>
<p>Cosa fare quando l’autocorrelazione è troppo alta?</p>
<ol type="1">
<li><p><strong>Aumentare il numero di iterazioni</strong>: Una catena più lunga può compensare l’alta autocorrelazione, purché sia sufficientemente prolungata da esplorare adeguatamente tutto lo spazio dei parametri.</p></li>
<li><p><strong>Applicare il thinning (diradamento)</strong>: Possiamo conservare solo un campione ogni k iterazioni (ad esempio, ogni 5 o 10), riducendo così la correlazione tra i campioni conservati. Tuttavia, questo approccio va usato con giudizio, poiché spreca informazioni.</p></li>
<li><p><strong>Rivedere le impostazioni dell’algoritmo</strong>: A volte, modificare il passo di proposta o altri parametri del campionatore può migliorare l’efficienza esplorativa.</p></li>
</ol>
<p>L’analisi dell’autocorrelazione non è solo un tecnicismo, ma uno strumento fondamentale per valutare la qualità delle nostre stime bayesiane. Ci aiuta a garantire che i risultati su cui basiamo le nostre conclusioni siano robusti e affidabili.</p>
</section><section id="la-dimensione-effettiva-del-campione-un-indicatore-cruciale-per-laffidabilità-delle-stime" class="level2" data-number="52.4"><h2 data-number="52.4" class="anchored" data-anchor-id="la-dimensione-effettiva-del-campione-un-indicatore-cruciale-per-laffidabilità-delle-stime">
<span class="header-section-number">52.4</span> La dimensione effettiva del campione: un indicatore cruciale per l’affidabilità delle stime</h2>
<p>Quando lavoriamo con metodi MCMC, un concetto fondamentale da comprendere è quello di <em>dimensione effettiva del campione</em> (indicata come <span class="math inline">\(N_{\text{eff}}\)</span>). A differenza del numero totale di campioni generati, <span class="math inline">\(N_{\text{eff}}\)</span> rappresenta il numero equivalente di campioni statisticamente indipendenti che avrebbero la stessa precisione delle nostre stime.</p>
<p>Poiché i campioni MCMC sono tipicamente correlati tra loro, la dimensione effettiva è sempre inferiore al numero totale di iterazioni. La formula per calcolarla tiene conto di queste correlazioni:</p>
<p><span class="math display">\[
N_{\text{eff}} = \frac{T}{1 + 2 \sum_{s=1}^{S} \rho_{s}}
\]</span> dove <span class="math inline">\(T\)</span> è il numero totale di campioni e <span class="math inline">\(\rho_{s}\)</span> rappresenta l’autocorrelazione a diverse distanze (lag).</p>
<p><strong>Interpretazione pratica</strong>:</p>
<ul>
<li>Un valore di <span class="math inline">\(N_{\text{eff}}\)</span> prossimo a <span class="math inline">\(T\)</span> indica che i campioni sono quasi indipendenti</li>
<li>Un valore di <span class="math inline">\(N_{\text{eff}}\)</span> molto inferiore a <span class="math inline">\(T\)</span> segnala una forte autocorrelazione tra i campioni</li>
</ul>
<p><strong>Cosa fare se <span class="math inline">\(N_{\text{eff}}\)</span> è troppo basso?</strong></p>
<ol type="1">
<li>
<strong>Aumentare il numero di iterazioni</strong>: La soluzione più diretta per ottenere più campioni indipendenti</li>
<li>
<strong>Utilizzare il thinning (diradamento)</strong>: Conservare solo un campione ogni <span class="math inline">\(k\)</span> iterazioni può ridurre l’autocorrelazione, anche se a costo di scartare informazioni</li>
<li>
<strong>Ottimizzare l’algoritmo</strong>: A volte, modificare i parametri del campionatore o il modello stesso può migliorare l’efficienza</li>
</ol>
<p>La dimensione effettiva del campione non è solo un tecnicismo statistico, ma un indicatore fondamentale della qualità delle nostre stime. Valori sufficientemente alti di <span class="math inline">\(N_{\text{eff}}\)</span> ci danno maggiore fiducia nell’affidabilità delle conclusioni tratte dai nostri modelli bayesiani.</p>
</section><section id="la-statistica-hatr-il-termometro-della-convergenza-delle-catene" class="level2" data-number="52.5"><h2 data-number="52.5" class="anchored" data-anchor-id="la-statistica-hatr-il-termometro-della-convergenza-delle-catene">
<span class="header-section-number">52.5</span> La statistica <span class="math inline">\(\hat{R}\)</span>: il termometro della convergenza delle catene</h2>
<p>La statistica <span class="math inline">\(\hat{R}\)</span>, formalmente nota come potenziale scale reduction factor, costituisce uno degli indicatori più solidi e ampiamente adottati per la valutazione della convergenza nelle analisi MCMC. Il suo principale scopo è determinare se multiple catene, inizializzate da differenti valori di partenza, hanno effettivamente raggiunto la stessa distribuzione target, garantendo così la robustezza delle inferenze statistiche prodotte.</p>
<p>Il principio di calcolo di <span class="math inline">\(\hat{R}\)</span> si fonda su un confronto tra la variabilità osservata all’interno di ciascuna catena e la variabilità presente tra le diverse catene. La formula, che sintetizza questo confronto, è la seguente:</p>
<p><span class="math display">\[
\hat{R} = \sqrt{\frac{W + \frac{1}{n}(B - W)}{W}}
\]</span> dove <span class="math inline">\(W\)</span> rappresenta la varianza media all’interno delle catene (within-chain variance) e <span class="math inline">\(B\)</span> rappresenta la varianza tra le catene (between-chain variance).</p>
<p>L’interpretazione dei valori di <span class="math inline">\(\hat{R}\)</span> segue linee guida ben consolidate. Un valore pari esattamente a 1 indica una convergenza perfetta, situazione ideale in cui le catene sono completamente sovrapposte e stabili. Valori fino a 1.01 sono considerati eccellenti, mentre valori fino a 1.05 sono generalmente accettabili nella maggior parte delle applicazioni pratiche. Oltre la soglia di 1.1, il risultato deve essere considerato con cautela, in quanto suggerisce che le catene potrebbero non aver raggiunto la convergenza e che le stime potrebbero essere inaffidabili.</p>
<p>L’importanza di <span class="math inline">\(\hat{R}\)</span> risiede nella sua capacità di segnalare discrepanze sistematiche tra le catene. Valori elevati indicano che le diverse esecuzioni stanno campionando da distribuzioni differenti, il che può derivare da una mancata stabilizzazione delle catene, da problemi di identificabilità del modello, o dalla necessità di un numero maggiore di iterazioni.</p>
<p>Nella pratica contemporanea, i software Bayesiani più diffusi calcolano automaticamente <span class="math inline">\(\hat{R}\)</span> per tutti i parametri del modello, facilitando un monitoraggio efficiente della qualità del campionamento. Come evidenziato in letteratura, ad esempio nei lavori di Martin (2022), catene ben comportate presentano valori di <span class="math inline">\(\hat{R}\)</span> estremamente vicini all’unità, mentre situazioni problematiche emergono chiaramente attraverso valori anomali.</p>
<p>Pertanto, <span class="math inline">\(\hat{R}\)</span> si conferma come una metrica indispensabile nell’arsenale del analista bayesiano, fornendo una valutazione oggettiva e quantitativa dell’affidabilità delle simulazioni MCMC e della credibilità delle conclusioni ad esse associate.</p>
</section><section id="la-diagnostica-di-geweke" class="level2" data-number="52.6"><h2 data-number="52.6" class="anchored" data-anchor-id="la-diagnostica-di-geweke">
<span class="header-section-number">52.6</span> La diagnostica di Geweke</h2>
<p>La diagnostica di Geweke fornisce un approccio elegante e intuitivo per verificare il raggiungimento della stazionarietà in una catena di Markov. Il principio fondamentale su cui si basa è il confronto tra le proprietà statistiche della porzione iniziale e di quella finale della catena. Nella pratica, si confronta la media calcolata sui primi campioni (generalmente il primo 10% della catena) con quella ottenuta dagli ultimi campioni (tipicamente l’ultimo 50%).</p>
<p>L’interpretazione dei risultati segue una logica relativamente semplice: valori prossimi allo zero indicano che non sussistono differenze significative tra le due porzioni della catena, suggerendo così il raggiungimento di una condizione di stazionarietà. Al contrario, valori assoluti superiori a 2 segnalano una discrepanza statisticamente rilevante tra le due fasi del campionamento, mettendo in dubbio il presupposto della stazionarietà.</p>
<p>Questo test può essere efficacemente concepito come un “termometro” della stabilità temporale della catena, offrendo una prima indicazione sulla qualità del campionamento ottenuto.</p>
<p>Qualora la diagnostica di Geweke riveli valori considerati problematici, diventa opportuno considerare alcune strategie correttive. Un aumento del numero di iterazioni può consentire alla catena di raggiungere la stazionarietà. Una verifica delle impostazioni dell’algoritmo di campionamento potrebbe identificare parametri non ottimali. Infine, è sempre consigliabile valutare la possibile presenza di problemi intrinseci nella specificazione del modello stesso, che potrebbero ostacolare il corretto funzionamento del processo di campionamento.</p>
<section id="lerrore-standard-di-monte-carlo-quantificare-lincertezza-dellapprossimazione" class="level3" data-number="52.6.1"><h3 data-number="52.6.1" class="anchored" data-anchor-id="lerrore-standard-di-monte-carlo-quantificare-lincertezza-dellapprossimazione">
<span class="header-section-number">52.6.1</span> L’errore standard di Monte Carlo: quantificare l’incertezza dell’approssimazione</h3>
<p>Nel contesto dei metodi Monte Carlo basati su catene di Markov (MCMC), è fondamentale riconoscere che i risultati prodotti costituiscono un’approssimazione della vera distribuzione a posteriori. Come in ogni processo approssimativo, è essenziale quantificare il margine di errore intrinseco a questa stima. A questo proposito, l’Errore Standard di Monte Carlo (MCSE) emerge come uno strumento metrico fondamentale per valutare la precisione della nostra approssimazione.</p>
<p>Il calcolo del MCSE si basa su una relazione matematica elegante e intuitiva:</p>
<p><span class="math display">\[
\text{MCSE} = \frac{\text{SD}}{\sqrt{N_{\text{eff}}}},
\]</span> dove <span class="math inline">\(N_{\text{eff}}\)</span> dove rappresenta la dimensione effettiva del campione, ovvero il numero equivalente di campioni indipendenti che fornirebbero la stessa quantità di informazione dei nostri campioni autocorrelati.</p>
<p>L’interpretazione del MCSE richiede una valutazione contestuale. Un valore di MCSE considerevolmente inferiore alla scala tipica del parametro in esame indica una stima precisa e affidabile. Al contrario, valori elevati di MCSE segnalano che la nostra approssimazione potrebbe essere eccessivamente “rumorosa” e quindi potenzialmente inaffidabile. Una regola pratica suggerisce di auspicare un MCSE almeno un ordine di grandezza inferiore alla deviazione standard della stima stessa.</p>
<p>Quando ci confrontiamo con valori di MCSE troppo elevati, diverse strategie corrective si rendono disponibili. L’aumento del numero di campioni rappresenta l’approccio più diretto, sebbene non sempre il più efficiente. Alternative più raffinate includono il miglioramento dell’efficienza del campionamento attraverso la regolazione dei parametri dell’algoritmo o l’ottimizzazione del modello per ridurre l’autocorrelazione tra i campioni.</p>
<p>Il MCSE, considerato congiuntamente ad altre diagnostiche come il test di Geweke, contribuisce a fornire un quadro analitico completo della qualità delle nostre catene MCMC. Questa combinazione di strumenti ci permette di discernere tra risultati robusti e pronti per l’interpretazione sostantiva e quelli che, invece, richiedono ulteriori raffinamenti metodologici prima di poter essere considerati affidabili.</p>
</section></section><section id="transizioni-divergenti-segnali-dallarme-nellalgoritmo-hmc" class="level2" data-number="52.7"><h2 data-number="52.7" class="anchored" data-anchor-id="transizioni-divergenti-segnali-dallarme-nellalgoritmo-hmc">
<span class="header-section-number">52.7</span> Transizioni divergenti: segnali d’allarme nell’algoritmo HMC</h2>
<p>Nel contesto dell’Hamiltonian Monte Carlo (HMC), la comparsa di transizioni divergenti costituisce un segnale diagnostico di fondamentale importanza, il cui significato non dovrebbe essere sottovalutato. Queste transizioni si manifestano quando l’algoritmo incontra difficoltà nel navigare regioni particolarmente complesse dello spazio parametrico, caratterizzate da elevate curvature o geometrie irregolari. In tali circostanze, invece di procedere con un’esplorazione fluida e completa, il campionatore tende a “rimbalzare” in modo inefficace, fallendo nel rappresentare adeguatamente queste zone della distribuzione target.</p>
<p>Le implicazioni di queste transizioni divergenti sono profonde e potenzialmente compromettenti per l’intera analisi. La loro presenza indica che porzioni significative dello spazio dei parametri potrebbero essere state inesplorate, minando così la completezza del campionamento e, di conseguenza, l’affidabilità di qualsiasi inferenza successiva. È come possedere una mappa incompleta di un territorio: le conclusioni tratte rischiano di essere parziali o fuorvianti.</p>
<p>Fortunatamente, quando ci confrontiamo con questo tipo di problematiche, diverse strategie correttive si rivelano disponibili. Un esame attento dei dati può identificare eventuali valori anomali che contribuiscono a creare queste regioni problematiche. Parallelamente, una revisione critica delle distribuzioni a priori può evidenziare specifiche troppo restrittive o mal calibrate che ostacolano il libero movimento dell’algoritmo. La regolazione fine dei parametri operativi dell’HMC, come la dimensione del passo di integrazione o il numero di passi, offre un altro canale di intervento per migliorare l’efficienza esplorativa. In ultima istanza, una riparametrizzazione del modello potrebbe rivelarsi necessaria per semplificare la geometria dello spazio da esplorare.</p>
<p>La gestione oculata delle transizioni divergenti rappresenta dunque una tappa indispensabile nel percorso verso stime bayesiane robuste e credibili. La loro assenza non è semplicemente un indicatore tecnico tra molti, ma il presupposto necessario per avere fiducia nel fatto che il nostro campionamento abbia catturato in modo esaustivo la ricchezza e la complessità della distribuzione a posteriori di interesse.</p>
</section><section id="la-bayesian-fraction-of-missing-information-bfmi-un-indicatore-di-efficienza-esplorativa" class="level2" data-number="52.8"><h2 data-number="52.8" class="anchored" data-anchor-id="la-bayesian-fraction-of-missing-information-bfmi-un-indicatore-di-efficienza-esplorativa">
<span class="header-section-number">52.8</span> La Bayesian Fraction of Missing Information (BFMI): un indicatore di efficienza esplorativa</h2>
<p>Nell’ambito dei metodi di campionamento avanzati come l’Hamiltonian Monte Carlo (HMC) e il No-U-Turn Sampler (NUTS), la Bayesian Fraction of Missing Information (BFMI) emerge come uno strumento diagnostico di notevole sofisticazione. Questo indicatore ci consente di valutare l’efficacia con cui l’algoritmo sta esplorando la distribuzione a posteriori, offrendo insights che vanno ben oltre le tradizionali misure di convergenza.</p>
<p>La BFMI opera analizzando le fluttuazioni energetiche durante il processo di campionamento. Concettualmente, possiamo paragonare l’energia al “carburante” che alimenta l’esplorazione dello spazio dei parametri da parte dell’algoritmo. Un’esplorazione efficiente richiede il mantenimento di un equilibrio energetico ottimale throughout il percorso esplorativo.</p>
<p>L’interpretazione dei valori di BFMI segue una scala di affidabilità ben definita. Valori superiori o uguali a 0.3 indicano una situazione ideale, in cui l’algoritmo sta esplorando in modo efficace tutte le regioni significative della distribuzione. Quando la BFMI si colloca tra 0.2 e 0.3, è opportuno prestare attenzione, poiché l’esplorazione potrebbe essere solo parziale e merita un esame più approfondito. Valori inferiori a 0.2 costituiscono un vero e proprio campanello d’allarme, segnalando che l’algoritmo sta incontrando serie difficoltà nell’esplorazione e che i risultati potrebbero essere compromessi in termini di affidabilità.</p>
<p>L’importanza della BFMI risiede nella sua capacità di rivelare quando l’algoritmo sta “faticando” nel muovers attraverso lo spazio dei parametri. Questo tipicamente accade in presenza di distribuzioni a posteriori con geometrie complesse, forti correlazioni tra parametri, scale parametriche eterogenee o regioni caratterizzate da curvature particolarmente accentuate.</p>
<p>Di fronte a valori di BFMI troppo bassi, diverse strategie correttive possono essere implementate. Una riparametrizzazione del modello, eventualmente attraverso l’utilizzo di trasformazioni appropriate, può semplificare significativamente l’esplorazione. La regolazione della “massa” dei parametri nell’ambito dell’HMC può migliorare l’efficienza del movimento. Inoltre, una verifica delle distribuzioni a priori è essenziale, poiché prior eccessivamente restrittive possono introdurre barriere artificiali all’esplorazione.</p>
<p>La BFMI rappresenta dunque molto più di un mero indicatore tecnico; essa costituisce una finestra privilegiata sul comportamento interno del nostro algoritmo di campionamento. Una vigilanza attenta su questo parametro ci permette di garantire che le nostre inferenze bayesiane siano fondate su un’esplorazione completa e affidabile dello spazio dei parametri, condizione essenziale per la validità dei nostri risultati analitici.</p>
</section><section id="la-leave-one-out-cross-validation-uno-sguardo-allaffidabilità-predittiva-del-modello" class="level2" data-number="52.9"><h2 data-number="52.9" class="anchored" data-anchor-id="la-leave-one-out-cross-validation-uno-sguardo-allaffidabilità-predittiva-del-modello">
<span class="header-section-number">52.9</span> La Leave-One-Out Cross-Validation: uno sguardo all’affidabilità predittiva del modello</h2>
<p>La Leave-One-Out Cross-Validation (LOO) emerge come una delle metodologie più raffinate per valutare la capacità predittiva dei modelli bayesiani. Questo approccio ci consente di rispondere a una domanda fondamentale: quanto possiamo fidarci delle previsioni del nostro modello quando incontra nuove osservazioni?</p>
<p>Il principio alla base della LOO è tanto elegante quanto efficace. Immaginiamo di voler testare la robustezza del nostro modello attraverso un esperimento concettuale: ripetutamente, escludiamo una singola osservazione dal nostro dataset, addestriamo il modello sulle restanti, e verifichiamo quanto bene riesce a predire proprio l’osservazione che aveva messo da parte. Questo processo viene iterato per ogni punto dati, offrendo così una valutazione completa delle performance predittive.</p>
<p>Il vero valore della LOO risiede nella sua capacità di prevenire due rischi opposti ma ugualmente pericolosi. Da un lato, ci protegge dall’overfitting, quel fenomeno per cui un modello si adatta così perfettamente ai dati di training da perdere la capacità di generalizzare a nuove situazioni. Dall’altro, evita l’underfitting, dove un modello troppo semplice fallisce nel catturare le pattern sottostanti nei dati.</p>
<p>Nella pratica bayesiana, la LOO si traduce in metriche quantitative come l’LOOIC (Leave-One-Out Information Criterion), che sintetizza in un unico valore la bontà predittiva del modello. Un LOOIC più basso indica generalmente un migliore equilibrio tra adattamento ai dati e capacità di generalizzazione.</p>
<p>Tuttavia, l’interpretazione dei risultati LOO richiede una certa cautela. Differenze sostanziali nel LOOIC tra modelli alternativi possono guidarci verso scelte più informate, ma è essenziale considerare anche il contesto applicativo e la plausibilità teorica dei modelli in esame.</p>
<p>In ultima analisi, la LOO non rappresenta un test definitivo, ma piuttosto un potente strumento diagnostico che ci aiuta a costruire modelli non solo statisticamente eleganti, ma anche praticamente utili per fare previsioni affidabili nel mondo reale. La sua applicazione sistematica costituisce quindi una tappa cruciale nel percorso verso modelli bayesiani robusti e credibili.</p>
</section><section id="il-parametro-κ-un-indicatore-cruciale-per-laffidabilità-delle-stime" class="level2" data-number="52.10"><h2 data-number="52.10" class="anchored" data-anchor-id="il-parametro-κ-un-indicatore-cruciale-per-laffidabilità-delle-stime">
<span class="header-section-number">52.10</span> Il parametro κ: un indicatore cruciale per l’affidabilità delle stime</h2>
<p>Il parametro κ (kappa) rappresenta un indicatore fondamentale nel contesto del campionamento bayesiano, particolarmente quando si utilizza il Pareto Smoothed Importance Sampling (PSIS). Questo parametro funge da vero e proprio “termometro” della qualità delle nostre stime, rivelando quanto possiamo fidarci dei risultati ottenuti.</p>
<p>Immaginiamo di dover stimare le preferenze alimentari di una grande popolazione. Se interrogassimo solo poche persone con gusti particolarmente estremi, le nostre conclusioni risulterebbero distorte. Allo stesso modo, nel campionamento statistico, alcuni valori estremi possono influenzare eccessivamente le nostre stime, compromettendone l’affidabilità.</p>
<p>Il parametro κ misura proprio questo rischio. Quando κ assume valori bassi (inferiori a 0.5), indica che il processo di campionamento ha catturato adeguatamente la variabilità dei dati senza essere eccessivamente influenzato da valori anomali. Valori compresi tra 0.5 e 0.7 segnalano una situazione di attenzione: le stime potrebbero essere accettabili, ma meritano un esame più approfondito.</p>
<p>Il vero campanello d’allarme suona quando κ supera 0.7. In questo caso, è probabile che pochi valori estremi stiano dominando il processo di stima, rendendo i risultati potenzialmente inaffidabili. Questa situazione richiede un intervento immediato, che può consistere nel raccogliere più dati, nel ripensare la strategia di campionamento, o nel verificare la presenza di outlier nel dataset.</p>
<p>L’interpretazione di κ diventa particolarmente importante quando utilizziamo tecniche avanzate come la validazione incrociata leave-one-out (LOO-CV), dove un κ elevato può indicare che le stime di capacità predittiva del modello sono compromesse da un numero eccessivo di osservazioni influenti.</p>
<p>In pratica, il monitoraggio sistematico del parametro κ costituisce una buona pratica analitica, permettendoci di distinguere tra risultati solidi e conclusioni che potrebbero essere fuorvianti. Come un buon meccanico che controlla gli indicatori della propria automobile, l’analista bayesiano dovrebbe sempre verificare il valore di κ prima di trarre conclusioni definitive dai propri modelli.</p>
</section><section id="riflessioni-conclusive" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="riflessioni-conclusive">Riflessioni conclusive</h2>
<p>In questo capitolo abbiamo esplorato gli strumenti fondamentali per valutare la qualità dei risultati ottenuti con i metodi MCMC. Per rendere concreti questi concetti, ecco una guida pratica che puoi seguire passo dopo passo.</p>
<section id="protocollo-di-verifica-passo-passo" class="level3" data-number="52.10.1"><h3 data-number="52.10.1" class="anchored" data-anchor-id="protocollo-di-verifica-passo-passo">
<span class="header-section-number">52.10.1</span> Protocollo di verifica passo-passo</h3>
<p>Inizia sempre controllando i messaggi di Stan: assicurati che non ci siano transizioni divergenti e che l’adattamento sia completato correttamente. Prosegui osservando i grafici delle tracce (trace plot): le diverse catene dovrebbero sovrapporsi e mostrare un andamento stabile, senza derive o pattern strani.</p>
<p>Verifica poi l’autocorrelazione tra i campioni: dovrebbe diminuire rapidamente all’aumentare della distanza tra i campioni. Questo ci porta a considerare la dimensione effettiva del campione (<span class="math inline">\(N_{\text{eff}}\)</span>), che dovrebbe essere sufficientemente grande per garantire stime affidabili.</p>
<p>Controlla quindi la statistica <span class="math inline">\(\hat{R}\)</span>: valori vicini a 1 indicano che le catene hanno convergono verso la stessa distribuzione. Valuta anche l’errore standard di Monte Carlo (MCSE), che dovrebbe essere piccolo rispetto alla scala dei parametri.</p>
<p>Per i modelli che usano HMC/NUTS, assicurati che non ci siano transizioni divergenti e che la BFMI sia sufficientemente alta. Infine, se stai confrontando modelli diversi, utilizza gli strumenti predittivi come LOO/PSIS, prestando attenzione al parametro <span class="math inline">\(\kappa\)</span>.</p>
</section><section id="cosa-fare-se-incontri-problemi" class="level3" data-number="52.10.2"><h3 data-number="52.10.2" class="anchored" data-anchor-id="cosa-fare-se-incontri-problemi">
<span class="header-section-number">52.10.2</span> Cosa fare se incontri problemi</h3>
<p>Se noti valori di <span class="math inline">\(\hat{R}\)</span> troppo alti o catene che non si sovrappongono, prova ad aumentare il numero di iterazioni o a rivedere le inizializzazioni. In caso di transizioni divergenti, regola i parametri del campionatore o considera una riparametrizzazione del modello.</p>
<p>Se l’autocorrelazione persiste o la dimensione effettiva del campione è bassa, potresti bisogno di più iterazioni o di ottimizzare la parametrizzazione del modello. Per problemi con la BFMI o valori alti di <span class="math inline">\(\kappa\)</span>, valuta la standardizzazione delle variabili o l’uso di distribuzioni più robuste.</p>
</section><section id="consigli-pratici-per-il-report-dei-risultati" class="level3" data-number="52.10.3"><h3 data-number="52.10.3" class="anchored" data-anchor-id="consigli-pratici-per-il-report-dei-risultati">
<span class="header-section-number">52.10.3</span> Consigli pratici per il report dei risultati</h3>
<p>Quando presenti i tuoi risultati, includi sempre informazioni sulle impostazioni usate: numero di catene, iterazioni, e parametri del campionatore. Riporta i valori diagnostici chiave (<span class="math inline">\(\hat{R}\)</span>, <span class="math inline">\(N_{\text{eff}}\)</span>, MCSE) e menziona eventuali problemi incontrati e come li hai risolti. Non dimenticare di condividere il codice e i dati necessari per garantire la riproducibilità dei tuoi risultati.</p>
</section><section id="quando-fermarsi" class="level3" data-number="52.10.4"><h3 data-number="52.10.4" class="anchored" data-anchor-id="quando-fermarsi">
<span class="header-section-number">52.10.4</span> Quando fermarsi</h3>
<p>Il processo di tuning può considerarsi concluso quando: non ci sono più transizioni divergenti, i trace plot mostrano catene stabili e sovrapposte, <span class="math inline">\(\hat{R}\)</span> è vicino a 1 per tutti i parametri importanti, l’MCSE è sufficientemente piccolo, e gli indicatori predittivi non mostrano problemi critici.</p>
<p>Ricorda: prendersi il tempo per una diagnostica accurata non è una perdita di tempo, ma un investimento necessario per garantire la solidità delle tue conclusioni scientifiche. Meglio un modello semplice ma robusto, che un modello complesso ma inaffidabile.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Informazioni sull'ambiente di sviluppo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Informazioni sull’ambiente di sviluppo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] insight_1.4.2         cmdstanr_0.9.0        pillar_1.11.0        </span></span>
<span><span class="co">#&gt;  [4] tinytable_0.13.0      patchwork_1.3.2       ggdist_3.3.3         </span></span>
<span><span class="co">#&gt;  [7] tidybayes_3.0.7       bayesplot_1.14.0      ggplot2_3.5.2        </span></span>
<span><span class="co">#&gt; [10] reliabilitydiag_0.2.1 priorsense_1.1.1      posterior_1.6.1      </span></span>
<span><span class="co">#&gt; [13] loo_2.8.0             rstan_2.32.7          StanHeaders_2.32.10  </span></span>
<span><span class="co">#&gt; [16] brms_2.22.0           Rcpp_1.1.0            sessioninfo_1.2.3    </span></span>
<span><span class="co">#&gt; [19] conflicted_1.2.0      janitor_2.2.1         matrixStats_1.5.0    </span></span>
<span><span class="co">#&gt; [22] modelr_0.1.11         tibble_3.3.0          dplyr_1.1.4          </span></span>
<span><span class="co">#&gt; [25] tidyr_1.3.1           rio_1.2.3             here_1.0.1           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gridExtra_2.3         inline_0.3.21         sandwich_3.1-1       </span></span>
<span><span class="co">#&gt;  [4] rlang_1.1.6           magrittr_2.0.3        multcomp_1.4-28      </span></span>
<span><span class="co">#&gt;  [7] snakecase_0.11.1      compiler_4.5.1        reshape2_1.4.4       </span></span>
<span><span class="co">#&gt; [10] systemfonts_1.2.3     vctrs_0.6.5           stringr_1.5.1        </span></span>
<span><span class="co">#&gt; [13] pkgconfig_2.0.3       arrayhelpers_1.1-0    fastmap_1.2.0        </span></span>
<span><span class="co">#&gt; [16] backports_1.5.0       labeling_0.4.3        rmarkdown_2.29       </span></span>
<span><span class="co">#&gt; [19] ps_1.9.1              ragg_1.5.0            purrr_1.1.0          </span></span>
<span><span class="co">#&gt; [22] xfun_0.53             cachem_1.1.0          jsonlite_2.0.0       </span></span>
<span><span class="co">#&gt; [25] broom_1.0.9           parallel_4.5.1        R6_2.6.1             </span></span>
<span><span class="co">#&gt; [28] stringi_1.8.7         RColorBrewer_1.1-3    lubridate_1.9.4      </span></span>
<span><span class="co">#&gt; [31] estimability_1.5.1    knitr_1.50            zoo_1.8-14           </span></span>
<span><span class="co">#&gt; [34] pacman_0.5.1          Matrix_1.7-4          splines_4.5.1        </span></span>
<span><span class="co">#&gt; [37] timechange_0.3.0      tidyselect_1.2.1      abind_1.4-8          </span></span>
<span><span class="co">#&gt; [40] yaml_2.3.10           codetools_0.2-20      curl_7.0.0           </span></span>
<span><span class="co">#&gt; [43] processx_3.8.6        pkgbuild_1.4.8        plyr_1.8.9           </span></span>
<span><span class="co">#&gt; [46] lattice_0.22-7        withr_3.0.2           bridgesampling_1.1-2 </span></span>
<span><span class="co">#&gt; [49] coda_0.19-4.1         evaluate_1.0.5        survival_3.8-3       </span></span>
<span><span class="co">#&gt; [52] RcppParallel_5.1.11-1 tensorA_0.36.2.1      checkmate_2.3.3      </span></span>
<span><span class="co">#&gt; [55] stats4_4.5.1          distributional_0.5.0  generics_0.1.4       </span></span>
<span><span class="co">#&gt; [58] rprojroot_2.1.1       rstantools_2.5.0      scales_1.4.0         </span></span>
<span><span class="co">#&gt; [61] xtable_1.8-4          glue_1.8.0            emmeans_1.11.2-8     </span></span>
<span><span class="co">#&gt; [64] tools_4.5.1           mvtnorm_1.3-3         grid_4.5.1           </span></span>
<span><span class="co">#&gt; [67] QuickJSR_1.8.0        colorspace_2.1-1      nlme_3.1-168         </span></span>
<span><span class="co">#&gt; [70] cli_3.6.5             textshaping_1.0.3     svUnit_1.0.8         </span></span>
<span><span class="co">#&gt; [73] Brobdingnag_1.2-9     V8_7.0.0              gtable_0.3.6         </span></span>
<span><span class="co">#&gt; [76] digest_0.6.37         TH.data_1.1-4         htmlwidgets_1.6.4    </span></span>
<span><span class="co">#&gt; [79] farver_2.1.2          memoise_2.0.1         htmltools_0.5.8.1    </span></span>
<span><span class="co">#&gt; [82] lifecycle_1.0.4       MASS_7.3-65</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section></section><section id="bibliografia" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-martin2022bayesian" class="csl-entry" role="listitem">
Martin, O. A., Kumar, R., &amp; Lao, J. (2022). <em>Bayesian Modeling and Computation in Python</em>. CRC Press.
</div>
</div>
</section></main><!-- /main --><script>
document.body.classList.add('classic-book');
document.addEventListener('DOMContentLoaded', function() {
  const paragraphs = document.querySelectorAll('p');
  paragraphs.forEach(p => {
    if (p.textContent.length > 200) {
      p.style.hyphens = 'auto';
      p.style.hyphenateCharacter = '-';
    }
  });
  const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
  headings.forEach(h => {
    h.style.fontFeatureSettings = '"liga" 1, "dlig" 1, "smcp" 1';
  });
});
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/mcmc/03_stan_intro.html" class="pagination-link" aria-label="Introduzione pratica a Stan">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Introduzione pratica a Stan</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/mcmc/06_mcmc_prediction.html" class="pagination-link" aria-label="Controlli predittivi bayesiani (a priori e a posteriori) con `cmdstanr`">
        <span class="nav-page-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Controlli predittivi bayesiani (a priori e a posteriori) con <code>cmdstanr</code></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> è una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/mcmc/05_stan_diagnostics.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>