# Flusso di lavoro bayesiano {#sec-mcmc-workflow}

::: {.epigraph}

> “Bayesian data analysis is not a set of methods but a way of thinking: building models, checking them, and learning from the misfits.”
>
> — **Andrew Gelman**, Bayesian Data Analysis (2013)
:::


## Introduzione {.unnumbered .unlisted}

<p class="capo"> <span class="capo-initial" data-bg="1">F</span> are analisi bayesiana non si riduce alla semplice applicazione della formula di Bayes per ottenere delle stime. Nella pratica della ricerca, è necessario un approccio più ampio e strutturato: il *workflow bayesiano*. Si tratta di un processo ciclico che guida il ricercatore nel trasformare un'idea iniziale – una domanda di ricerca – in un modello solido e convincente, in grado di generare previsioni plausibili e di fornire una base fondata per le conclusioni. </p>

Immaginiamo di voler valutare l’efficacia di un nuovo intervento psicologico. Non basta raccogliere i dati e stimare i parametri: bisogna decidere quali variabili considerare, come trattare le differenze tra individui e gruppi, quali assunzioni fare sulle distribuzioni, e come controllare che il modello davvero rifletta la realtà osservata. Tutto questo richiede un percorso iterativo di costruzione, verifica e revisione.

In breve: il workflow bayesiano è un *metodo per fare ricerca in modo più consapevole e trasparente*.

### Panoramica del capitolo {.unnumbered .unlisted}

* Cos’è un workflow bayesiano e perché è utile nella ricerca.
* Le principali fasi del processo: formulare, verificare e migliorare un modello.
* Le verifiche predittive, cioè le simulazioni che ci aiutano a capire se il modello funziona.
* L'*analisi multiverso*, un approccio che esplora più modelli alternativi in modo trasparente.

---

::: {.callout-tip collapse=true}
## Prerequisiti

Può essere utile aver letto [Bulbulia (2023) su workflow e inferenza causale](https://www.researchgate.net/profile/Joseph-Bulbulia/publication/361799820_A_workflow_for_causal_inference_in_cross-cultural_psychology-A-workflow-for-causal-inference-in-cross-cultural-psychology/links/62c5cad2f8c0fc18d3ec9798/A-workflow-for-causal-inference-in-cross-cultural-psychology-A-workflow-for-causal-inference-in-cross-cultural-psychology.pdf).
:::


## Il ciclo di Box

Negli anni ’60, lo statistico George Box descrisse la modellizzazione come un ciclo continuo di *costruzione, valutazione e revisione*. Questo approccio, noto come *Ciclo di Box*, è diventato un punto di riferimento anche per il workflow bayesiano.

L’idea chiave è semplice: i modelli non sono mai perfetti, ma strumenti che possono essere continuamente migliorati.

![Figura tratta da @blei2014build.](../../figures/boxes_loop.png)

Il ciclo comprende quattro fasi:

1. **Formulare un modello** sulla base delle conoscenze disponibili;
2. **Fare inferenza**, cioè stimare parametri e incertezze;
3. **Valutare il modello**, controllando quanto descrive bene i dati;
4. **Rivedere il modello**, correggendo le discrepanze.

Il flusso di lavoro bayesiano si integra bene con questo ciclo perché le nostre convinzioni possono essere aggiornate man mano che arrivano nuovi dati.


## Le fasi del workflow bayesiano

Nella pratica, il workflow bayesiano segue alcune tappe principali:

* **Definizione della domanda di ricerca**: partire da un problema chiaro e da un’ipotesi sul processo che genera i dati.
* **Costruzione del modello**: tradurre l’ipotesi in un modello probabilistico.
* **Simulazioni a priori**: generare dati fittizi dai soli *priori* per capire se le ipotesi iniziali sono ragionevoli.
* **Adattamento ai dati**: stimare i parametri del modello sui dati osservati.
* **Verifiche a posteriori**: confrontare i dati osservati con quelli simulati a partire dal modello stimato.
* **Diagnostiche**: controllare che il procedimento di stima sia andato a buon fine (per esempio, che le catene MCMC abbiano esplorato bene lo spazio dei parametri).
* **Iterazione**: tornare indietro e migliorare il modello quando necessario.

Questa sequenza non è lineare: spesso bisogna ripetere più volte alcuni passaggi, fino a raggiungere un equilibrio tra semplicità e capacità esplicativa.


## Verifiche predittive

Uno strumento centrale sono le **verifiche predittive**.

* Le **verifiche a priori** controllano che i *priori* scelti non producano scenari irrealistici.
* Le **verifiche a posteriori** servono per confrontare i dati osservati con i dati che il modello, una volta stimato, sarebbe capace di generare.

Se il modello produce dati molto diversi da quelli reali, vuol dire che qualcosa va rivisto.

Queste verifiche non sono test statistici “passa/non passa”, ma occasioni di apprendimento: ci dicono dove il modello funziona e dove deve essere migliorato.


## Analisi multiverso

Un’estensione recente del workflow bayesiano è l’**analisi multiverso** \[@steegen2016increasing; @riha2024supporting].

L’idea è semplice: invece di puntare su un unico modello, esploriamo più modelli possibili, ognuno basato su scelte diverse (per esempio, variabili incluse, tipo di distribuzione, forma della relazione).

I vantaggi sono:

* maggiore trasparenza sulle scelte fatte;
* confronto diretto tra alternative;
* conclusioni più robuste, perché sappiamo quanto dipendono dalle assunzioni iniziali.

Ovviamente, più modelli significano anche più complessità. Per gestirla, sono stati proposti approcci di “filtraggio iterativo”: si parte da molti modelli e, passo dopo passo, si scartano quelli che non funzionano bene, fino a concentrarsi su un insieme ristretto e più solido.

Un esempio è l’analisi di dati clinici sulle crisi epilettiche (studio di Leppik et al., 1987). In quel caso, decine di modelli sono stati confrontati utilizzando criteri predittivi come l’ELPD (*Expected Log Predictive Density*). Alcuni modelli si sono rivelati poco plausibili, altri molto più predittivi e stabili. Questo dimostra come l’analisi multiverso possa rendere le conclusioni più affidabili, senza ridursi a una sola scelta arbitraria.


## Riflessioni conclusive {.unnumbered .unlisted}

Il workflow bayesiano è un approccio pratico e flessibile per fare ricerca. Non si tratta di una serie di regole rigide, ma di una guida che incoraggia cicli di costruzione, verifica e revisione dei modelli.

Con strumenti come le verifiche predittive e l’analisi multiverso, i ricercatori possono:

* evitare modelli troppo semplici o troppo complicati;
* rendere trasparenti le proprie scelte;
* costruire inferenze più solide e replicabili.

In altre parole, il workflow bayesiano aiuta a trasformare la teoria in pratica, accompagnando il ricercatore in tutte le fasi del processo analitico.


## Bibliografia {.unnumbered .unlisted}
